:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: fakso.fml [17.00]
:: Utworzony: 20.02.2015
:: Autor: [rr]
::======================================================================================================================
:: Zawartość: obsługa wspólnych operacji dla tabeli FAKSO - informacje dodatkowe
::======================================================================================================================


\pobgdnag
::----------------------------------------------------------------------------------------------------------------------
::  UTW: rr [2008]
:: OPIS: pobiera i porzadkuje dane naglowkowe
::   WE: _a - typ naglowka F-faktura M-magazyn Z-zamowienie D-dostawa
::       _b - ref naglowka
::   WY: 1
::  OLD: \pobgdnag/autfakso.fml
::----------------------------------------------------------------------------------------------------------------------
VAR_DEL.delete('M_GD','S_GD');
M_GD:=tab_tmp(3
   ,'GD','STRING[1]'  ,''
   ,'LK','INTEGER'  ,''
   ,'PZ','INTEGER'    ,''
   ,'OP','STRING[255]','');
S_GD:=tab_tmp(2
   ,'GD','STRING[1]',''
   ,'LK','INTEGER'  ,'');
_ind:={? _a='F' || 'FAKS' |? _a='M' || 'ND' |? _a='Z' || 'ZK_N' |? _a='D' || 'ZD_NAG' ?};
FAKSO.cntx_psh();
{? _a='F' || FAKSO.use('fakto' + (FAKS.name() + 3))
|? _a='M' || FAKSO.use('fakto' + (ND.name() + 3))
|? _a='Z' || FAKSO.use('fakto' + (ZK_N.name() + 3))
|? _a='D' || FAKSO.use('fakto' + (ZD_NAG.name() + 3))
?};
FAKSO.index(_ind);
FAKSO.prefix(_b);
{? FAKSO.first()
||
   _i:=0;
   {!
   |? {? 'ATA'*FAKSO.PRN
      ||
         _i+=1;
:: MOD: SITEK - obsluga zamowien klienta zrobiona w faktury_wydruk_new.m
         {? FAKSO.T<>'Symbole zamówień klienta do faktury'
         || M_GD.GD:=1 + FAKSO.GD; M_GD.PZ:=_i; M_GD.LK:=#(FAKSO.GD + 1);
            M_GD.OP:=exec('printFAKSO','fakso',PARAM_W.JEZYK);
            M_GD.add(1);
            {? ~S_GD.find_key(M_GD.GD,M_GD.LK)
            || 
               S_GD.GD:=M_GD.GD; S_GD.LK:=M_GD.LK; S_GD.add(1)
            ?}
         ?}
      ?};
      FAKSO.next()
   !}
?};
FAKSO.cntx_pop();
1


