:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: obe_faw.fml
:: Utworzony: 23.06.2020
:: Autor: MB
::======================================================================================================================
:: Zawartość: Formuły obszaru OBE do obsługi wniosków w obiegu
::======================================================================================================================


\create_red
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [20.42]
:: OPIS: Tworzy okno redagowania dla wniosku
::   WE:  _a  - obiekt do obsługi tabel
::       [_b] - tylko informacje dodatkowe? 1-tak 0-nie
::       [_c] - typ akcji: 'R'-rejestracja 'P'-przekazania 'A'-akceptacji 'D'-wyświetlenie
::       [_d] - czy dodać przycisk zakończ? [1]-tak 0-nie
::----------------------------------------------------------------------------------------------------------------------
_obj:=_a;
_tab:=_obj.getTab('REKORD');
_all:=0;
_w_str:=100;
_w_number:=13;
_edok:=var_pres('_b')<=0 | _b=0;
_akcja:={? var_pres('_c')>0 || _c || 'D' ?};
_dokum:=EDOKUM.DOKUM<>'';
_istyp:=EDOKUM.TYP<>null;
EDOKUM.TYP();
_wp:=ETYPY.W_PORTAL<>'N';
_seod:=ETYPY.W_PORTAL='S';
ETYP_ATR.cntx_psh();
ETYP_ATR.index('KOLZ'); ETYP_ATR.prefix(EDOKUM.TYP,null);
_atr:=ETYP_ATR.first();
ETYP_ATR.cntx_pop();
_tabs:=_all | ETYPY.CZY_KH | _dokum | ETYPY.CZY_ZALP='T' | ETYPY.DEKR='T' | _atr | _edok & EDOKUM.ODD=null;
_tyt:={? _edok || 'Wniosek' || 'Informacje dodatkowe' ?};
_editable:={? _akcja='R' || 'editable=1'  || 'editable=0' ?};
_red:=_tab.mk_edit(_tyt,,'obe_faw_red');
{? _edok
|| {? _tabs
   || _tab.win_etab(_red,'Dane ogólne'@)
   ?};
   _tab.win_esep(_red,'Dane ogólne'@);
   {? _wp
   || _tab.win_efld(_red,EDOKUM,'DATAW',,,,,,'Data rejestracji'@);
      _tab.efld_opt(_red,_editable,EDOKUM,'DATAW')
   ?};
   {? ETYPY.CZY_DOPE='T' | _all
   || _tab.win_efld(_red,EDOKUM,'DOP',,,,,,'Operacja z dnia'@);
      _tab.efld_opt(_red,_editable+',mark=1',EDOKUM,'DOP')
   ?};
   {? exec('be_id_edokum1','obiegi') | _all
   || _tab.win_efld(_red,EDOKUM,'ID',,,_w_str);
      _tab.efld_opt(_red,_editable,EDOKUM,'ID')
:: mark, edit
   ?};
   _tab.win_efld(_red,EDOKUM,'TYP','NAZWA','DISP6',_w_str-3,,0,'Typ'@);
   {? _istyp
   || _tab.efld_opt(_red,'mark=0, enable=1, editable=0',EDOKUM,'TYP')
   || _tab.efld_opt(_red,'mark=1, enable=1, '+_editable,EDOKUM,'TYP')
   ?};
   {? ETYPY.W_PORTAL<>'P'
   || _tab.win_efld(_red,OBIEGI,'OSOBAOBI',,'OSOBA',_w_str-3,,,'Osoba'@,,,,'F3_button=1');
      {? ETYPY.CZY_ZALP='T' & ETYPY.ETYPZAL
      || {? ETYPY.CZY_PRAC
         || _tab.efld_opt(_red,'mark=1, enable=1, '+_editable,OBIEGI,'OSOBAOBI')
         || _tab.efld_opt(_red,'mark=1, enable=1, editable=0',OBIEGI,'OSOBAOBI')
         ?}
      |? ETYPY.CZY_PRAC
      || _tab.efld_opt(_red,'mark=0, enable=1, '+_editable,OBIEGI,'OSOBAOBI')
      || _tab.efld_opt(_red,'mark=0, enable=1, editable=0',OBIEGI,'OSOBAOBI')
      ?}
   |? ETYPY.CZY_PRAC
   || OBIEGI.fld_fml('PRAC','BEFORE_DISPLAY',"exec('prac_fld','portal_paperless','BD')");
      OBIEGI.fld_fml('PRAC','F3',"exec('prac_fld','portal_paperless','F3')");
      OBIEGI.fld_fml('PRAC','AFTER_EDIT',"exec('prac_fld','portal_paperless','AE')");
      OBIEGI.PRAC:='';
      _tab.win_efld(_red,OBIEGI,'PRAC',,,_w_str-3,,,'Pracownik'@,,,,'F3_button=1');
      {? EDOKUM.PAPERLES
      || _tab.efld_opt(_red,'mark=1, enable=1, '+_editable,OBIEGI,'PRAC')
      || _tab.efld_opt(_red,_editable,OBIEGI,'PRAC')
      ?}
   ?};
   _tab.win_efld(_red,EDOKUM,'ALERTY',,,,,,'Wysłanie emaili'@,,,'check-box',,"'T'","'N'");
   _tab.efld_opt(_red,_editable,EDOKUM,'ALERTY');
   {? ETYPY.CZY_WAR | _all
   || _tab.win_esep(_red,'Wartości'@);
      _tab.win_efld(_red,EDOKUM,'WAL','KOD','SL',_w_str-3,,,'Waluta transakcji'@);
      _tab.efld_opt(_red,_editable,EDOKUM,'WAL');
      {? ETYPY.CZY_WAR=2 | ETYPY.CZY_WAR=3
      || _tab.win_efld(_red,EDOKUM,'NETTO',,,_w_number,2,,'Wartość netto'@);
         _tab.efld_opt(_red,_editable,EDOKUM,'NETTO')
      ?};
      {? ETYPY.CZY_WAR=1 | ETYPY.CZY_WAR=3
      || _tab.win_efld(_red,EDOKUM,'WART',,,_w_number,2,,'Wartość brutto'@);
         _tab.efld_opt(_red,_editable+{? ETYPY.CZY_ZALP='T' || ',mark=1' || '' ?},EDOKUM,'WART')
      ?};
      {? ETYPY.ZAPOT
      || _tab.win_efld(_red,EDOKUM,'TP',,,,,,'Termin'@);
         _tab.efld_opt(_red,_editable,EDOKUM,'TP')
      ?}
   ?};
   {? ETYPY.CZY_KH | _all | _dokum
   || _tab.win_esep(_red,'Kontrahent'@);
      SKID.SL_KH:={? ETYPY.DOM_SL || ETYPY.DOM_SL().SLU().NAZ || '' ?};
      _tab.win_efld(_red,SKID,'SL_KH',,,_w_str-3,,,'Źródło pochodzenia'@,,,,'F3_button=1');
      _tab.efld_opt(_red,_editable,SKID,'SL_KH');
      SKID.fld_fml('SL_KH','BEFORE_EDIT',"exec('besldob','obiegi')");
      SKID.NIP:={? EDOKUM.KHKH || EDOKUM.KHKH().NIP || '' ?};
      _tab.win_efld(_red,SKID,'NIP',,,20,,,'NIP'@);
      _tab.efld_opt(_red,_editable,SKID,'NIP');
      _tab.win_efld(_red,EDOKUM,'KH','KOD','SL',_w_str-3,,,'Kod'@);
      _tab.efld_opt(_red,'mark='+$(ETYPY.DEKR='T' | _dokum)+', '+_editable,EDOKUM,'KH')
   ?};
   {? ETYPY.CZY_DATY | _all
   || _tab.win_esep(_red,'Zakres dat i godzin'@);
      _tab.win_efld(_red,EDOKUM,'DATA_OD',,,,,,'Od dnia'@);
      _tab.efld_opt(_red,_editable,EDOKUM,'DATA_OD');
      {? ETYPY.CZY_DATY=2 | _all
      || _tab.win_efld(_red,EDOKUM,'GODZ_OD',,,13,,,'Od godziny'@);
         _tab.efld_opt(_red,_editable,EDOKUM,'GODZ_OD')
      ?};
      _tab.win_efld(_red,EDOKUM,'DATA_DO',,,,,,'Do dnia'@);
      _tab.efld_opt(_red,_editable,EDOKUM,'DATA_DO');
      {? ETYPY.CZY_DATY=2 | _all
      || _tab.win_efld(_red,EDOKUM,'GODZ_DO',,,13,,,'Do godziny'@);
         _tab.efld_opt(_red,_editable,EDOKUM,'GODZ_DO')
      ?}
   ?};
   {? EDOKUM.TYP().W_PORTAL='N'
   || _tab.win_esep(_red,'Opis'@);
      {? ETYPY.ED_TEMAT='T' | _all
      || _tab.win_efld(_red,EDOKUM,'TR',,,_w_str,,,'Temat'@);
         _tab.efld_opt(_red,'mark=1 '+_editable,EDOKUM,'TR')
      ?};
      _tab.win_efld(_red,EDOKUM,'UW_OPDL',,,_w_str,,,'Treść'@);
      _tab.efld_opt(_red,_editable,EDOKUM,'UW_OPDL');
      EDOKUM.memo_get(,'UW_OPDL')
   ?}
?};
_editInnd:=exec('blok_innd','obiegi',OBIEGI.B_PREL)=0 | _akcja='R' & EDOKUM.TYP().W_PORTAL='N' & ETYPY.IN_POR;
_edit:=_editInnd & _editable+1='1';

{? EDOKUM.TYP().ATR_G1R
|| EDOK_ATR.cntx_psh();
   EDOK_ATR.use('edokat'+(EDOKUM.name()+2));
   EDOK_ATR.index('REKKOLED'); EDOK_ATR.prefix(EDOKUM.ref(),null,'',);
   {? _edit & ~EDOK_ATR.first()
   || refr_okn:=0;
      OBIEGI.TYP_ID:='D';
      _msg:=exec('edk_atr_dolacz','obiegi',0,0,1);
      VAR_DEL.delete('refr_okn')
   ?};
   EDOK_ATR.cntx_pop()
?};
{? EDOKUM.TYP().IDINHEAD | _wp | _edok=0
|| exec('get_atr','obe_faw',_obj);
   {? _akcja<>'D' || exec('set_atr','obe_faw',_obj) ?};
   ETYP_ATR.cntx_psh();
   {? _wp
   || ETYP_ATR.index('SECWP')
   || ETYP_ATR.index('KOLZ')
   ?};
   ETYP_ATR.prefix(EDOKUM.TYP,null);
   {? ETYP_ATR.first()
   || {? _edok & 0
      || _tab.win_etab(_red,'Informacja dodatkowa'@)
      ?};
      _first:=1;
      {? EDOKUM.TYP().ATR_ONE=0 & ~_wp
      || _tab.win_esep(_red,{? _wp || 'Dane wniosku (HR Portal)' || 'Informacja dodatkowa'@ ?});
         _tab.win_efld(_red,,'REKORD',,,_w_number,,,'Pozycja'@);
         _tab.fld_fml('REKORD','BEFORE_EDIT',"0");
         _first:=0
      ?};
      _wp_sect:='';
      {!
      |? {? ETYP_ATR.TAT & (~_wp | _seod | ETYP_ATR.VISIBLE)
         || _pole:='P'+$ETYP_ATR.KOL;
            _tabela:=_obj.getTab(_pole);
            _naz:=60+ETYP_ATR.TAT().OPIS;
            _typ:=ETYP_ATR.TAT().TYP;
            _opis:=ETYP_ATR.memo_txt(,1,'OPIS');
            {? (_opis*'deklaracja będzie obowiązywała')>0
               | (42+_opis='Deklaruję chęć oszczędzania w pracowniczym')
               | (32+_opis='Oświadczam, że mam zawarte umowy') | (38+_opis='Przesłanie deklaracji będzie oznaczało')
            || _tab.win_esep(_red,'');
               ETYP_ATR.cntx_psh();
               ETYP_ATR.memo_set(_opis,'OPIS');
               _tab.win_efld(_red,ETYP_ATR,'OPIS',,,_w_str-3,-2,1,'',1);
               ETYP_ATR.cntx_pop()
            |? EDOKUM.TYP().NAZWA=exec('nazwa_rachunek','obiegi')
            || {? (_opis*'Dane aktualne')>0
               || _tab.win_esep(_red,'Dane aktualne'@)
               |? (_opis*'Dane dotychczasowe')>0
               || _tab.win_esep(_red,'Dane dotychczasowe'@)
               |? 5+_opis='Konto'
               || _tab.win_esep(_red,_opis)
               ?}
            ?};
            {? _wp

            || {? _wp_sect<>ETYP_ATR.SECTION & ETYP_ATR.SECTION<>''
               || _tab.win_esep(_red,ETYP_ATR.SECTION);
                  _wp_sect:=ETYP_ATR.SECTION;
                  _first:=0
               ?}
            ?};
            {? _first
            || _first:=0;
               {? _typ<>'O' & EDOKUM.TYP().NAZWA<>exec('nazwa_rachunek','obiegi')
               || _tab.win_esep(_red,'Informacja dodatkowa'@)
               ?}
            ?};
            {? _typ='O'
:: Nagłowek
            || _opis:=ETYP_ATR.memo_txt(,1,'OPIS');
               {? +_opis>60 || _opis:=60+_opis ?};
               {? _opis<>''
               || _tab.win_esep(_red,_opis)
               ?}
            ?};
            {? var_press('_tabela')>0
            ||
               {? _typ='L'
:: Liczba
               || _tab.win_efld(_red,_tabela,_pole,,,_w_number,ETYP_ATR.TAT().PREC,,_naz)
               |? _typ='B'
:: Tak/nie
               || _tab.win_efld(_red,_tabela,_pole,,,,,,_naz,,,'check-box',,"'T'","'N'")
               |? _typ='D'
:: Data
               || _tab.win_efld(_red,_tabela,_pole,,,10,,,_naz)
               |? _typ='C'
:: czas
               || _tab.win_efld(_red,_tabela,_pole,,,10,,,_naz)
               |? _typ='S' & ETYP_ATR.TAT().SLU
:: Słownik
               || _tab.win_efld(_red,_tabela,_pole,,,_w_str-3,,,_naz,,,,'F3_button=1');
                  _tabela.fld_fml(_pole,'F3',"exec('akc_f3','obe_faw')");
                  _tabela.fld_fml(_pole,'AFTER_EDIT',"exec('akc_ae','obe_faw')")
               |? _typ='U' & ETYP_ATR.TAT().UD_SCH
:: Schemat struktury
               || _tab.win_efld(_red,_tabela,_pole,,,_w_str-3,,,_naz,,,,'F3_button=1');
                  _tabela.fld_fml(_pole,'F3',"exec('akc_f3','obe_faw')");
                  _tabela.fld_fml(_pole,'AFTER_EDIT',"exec('akc_ae','obe_faw')")
               |? _typ='X' & ETYP_ATR.TSLO<>''
:: Dowolny słownik
:: TODO - poprawić zależności pomiędzy polami
               || {? ETYP_ATR.SLO_CHG
                  || _tab.win_efld(_red,_tabela,_pole,,,_w_str-3,,,_naz,,,,'F3_button=1');
                     _tabela.fld_fml(_pole,'F3',"exec('akc_f3','obe_faw')")
                  || _tab.win_efld(_red,_tabela,_pole,,,_w_str-3,,,_naz,,,,'F3_button=1');
                     _tabela.fld_fml(_pole,'F3',"exec('akc_f3','obe_faw')");
                     _tabela.fld_fml(_pole,'AFTER_EDIT',"exec('akc_ae','obe_faw')")
                  ?}
               |? _typ='W'
               || _tab.win_efld(_red,_tabela,_pole,,,_w_str,-3,,_naz)
               |? _seod & _typ='T' & ETYP_ATR.TAT().PORSLO
               || _tab.win_efld(_red,_tabela,_pole,,,_w_str-3,,,_naz,,,,'F3_button=1');
                  _tabela.fld_fml(_pole,'F3',"exec('akc_f3','obe_faw')");
                  _tabela.fld_fml(_pole,'AFTER_EDIT',"exec('akc_ae','obe_faw')")
               || _tab.win_efld(_red,_tabela,_pole,,,_w_str,,,_naz)
               ?};
               {? _typ<>'O'
               || _tab.efld_opt(_red,'mark='+$(ETYP_ATR.WYMAG='T')+{? _edit || '' || ',editable=0'?},_tabela,_pole);
                  {? ETYP_ATR.EDIT='T' | ~_edit
                  || _tabela.fld_fml(_pole,'BEFORE_EDIT',"0")
                  ?}
               ?};
:: TODO - poprawić formuły po redakcji pól
               {? ETYP_ATR.AE<>''
               || _tabela.fld_fml(_pole,'AFTER_EDIT',$ETYP_ATR.AE)
               ?}
            ?};
            &_tabela
         ?};
         ETYP_ATR.next()
      !}
   ?};
   ETYP_ATR.cntx_pop()
?};
{? _edok & (ETYPY.CZY_ZALP='T' | _all)
|| _tab.win_etab(_red,'Dane zaliczki'@);
   _tab.win_esep(_red,'Dane zaliczki'@);
   _tab.win_efld(_red,EDOKUM,'KASPRZEL',,,10,,,'Realizacja poprzez'@,,,'radio-buttons',,'Kasę'@,"'K'",'Przelew'@,"'P'");
   _tab.win_efld(_red,EDOKUM,'N',,,36,,,'Rachunek bankowy pracownika'@,,,,'F3_button=1');
   _tab.efld_opt(_red,_editable+{? EDOKUM.KASPRZEL='P' || ',mark=1' || ',mark=0' ?},EDOKUM,'N');
   _tab.win_efld(_red,EDOKUM,'PLACE',,,,,,'Rozliczane w płacach'@,,,'check-box',,"'T'","'N'");
   _tab.win_efld(_red,EDOKUM,'POTRODDN',,,,,,'Od dnia'@);
   _tab.efld_opt(_red,_editable+{? EDOKUM.PLACE='T' || ',mark=1' || ',mark=0' ?},EDOKUM,'POTRODDN')
?};
{? _edok
|| {? ETYPY.DEKR='T' | _all | EDOKUM.ODD=null
   || {? _tabs || _tab.win_etab(_red,'Dekretacja'@) ?};
      _tab.win_esep(_red,'Dekretacja wniosku'@);
      _tab.win_efld(_red,EDOKUM,'ODD','OD','ODDZIALY',,,,'Jednostka księgowa'@);
      {? ETYPY.DEKR='T' | _all
      || _tab.win_efld(_red,EDOKUM,'DATDOK',,,10,,1,'Data dokumentu'@);
         _tab.win_efld(_red,EDOKUM,'REJ','KOD','KOD',10,,1,'Rejestr'@);
         _tab.win_efld(_red,EDOKUM,'NREJ',,,10,,1,'Numer w rejestrze'@)
      ?}
   ?}
?};
{? _edok
|| {? ~_istyp | (~EDOKUM.TYP().IDINHEAD & ETYPY.W_PORTAL='N')
   || _ind_fml:=$('EDOKUM.cntx_psh(); exec(\'inne_dane\',\'obiegi\',,2,1,'+{? (_akcja='D' | ~_editInnd) || '1' || '0' ?}+'); EDOKUM.cntx_pop(); \'\'');
      _tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=begin,display=1'['Informacje'@],_ind_fml)
   ?};
   {? _akcja<>'D'
   || {? EDOKUM.TYP().OBS_PROJ
   || _tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=begin,display=1'['Projekty'@],"
            EDOKUM.cntx_psh(); exec('proj_dob','obiegi_proj',,2); EDOKUM.cntx_pop(); ''
      ")
   ?};
   {? EDOKUM.TYP().ED_PODZ='T' & PAR_SKID.get(80)='T'
   || _tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=begin,display=1'['Podziały'@],"
            EDOKUM.cntx_psh(); exec('podz_dob','obiegi',,2); EDOKUM.cntx_pop(); ''
      ")
   ?};

   {? exec('dok_pow_log','obiegi_log')
   || _tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=begin,display=1'['W logi&styce'@],"
            EDOKUM.cntx_psh(); exec('dob_log','obiegi_log'); EDOKUM.cntx_pop(); ''
      ");

::NUCO
:WW:NUCO Dodano przycisk przekierowujący do załączników w oknie akceptacji wniosku
      _tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=begin,display=1'['Załączniki zamówień'@],"
         exec('zalacznik','qzalacznik','ZD_NAG',,ZD_NAG.STAT_REJ='A');''

      ")
   ?};
      _tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=begin,display=1'['Załą&czniki'@],"
         EDOKUM.cntx_psh(); exec('zalaczniki','obiegi'); EDOKUM.cntx_pop(); ''
      ")
   ?}
?};
{? EDOKUM.TYP().IN_POR
|| _tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=begin,display=1'['Ś&cieżka akceptacji'@],"
      exec('btn_akc_path','portal_interm'); ''
   ")
?};
{? _edok & EDOKUM.EDOKUM & 'pdf;bmp;png;tiff;tif;jpeg;jpg'*(-EDOKUM.bl_info('EDOKUM','EXTENSION'))>0
|| _tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=begin,display=1'['E-dokument'@],"
         exec('preview','obe_faw')
      ")
?};
{? _edok & EDOKUM.TYP().IDINHEAD
|| {? ~EDOKUM.TYP().ATR_ONE
   || {? _akcja<>'D' & _edit
      || _obj.btnD:=
         _tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=end,display=1'['<<'@],"
            exec('edok_atk_step','obe_faw',-1,1)
         ");
         _obj.btnU:=
         _tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=end,display=1'['>>'@],"
            exec('edok_atk_step','obe_faw',1,1)
         ");
         {? _akcja<>'P' & _edit
         || _obj.btnDEL:=
            _tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=end,display=1'['X'@],"
               exec('edok_atk_del','obe_faw')
            ")
         ?}
      || _obj.btnD:=
         _tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=end,display=1'['<<'@],"
            exec('edok_atk_step','obe_faw',-1,0)
         ");
         _obj.btnU:=
         _tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=end,display=1'['>>'@],"
            exec('edok_atk_step','obe_faw',1,0)
         ")
      ?};
      exec('edok_atk_btn_upd','obe_faw',_red,_akcja<>'D' & _edit)
   ?};
   {? _akcja<>'D' & _akcja<>'R' & _editInnd
   ||  _obj.btnEDIT:=_tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=end,display=1'['Edycja'@],"
            EDOKUM.cntx_psh(); exec('edit_red','obiegi2'); EDOKUM.cntx_pop(); ''
         ")
   ?}
?};
{? _edok
|| {? _akcja='R' & (var_pres('_d')<=0 | _d>0)
   || _id:=_tab.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=end,display=1'['Wyślij'@],
                         "BPMN.END:=1;'key:F2'");
      _tab.btn_eopt(_red,_id,'tooltip=Zapisanie danych i wysłanie do kolejnego etapu')
   |? _akcja='P'
   || _id:=_tab.win_ebtn(_red,'text=%1, btn_label_align=center, panel=bottom, align=end,display=1'['Przekaż'@],
                         "BPMN.END:=1;'key:Esc'");
      _tab.btn_eopt(_red,_id,'tooltip=Przekazanie dokumentu do dalszego obiegu');
      _id:=_tab.win_ebtn(_red,'text=%1, btn_label_align=center, panel=bottom, align=end,display=1'['Odrzuć'@],
                         "BPMN.END:=2;'key:Esc'");
      _tab.btn_eopt(_red,_id,'tooltip=Odrzucenie dokumentu')
   |? _akcja='A'
   || _id:=_tab.win_ebtn(_red,'text=%1, btn_label_align=center, panel=bottom, align=end,display=1'['Akceptuj'@],
                         "BPMN.END:=1;'key:F2'");
      _tab.btn_eopt(_red,_id,'tooltip=Akceptacja dokumentu');
      _id:=_tab.win_ebtn(_red,'text=%1, btn_label_align=center, panel=bottom, align=end,display=1'['Odrzuć'@],
                         "BPMN.END:=2;'key:Esc'");
      _tab.btn_eopt(_red,_id,'tooltip=Odrzucenie dokumentu')
   ?}
?};
_id:=_tab.win_ebtn(_red,'text=%1, btn_label_align=center, panel=bottom, align=end'['Zapisz'@],"'key:F2'");
_tab.btn_eopt(_red,_id,'tooltip='+exec('help_red_ok','#window','Z'));
_anuluj:=_tab.win_ebtn(_red,'text=%1, btn_label_align=center, panel=bottom, align=end, display=1'
                       [{? _akcja='D' || 'Zamkni&j'@ || 'Anulu&j'@ ?}],'key:Esc');
_tab.btn_eopt(_red,_anuluj,'tooltip='+exec('help_red_esc','#window','A'));
_red


