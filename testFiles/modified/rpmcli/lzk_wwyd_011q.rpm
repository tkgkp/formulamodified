{TITLE:L. Skr¢cone zestawienie realizacji zam¢wie§ dostaw}
{PRINTER: exec('set_parw','param_wydr');exec('prt','param_wydr','h'),,,,,'Q','C',,,,,,1,
   PAR_WYDR.MBOT,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,0,1}
{BEGIN:
  dod := ddo := date();
  VAR_DEL.delete('cWhere', 'PRN', 'ZAMSQL', 'ZAMNDX' );
  cWhere1 := cWhere := '';
  VAR_DEL.delete('color','prn1','prn2', 'lm', 'll' , 'vp', 'lmt', 'rsep', 'prn1');
  color:=prn1:=prn2:='';
  lm:=ll:=vp:=lmt:=rsep:=0;
  PRN := obj_new(@.CLASS.PRINT, 20);
  prn1 := 'PRN';
  PRN.s_frame();
  undefine();
  define('OD',date(0,0,0),'Data od');
  define('DO',date(0,0,0),'Data do');
  PAR_WYDR.TITLE := 'SKR£CONE ZESTAWIENIE REALIZACJI ZAM£WIE• DOSTAW'
}
{END:
  undefine();
  VAR_DEL.delete('cWhere', 'PRN', 'ZAMSQL', 'ZAMNDX' );
  VAR_DEL.delete('color','prn1','prn2', 'lm', 'll' , 'vp', 'lmt', 'rsep', 'prn1')
}
{EXIT: ~def_edit(,'Podaj parametry')}
{ dod := DEFINE.OD;
  ddo := DEFINE.DO;
  cWhere := ' and ZD_NAG.DATA between to_date(\'' + $dod + '\') and to_date(\'' + $ddo + '\')';
  ZAMSQL := sql('select
      TYPYZAM.T as TYPZAM,
      ZD_NAG.SYM ZAMZREAL,
      ZD_NAG.DATA,
      ZD_RN.DR,
      ZD_NAG.DTPREAL,
      (cast( ZD_NAG.DTPREAL as integer_type)-cast( ZD_RN.DR as integer_type))as OPOZNIEN,
      KH.KOD || \' \' || KH.NAZ KONTR,
      MG.SYM MAG,
      USERS.KOD US,
      TYPYDOK.T TYPDOK,
      ND.NR,
      ND.SYM
from @ZD_RP
join @ZD_RN using(ZD_RP.ZD_RN, ZD_RN.reference)
left join @ZD_NAG using(ZD_RN.ZD_NAG, ZD_NAG.reference)
join TYPYZAM using(ZD_NAG.T, TYPYZAM.reference)
left join @ND using(ZD_RN.ND, ND.reference)
join KH using(ZD_NAG.KH, KH.reference)
join MG using(ZD_RN.MG, MG.reference)
join USERS using(ZD_RN.US, USERS.reference)
left join TYPYDOK using(TYPYZAM.TYPYDOK, TYPYDOK.reference)
where ZD_NAG.STAN=\'Z\' :_a', cWhere);
  ZAMNDX := ZAMSQL.index('?');
  PRN.add("ZAMSQL.TYPZAM", 8,'Rodzaj zam.');
  PRN.add("ZAMSQL.ZAMZREAL", 15, 'Symbol zam¢wienia');
  PRN.add("form(ZAMSQL.DATA)", 12, 'Data zam¢wienia');
  PRN.add("form(ZAMSQL.DR)", 12, 'Data realizacji');
  PRN.add("form(ZAMSQL.DTPREAL)", 12, 'Data planowanej realizacji');
  PRN.add("form(ZAMSQL.OPOZNIEN)", 10, 'Iloûç dni op¢¶nienia');
  PRN.add("ZAMSQL.KONTR", 30, 'Kontrahent');
  PRN.add("ZAMSQL.MAG", 10, 'Magazyn');
  PRN.add("ZAMSQL.TYPDOK", 10, 'Typ dok. realizacji');
  PRN.add("ZAMSQL.NR", 10, 'Numer dok. realizacji');
  PRN.add("ZAMSQL.SYM", 15, 'Symbol dok. realizacji')
;~~}
{INCLUDE: wsp_pw.rpi}
{vp := 1; rsep:=PAR_WYDR.RSEP; lmt:=int((charleft()-PRN.width())/2);~~}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{LINE}
{FONT: 'T8G'}{SPACE: 'C'}
{<{lmt+1}'Parametry: '}
{<{lmt+1}'Data od: ' + $dod}
{<{lmt+1}'Data do: ' + $ddo}
{LINE}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{vp:=1;~~}
{HEADER-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE}
{FOOTER-}
{FOR: ZAMSQL}
{INDEX: ZAMNDX}
{DO}
{SUBSTITUTE: 'LINIA0'}
{OD}