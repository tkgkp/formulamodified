:!UTF-8
{TITLE: Towary bez opakowań}
{PRINTER: exec('set_parw','param_wydr'); exec('prt','param_wydr','v'),,,,,'Q','C',,,,,,1,
   PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   color:=prn1:='';
   lm:=ll:=vp:=lmt:=rsep:=0;

   VAR_DEL.delete('k','w','PRN');
   k:=obj_new(4);
   w:=obj_new(4); "--wartosci kolumn--";
   dokl:=3; "--ilosc miejsc dziesietnych--";
   PRN:=obj_new(@.CLASS.PRINT,6); PRN.s_frame();
   lp:=1;
   k[1]:=8;
   k[2]:=20;
   k[3]:=40;
   w[1]:=w[2]:=w[3]:='';
   M.cntx_psh();
   M_OPAKOW.cntx_psh();
   M_OPAKOW.index('M_OPAKOW')
}
{END:
   M.cntx_pop();
   M_OPAKOW.cntx_pop();
   &lp;
   VAR_DEL.delete('color','prn1');
   VAR_DEL.delete('lm','ll','vp','lmt','rsep');
   VAR_DEL.delete('k','w','PRN');
   VAR_DEL.delete('ilosc','wartosc','dokl','wsokr')
}
{INCLUDE: wsp_pw.rpi}
{
PRN.add("w[1]",k[1],'Lp.');
PRN.add("w[2]",k[2],'Kod towaru');
PRN.add("w[3]",k[3],'Nazwa towaru');

PAR_WYDR.TITLE:='TOWARY BEZ OPAKOWAŃ';

prn1:='PRN';
~~}
{COMMENT}   drukowanie pozycji wydruku                               {COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{ rsep:=PAR_WYDR.RSEP; ilosc:=0; wartosc:=0;~~}
{COMMENT}   SIGNATURE                                                {COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}   REPORT-HEADER                                            {COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{FONT: 'T8GB'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
{COMMENT}   HEADER                                                   {COMMENT-}
{HEADER}
   {SUBSTITUTE: 'HEAD'}
   {FONT: 'T8GB'}{SPACE: 'C'}
   {SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}   FOOTER                                                   {COMMENT-}
{FOOTER: 0}
   {SUBSTITUTE: 'LINIAF'}
   {LINE}
{FOOTER-}
{FOR: M}
{INDEX: 'MATKTM'}
{PREFIX: '02'}
{DO}
   {IF: M_OPAKOW.clear(); M_OPAKOW.prefix( M.ref() ); ~M_OPAKOW.first() | (M_OPAKOW.first() & M_OPAKOW.POJ=0) }
   { w[1]:=form(lp,,0,'9A',1);
     w[2]:=form(M.KTM);
     w[3]:=form(M.N);
   ~~}
{FONT: 'T8G'}{SPACE: 'C'}
{SUBSTITUTE: 'LINIA0'}
   {lp+=1;~~}
   {FI}
{OD}
{IF: lineleft()>0 & lineleft()<2}{PAGE}{FI}
{SUBSTITUTE: 'LINIAF'}
{FOOTER}{FOOTER-}