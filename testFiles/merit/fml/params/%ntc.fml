:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: %ntc.fml
:: Utworzony: 10.03.2023
:: Autor: TS
::======================================================================================================================
:: Zawartość: Formuły obsługi czynności i zdarzeń typu komunikat wychodzący (wysyłanie powiadomienia w aplikacji)
::======================================================================================================================


\role_users
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [23.25]
:: OPIS: Formuła zwraca listę nazw użytkowników przypisanych do roli, na której leży zdarzenie/czynność
::       Sposób użycia: params_exec('role_users','%ntc')
::   WY: lista nazw użytkowników oddzielonych przecinkami
::----------------------------------------------------------------------------------------------------------------------
_mp:=params_get().mp;
_b_prel:=_mp.b_prel;

_result:='';

B_ROLE.cntx_psh(); B_USRROL.cntx_psh(); USERS.cntx_psh();
B_ROLE.prefix();
{? B_ROLE.seek(exec('FindAndGet','#table',B_PREL,_b_prel,,"B_ROLE",null()))
|| B_USRROL.index('UNIK');
   B_USRROL.prefix(REF.FIRMA,B_ROLE.ref());
   {? B_USRROL.first()
   || {!
      |? _result+=B_USRROL.USERS().KOD+',';
         B_USRROL.next()
      !}
   ?}
?};
B_ROLE.cntx_pop(); B_USRROL.cntx_pop(); USERS.cntx_pop();
_result

:Sign Version 2.0 jowisz:1048 2023/06/23 14:15:44 0cf7c901167a132e105ca31fa0be7fbc41e078531a95aa6ae3a386b1855cfc9b76a28800e0da54c6be77ac3baa50c223e1c9f2d7df32f7ad6f6305726fef054282090aa3437b76fd6f6cd191c4f4d9bff246eb6b9936c19f04e9c22977734f6194cd77966d8137b123c955b976e106d29f343dadb4f3028d30bf46f455ffc593
