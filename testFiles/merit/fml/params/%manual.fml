:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: %manual.fml
:: Utworzony: 16.02.2019
:: Autor: WH
::======================================================================================================================
:: Zawartość: Formuły do obsługi czynności ręcznych
::======================================================================================================================


\lum_haw_main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: WH [19.22]
:: OPIS: Uruchamia przegląd harmonogramów umów w danym roku i oddziale
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_rok:=0;
{? params_get().in.p01>0
|| _rok:=params_get().in.p01
|? params_get().in.p02>0
|| _rok:=params_get().in.p02
?};
_oddzial:=params_get().in.p03;

exec('lum_haw','lum',_rok,_oddzial);
FUN.ask('Czy zakończyć redagowanie harmonogramów umów w oddziale: %1 w roku: %2'@[_oddzial,$_rok])


\lum_haw_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: WH [19.22]
:: OPIS: Formuła na opis przeglądania harmonogramów umów w danym roku i oddziale
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_mp:=params_get().mp;
_in:=_mp.load(exec('kind_in','#b_port'));

_rok:=0;
{? type_of(_in.p01)=type_of(0) & _in.p01>0
|| _rok:=_in.p01
|? type_of(_in.p02)=type_of(0) & _in.p02>0
|| _rok:=_in.p02
?};
_oddzial:=_in.p03;

_result:='Zredaguj harmonogramy umów w oddziale: %1 w roku: %2'@[_oddzial,$_rok];
_result


\lum_haw_access
::----------------------------------------------------------------------------------------------------------------------
::  UTW: WH [19.22]
:: OPIS: Formuła na opis przeglądania harmonogramów umów w danym roku i oddziale
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_in:=params_get().in;
_user:=params_get().user;
_mp:=params_get().mp;

_rok:=0;
{? params_get().in.p01>0
|| _rok:=params_get().in.p01
|? params_get().in.p02>0
|| _rok:=params_get().in.p02
?};
_oddzial:=params_get().in.p03;

_result:=0;

_refo:={? _oddzial<>'' || exec('FindInSet','#table','ODDZ','KOD2',_oddzial,_oddzial) || null() ?};
{? _refo<>null()
||
   USERS_UP.cntx_psh();
   USERS_UP.index('ODDZ');
   USERS_UP.prefix(_user,'ODDZ',_refo);
   {? USERS_UP.first()
   || _result:=1
   ?};
   USERS_UP.cntx_pop()
||
::  Brak oddziału
   _result:=1
?};
_result


\lum_haw_params_sum
::----------------------------------------------------------------------------------------------------------------------
::  UTW: WH [19.22]
:: OPIS: Skleja parametry roku i oddziału i robi z nich jeden parametr wyjściowy STRING
::       który można wykorzystać na bramie
::   WY: STRING - sklejone parametry (rok,oddział) np: '2019;c'
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_rok:=0;
{? params_get().in.p01>0
|| _rok:=params_get().in.p01
|? params_get().in.p02>0
|| _rok:=params_get().in.p02
?};
_oddzial:=params_get().in.p03;
_result:=$_rok+';'+_oddzial;
_result


\rem_gwar_zalacz
::----------------------------------------------------------------------------------------------------------------------
::  UTW: WH [19.42]
:: OPIS: Wystawienie załączników
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_rem_gwar:=params_get().in.p01;
_mp:=params_get().mp;
_out:=params_get().out;

REM_GWAR.cntx_psh();
REM_GWAR.prefix();
{? REM_GWAR.seek(_rem_gwar)
|| REM_GWAZ.cntx_psh();
   REM_GWAZ.index('REM_GWAR');
   REM_GWAZ.prefix(REM_GWAR.ref());
   {? REM_GWAZ.first()
   || {!
      |? _mp.bl_add(REM_GWAZ.ATA);
         REM_GWAZ.next()
      !}
   ?};
   REM_GWAZ.cntx_pop();
   _mp.save(,_out);
   ~~
?};
REM_GWAR.cntx_pop();
1


\rem_gwar_sent
::----------------------------------------------------------------------------------------------------------------------
::  UTW: WH [19.42]
:: OPIS: Oznaczenie gwarancji że wysłano powiadomienie o upływającej/zakończonej gwarancji
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_rem_gwar:=params_get().in.p01;
_mp:=params_get().mp;
_out:=params_get().out;

REM_GWAR.cntx_psh();
REM_GWAR.prefix();
{? REM_GWAR.seek(_rem_gwar)
|| {? REM_GWAR.r_lock(1,1,1)
   ||
      _chk:=exec('rem_gwar_chk','zasoby');
      {? _chk=1
      || REM_GWAR.SENT_BEF:='T'
      |? _chk=2
      || REM_GWAR.SENT_AFT:='T'
      ?};
      REM_GWAR.put();
      REM_GWAR.r_unlock()
   ?};
   ~~
?};
REM_GWAR.cntx_pop();
REM_GWAR.get();
1


\zlp_sent
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [20.14]
:: OPIS: Oznaczenie zgłoszenia jednorazowego, że wysłano powiadomienie o braku KPO
::----------------------------------------------------------------------------------------------------------------------
_zlp:=params_get().in.p01;
_formula:="
   {? ZLP.r_lock(1,1,1)
   || ZLP.SENT_KPO:='T';
      ZLP.put();
      ZLP.r_unlock()
   ?};
   ~~
";
exec('FindAndGet','#table',ZLP,_zlp,,_formula,~~);
1


\wybTR_NAG
::----------------------------------------------------------------------------------------------------------------------
::  UTW: [rr] [20.14]
:: OPIS: Wybór nagłówka transportu
::   WE: _a - TR_NZL.ref()
::   WY: ref TR_NAG-a lub null() lub ~~ jak nic nie wybrano
::----------------------------------------------------------------------------------------------------------------------
_res:=null();
_tr_nzl:={? var_pres('_a')=type_of(null()) || _a || null() ?};
exec('opentr_psh','open_tab');
_msk:=ref_name(_tr_nzl);
{? (_msk+4)='____'
|| exec('opentr','open_tab','____');
   TR_NZL.prefix();
   {? TR_NZL.seek(_tr_nzl)
   || {? TR_NZL.TR_NAG<>null()
      || _res:=TR_NZL.TR_NAG().uidref()
      || _tr_naguid:=exec('wybTR_NAG','transport');
         {? _tr_naguid='add'
         || _res:=null()
         |? _tr_naguid=''
         || _res:=~~
         || _res:=exec('FindAndGet','#table',TR_NAG,_tr_naguid,,"ref()",null());
            _sel:=tab_tmp(1,'REF','INTEGER','');
            {? TR_NZL.STAT_REJ='Z' & TR_NZL.PLAN='T' || _sel.REF:=#TR_NZL.ref(); _sel.add() ?};
            exec('ini_kom','#message','Informacje o dodaniu dyspozycji transportu.'@);
            __kom_gr:='Dodanie dyspozycji do transportu.'@;
            {? _sel.first()
            || TR_NZL.cntx_psh();
               {!
               |? {? (TR_NZL.prefix(); TR_NZL.seek(_sel.REF)) & TR_NZL.STAT_REJ='Z' & TR_NZL.PLAN='T'
                  || exec('add_kom','#message','Dodano dyspozycję %1 do transportu.'@[TR_NZL.SYM],1);
                     _sel.next()
                  || exec('add_kom','#message','Nie można zaplanować dyspozycji %1 do transportu.'@[TR_NZL.SYM],6);
                     _sel.del()
                  ?}
               !};
               TR_NZL.cntx_pop()
            ?};
            {? ~_sel.size()
            || _res:=~~;
               exec('add_kom','#message'
                ,'Żadna z zaznaczonych dyspozycji nie spełnia kryteriów zaplanowania do transportu.'@,81)
            || exec('nzl2tr_poz','transport',_res,_sel)
            ?};
            exec('end_kom','#message');
            obj_del(_sel)
         ?}
      ?}
   ?}
?};
exec('opentr_pop','open_tab');
_res


\wybTR_NAG_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: [rr] [20.14]
:: OPIS: Wybór nagłówka transportu - opis na TODO
::----------------------------------------------------------------------------------------------------------------------
{? TR_Z.TR_NZL<>null()
|| 'Zarejestruj lub wskaż transport dla dyspozycji transportowej: %1'@@[exec('record','#to_string',TR_Z.TR_NZL)]
|| ''
?}


\uprTR_NAG
::----------------------------------------------------------------------------------------------------------------------
::  UTW: [rr] [20.14]
:: OPIS: Uprawnienia dla wybóru nagłówka transportu
::   WE: _a - TR_NZL.ref()
::----------------------------------------------------------------------------------------------------------------------
TR_Z.TR_NZL:={? var_pres('_a')=type_of(null()) || _a || null() ?};
1


\wyb_dyspPRINT
::----------------------------------------------------------------------------------------------------------------------
::  UTW: [rr] [20.14]
:: OPIS: Wybór rodzaju wydruku
::----------------------------------------------------------------------------------------------------------------------
_res:=0;
_opc:=FUN.choice('Wybierz rodzaj wydruku'@,,'Zadania'@,'Lista pakunkowa'@,'Dowód dostawy'@,'Bez wydruku'@);
{? _res<4 || _res:=_opc ?};
_res


\ask_dokument_zak
::----------------------------------------------------------------------------------------------------------------------
::  UTW: WH [21.37]
:: OPIS: Pytanie czy tworzyć dokument magazynowy na podstawie dokumentu zakupu
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_mp:=params_get().mp;
_result:=0;
_id:='ERIREIIRIR';
{? _mp.isGroup()>0
|| _msg:='Czy utworzyć dokumenty magazynowe dla wszystkich zaznaczonych dokumentów zakupu?'@;
   _result:=FUN.ask(_msg,,,_id,__kom)
|| _result:=FUN.ask('Czy utworzyć dokument magazynowy na podstawie dokumentu zakupu?'@)
?};
_result


\zkm_zak_ask_dok_zak_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć dokument magazynowy na podstawie dokumentu zakupu
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Faktura zakupowa - Czy utworzyć dokument magazynowy na podstawie dokumentu zakupu?'@@


\ask_dokument_wew
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć dokument magazynowy na podstawie dokumentu wewnętrznego
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_mp:=params_get().mp;
_result:=0;
_id:='ERIREIIRIA';
{? _mp.isGroup()>0
|| _msg:='Czy utworzyć dokumenty magazynowe dla wszystkich zaznaczonych dokumentów wewnętrznych?'@;
   _result:=FUN.ask(_msg,,,_id,__kom)
|| _result:=FUN.ask('Czy utworzyć dokument magazynowy na podstawie dokumentu wewnętrznego?'@)
?};
_result


\zkm_wew_ask_dok_wew_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć dokument magazynowy na podstawie dokumentu wewnętrznego
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Faktura wewnętrzna - Czy utworzyć dokument magazynowy na podstawie dokumentu wewnętrznego?'@@


\spr_fdp_ask_dok_pdf_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć dokument PDF
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Faktura do paragonu - Czy utworzyć dokument PDF?'@@


\ask_dok_pdf
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć dokument PDF
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_result:=0;
_spr_czy:=0;
_ndgr_czy:=0;
_parget:=params_get();
{? type_of(_parget)>0
|| {? var_pres('mp',_parget) >0 & var_pres('b_proc',_parget.mp)>0
   || _proces:=exec('FindAndGet','#table','B_PROC',params_get().mp.b_proc,,'SYMBOL','');
      {? _proces<>'' & 4+_proces='SPR_'
      || _spr_czy:=1
      ?};
      {? _proces<>'' & 4+_proces='ZKM_' & ND.sel_size()>0
      || _ndgr_czy:=1
      ?}
   ?}
?};
{? _spr_czy & FAKS.EDOKUMEN='T'
|| _result:=1
|? _ndgr_czy
|| {? var_pres('__ndgr_pdf')>0
   || _result:=__ndgr_pdf
   || _msg:='Czy utworzyć dokument PDF?'@;
      _result:=__ndgr_pdf:=FUN.ask(_msg)
   ?}
|? ~_spr_czy | FAKS.DRUKUJ<>'N'
|| _msg:='Czy utworzyć dokument PDF?'@;
   _result:=FUN.ask(_msg)
?};
_result


\spr_fdp_ask_efak_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać fakturę
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Faktura do paragonu - Czy wysłać fakturę do kontrahenta?'@@


\ask_efak
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać fakturę
::   WE: _a - FAKS.ref()
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
params_exec('czy_efaktura_kontrah','%gate',_a,'Czy wysłać fakturę do kontrahenta?'@)


\spr_got_ask_fak_zal_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wystawić fakturę zaliczkową
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Wpłata gotówkowa - Czy wystawić fakturę zaliczkową?'@@


\spr_got_ask_fak_zal
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wystawić fakturę zaliczkową
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_msg:='Czy do wpłaty gotówkowej wystawić fakturę zaliczkową?'@;
_result:=FUN.ask(_msg);
_result


\spr_int_spos_dod_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Sposób dodawania deklaracji INTRASTAT wywóz
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Sposób dodawania deklaracji INTRASTAT wywóz'@@


\spr_int_spos_dod
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Sposób dodawania deklaracji INTRASTAT wywóz
::   WY: wybrana opcja
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_result:=FUN.choice('Sposób dodawania'@,,'Ręcznie'@,'Generowanie na podstawie dokum.'@);
_result


\spr_khi_ask_kor_pdf_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć korektę w PDF
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Korekta historyczna - Czy utworzyć korektę w PDF?'@@


\ask_kor_pdf
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć korektę w PDF
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_result:=0;
_spr_czy:=0;
_parget:=params_get();
{? type_of(_parget)>0
|| {? var_pres('mp',_parget) >0 & var_pres('b_proc',_parget.mp)>0
   || _proces:=exec('FindAndGet','#table','B_PROC',params_get().mp.b_proc,,'SYMBOL','');
      {? _proces<>'' & 4+_proces='SPR_'
      || _spr_czy:=1
      ?}
   ?}
?};
{? _spr_czy & FAKS.EDOKUMEN='T'
|| _result:=1
|? ~_spr_czy | FAKS.DRUKUJ<>'N'
|| _msg:='Czy utworzyć korektę w PDF?'@;
   _result:=FUN.ask(_msg)
?};
_result


\spr_kor_ask_kor_pdf_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć korektę w PDF
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Korekta dokumentu sprzedaży - Czy utworzyć korektę w PDF?'@@


\spr_koz_ask_kor_pdf_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć korektę w PDF
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Korekta zbiorcza - Czy utworzyć korektę w PDF?'@@


\spr_mag_ask_dok_pdf_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć dokument PDF
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Faktura sprzedaży z dokumentów magazynowych - Czy utworzyć dokument PDF?'@@


\spr_mag_ask_efak_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać fakturę
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Faktura sprzedaży z dokumentów magazynowych - Czy wysłać fakturę do kontrahenta?'@@


\spr_ofe_ask_wys_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać ofertę
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Oferta sprzedaży - Czy wysłać ofertę klientowi?'@@


\spr_ofe_ask_wys
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać ofertę
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_msg:='Czy wysłać ofertę klientowi?'@;
_result:=FUN.ask(_msg);
_result


\spr_ofe_akcept_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Decyzja w sprawie akceptacji oferty
::   WE: _a - symbol oferty
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Oferta sprzedaży - Decyzja w sprawie akceptacji oferty: %1'@@[_a]


\spr_ofe_akcept
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Decyzja w sprawie akceptacji oferty
::   WY: wybrana opcja
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
choice(params_exec('descRef_ToDo','%event','Oferta: '@,1),'',,,1,,'Akceptacja'@,'Odrzucenie'@)


\spr_ofe_zam_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy utworzyć zamówienie
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Oferta sprzedaży - Czy utworzyć zamówienie sprzedaży na podstawie oferty?'@@


\spr_ofe_zam
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy utworzyć zamówienie
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_msg:='Czy utworzyć zamówienie sprzedaży na podstawie wystawionej oferty?'@;
_result:=FUN.ask(_msg);
_result


\spr_opk_ask_dok_pdf_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć dokument PDF
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Faktura za opakowania zwrotne - Czy utworzyć dokument PDF?'@@


\spr_opk_ask_efak_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać fakturę
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Faktura za opakowania zwrotne - Czy wysłać fakturę do kontrahenta?'@@


\spr_wyd_ask_dok_pdf_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć dokument PDF
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Faktura sprzedaży z generacją wydania - Czy utworzyć dokument PDF?'@@


\spr_wyd_ask_efak_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać fakturę
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Faktura sprzedaży z generacją wydania - Czy wysłać fakturę do kontrahenta?'@@


\ask_zal_zam
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wystawić zaliczkę do zamówienia
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_msg:='Czy wystawić zaliczkę do zamówienia?'@;
_result:=FUN.ask(_msg);
_result


\spr_zam_ask_zal_zam_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wystawić zaliczkę do zamówienia
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Zamówienie sprzedaży z realizacją - Czy wystawić zaliczkę do zamówienia?'@@


\ask_zam_pdf
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć zamówienie w PDF
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_msg:='Czy utworzyć zamówienie w PDF?'@;
_result:=FUN.ask(_msg);
_result


\spr_zam_ask_zam_pdf_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć zamówienie w PDF
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Zamówienie sprzedaży z realizacją - Czy utworzyć zamówienie w PDF?'@@


\ask_zam_wys
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać zamówienie
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_msg:='Czy wysłać zamówienie do kontrahenta?'@;
_result:=FUN.ask(_msg);
_result


\spr_zam_ask_zam_wys_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać zamówienie
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Zamówienie sprzedaży z realizacją - Czy wysłać zamówienie do kontrahenta?'@@


\ask_zam_mob
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać zamówienie na urządzenie mobilne
::   WE: _a - symbol zamówienia
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_msg:='Czy wysłać zamówienie %1 na urządzenie mobilne?'@[_a];
_result:=FUN.ask(_msg);
_result


\spr_zam_ask_zam_mob_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać zamówienie na urządzenie mobilne
::   WE: _a - symbol zamówienia
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Zamówienie sprzedaży z realizacją - czy wysłać zamówienie %1 na urządzenie mobilne?'@@[_a]


\ask_zamd_wys
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać zamówienie
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_result:=0;
{? exec('rodzaje_zam_edokumentu','zbl_dok',ZD_NAG.KH,ZD_NAG.T,ZD_NAG.DATA)=''
|| _msg:='Czy wysłać zamówienie do dostawcy?'@;
   _result:=FUN.ask(_msg)
?};
_result


\zkm_dos_ask_zamd_wys_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać zamówienie
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Zamówienie dostaw z realizacją - Czy wysłać zamówienie do dostawcy?'@@


\zkm_int_spos_dod_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Sposób dodawania deklaracji INTRASTAT wywóz
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Sposób dodawania deklaracji INTRASTAT przywóz'@@


\zkm_int_spos_dod
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Sposób dodawania deklaracji INTRASTAT wywóz
::   WY: wybrana opcja
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_result:=FUN.choice('Sposób dodawania'@,,'Ręcznie'@,'Generacja na podstawie dokum.'@);
_result


\ask_reo_mob
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać reorganizację na urządzenie mobilne
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_msg:='Czy wysłać reorganizację na urządzenie mobilne?'@;
_result:=FUN.ask(_msg);
_result


\zkm_reo_ask_reo_mob_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać reorganizację na urządzenie mobilne
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Reorganizacja - Czy wysłać reorganizację na urządzenie mobilne?'@@


\zkm_wyd_ask_dok_pdf_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy tworzyć dokument PDF
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Wydanie z magazynu - Czy utworzyć dokument PDF?'@@


\ask_dokm_wys
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać dokument magazynowy
::   WY: 0/1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_msg:='Czy wysłać dokument magazynowy do kontrahenta?'@;
_result:=FUN.ask(_msg,,,'ask_dokm_wys');
_result


\zkm_wyd_ask_dokm_wys_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać dokument magazynowy
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Wydanie z magazynu - Czy wysłać dokument magazynowy do kontrahenta?'@@


\zkm_zam_ask_zam_mob_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Pytanie czy wysłać zamówienie na urządzenie mobilne
::   WE: _a - symbol zamówienia
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Zamówienie wewnętrzne z realizacją - Zrealizuj zamówienie %1'@@[_a]


\zws_bak_info
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Uruchomiono backup bazy danych
::   WY: 1
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_msg:='Uruchomiono backup bazy danych'@;
FUN.info(_msg);
1


\zws_bak_info_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Uruchomiono backup bazy danych
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Uruchomiono backup bazy danych'@@


\spr_dtr_info_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Trzeba uzpełnić magazyny
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Dyspozycja transportowa - w pozycjach trzeba uzupełnić magazyny'@@


\ask_rok_har
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Rok harmonogramu
::   WY: rok (liczba)
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_msg:='Rok harmonogramu'@;
_result:=exec('edit_number','#edit',date()~1+1,_msg,0,date()~1);
_result


\spr_hpo_ask_rok_har_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Rok harmonogramu
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Ostateczne powiadomienie o harmonogramach - Rok harmonogramu'@@


\spr_hpw_ask_rok_har_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Rok harmonogramu
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Wstępne powiadomienie o harmonogramach - Rok harmonogramu'@@


\zui_abs_b2b_info_desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [21.37]
:: OPIS: Komunikat
::   WY: tekst
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
'Integracja AbStore B2B - Komunikat o błędzie'@@


\hgen_gen_auto
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [21.37]
:: OPIS: Generowanie zgłoszeń do umów
::----------------------------------------------------------------------------------------------------------------------
_mp:=params_get().mp;
_in:=params_get().in;
_ilplus:={? var_press('p01',_in)=type_of(0) & _in.p01>0 || _in.p01 || 0 ?};
_result:='';
:: Deklaracje obiektów
exec('FZL','object');

:: Ustalanie daty końcowej
_ar:=date()~1;
_am:=(date()~2)+_ilplus;
_ar:=_ar+(_am%12);
_am:=(_am%*12);
_do:=date(_ar,_am,0);

:: Generowanie zgłoszeń dla okresów do wskazanej daty, pomijane okresy do których już wygenerowano zgłoszenia
HGEN.cntx_psh();
HGEN.index('ODDZ');
HGEN.prefix();
{? HGEN.find_tab('first','ST',,'=','N','IL',,'=',0,'DO',,'<=',_do)
||
   {!
   |?
      ST.ODDZ:=HGEN.ODDZ;
      ST.AR:=HGEN.AR;
      ST.AM:=HGEN.AM;
      _result:=exec('hgen_gen','umowy_zlecenia',1);
      _result='' & HGEN.find_tab('next','ST',,'=','N','IL',,'=',0,'DO',,'<=',_do)
   !}
?};
HGEN.cntx_pop();
~~


\p01_p02_sum
::----------------------------------------------------------------------------------------------------------------------
::  UTW: WH [21.37]
:: OPIS: Sumuje dwa wejściowe parametry liczbowe
::   WY: REAL
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_result:=0;
_in:=params_get().in;
{? var_pres('p01',_in)=type_of(0) || _result+=_in.p01 ?};
{? var_pres('p02',_in)=type_of(0) || _result+=_in.p02 ?};
_result


\rem_zgl_pow
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [22.26]
:: OPIS: Wyznacza wartość utworzonego powiązanego zgłoszenia remontowego
::       (sprawdza, czy któryś z podanych parametrów przechowuje wartość)
::----------------------------------------------------------------------------------------------------------------------
_in:=params_get().in;
_result:=
   {? var_pres('p01',_in)=type_of(null())
   || _in.p01
   |? var_pres('p02',_in)=type_of(null())
   || _in.p02
   |? var_pres('p03',_in)=type_of(null())
   || _in.p03
   || null()
   ?};
_result


\r2r
::----------------------------------------------------------------------------------------------------------------------
::  UTW: [rr] [22.26]
:: OPIS: Zamienia parametr typu ref na inny wynikający z danych typu ref
::   WE: _a - ref rekordu
::   WY:  ref  lub null gdy nie znalezione
::----------------------------------------------------------------------------------------------------------------------
_res:=null();

_ref:={? var_pres('_a')=type_of(null())
      || _tab:=ref_tab(_a);
         {? var_pres('_tab')=type_of(FIRMA)
         || {? _tab=TR_NZL || _a
            || null()
            ?}
         || null()
         ?}
      |? var_pres('_a')=type_of('') & ((+_a)=48 | (+_a)=16)
      || _tab:=ref_tab(_a);
         {? var_pres('_tab')=type_of(FIRMA)
         || {? _tab=TR_NZL || exec('FindAndGet','#table',TR_NZL,_a,,,null())
            || null()
            ?}
         || null()
         ?}
      || null()
      ?};

{? _ref<>null()
|| {? _tab=TR_NZL
   || _zlp:=exec('FindAndGet','#table',TR_NZL,_ref,,"{? WHERE='ZLP' || DOK_REF || '' ?}",'');
      _res:={? _zlp<>'' || exec('FindAndGet','#table',ZLP,_zlp,,,null()) || null() ?}
   ?}
?};
_res

:Sign Version 2.0 jowisz:1048 2023/06/23 14:15:44 0b7fafded6e7a590ede7c47debe9459d4534578d58a25d1d3a1b1c33e0de45ed25a2b4190a5fef776e67d12514413957efef50ff81bd930ecbc0b99d0ac7a6c216228d41e5141d0ecde170fd18e513bd38f2b856b91761b8becd91ccc59dd98420ee968f42f5f0427871866469114dae987b9c521c95e6c3efd02008da61e48a
