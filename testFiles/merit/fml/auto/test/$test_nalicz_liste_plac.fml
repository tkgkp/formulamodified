:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: $test_nalicz_liste_plac.fml
:: Utworzony: 15.01.2019
:: Autor: ARTSLO
:: Systemy:
::======================================================================================================================
:: Zawartość:
:: AREA: [PPL_PLL]
::======================================================================================================================
::GIVEN
_test_driver:=exec('init','$lib_base','$test_nalicz_liste_plac.log');
_OBSZAR_LP:=obj_new(@.CLASS.PLACE_LP,_test_driver);
_tab:=obj_new('PULPIT','LISTY_PLAC');
_tab.PULPIT:=_test_driver.app_activate(_b);
_potracenie:=exec('importBuff','$lib_base','$nalicz_liste_plac_potracenia.csv',($_OBSZAR_LP.KOM_OS.fTAB)());
_potracenie.first();
_prac:=tab_tmp(1,'IP','STRING[30]','Ip',
                'NAZWISKO','STRING[30]','Imię',
                'IMIE','STRING[30]','Nazwisko',
                'LISTA','STRING[8]','Symbol listy',
                'OCZ_POTR','STRING[10]','kwota potracenia',
                'OCZ_WYPL','STRING[10]','kwota wypłaty'
             );
_pracownik:=exec('importBuff','$lib_base','$nalicz_liste_plac_pracownicy.csv',_prac);

::WHEN
_tab.LISTY_PLAC:=_OBSZAR_LP.otworzObszar();
{? ~_pracownik.first() | ~_potracenie.first() || return(0) ?};

::zasadniczy test
{!
|? _OBSZAR_LP.otworzListe(_pracownik.LISTA);
   _OBSZAR_LP.wybierzListe(_pracownik.LISTA);
   _OBSZAR_LP.wybierzZakladke('Wszyscy pracownicy');
   _OBSZAR_LP.wybierzPracownika(_pracownik);
   {? _test_driver.state('btn:aa8621985000000').enable='true'
   || _OBSZAR_LP.wcisnijPrzycisk('ROZLICZ')
   ?};
   _OBSZAR_LP.wybierzZakladke('Potrącenia');
   _OBSZAR_LP.dodajPotracenie(_potracenie);
   _OBSZAR_LP.wybierzZakladke('Składniki listy');
   _OBSZAR_LP.wcisnijPrzycisk('TABOBLICZ');
   _OBSZAR_LP.sprawdzNaliczeniePotracenia(_potracenie,_pracownik);
   _OBSZAR_LP.sprawdzNaliczenieWyplaty(_potracenie,_pracownik);
   _potracenie.next() & _pracownik.next()
!};

::sprzątamy
_pracownik.first();
_potracenie.first();
{!
|? _OBSZAR_LP.wybierzZakladke('Rozliczani na liście');
   _OBSZAR_LP.wybierzPracownika(_pracownik);
   _OBSZAR_LP.wybierzZakladke('Składniki listy');
   _OBSZAR_LP.usunSkladnikiZListy();
   _OBSZAR_LP.wybierzZakladke('Potrącenia');
   _OBSZAR_LP.usunPotracenie(_potracenie);
   _OBSZAR_LP.usunPracownikaZRozliczeniaListy();
   _potracenie.next() & _pracownik.next()
!};


::THEN
_test_driver.app_close(_tab.LISTY_PLAC);
obj_del(_OBSZAR_LP);
return(1)

:Sign Version 2.0 jowisz:1048 2021/04/09 15:23:47 a365af5d64a02ccd063d0dc51252bcd2d6818bfaa1c9c471e6780da70046d5d25e91e8f6ce30821f76cc3e20da24547e4cff28b38cc64edb04e8e8a29cc1181b99b8506a22164f3ba2d504d21403d9e83251ce694b34a08b77790383b7bc3b19547b55f9cca59eba7612e953ceb8571f88f78e78f6a5d284b0060d0909fd7e55
