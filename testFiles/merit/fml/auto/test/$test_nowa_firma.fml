:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: Nowy1.fml
:: Utworzony: 28.02.2023
:: Autor: GZ
:: Systemy:
::======================================================================================================================
:: Zawartość:
::======================================================================================================================


\make_all
::----------------------------------------------------------------------------------------------------------------------
::  UTW: GZ [23.25]
:: OPIS: Importuje proces i dodaje nowe firmy
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('importuj_proces','$test_nowa_firma');
exec('dodaj_PMCLS','$test_nowa_firma');
exec('dodaj_PMCHR','$test_nowa_firma');
exec('dodaj_PMCFI','$test_nowa_firma');
::exec('dodaj_PMCPR','$test_nowa_firma');
::exec('dodaj_z_katalogu','$test_nowa_firma');
::exec('dodaj_z_wzor','$test_nowa_firma');
delay(300);
exec('todo_rozpocznij','$test_nowa_firma')


\importuj_proces
::----------------------------------------------------------------------------------------------------------------------
::  UTW: GZ [23.25]
:: OPIS: Importuje proces ZWS_FIRM_NEW
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------

_test_driver:=exec('init','$lib_base','$test_nowa_firma.log');

_app:=_test_driver.app_activate();

_test_driver.control('!leftmenu', 'open', 'Obsługa procesów\\Obszary\\Obsługa procesów', 1);
_app1:=_test_driver.app_wait_for_change();
_test_driver.assert('', 'wnd:@B_PROC.WER', 'title', 'Procesy', 'type', 's');
_test_driver.filter();
_test_driver.click('btn:aa4149056000000');
_test_driver.ctrl_call_ret('!application>ctr:filechooser', 'showOpenDialog', 'int', '1');
_test_driver.ctrl_call_ret('!application>ctr:filechooser', 'getSelectedFile', 'string', 'C:\\auto\\import');
_test_driver.assert('', 'wnd:@tmp.s_tmp', 'title', 'Wybór procesów do importu', 'type', 's');
_test_driver.filter('@tmp.SYMBOL', 'ZWS_FIRM_NEW', '@tmp.VER', 'RRxx');
_test_driver.menu('Zaznacz');
_test_driver.menu('Akceptuj');
_test_driver.filter('@B_PROC.SYMBOL', 'ZWS_FIRM_NEW');
_test_driver.click('btn:B_PROC_AKCEPTUJ');
_test_driver.click('btn:@OK');
_test_driver.click('dbtn:Tak');
_test_driver.app_close(_app1);
::_test_driver.app_close('*');
::_test_driver.show_res();
~~


\dodaj_z_katalogu
::----------------------------------------------------------------------------------------------------------------------
::  UTW: GZ [23.25]
:: OPIS: Dodaje nową firmę poprzez import danych z katalogu
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
_test_driver:=exec('init','$lib_base','$test_nowa_firma.log');
_app:=_test_driver.app_activate();
_test_driver.control('!leftmenu', 'open', 'Wspólne\\Obszary\\Ustawienia i parametryzacja', 1);
_app1:=_test_driver.app_wait_for_change();

::_test_driver.assert('', 'wnd:@param', 'title', 'Parametryzacja', 'type', 's');
::_test_driver.control('!leftmenu', 'open', 'Obsługa procesów\\Obszary\\Obsługa procesów', 1);
::_app2:=_test_driver.app_wait_for_change();
::_test_driver.assert('', 'wnd:@B_PROC.WER', 'title', 'Procesy', 'type', 's');
::_test_driver.filter('@B_PROC.SYMBOL', 'ZWS_FIRM_NEW');
::_test_driver.click('btn:B_PROC_AKCEPTUJ');
::_test_driver.click('dbtn:Tak');
::_test_driver.app_close(_app2);

_test_driver.click('gtab:@Wykonanie');
_test_driver.filter('@FP_WYK.FP_DEF.NAZWA', 'FIRMY');
_test_driver.menu('Wybierz');
_test_driver.assert('', 'wnd:@FIRMA.URL', 'title', 'Firmy', 'type', 's');
_test_driver.menu('Dołącz');
_test_driver.assert('', 'wnd:@tmp.e_tmp', 'title', 'Zakładanie nowej firmy', 'type', 'e');
_test_driver.click('fld:@tmp.ROLE_PAT(ndx=3)');
_test_driver.send('3', '', 'fld:@tmp.ROLE_PAT');
_test_driver.click('fld:@tmp.DATA(ndx=2)');
_test_driver.send('2', '', 'fld:@tmp.DATA');
_test_driver.click('fld:@tmp.CLUSTER');
_test_driver.send('/auto/server/cfg/cluster.cfg', '', 'fld:@tmp.CLUSTER');
_test_driver.click('etab:@Okresy pracy');
_test_driver.click('fld:@tmp.FKS');
_test_driver.send('checked', '', 'fld:@tmp.FKS');
_test_driver.click('fld:@tmp.CTR');
_test_driver.send('checked', '', 'fld:@tmp.CTR');
_test_driver.click('fld:@tmp.OBG');
_test_driver.send('checked', '', 'fld:@tmp.OBG');
_test_driver.click('fld:@tmp.FST');
_test_driver.click('fld:@tmp.FST');
_test_driver.send('unchecked', '', 'fld:@tmp.FST');
_test_driver.click('fld:@tmp.KAS');
_test_driver.send('checked', '', 'fld:@tmp.KAS');
_test_driver.click('fld:@tmp.LMG');
_test_driver.click('fld:@tmp.LMG');
_test_driver.send('unchecked', '', 'fld:@tmp.LMG');
_test_driver.click('fld:@tmp.LSP');
_test_driver.click('fld:@tmp.LSP');
_test_driver.send('unchecked', '', 'fld:@tmp.LSP');
_test_driver.click('fld:@tmp.LZK');
_test_driver.send('checked', '', 'fld:@tmp.LZK');
_test_driver.click('fld:@tmp.LUM');
_test_driver.send('checked', '', 'fld:@tmp.LUM');
_test_driver.click('fld:@tmp.LSP');
_test_driver.send('checked', '', 'fld:@tmp.LSP');
_test_driver.click('fld:@tmp.LMG');
_test_driver.send('checked', '', 'fld:@tmp.LMG');
_test_driver.click('fld:@tmp.CTR');
_test_driver.send('unchecked', '', 'fld:@tmp.CTR');
_test_driver.click('fld:@tmp.OBG');
_test_driver.send('unchecked', '', 'fld:@tmp.OBG');
_test_driver.click('fld:@tmp.FST');
_test_driver.send('checked', '', 'fld:@tmp.FST');
_test_driver.click('fld:@tmp.OBG');
_test_driver.send('checked', '', 'fld:@tmp.OBG');
_test_driver.click('fld:@tmp.CTR');
_test_driver.send('checked', '', 'fld:@tmp.CTR');
_test_driver.click('fld:@tmp.PLAN_GR');
_test_driver.send('checked', '', 'fld:@tmp.PLAN_GR');
_test_driver.click('etab:@Dane firmy');
_test_driver.send('testowa', '{TAB}', 'fld:@KST.NAZWA');
_test_driver.send('test','{F2}', 'fld:@KST.SKROT');

::_test_driver.app_activate(_app);
::_test_driver.control('!desktop', 'todo');
::_app2:=_test_driver.app_wait_for_change();
::_test_driver.assert('', 'wnd:ZAD', 'title', 'Zadania', 'type', 's');
::_test_driver.app_close(_app2);
::_test_driver.app_activate(_app1);

_test_driver.app_close(_app1);

_test_driver.control('!desktop', 'todo');
_app1:=_test_driver.app_wait_for_change();
_test_driver.assert('', 'wnd:ZAD', 'title', 'Zadania', 'type', 's');
_test_driver.filter('@BI_TODO.BI_PREL.DESC', 'Nowa firma');
_test_driver.menu('Rozpocznij');
_test_driver.click('dbtn:OK');
_test_driver.app_close(_app1);
:: _test_driver.app_close('*');
::_test_driver.show_res();
~~


\dodaj_z_wzor
::----------------------------------------------------------------------------------------------------------------------
::  UTW: GZ [23.25]
:: OPIS: Dodaje nową firmę z danych wzaorcowych
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------

_test_driver:=exec('init','$lib_base','$test_nowa_firma.log');

_app:=_test_driver.app_activate();

_test_driver.control('!leftmenu', 'open', 'Wspólne\\Obszary\\Ustawienia i parametryzacja', 1);
_app1:=_test_driver.app_wait_for_change();
_test_driver.assert('', 'wnd:@param', 'title', 'Parametryzacja', 'type', 's');
_test_driver.click('gtab:@Wykonanie');
_test_driver.filter('@FP_WYK.FP_DEF.NAZWA', 'FIRMY');
_test_driver.menu('Wybierz');
_test_driver.assert('', 'wnd:@FIRMA.URL', 'title', 'Firmy', 'type', 's');
_test_driver.menu('Dołącz');
_test_driver.assert('', 'wnd:@tmp.e_tmp', 'title', 'Zakładanie nowej firmy', 'type', 'e');
_test_driver.click('fld:@tmp.CLUSTER');
_test_driver.send('/auto/server/cfg/cluster.cfg', '', 'fld:@tmp.CLUSTER');
_test_driver.click('fld:@tmp.ROLE_PAT(ndx=2)');
_test_driver.send('2', '', 'fld:@tmp.ROLE_PAT');
_test_driver.click('fld:@tmp.DATA(ndx=2)');
_test_driver.send('2', '', 'fld:@tmp.DATA');
_test_driver.click('fld:@tmp.DATA_PTH');
_test_driver.send('/auto/merit/danewzor/', '', 'fld:@tmp.DATA_PTH');
_test_driver.click('etab:@Okresy pracy');
_test_driver.click('fld:@tmp.FKS');
_test_driver.send('checked', '', 'fld:@tmp.FKS');
_test_driver.click('fld:@tmp.OBG');
_test_driver.send('checked', '', 'fld:@tmp.OBG');
_test_driver.click('fld:@tmp.KAS');
_test_driver.send('checked', '', 'fld:@tmp.KAS');
_test_driver.click('fld:@tmp.LMG');
_test_driver.send('checked', '', 'fld:@tmp.LMG');
_test_driver.click('fld:@tmp.LSP');
_test_driver.send('checked', '', 'fld:@tmp.LSP');
_test_driver.click('fld:@tmp.LZK');
_test_driver.send('checked', '', 'fld:@tmp.LZK');
_test_driver.click('fld:@tmp.LUM');
_test_driver.send('checked', '', 'fld:@tmp.LUM');
_test_driver.click('fld:@tmp.PLAN_GR');
_test_driver.send('checked', '', 'fld:@tmp.PLAN_GR');
_test_driver.click('etab:@Dane firmy');
_test_driver.send('testy', '{TAB}', 'fld:@KST.NAZWA');
_test_driver.send('testowa', '', 'fld:@KST.SKROT');
_test_driver.click('fld:@XINFO.WIELKOSC');
_test_driver.send('', '{F3}', '');
_test_driver.assert('', 'dial:@Popup', 'title', 'Wybierz wielkość przedsiębiorstwa');
_test_driver.popup('średni');
_test_driver.send('', '{F2}', 'fld:@XINFO.WIELKOSC');
_test_driver.app_close(_app1);
::_test_driver.app_close('*');
::_test_driver.show_res();
~~


\todo_rozpocznij
::----------------------------------------------------------------------------------------------------------------------
::  UTW: GZ [23.25]
:: OPIS: Rozpoczyna zadanie z listy zadań informujące o gotowości do
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------

_test_driver:=exec('init','$lib_base','$test_nowa_firma.log');

_app:=_test_driver.app_activate();

_test_driver.control('!desktop', 'todo');
_app1:=_test_driver.app_wait_for_change();
_test_driver.assert('', 'wnd:ZAD', 'title', 'Zadania', 'type', 's');
_test_driver.filter('@BI_TODO.BI_PREL.DESC', 'Nowa firma');
_test_driver.menu('Rozpocznij');
_test_driver.click('dbtn:OK');
_test_driver.menu('Rozpocznij');
_test_driver.click('dbtn:OK');
_test_driver.send('', '{ESC}', '');
_app:=_test_driver.app_wait_for_change();
::_test_driver.app_close('*');
_test_driver.show_res();
~~


\dodaj_backup
::----------------------------------------------------------------------------------------------------------------------
::  UTW: GZ [23.25]
:: OPIS: Przywraca backup
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('init','__test');
_test_driver:=obj_new(@.CLASS.AUTOTEST);
_test_driver.logger.log_actions:=1;
_test_driver.exec_after_error:=0;
_test_driver.sa_enable(0);
_test_driver.sa_reset_error();
_test_driver.set_delay(0, 0);
_test_driver.set_lib_mock_enabled('', '', 0);
_test_driver.set_lib_mock_enabled('mbutil.jar', '', 1);
_test_driver.set_lib_mock_enabled('filedlg.jar', '', 1);

_test_driver.set_ctrl_mock_enabled('', '', 0);
_test_driver.set_ctrl_mock_enabled('!application>ctr:filechooser', '', 1);

_app:=_test_driver.app_open('admin', 'admin123', 'firma', 'merit001', '', '');

_test_driver.control('!leftmenu', 'open', 'Wspólne\\Obszary\\Ustawienia i parametryzacja', 1);
_app1:=_test_driver.app_wait_for_change();

_test_driver.click('gtab:@Wykonanie');
_test_driver.filter('@FP_WYK.FP_DEF.NAZWA', 'FIRMY');
_test_driver.menu('Wybierz');
_test_driver.assert('', 'wnd:@FIRMA.URL', 'title', 'Firmy', 'type', 's');
_test_driver.menu('Dołącz');
_test_driver.assert('', 'wnd:@tmp.e_tmp', 'title', 'Zakładanie nowej firmy', 'type', 'e');
_test_driver.click('fld:@tmp.ROLE_PAT(ndx=3)');
_test_driver.send('3', '', 'fld:@tmp.ROLE_PAT');
_test_driver.click('fld:@tmp.DATA(ndx=2)');
_test_driver.send('2', '', 'fld:@tmp.DATA');
_test_driver.click('fld:@tmp.CLUSTER');
_test_driver.send('/auto/server/cfg/cluster.cfg', '', 'fld:@tmp.CLUSTER');
_test_driver.click('etab:@Okresy pracy');
_test_driver.click('fld:@tmp.FKS');
_test_driver.send('checked', '', 'fld:@tmp.FKS');
_test_driver.click('fld:@tmp.CTR');
_test_driver.send('checked', '', 'fld:@tmp.CTR');
_test_driver.click('fld:@tmp.OBG');
_test_driver.send('checked', '', 'fld:@tmp.OBG');
_test_driver.click('fld:@tmp.FST');
_test_driver.click('fld:@tmp.FST');
_test_driver.send('unchecked', '', 'fld:@tmp.FST');
_test_driver.click('fld:@tmp.KAS');
_test_driver.send('checked', '', 'fld:@tmp.KAS');
_test_driver.click('fld:@tmp.LMG');
_test_driver.click('fld:@tmp.LMG');
_test_driver.send('unchecked', '', 'fld:@tmp.LMG');
_test_driver.click('fld:@tmp.LSP');
_test_driver.click('fld:@tmp.LSP');
_test_driver.send('unchecked', '', 'fld:@tmp.LSP');
_test_driver.click('fld:@tmp.LZK');
_test_driver.send('checked', '', 'fld:@tmp.LZK');
_test_driver.click('fld:@tmp.LUM');
_test_driver.send('checked', '', 'fld:@tmp.LUM');
_test_driver.click('fld:@tmp.LSP');
_test_driver.send('checked', '', 'fld:@tmp.LSP');
_test_driver.click('fld:@tmp.LMG');
_test_driver.send('checked', '', 'fld:@tmp.LMG');
_test_driver.click('fld:@tmp.CTR');
_test_driver.send('unchecked', '', 'fld:@tmp.CTR');
_test_driver.click('fld:@tmp.OBG');
_test_driver.send('unchecked', '', 'fld:@tmp.OBG');
_test_driver.click('fld:@tmp.FST');
_test_driver.send('checked', '', 'fld:@tmp.FST');
_test_driver.click('fld:@tmp.OBG');
_test_driver.send('checked', '', 'fld:@tmp.OBG');
_test_driver.click('fld:@tmp.CTR');
_test_driver.send('checked', '', 'fld:@tmp.CTR');
_test_driver.click('fld:@tmp.PLAN_GR');
_test_driver.send('checked', '', 'fld:@tmp.PLAN_GR');
_test_driver.click('etab:@Dane firmy');
_test_driver.send('testowa', '{TAB}', 'fld:@KST.NAZWA');
_test_driver.send('test', '{F2}', 'fld:@KST.SKROT');

::_test_driver.app_activate(_app);
::_test_driver.control('!desktop', 'todo');
::_app2:=_test_driver.app_wait_for_change();
::_test_driver.assert('', 'wnd:ZAD', 'title', 'Zadania', 'type', 's');
::_test_driver.app_close(_app2);
::_test_driver.app_activate(_app1);

_test_driver.app_close(_app1);

_test_driver.control('!desktop', 'todo');
_app1:=_test_driver.app_wait_for_change();
_test_driver.assert('', 'wnd:ZAD', 'title', 'Zadania', 'type', 's');
_test_driver.filter('@BI_TODO.BI_PREL.DESC', 'Nowa firma');
_test_driver.menu('Rozpocznij');
_test_driver.click('dbtn:OK');
::_test_driver.app_close('*');
_test_driver.show_res();
~~

::exec('init','__test');
::_test_driver:=obj_new(@.CLASS.AUTOTEST);
::_test_driver.logger.log_actions:=1;
::_test_driver.exec_after_error:=0;
::_test_driver.sa_enable(0);
::_test_driver.sa_reset_error();
::_test_driver.set_delay(0, 0);
::_test_driver.set_lib_mock_enabled('', '', 0);
::_test_driver.set_lib_mock_enabled('mbutil.jar', '', 1);
::_test_driver.set_lib_mock_enabled('filedlg.jar', '', 1);
::
::_test_driver.set_ctrl_mock_enabled('', '', 0);
::_test_driver.set_ctrl_mock_enabled('!application>ctr:filechooser', '', 1);
::
::_app:=_test_driver.app_open('admin', 'admin123', 'firma', 'merit001', '', '');
::
::_test_driver.app_close('*');
::_test_driver.show_res();
::~~


\dodaj_PMCHR
::----------------------------------------------------------------------------------------------------------------------
::  UTW: GZ [23.25]
:: OPIS: Dodaje nową firmę z danych wzaorcowych
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------

_test_driver:=exec('init','$lib_base','$test_nowa_firma.log');

_app:=_test_driver.app_activate();

_test_driver.control('!leftmenu', 'open', 'Wspólne\\Obszary\\Ustawienia i parametryzacja', 1);
_app1:=_test_driver.app_wait_for_change();
_test_driver.assert('', 'wnd:@param', 'title', 'Parametryzacja', 'type', 's');
_test_driver.click('gtab:@Wykonanie');
_test_driver.filter('@FP_WYK.FP_DEF.NAZWA', 'FIRMY');
_test_driver.menu('Wybierz');
_test_driver.assert('', 'wnd:@FIRMA.URL', 'title', 'Firmy', 'type', 's');
_test_driver.menu('Dołącz');
_test_driver.assert('', 'wnd:@tmp.e_tmp', 'title', 'Zakładanie nowej firmy', 'type', 'e');
_test_driver.click('fld:@tmp.CLUSTER');
_test_driver.send('/auto/server/cfg/cluster.cfg', '', 'fld:@tmp.CLUSTER');
_test_driver.click('fld:@tmp.ROLE_PAT(ndx=2)');
_test_driver.send('2', '', 'fld:@tmp.ROLE_PAT');
_test_driver.click('fld:@tmp.DATA(ndx=2)');
_test_driver.send('2', '', 'fld:@tmp.DATA');
_test_driver.click('fld:@tmp.DATA_PTH');
_test_driver.send('/auto/merit/robot/nowa_firma/PMCHR', '', 'fld:@tmp.DATA_PTH');
_test_driver.click('fld:@tmp.OPIS');
_test_driver.send('Firma 005 - PMCHR', '', 'fld:@tmp.OPIS');
_test_driver.click('etab:@Okresy pracy');
_test_driver.click('fld:@tmp.FKS');
_test_driver.send('checked', '', 'fld:@tmp.FKS');
_test_driver.click('fld:@tmp.OBG');
_test_driver.send('checked', '', 'fld:@tmp.OBG');
_test_driver.click('fld:@tmp.KAS');
_test_driver.send('checked', '', 'fld:@tmp.KAS');
_test_driver.click('fld:@tmp.LMG');
_test_driver.send('checked', '', 'fld:@tmp.LMG');
_test_driver.click('fld:@tmp.LSP');
_test_driver.send('checked', '', 'fld:@tmp.LSP');
_test_driver.click('fld:@tmp.LZK');
_test_driver.send('checked', '', 'fld:@tmp.LZK');
_test_driver.click('fld:@tmp.LUM');
_test_driver.send('checked', '', 'fld:@tmp.LUM');
_test_driver.click('fld:@tmp.PLAN_GR');
_test_driver.send('checked', '', 'fld:@tmp.PLAN_GR');
_test_driver.click('etab:@Dane firmy');
_test_driver.send('testy', '{TAB}', 'fld:@KST.NAZWA');
_test_driver.send('testowa', '', 'fld:@KST.SKROT');
_test_driver.click('fld:@XINFO.WIELKOSC');
_test_driver.send('', '{F3}', '');
_test_driver.assert('', 'dial:@Popup', 'title', 'Wybierz wielkość przedsiębiorstwa');
_test_driver.popup('średni');
_test_driver.send('', '{F2}', 'fld:@XINFO.WIELKOSC');
_test_driver.app_close(_app1);
::_test_driver.app_close('*');
::_test_driver.show_res();
~~


\dodaj_PMCLS
::----------------------------------------------------------------------------------------------------------------------
::  UTW: GZ [23.25]
:: OPIS: Dodaje nową firmę z danych wzaorcowych
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------

_test_driver:=exec('init','$lib_base','$test_nowa_firma.log');

_app:=_test_driver.app_activate();

_test_driver.control('!leftmenu', 'open', 'Wspólne\\Obszary\\Ustawienia i parametryzacja', 1);
_app1:=_test_driver.app_wait_for_change();
_test_driver.assert('', 'wnd:@param', 'title', 'Parametryzacja', 'type', 's');
_test_driver.click('gtab:@Wykonanie');
_test_driver.filter('@FP_WYK.FP_DEF.NAZWA', 'FIRMY');
_test_driver.menu('Wybierz');
_test_driver.assert('', 'wnd:@FIRMA.URL', 'title', 'Firmy', 'type', 's');
_test_driver.menu('Dołącz');
_test_driver.assert('', 'wnd:@tmp.e_tmp', 'title', 'Zakładanie nowej firmy', 'type', 'e');
_test_driver.click('fld:@tmp.CLUSTER');
_test_driver.send('/auto/server/cfg/cluster.cfg', '', 'fld:@tmp.CLUSTER');
_test_driver.click('fld:@tmp.ROLE_PAT(ndx=2)');
_test_driver.send('2', '', 'fld:@tmp.ROLE_PAT');
_test_driver.click('fld:@tmp.DATA(ndx=2)');
_test_driver.send('2', '', 'fld:@tmp.DATA');
_test_driver.click('fld:@tmp.DATA_PTH');
_test_driver.send('/auto/merit/robot/nowa_firma/PMCLS', '', 'fld:@tmp.DATA_PTH');
_test_driver.click('fld:@tmp.OPIS');
_test_driver.send('Firma 005 - PMCLS', '', 'fld:@tmp.OPIS');
_test_driver.click('etab:@Okresy pracy');
_test_driver.click('fld:@tmp.FKS');
_test_driver.send('checked', '', 'fld:@tmp.FKS');
_test_driver.click('fld:@tmp.OBG');
_test_driver.send('checked', '', 'fld:@tmp.OBG');
_test_driver.click('fld:@tmp.KAS');
_test_driver.send('checked', '', 'fld:@tmp.KAS');
_test_driver.click('fld:@tmp.LMG');
_test_driver.send('checked', '', 'fld:@tmp.LMG');
_test_driver.click('fld:@tmp.LSP');
_test_driver.send('checked', '', 'fld:@tmp.LSP');
_test_driver.click('fld:@tmp.LZK');
_test_driver.send('checked', '', 'fld:@tmp.LZK');
_test_driver.click('fld:@tmp.LUM');
_test_driver.send('checked', '', 'fld:@tmp.LUM');
_test_driver.click('fld:@tmp.PLAN_GR');
_test_driver.send('checked', '', 'fld:@tmp.PLAN_GR');
_test_driver.click('etab:@Dane firmy');
_test_driver.send('testy', '{TAB}', 'fld:@KST.NAZWA');
_test_driver.send('testowa', '', 'fld:@KST.SKROT');
_test_driver.click('fld:@XINFO.WIELKOSC');
_test_driver.send('', '{F3}', '');
_test_driver.assert('', 'dial:@Popup', 'title', 'Wybierz wielkość przedsiębiorstwa');
_test_driver.popup('średni');
_test_driver.send('', '{F2}', 'fld:@XINFO.WIELKOSC');
_test_driver.app_close(_app1);
::_test_driver.app_close('*');
::_test_driver.show_res();
~~


\dodaj_PMCFI
::----------------------------------------------------------------------------------------------------------------------
::  UTW: GZ [23.25]
:: OPIS: Dodaje nową firmę z danych wzaorcowych
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------

_test_driver:=exec('init','$lib_base','$test_nowa_firma.log');

_app:=_test_driver.app_activate();

_test_driver.control('!leftmenu', 'open', 'Wspólne\\Obszary\\Ustawienia i parametryzacja', 1);
_app1:=_test_driver.app_wait_for_change();
_test_driver.assert('', 'wnd:@param', 'title', 'Parametryzacja', 'type', 's');
_test_driver.click('gtab:@Wykonanie');
_test_driver.filter('@FP_WYK.FP_DEF.NAZWA', 'FIRMY');
_test_driver.menu('Wybierz');
_test_driver.assert('', 'wnd:@FIRMA.URL', 'title', 'Firmy', 'type', 's');
_test_driver.menu('Dołącz');
_test_driver.assert('', 'wnd:@tmp.e_tmp', 'title', 'Zakładanie nowej firmy', 'type', 'e');
_test_driver.click('fld:@tmp.CLUSTER');
_test_driver.send('/auto/server/cfg/cluster.cfg', '', 'fld:@tmp.CLUSTER');
_test_driver.click('fld:@tmp.ROLE_PAT(ndx=2)');
_test_driver.send('2', '', 'fld:@tmp.ROLE_PAT');
_test_driver.click('fld:@tmp.DATA(ndx=2)');
_test_driver.send('2', '', 'fld:@tmp.DATA');
_test_driver.click('fld:@tmp.DATA_PTH');
_test_driver.send('/auto/merit/robot/nowa_firma/PMCFI', '', 'fld:@tmp.DATA_PTH');
_test_driver.click('fld:@tmp.OPIS');
_test_driver.send('Firma 005 - PMCFI', '', 'fld:@tmp.OPIS');
_test_driver.click('etab:@Okresy pracy');
_test_driver.click('fld:@tmp.FKS');
_test_driver.send('checked', '', 'fld:@tmp.FKS');
_test_driver.click('fld:@tmp.OBG');
_test_driver.send('checked', '', 'fld:@tmp.OBG');
_test_driver.click('fld:@tmp.KAS');
_test_driver.send('checked', '', 'fld:@tmp.KAS');
_test_driver.click('fld:@tmp.LMG');
_test_driver.send('checked', '', 'fld:@tmp.LMG');
_test_driver.click('fld:@tmp.LSP');
_test_driver.send('checked', '', 'fld:@tmp.LSP');
_test_driver.click('fld:@tmp.LZK');
_test_driver.send('checked', '', 'fld:@tmp.LZK');
_test_driver.click('fld:@tmp.LUM');
_test_driver.send('checked', '', 'fld:@tmp.LUM');
_test_driver.click('fld:@tmp.PLAN_GR');
_test_driver.send('checked', '', 'fld:@tmp.PLAN_GR');
_test_driver.click('etab:@Dane firmy');
_test_driver.send('testy', '{TAB}', 'fld:@KST.NAZWA');
_test_driver.send('testowa', '', 'fld:@KST.SKROT');
_test_driver.click('fld:@XINFO.WIELKOSC');
_test_driver.send('', '{F3}', '');
_test_driver.assert('', 'dial:@Popup', 'title', 'Wybierz wielkość przedsiębiorstwa');
_test_driver.popup('średni');
_test_driver.send('', '{F2}', 'fld:@XINFO.WIELKOSC');
_test_driver.app_close(_app1);
::_test_driver.app_close('*');
::_test_driver.show_res();
~~


\dodaj_dla_grup
exec('init','__test');
_test_driver:=obj_new(@.CLASS.AUTOTEST);
_test_driver.logger.log_actions:=1;
_test_driver.exec_after_error:=0;
_test_driver.sa_enable(0);
_test_driver.sa_reset_error();
_test_driver.set_delay(0, 0);
_test_driver.set_lib_mock_enabled('', '', 0);
_test_driver.set_lib_mock_enabled('mbutil.jar', '', 1);
_test_driver.set_lib_mock_enabled('filedlg.jar', '', 1);

_test_driver.set_ctrl_mock_enabled('', '', 0);
_test_driver.set_ctrl_mock_enabled('!application>ctr:filechooser', '', 1);

_app:=_test_driver.app_open('admin', 'admin123', 'firma', 'merit001', '', '');

_test_driver.control('!leftmenu', 'open', 'Wspólne\\Obszary\\Ustawienia i parametryzacja', 1);
_app1:=_test_driver.app_wait_for_change();
_test_driver.assert('', 'wnd:@param', 'title', 'Parametryzacja', 'type', 's');
_test_driver.click('gtab:@Wykonanie');
_test_driver.filter('@FP_WYK.FP_DEF.NAZWA', 'FIRM');
_test_driver.menu('Wybierz');
_test_driver.assert('', 'wnd:@FIRMA.URL', 'title', 'Firmy', 'type', 's');
_test_driver.menu('Dołącz');
_test_driver.assert('', 'wnd:@tmp.e_tmp', 'title', 'Zakładanie nowej firmy', 'type', 'e');
_test_driver.click('fld:@tmp.CLUSTER');
_test_driver.send('', '^{A}', '');
_test_driver.send('/auto/server/cfg/cluster.cfg', '', 'fld:@tmp.CLUSTER');
_test_driver.click('fld:@tmp.ROLE_PAT(ndx=3)');
_test_driver.send('3', '', 'fld:@tmp.ROLE_PAT');
_test_driver.click('fld:@tmp.DATA(ndx=2)');
_test_driver.send('2', '', 'fld:@tmp.DATA');
_test_driver.click('fld:@tmp.DATA_PTH');
_test_driver.send('/auto/merit/robot/nowa_firma/PMCFI', '', 'fld:@tmp.DATA_PTH');
_test_driver.click('fld:@tmp.DATA(ndx=1)');
_test_driver.send('1', '{F2}', 'fld:@tmp.DATA');
_test_driver.send('unchecked', '', 'fld:@tmp.FKS');
_test_driver.click('fld:@tmp.PLAN_GR');
_test_driver.send('checked', '', 'fld:@tmp.PLAN_GR');
_test_driver.click('fld:@tmp.FKS');
_test_driver.send('checked', '', 'fld:@tmp.FKS');
_test_driver.click('fld:@tmp.CTR');
_test_driver.send('checked', '', 'fld:@tmp.CTR');
_test_driver.click('fld:@tmp.OBG');
_test_driver.send('checked', '', 'fld:@tmp.OBG');
_test_driver.click('fld:@tmp.FST');
_test_driver.click('fld:@tmp.FST');
_test_driver.send('unchecked', '', 'fld:@tmp.FST');
_test_driver.click('fld:@tmp.KAS');
_test_driver.send('checked', '', 'fld:@tmp.KAS');
_test_driver.click('fld:@tmp.FST');
_test_driver.send('checked', '', 'fld:@tmp.FST');
_test_driver.click('fld:@tmp.LMG');
_test_driver.send('checked', '', 'fld:@tmp.LMG');
_test_driver.click('fld:@tmp.LSP');
_test_driver.send('checked', '', 'fld:@tmp.LSP');
_test_driver.click('fld:@tmp.LZK');
_test_driver.send('checked', '', 'fld:@tmp.LZK');
_test_driver.click('fld:@tmp.LUM');
_test_driver.send('checked', '', 'fld:@tmp.LUM');
_test_driver.click('etab:@Parametry ogólne');
_test_driver.click('fld:@tmp.OPIS');
_test_driver.send('Firma 004 PMCFI', '{F2}', 'fld:@tmp.OPIS');
_test_driver.menu('Dołącz');
_test_driver.assert('', 'wnd:@tmp.e_tmp', 'title', 'Zakładanie nowej firmy', 'type', 'e');
_test_driver.click('fld:@tmp.ROLE_PAT(ndx=3)');
_test_driver.send('3', '', 'fld:@tmp.ROLE_PAT');
_test_driver.click('fld:@tmp.DATA(ndx=2)');
_test_driver.send('2', '', 'fld:@tmp.DATA');
_test_driver.click('fld:@tmp.DATA_PTH');
_test_driver.send('/auto/merit/robot/nowa_firma/PMCLS', '', 'fld:@tmp.DATA_PTH');
_test_driver.click('fld:@tmp.OPIS');
_test_driver.send('Firma 005 PMCLS', '', 'fld:@tmp.OPIS');
_test_driver.click('etab:@Okresy pracy');
_test_driver.click('fld:@tmp.PLAN_GR');
_test_driver.send('checked', '', 'fld:@tmp.PLAN_GR');
_test_driver.click('fld:@tmp.LUM');
_test_driver.send('checked', '', 'fld:@tmp.LUM');
_test_driver.click('fld:@tmp.LZK');
_test_driver.send('checked', '', 'fld:@tmp.LZK');
_test_driver.click('fld:@tmp.LSP');
_test_driver.send('checked', '', 'fld:@tmp.LSP');
_test_driver.click('fld:@tmp.LMG');
_test_driver.send('checked', '', 'fld:@tmp.LMG');
_test_driver.click('fld:@tmp.KAS');
_test_driver.send('checked', '', 'fld:@tmp.KAS');
_test_driver.click('fld:@tmp.FST');
_test_driver.send('checked', '', 'fld:@tmp.FST');
_test_driver.click('fld:@tmp.OBG');
_test_driver.send('checked', '', 'fld:@tmp.OBG');
_test_driver.click('fld:@tmp.CTR');
_test_driver.send('checked', '', 'fld:@tmp.CTR');
_test_driver.click('fld:@tmp.FKS');
_test_driver.send('checked', '{F2}', 'fld:@tmp.FKS');
_test_driver.menu('Dołącz');
_test_driver.assert('', 'wnd:@tmp.e_tmp', 'title', 'Zakładanie nowej firmy', 'type', 'e');
_test_driver.click('fld:@tmp.OPIS');
_test_driver.send('Firma 006 PMCHR', '', 'fld:@tmp.OPIS');
_test_driver.click('fld:@tmp.ROLE_PAT(ndx=3)');
_test_driver.send('3', '', 'fld:@tmp.ROLE_PAT');
_test_driver.click('fld:@tmp.DATA(ndx=2)');
_test_driver.send('2', '', 'fld:@tmp.DATA');
_test_driver.click('fld:@tmp.DATA_PTH');
_test_driver.send('/auto/merit/robot/nowa_firma/PMCHR', '', 'fld:@tmp.DATA_PTH');
_test_driver.click('etab:@Okresy pracy');
_test_driver.click('fld:@tmp.PLAN_GR');
_test_driver.send('checked', '', 'fld:@tmp.PLAN_GR');
_test_driver.click('fld:@tmp.LUM');
_test_driver.send('checked', '', 'fld:@tmp.LUM');
_test_driver.click('fld:@tmp.LZK');
_test_driver.send('checked', '', 'fld:@tmp.LZK');
_test_driver.click('fld:@tmp.LSP');
_test_driver.send('checked', '', 'fld:@tmp.LSP');
_test_driver.click('fld:@tmp.LMG');
_test_driver.send('checked', '', 'fld:@tmp.LMG');
_test_driver.click('fld:@tmp.KAS');
_test_driver.send('checked', '', 'fld:@tmp.KAS');
_test_driver.click('fld:@tmp.FST');
_test_driver.send('checked', '', 'fld:@tmp.FST');
_test_driver.click('fld:@tmp.OBG');
_test_driver.send('checked', '', 'fld:@tmp.OBG');
_test_driver.click('fld:@tmp.CTR');
_test_driver.send('checked', '', 'fld:@tmp.CTR');
_test_driver.click('fld:@tmp.FKS');
_test_driver.send('checked', '{F2}', 'fld:@tmp.FKS');
_test_driver.send('', '{ESC}', '');
_test_driver.send('', '{ESC}', '');
_app:=_test_driver.app_wait_for_change();
_test_driver.app_close('*');
_test_driver.show_res();
~~

:Sign Version 2.0 jowisz:1048 2023/06/23 14:12:56 1a1ab27edcb7a7a0db111fd319e3f46d3ce53d8172fabb101e7664247b9e088c93d6cfe909e69e7a092f7076d4b3345a78c87e497649816d9555edf7e3f4970f2d43acd23cc461182edde15683766822228f6d17eca24a30371d7fb44f00aa1bac7fada658f0232bbdd3ca1d4db22f007de59bbb12f10312c2e234bb272f77f9
