:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: $materialy.fml
:: Utworzony: 26.02.2019
:: Autor: GZ
:: Systemy:
::======================================================================================================================
:: Zawartość: Skrypty automatyzujące obsługę materiały
:: AREA: [ZWS_MAT]
::======================================================================================================================


\test_materialy
::----------------------------------------------------------------------------------------------------------------------
::  UTW: GZ [19.02]
:: OPIS:
::   WE: _a - obiekt testujący
::----------------------------------------------------------------------------------------------------------------------
:: @GIVEN
_test_driver:=exec('init','$lib_base','$test_materialy.log');
_test_driver.app_activate(_b);
:: @WHEN
exec('obszar','$materialy',_test_driver);
_dane_ogolne:=exec('importuj_dane','$test_materialy');
{? _dane_ogolne.first()
|| {!
   |?
      _kod_materialu:=exec('dolacz','$materialy',_test_driver,_dane_ogolne);
      exec('szukaj','$materialy',_test_driver,_kod_materialu);
      exec('wyswietl','$materialy',_test_driver);
      exec('popraw','$materialy',_test_driver);
      exec('usun','$materialy',_test_driver);
      _dane_ogolne.next()
   !}
|| _test_driver.fail('Brak zaimportowanych danych');
   return(0)
?};
:: Zamknięcie okna materiałów
_test_driver.win_action('file_close');
~~


\importuj_dane
::----------------------------------------------------------------------------------------------------------------------
::  UTW: [21.37]
:: OPIS: Importuje z csv inne dane
::   WE:
::   WY: _tab_tmp
::----------------------------------------------------------------------------------------------------------------------
_dane:=tab_tmp(1,
'KTM','STRING[50]','Indeks',
'N','STRING[100]','Nazwa',
'FIS_KTM','STRING[50]','KTM dla drukarki fiskalnej',
'JM_KOD','STRING[10]','Jednostka miary',
'MATR_SYM','STRING[20]','Atrybut budowy cech dostaw',
'VAT_KOD','STRING[8]','% VAT',
'PKWIU','STRING[20]','PKWiU',
'MGR_KOD','STRING[8]','Grupa',
'MGRP_KOD','STRING[8]','Podgrupa',

'MGAT','STRING[20]','Gatunek',
'MODM','STRING[20]','Odmiana',
'KODK','STRING[30]','Kod kreskowy',
'WN','REAL','Waga netto [kg]',
'WB','REAL','Waga brutto [kg]',
'DOKL','INTEGER','Dokładność',
'DOKL_C','INTEGER','Dokładność ceny magazynowej',
'DOKL_S','INTEGER','Dokładność ceny sprzedaży',
'DOKL_Z','INTEGER','Dokładność ceny zakupu',

'PR_M','REAL','Proponowana wartość marży',
'PR_N','REAL','Proponowana wartość narzutu',

'R','STRING[1]','Rodzaj',
'OPAKOW','STRING[1]','Opakowanie',
'SETW','STRING[1]','Sposób ewidencji terminu ważności',
'CZY_TW','STRING[15]','Czy wymagany termin ważności',

'BADSEH_N','STRING[60]','Domyślny zestaw badań',

'OSL','STRING[255]','Opis wg budowy',
:: F3
'GTU_KOD','STRING[20]','Kod grupy towarów i usług',

'OO','STRING[1]','Odwrotne obciążenie',
'SP_WYM','STRING[1]','Wymagany Split Payment',
'WYPDOM','STRING[1]','Materiał domyślny w podgrupie',

'GOMOB','STRING[1]','Sposób kontroli wydania wg identyfikacji',
'IDMOB','STRING[1]','Identyfikacja na urządzeniu mobilnym',
'SKROT','STRING[8]','Formuła na opis kodu mobilnego',
'UNB','REAL','Uzysk (WARN/WARB)',
'KODT','STRING[10]','Kod towarowy',
'KP','STRING[2]','Kraj pochodzenia',
'JUKOD','STRING[10]','Uzupełniająca jm',
'JU_P','REAL','Przelicznik z jednostki bazowej na uzupełniającą',
'SZER','REAL','Szerokość',

'DLUG','REAL','Długość',

'WYS','REAL','Wysokość',

'ILOBJ','REAL','Ilość zbiorcza dla objętości',

'TEMP_OD','REAL','Temperatura składowania od',
'TEMP_DO','REAL','Temperatura składowania do',
'ABSTORE','STRING[1]','Dostępność w abstore B2B',
'ABSTOREC','STRING[1]','Dostępność w abstore B2C',
'OPIS','SYS_MEMO','Opis');

_dane.import('$materialy.csv',,1,,'Windows,header',,'KTM',,1,,'N',,2,,'FIS_KTM',,3,,'JM_KOD',,4,,'MATR_SYM',,5,,
                                                    'VAT_KOD',,6,,'PKWIU',,7,,'MGR_KOD',,8,,'MGRP_KOD',,9,,'MGAT',,10,,
                                                    'MODM',,11,,'KODK',,12,,'WN',,13,,'WB',,14,,'DOKL',,15,,
                                                    'DOKL_C',,16,,'DOKL_S',,17,,'DOKL_Z',,18,,'PR_M',,19,,'PR_N',,20,,
                                                    'R',,21,,'OPAKOW',,22,,'SETW',,23,,'CZY_TW',,24,,'BADSEH_N',,25,,
                                                    'OSL',,26,,'GTU_KOD',,27,,'OO',,28,,'SP_WYM',,29,,'WYPDOM',,30,,
                                                    'GOMOB',,31,,'IDMOB',,32,,'SKROT',,33,,'UNB',,34,,'KODT',,35,,
                                                    'KP',,36,,'JUKOD',,37,,'JU_P',,38,,'SZER',,39,,'DLUG',,40,,
                                                    'WYS',,41,,'ILOBJ',,42,,'TEMP_OD',,43,,'TEMP_DO',,44,,
                                                    'ABSTORE',,45,,'ABSTORE',,46,,'OPIS',,47,);
_dane


\run_test
::----------------------------------------------------------------------------------------------------------------------
::  UTW: GZ [21.37]
:: OPIS: Uruchamia test materiałów w okienku
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
params_exec('test_materialy','$test_materialy',,'1')

:Sign Version 2.0 jowisz:1045 2021/09/17 15:17:03 55d9d50dca8691a348be9df06fe14ad5a74afa0c448fc15f91ce99bb5ac9d8571ab56c5de169fbc0d58a2add00512084cf1cb3b2510b7eb41b9a752e1708662ddcd7062f281e4957bf2e98eb1fa8da947e47b6e8ff0b12e007e036a9e2e94f884a0fd195f47dade1f6a9c338f9abc00e14478d3faef90d5b0905561fec9933c4
