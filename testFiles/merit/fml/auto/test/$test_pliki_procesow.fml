:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: Nowy1.fml
:: Utworzony: 21.07.2022
:: Autor: ARTSLO
::======================================================================================================================
:: Zawartość:
::======================================================================================================================
:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: $test_dane_wzorc.fml
:: Utworzony: 22.03.2019
:: Autor: ARTSLO
:: Systemy:
::======================================================================================================================
:: Zawartość: Test automatyczny dla obszaru ZWS - import danych wzorcowych
:: AREA: [ZWS_ADM]
::   WE: _a - [aktualnie nic, względy historyczne kiedyś był przekazywany obiekt testowy]
::       _b - wskazanie na zakladke pulpitu
::   WY: 1/0 - pełne powodzenie testu lub porażka
::======================================================================================================================
::GIVEN
_test_driver:=exec('init','$lib_base','$test_pliki_procesow.log');
_test_driver.logger.info('START TESTU: $test_pliki_procesow.fml (time: '+$date()+' '+(time()$3)+')');
_set:=exec('importBuff','$lib_base','$pliki_proc_ustawienia.csv',exec('bf_proc_xls','$wspolne'));
_set.first();
_obszar:=obj_new('PULPIT','ADMINISTRACJA');
{? _b<>~~
|| _obszar.PULPIT:=_test_driver.app_activate(_b)
|| _obszar.PULPIT:=_test_driver.app_activate('1')
?};
_error:='';
_timeout:=_test_driver.timeout;
_test_driver.timeout:=1800000;

::WHEN
{? exec('prepare_proc_files','$wspolne',_set.SCRIPT,_set.DIR,_set.DIR2)
|| _wynik:=exec('analyze_proc_files','$wspolne')
|| _error:='Nie udało się przygotować plików pośrednich'
?};

::THEN
{? _error='' & _wynik.size()=0
|| _test_driver.logger.info('WYNIK TESTU: Test zakończony powodzeniem.');
   _ret:=1
|| _test_driver.logger.info('WYNIK TESTU: Test zakończony niepowodzeniem.');
   {? _error<>''
   || _test_driver.logger.info('WYNIK POSREDNI: '+_error)
   |? _wynik.first()
   || {!
      |? _msg:='';
         _msg+=_wynik.NAZWA+' | '+_wynik.KOD+' | ';
         {? _wynik.FTXN='T' || _msg+='Jest plik a nie ma w .xlsx | ' ?};
         {? _wynik.NFXT='T' || _msg+='Nie ma pliku a jest w .xlsx | ' ?};
         {? _wynik.MOF='T' || _msg+='Wiele wersji procesu w plikach | ' ?};
         {? _wynik.MOX='T' || _msg+='Wiele wersji procesu w xlsx | ' ?};
         {? _wynik.STGN='T' || _msg+='Jest .svg a nie ma .graphml | ' ?};
         {? _wynik.SNGT='T' || _msg+='Jest .graphml a nie ma .svg | ' ?};
         _test_driver.logger.info('WYNIK POSREDNI: '+_msg);
         _wynik.next()
      !}
   ?};
   _ret:=0
?};
_test_driver.logger.info('KONIEC TESTU: $test_dane_wzorc.fml (time: '+$date()+' '+(time()$3)+')');
_test_driver.timeout:=_timeout;
return(_ret)

:Sign Version 2.0 jowisz:1048 2023/06/23 14:12:56 7254f9e69da0027dd599fe6539ad63790d9b88b4d5650e0d61cd670d7972d773d2b336741cae7fcea795e0a5514ce0eb325956bcfb427001d666363d1c0a9e78919c1b76f9454be59f75fae772d2a9753e7a4129ef2d0e8b3fce53eb933740c236c78197bea19640af063f3637229874cb3e8b4f251e4ccc6044f2fd8e5980a9
