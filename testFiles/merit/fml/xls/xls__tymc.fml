:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: xls_tymc.fml
:: Utworzony: 05.12.2018
:: Autor:
:: Systemy:
::======================================================================================================================
:: Zawartość: Formuły do obsługi eksportu komunikatów po imporcie
::======================================================================================================================


\init
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [19.02]
:: OPIS: Inicjalizuje mechanizm importu/eksportu do Excel
::   WE: _a - obj_new - środowisko mechanizmu
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_def:=_a;
_def.ID:='IMP_HIST';
_def.DOMAIN:=exec('name','#b_domain','ZWS');
_def.FUNPAR:='ZWS_IMP_HIST';

_def.FILE:='_komunikaty.xlsx';
_def.SHEET:='Komunikaty=1,1';
_def.NAME:='Komunikaty po imporcie'@;
_def.DESC:='Komunikaty po imporcie';

_def.PREFIX:="exec('prefix','xls__tymc')";
_def.TABLE:="exec('table','xls__tymc')";
_def.TAB_IMP:="B_ACTION";
_def.FIELDS:="exec('fields','xls__tymc',_a)";

::_def.BEFORE:="";
::_def.AFTER:="";
::_def.SELECT:="";

_def.EXPORT:="exec('export','xls__tymc',_a,_b)";
::_def.VALIDATE:="";
::_def.IMPORT:="";

::_def.HIDDEN:='T';
~~


\prefix
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [19.02]
:: OPIS: Określa zakres eksportowanych danych
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
~~


\table
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [19.02]
:: OPIS: Określa uchwyt do tabeli
::   WY: uchwyt do eksportowanej tabeli
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
__TableImpHist


\fields
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [19.02]
:: OPIS: Określa pola tabeli
::   WE: _a - obiekt z definicją pól który należy zasilić
::  TAG: <PUBLICZNA>
::----------------------------------------------------------------------------------------------------------------------
_def:=_a;

_def.define('FILE','Plik'@,1,,'Plik'@);
_def.define('SHEET','Arkusz'@,1,,'Arkusz'@);
_def.define('ROW','Wiersz'@,1,,'Wiersz'@);
_def.define('MESSAGE','Komunikat'@,1,,'Komunikat'@);
_def.define('IS_MOD','Błąd/Uwaga'@,1,,'Błąd/Uwaga'@);
~~


\export
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [19.02]
:: OPIS: Wypełnia obiekt który zapisze w Excel wiersz danymi z rekordu
::       Użycie: export
::   WE: _a - obj_new - środowisko mechanizmu
::       _b - obj_new - obiekt który zasilić wartościami z pól
::   WY: ANY - dowolny wynik (zwracany przez _excel.write_async())
::----------------------------------------------------------------------------------------------------------------------
_excel:=_a;
_table:=_b;

_tab := exec('table','xls__tymc');

_result:=1;
_table.FILE.VALUE:=_tab.FILE;
_table.SHEET.VALUE:=_tab.SHEET;
_table.ROW.VALUE:=_tab.ROW;
_table.MESSAGE.VALUE:=_tab.memo_txt(0,1,'MESSAGE');
_table.IS_MOD.VALUE:=~_tab.IS_MOD;
_result

:Sign Version 2.0 jowisz:1048 2023/06/23 14:17:12 20f660460893c0dac68433ef021c8372a8f50ddb4d62e0fe2626d8ed68106b8953491f725b21c75e0d1b8fd72fd83c01b06365f6b85338b9048401423e4b3ff9830cd71818e644f9bbcce073ef09c1277df7146e95ea0b18c5d06ea978345e0bc37809bd8791fd7f006ddc97aa71b62e7d6befdcb4661f87ce6020681e916e9b
