:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !zso_scn_dark.fml
:: Utworzony: 06.02.2020
:: Autor: MB
::======================================================================================================================
:: Zawartość: Formuły czynności ZSO_SCN_DARK - Dodanie zeskanowanego dokumentu
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [20.14]
:: OPIS: Formuła główna czynności ZSO_SCN_DARK
::----------------------------------------------------------------------------------------------------------------------
:: PARAMETRY WE:
::# kind=WE, symbol=TYP, type=STRING, name=Typ dokumentu, required=N, fml_val="exec('typ','skanuj',_a)"
:: PARAMETRY WY:
::# kind=WY, symbol=SKAN_DOK,   type=_SKAN_DOK, name=Wskazanie na zeskanowany dokument, required=T
_args:=params_get();
_in:=_args.in;
_out:=_args.out;
_mp:=_args.mp;
_akcja:=_mp.akcja();

{? FUN.ask('Dołączyć zeskanowany dokument?')
||
   __temp_dir:=fmk_tmp_dir(0);
   _file:= __temp_dir.get_path();
   _file+= '\\' + dlg_upload(_file,0);
   {? _file<>''
   || _typ:={? var_pres('_in')>0 & var_pres('TYP',_in)>0 || _in.TYP || '' ?};
      _mp.trigRef('SKAN_DOK');
      _ref:=exec('add','skanuj',_file,_typ);
      {? type_of(_ref)=type_of('')
      || FUN.info(_ref)
      || _out.SKAN_DOK:=_ref;
         _mp.save(,_out);
         _mp.done()
      ?}
   ?};
   VAR_DEL.delete('__temp_dir')
?};
~~


\desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [20.14]
:: OPIS: Formuła na opis TO DO
::----------------------------------------------------------------------------------------------------------------------
'Dodanie zeskanowanego dokumentu'@@

:Sign Version 2.0 jowisz:1045 2022/06/30 14:22:55 790f7174e60aa26ef23e06362c819411c47fd104adda35dd8cfc9d9149d187da2c384deb6f33a3ed0740d29ce3619adf71f61e83ad17eb861050e09d1ffb6aa5b21c2c200cb638fcc778eb94415859cb6af9c545d2c3383366e0f8733bbb35fd69c54dafa7b06b9d60ff9f24cba3ad6076faaafc31fde2bca09473629ecff846
