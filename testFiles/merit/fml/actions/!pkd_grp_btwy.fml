:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrze�one
::======================================================================================================================
:: Nazwa pliku: !pkd_grp_btwy.fml
:: Utworzony: 17.04.2023
:: Autor: MicKoc [22.23]
::======================================================================================================================
:: Zawartość: Ewidencja wyników badań przeprowadzonej kontroli trzeźwości
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MicKoc [22.26]
:: OPIS: Ewidencja wyników badań przeprowadzonej kontroli trzeźwości
::   WE:
::   WY:
::  OLD: \menu_kot_wynik/kontrola_trzezwosci.fml
::----------------------------------------------------------------------------------------------------------------------
::# permissions=F_ZATR,UD_SKL

exec('init','pkd');

{? ~__F_ZATR.upr('P')
|| FUN.info('Brak wymaganego dostępu do formy współpracy "%1".'@ ['P']);
   return()
?};

_txt:=exec('uprawnieniawrap','pkd','Kontroli trzeźwości','PKD_EZK_OPKT','PKD_EZK_ORKT');
{? +|_txt
|| FUN.emsg('Brak wymaganych uprawnień do informacji o:%1'@[_txt]);
   return()
?};

Cntx.psh(KOT_TEST,KOT_JM,P,OSOBA);
KOT_TEST.index('NAZIM');
KOT_TEST.clear();
KOT_TEST.win_sel('WER_ALL');
KOT_TEST.win_edit('RED');
{? ~KOT_TEST.f_set(
      '',
      'join P using (KOT_TEST.OSOBA,P.OSOBA)',
      'KOT_TEST.FIRMA=:_a and P.REFERENCE in (select distinct :_b.REF from :_b)',
      exec('ref_firma','#firma'),
      exec('dostepne_p','schemat','PKD',P_FILTER.F_ZATR().KOD,'*')
   )
|| KOT_TEST.f_set(,,'0=1')
?};
KOT_TEST.fld_fml('WYNIK','BEFORE_DISPLAY',"
   {? KOT_TEST.KOT_JM
   || KOT_TEST.KOT_JM().TYP='T'
   || 0
   ?}
");
KOT_TEST.fld_fml('TEST','BEFORE_DISPLAY',"
   {? KOT_TEST.KOT_JM
   || KOT_TEST.KOT_JM().TYP='N'
   || 0
   ?}
");
exec('ustaw_zmienne','kontrola_trzezwosci',KOT_TEST);
KOT_TEST.select();
KOT_TEST.fld_fml('WYNIK','DISPLAY_FORMAT',"*");
KOT_TEST.fld_fml('TEST','DISPLAY_FORMAT',"*");
Cntx.pop(KOT_TEST,KOT_JM,P,OSOBA);
{? KOT_TEST.f_active() || KOT_TEST.f_clear() ?};
~~

:Sign Version 2.0 jowisz:1045 2023/04/28 15:59:40 6b1fd20d626a88688fde488d1a5d5498491d36cf88e370bf494e466db139a2e6fe6be2782d56a0471fcecf92130207109fcbf544dac40488f253ea6127e2f82c84effb0849ebd872c0a9c57ed8d7ab95260b3c5386317622fbe074bb105e38918735e7a24e3c2510ad40fb1fa8349e91f4b35efdea2b5406f87414b8eb453c6a
