:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !zws_par_fkok.fml
:: Utworzony: 12.02.2016
:: Autor: AWI
::======================================================================================================================
:: Zawartość: Operacje kasy
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AWI [17.00]
:: OPIS: Czynność ZWS_PAR_FKTO - multi kasa
::       UWAGA. Do pobrania parametrów stosować params_get() = tablica nazwana:
::       _in  - [obj_new] - parametry wejsciowe czynnosci
::       _int - [obj_new] - parametry wewnetrzne czynnosci
::       _out - [obj_new] - parametry wyjsciowe czynnosci
::       _mp  - obiekt odpowiedzialny za obsluge procesu
::----------------------------------------------------------------------------------------------------------------------
exec('mf5_opk','!zws_par_fkok')


\mf5_opk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: [rr] [2011]
:: OPIS: operacje dla kas
::  OLD: \mf5_opk/kasa.fml
::----------------------------------------------------------------------------------------------------------------------
STANKAS.win_sel('SLO');
KOPERKAS.index('STANKAS1');
_win_tm1:=STANKAS.mk_sel('Stanowiska kasowe'@,,,'#mlrr_oper',,,,,'U','T');
STANKAS.win_fld(_win_tm1,,'KOD',,,3,,,'Kod stanowiska'@);
STANKAS.win_fld(_win_tm1,,'NAZWA',,,23,,,'Nazwa stanowiska'@);
STANKAS.win_fld(_win_tm1,,'WALUTA','SYM',,3,,,'Waluta'@);
STANKAS.win_sel(_win_tm1);
_grp:=STANKAS.grp_make('Operacje dostępne dla Kas',,'#mlop_dost',,);
STANKAS.grp_sel(_grp,,_win_tm1,,
   "KOPERKAS.prefix(STANKAS.ref()); KOPERKAS.hdr_sel();
    KOPERKAS.hdr_sel(' '+STANKAS.NAZWA); grp_disp(KOPERKAS,'WER')",,,,"","",,,'maximized_with_title');
STANKAS.grp_splt(_grp,'panel0','vertical','gora_prawo');
STANKAS.grp_sel(_grp,KOPERKAS,'WER',,"KOPERKAS.prefix(STANKAS.ref())",,,,"","",,,'maximized_with_title');
STANKAS.win_sel(_grp);
STANKAS.select(,1,10);
clr_sel;
0


\blanksta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: Mario [2010]
:: OPIS: blank - stanowisko kasowe
::  OLD: \blanksta/i_o.fml
::----------------------------------------------------------------------------------------------------------------------
STANKAS.ref


\addkoper
::----------------------------------------------------------------------------------------------------------------------
::  UTW: [rr] [2010]
:: OPIS: akcja dolaczenia operacji dla kasy
::  OLD: \addkoper/poz_pola.fml
::----------------------------------------------------------------------------------------------------------------------
_sel:=OPER.win_sel('?');
_seloper:=OPER.mk_sel('Definicje typów operacji'@,'P',,'deftypoper_sel');

OPER.win_fld(_seloper,,'KOD',,,8,,1,'Typ operacji'@);
OPER.win_fld(_seloper,,'NAZWA',,,10,,1,'Nazwa operacji'@);
OPER.win_fld(_seloper,,'PLUS_MIN',,,20,,1,'Przychód / Rozchód'@);
OPER.win_fld(_seloper,,'TYP_DOK',,,10,,1,'Typ dokumentu'@);
OPER.win_act(_seloper,0,'Formuła','&Wybierz'@@,,,,"exec('akckoper','!zws_par_fkok')",1,1,"exec('akckoper','!zws_par_fkok')",,'W');
OPER.win_act(_seloper,0,'Rekord',,,,,"exec('ope_wal','kasa_wspolne')");
OPER.win_act(_seloper,0,'Szukaj');
OPER.win_act(_seloper,0,'Dołącz');
OPER.win_act(_seloper,0,'Usuń');
OPER.win_act(_seloper,0,'Popraw',,,,"exec('bekod','kasa_wspolne')","exec('ae_kod','kasa_wspolne',0)");
OPER.win_act(_seloper,0,'Kolejność');
OPER.win_act(_seloper,1,'Rekord',,,,,"exec('ope_wal','kasa_wspolne')");
OPER.win_act(_seloper,1,'Dołącz');
OPER.win_sel(_seloper);

OPER.index('KOD');
OPER.prefix();
OPER.select();
OPER.win_sel(_sel);
1


\akckoper
::----------------------------------------------------------------------------------------------------------------------
::  UTW: [rr] [2010]
:: OPIS: akceptacja przypisania operacji
::  OLD: \akckoper/poz_pola.fml
::----------------------------------------------------------------------------------------------------------------------
_tab:=OPER.sel_aget(); OPER.sel_adel();
_tab.clear();
{? _tab.size()
|| {? _tab.first()
   || {!
      |? {? (OPER.clear; OPER.seek(_tab.REF,OPER.name()))
         || KOPERKAS.blank();
            KOPERKAS.OPER:=OPER.ref();
            KOPERKAS.add(1)
         ?};
         _tab.next()
      !}
   ?}
|| KOPERKAS.blank();
   KOPERKAS.OPER:=OPER.ref();
   KOPERKAS.add(1)
?};
sel_exit

:Sign Version 2.0 jowisz:1028 2019/06/07 15:56:04 9b79af00e520c4354f2c049fc76816a8c0d08a57e9d2efaea82d8c88111762e2f5453047b7ef6d22cc0165ec83f34f13f302da71751ae7d853593a99835ff379a64a12ea468f903f0528a31c89a902dc85c81e85238e9cfd711440e7c69b8c92c73ed75ab0093f0d3aecbe204b391f56f82776b8dddd96ee7ebfe8d2ee2e0417
