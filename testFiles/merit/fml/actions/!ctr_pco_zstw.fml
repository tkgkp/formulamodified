:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !ctr_pco_zstw.fml
:: Utworzony: 02.06.2016
:: Autor: MB
::======================================================================================================================
:: Zawartość: Formuły czynności CTR_PCO_ZSTW - Przegląd - podziały amortyzacji
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [17.00]
:: OPIS: Przegląd - podziały amortyzacji - główna formuła czynności CTR_PCO_ZSTW
::----------------------------------------------------------------------------------------------------------------------


\add_tab
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [17.00]
:: OPIS: Dodaje okno do okna grupowego
::   WE: _a - nazwa zakładki
::       _b - tabela
::       _c - okno grupowe
::----------------------------------------------------------------------------------------------------------------------
K_ES.OPCJA:='WP';
VAR.ROK_F:=SSTALE.AR; VAR.OKRO_F:=SSTALE.AO; VAR.KONTROL:='T'; VAR.ROK_F(); VAR.OKRO_F();
_om:=exec('mod_win','control',22);
SKID_MBN.win_sel(_om);
_b.grp_sel(_c,SKID_MBN,_om,_a,"
   ZM.SKID_MBN:=SKID_MBN.ref();
   exec('opiszwym','control');
   ZM.PLAN:='r';
   SRD.maski('r');
   KTRWN.hdr_sel(); KTRWN.hdr_sel(': '+ZM.SKID_MBN().NAZ);
   KTRWN.index('KTRWN'); KTRWN.prefix(REF.FIRMA,ZM.SKID_MBN,ZM.PLAN,VAR.ROK_F,VAR.OKRO_F);
   _find:=KTRWN.first();
   KTRWN.index('KTRWN2'); KTRWN.prefix(REF.FIRMA,ZM.SKID_MBN,ZM.PLAN);
   {? ~_find || KTRWN.first() ?};
   grp_disp(KTRWN,'SELEKCJA',1);
   ~~
",,,,"
   SKID_MBN.f_clear();
   SKID_MBN.index('EWID'); SKID_MBN.prefix('T','O')

",,,,'maximized_with_title');
task_attach('CTR_PCO_ZSTW');
_b.tab_splt(_c,,'vertical','left');
_b.grp_sel(_c,KTRWN,'SELEKCJA',,"exec('kontrobl','control')",,,,,,,,'maximized_with_title');
_b.tab_splt(_c,'left','horizontal','panel1',10);
KTRWP.fld_opt('SELEKCJ2','col_name=""',KTRWP,'PBUD','SYMBOL');
KTRWP.fld_opt('SELEKCJ2','col_name=""',KTRWP,'JORG','SYMBOL');
KTRWP.fld_opt('SELEKCJ2','col_name=""',KTRWP,'OKOSZ','SYMBOL');
KTRWP.fld_opt('SELEKCJ2','col_name=""',KTRWP,'WYM4','SYMBOL');
KTRWP.fld_opt('SELEKCJ2','col_name=""',KTRWP,'WYM5','SYMBOL');
_b.grp_sel(_c,KTRWP,'SELEKCJ2',,,,,,,,,,'maximized_with_title');
KTRWN.win_sel('SELEKCJA');
exec('ktrwn','!ctr_pco_zstp');
exec('SRD','object');
~~


\bdispr
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MGO [2006]
:: OPIS: Podstawienie wartosci do wolnego pola - kontroling
::  OLD: \bdispr/skid_ktr.fml
::----------------------------------------------------------------------------------------------------------------------
ZM.AMOR:=0;
SRSR.cntx_psh();
SRSR.prefix();
{? SRSR.seek(KTRWP.SROD_ID)
|| SRST.cntx_psh();
   SRST.index('SROD'); SRST.prefix(SRSR.ref(),KTRWN.ROK_F,KTRWN.OKRO_F);
   {? SRST.first()
   || ZM.AMOR:=SRST.AMOF
   ?};
   SRST.cntx_pop()
?};
SRSR.cntx_pop();
ZM.PR:={? ZM.AMOR<>0 || (KTRWP.KWOTA/ZM.AMOR)*100 || ZM.PR:=0 ?};
''

:Sign Version 2.0 jowisz:1048 2021/04/09 15:19:36 b1bae3d88958242a9117718550e0e601d3a89e7f1438d3958e04c97416b48aa98abbd016e001ad332ffc36562b4102599d07db7e995811db8f1fdd44f5d5d087fe4714d0c9051d51a06931d2c042b4d05d2adbc85e048be0c1f0e630fd97ec282d357593cdac73ebe8506dd9c92a37d26a6982b70322e989ff3f08f033e6c87e
