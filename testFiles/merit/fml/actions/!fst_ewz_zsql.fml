:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !fst_ewz_zsql.fml
:: Utworzony: 13.05.2016
:: Autor: PJ
::======================================================================================================================
:: Zawartość: Formuły czynności FST_EWZ_ZSQL - Zapytania SQL dotyczące środków trwałych
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: PJ [17.00]
:: OPIS: Zapytaia SQL dotyczące środków trwałych - główna formuła czynności FST_EWZ_ZSQL
::   WE: [_a] - uruchomienie z pulpitu? [1] - tak, 0 - nie
::       [_b] - czy obszar plany amortyzacji? 1 - tak, [0] - nie
::----------------------------------------------------------------------------------------------------------------------
::# permissions=FJKS
{? var_press('_a')<0 || _a:=1 ?};
{? var_press('_b')<0 || _b:=0 ?};
params_set(params_get());
{? _a=1
|| exec('czytaj','#stalesys',,XINFO);
   exec('czytaj','#stalesys',,FINFO);
   exec('init','fst');
   {? _b=0
   || SRD.maski('r')
   || _maska:=SRST.name();
      _maska:=4-_maska-3;
      SRD.maski(_maska)
   ?}
?};
{? _b=0
|| exec('m_sql','#sql','FST_EWZ_ZSQL','Raporty')
|| exec('m_sql','#sql','FST_EWZ_ZSQL','Plany amortyzacji')
?}


\f3_masql
::----------------------------------------------------------------------------------------------------------------------
::  UTW: PJ  [8.50]
:: OPIS: Obsluga akcji na f3 w polu metoda okienka zapytan SQL
::   WE: _a - rodzaj metody (P - podatkowa, F - bilansowa, D - dodatkowa
::   WY: Kod metody
::  OLD: \f3_masql/tech_es.fml
::----------------------------------------------------------------------------------------------------------------------
MA.cntx_psh();
MA.index('MA_RODZ');
MA.prefix(_a);
MA.win_sel('SEL_SQL');
{? MA.select() || _w:=MA.K || _w:='' ?};
MA.cntx_pop();
_w


\f3_sql_rodzaj
::----------------------------------------------------------------------------------------------------------------------
::  UTW: [PJ] [8.60]
:: OPIS: Formuła na F3 polu rodzaj srodkow w okienku z parametrami zapytan SQL
::  OLD: \f3_sql_rodzaj/tech_es.fml
::----------------------------------------------------------------------------------------------------------------------
pop_wynik:=_a;
popup(0,'Wybierz rodzaj środków'@,
       'W - wszystkie'@, '', "pop_wynik:='W'",
       'T - trwałe'@,'',"pop_wynik:='T'",
       'N - niskocenne'@,'',"pop_wynik:='N'"
);
pop_wynik


\ae_sql_rodzaj
::----------------------------------------------------------------------------------------------------------------------
::  UTW: PJ [2006]
:: OPIS: Funkcja weryfikuje zawartosc pola Rodzaj w oknie redagowania parametrów
::       zapytań sql
::  OLD: \ae_sql_rodzaj/tech_es.fml
::----------------------------------------------------------------------------------------------------------------------
{? 'WTN'*fld()<>0
|| {? fld()='W' || fld():='' ?};
   1
|| FUN.emsg('Błędny rodzaj środków.\n Dozwolone wartości: W - wszystkie, T - trwałe, N - niskocenne.'@);
   0
?}


\ae_oddsql
::----------------------------------------------------------------------------------------------------------------------
::  UTW: PJ  [8.50]
:: OPIS: Po redakcji pola j. ksiegowa w okienku zapytan SQL
::   WE: _a - j. księgowa
::   WY: 1 - ok, 0 - brak
::  OLD: \ae_oddsql/tech_es.fml
::----------------------------------------------------------------------------------------------------------------------
ODD.cntx_psh();
ODD.index('ODDZIALY');
ODD.prefix(REF.FIRMA,_a,_a);
{? ODD.size=0 & fld <> ''
|| FUN.emsg('Brak jednostki księgowej o podanej nazwie.'@);
   _wy:=0
|| _wy:=1
?};
ODD.cntx_pop();
_wy

:Sign Version 2.0 jowisz:1045 2020/04/03 17:04:43 37590b0705656a035e2302816345170e8bbbb6a505bd1904812d43806441a02c596276b05c026ad5f7eddab9387dceb240430ee61c998e8bd43b435ccdcebf6129a543453505d7e9263c48b1e74e26edd03423c15438f4978ecdef4391cc0d46a9e2c8dd1874b8aa122545106bb61e963ca8a720f171bd946f20a79ada40536e
