:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !ctr_pco_zstp.fml
:: Utworzony: 30.05.2016
:: Autor: MB
::======================================================================================================================
:: Zawartość: Formuły czynności CTR_PCO_ZSTP - Przegląd - podziały planów amortyzacji
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [17.00]
:: OPIS: Przegląd - podziały planów amortyzacji - główna formuła czynności CTR_PCO_ZSTP
::----------------------------------------------------------------------------------------------------------------------


\add_tab
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [17.00]
:: OPIS: Dodaje okno do okna grupowego
::   WE: _a - nazwa zakładki
::       _b - tabela
::       _c - okno grupowe
::----------------------------------------------------------------------------------------------------------------------
K_ES.OPCJA:='WP';
VAR.ROK_F:=SSTALE.AR; VAR.OKRO_F:=SSTALE.AO; VAR.KONTROL:='T'; VAR.ROK_F(); VAR.OKRO_F();
ZM.PLAN:='_';
_om:=exec('mod_win','control',23);
SKID_MBN.win_sel(_om);
_b.grp_sel(_c,SKID_MBN,_om,_a,"
   ZM.SKID_MBN:=SKID_MBN.ref();
   exec('opiszwym','control');
   grp_disp(SRSP,SRSP.win_sel('?'),1);
   ~~
",,,,"
   SKID_MBN.f_clear();
   SKID_MBN.index('EWID'); SKID_MBN.prefix('T','O')
",,,,'maximized_with_title');
task_attach('CTR_PCO_ZSTP');
_pw:=exec('srsp_win','!ctr_pco_zstp');
SRSP.win_sel(_pw);
_b.tab_splt(_c,,'horizontal','bottom',10);
SRSP.win_act(_pw,1,'Formuła','Wartości dla podziału',,,,"KTRWP.select()");
SRSP.win_act(_pw,0,'Formuła','Wartości dla podziału',,,,"KTRWP.select()");
_b.grp_sel(_c,SRSP,_pw,,"
   _maska:={? SRSP.get() || SRSP.MASKA || 'r' ?};
   ZM.PLAN:={? _maska='r' || '' || _maska ?};
   SRD.maski(_maska);
   KTRWN.hdr_sel(); KTRWN.hdr_sel(': '+ZM.SKID_MBN().NAZ);
   KTRWN.index('KTRWN'); KTRWN.prefix(REF.FIRMA,ZM.SKID_MBN,ZM.PLAN,VAR.ROK_F,VAR.OKRO_F);
   _find:=KTRWN.first();
   KTRWN.index('KTRWN2'); KTRWN.prefix(REF.FIRMA,ZM.SKID_MBN,ZM.PLAN);
   {? ~_find || KTRWN.first() ?};
   grp_disp(KTRWN,'SELEKCJA',1);
   ~~
",,,,,,,,'maximized_with_title');
_b.tab_splt(_c,,'vertical','left');
_b.grp_sel(_c,KTRWN,'SELEKCJA',,"exec('kontrobl','control')",,,,,,,,'maximized_with_title');
KTRWN.win_sel('SELEKCJ3');
exec('ktrwn','!ctr_pco_zstp');
exec('SRD','object');
~~


\ktrwn
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AMK [2011]
:: OPIS: Ustawienie tabeli KTRWN - wyswietlanie wartosci
::  OLD: \ktrwn/skid_ktr.fml
::----------------------------------------------------------------------------------------------------------------------
SRSP.index('AKCEPT'); SRSP.prefix('T');
~~


\srsp_win
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [17.00]
:: OPIS: Zwraca okno wersji planow amortyzacji
::----------------------------------------------------------------------------------------------------------------------
_okno:=SRSP.mk_sel('Plan amortyzacji'@,'P',,'srspsel',,,,,'U');
SRSP.win_fld(_okno,,'NAZWA',,,10);
SRSP.win_fld(_okno,,'OD',,,5,,,'Od'@);
SRSP.win_fld(_okno,,'DO',,,5,,,'Do'@);
SRSP.win_fld(_okno,,'R_OPIS',,,9,,,'Rodzaj'@);
_okno

:Sign Version 2.0 jowisz:1045 2021/09/17 15:16:56 d2272bc2d8def78d98debf686b86fae2089b9db5b50e857a12bba258b64994998ef8c037757724e1f1339fd29069b2d797f70af16203e21898266bd2c591bf3d724ca9bf2c8fbeb4928b13a29e03e2b9b6a823374ce4ee442019f4673da1a2e45cf5ab62a0eee672488e5e2495cfb826b439915fe1bcba90fd2a62b09b0500bb
