:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !ppl_zes_rzez.fml
:: Utworzony: 01.03.2016
:: Autor: jaws
::======================================================================================================================
:: Zawartość: Formuły czynności PPL_ZES_RZEZ — Tworzenie zestawień zbiorczych.
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.00]
:: OPIS: Tworzenie zestawień zbiorczych - główna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
::# kind=WE, symbol=O, type=_O, name=Nagłówek listy płac, required=N, keyref=T
::
::# permissions=F_ZATR,UD_SKL
::# properties=GRP_FIRM
::# access=exec('no_limit_access','schemat','PPL')

_par:=params_get();
params_set(_par);

_in:=_par.in;
_ib:=_par.int;
_rv:=_par.out;
_mp:=_par.mp;

_result:='';

{? _in.O=~~ | _in.O=null
|| exec('ustawienia','zbiorowk');
   {? _mp.isMicro()
   || _mp.cancel()
   || _mp.done()
   ?};
   return()

|| _mp.save(_ib,_rv);
   _id:=exec('ref2uid','#table',_in.O);
   _mp.keyRef(_id,0,0);
   _value:=exec('zestawienia','zbiorowk',_in.O);
   {? type_of(_value)=type_of(0)
   || {? _mp.isMicro()
      || _mp.cancel()
      || {? _value<>0
         || _mp.done()
         || _mp.keep()
         ?}
      ?}
   || _result:=_value
   ?}
?};

{? _result<>''
:  obsługa błędów
|| _mp.error(_result);
   FUN.emsg(_result)
?};
~~


\desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.00]
:: OPIS: Tworzenie zestawień zbiorczych - formuła opisu zadania.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
_in:=params_get().mp.load(exec('kind_in','#b_port'));
_lt:='';

{? type_of(_in.O)=type_of(null) & _in.O<>null
|| SEEK.O:=_in.O;
   _lt:=~SEEK.O().LT
?};

{? +_lt
|| 'Tworzenie zestawień zbiorczych %1'@@[_lt]
|| 'Tworzenie zestawień zbiorczych'@@
?}


\error
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.00]
:: OPIS: Treść komunikatu o błędzie
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('error','zbiorowk')

:Sign Version 2.0 jowisz:1048 2020/10/16 15:19:20 94d145b7cc23a01da99635234d5922926ec4064de51dff21ac63a6cbac201dfc9d6268fcdb941fc9c014123cee20d32e9821cd0fd3b09e98e0cd404fef38090cf1ade7931befb8d1527cac253ded34f790560d6ce9c1ec185805914195534064c1d2676651ba2322cabe19977667eac268caf0691c7be289fb72739ea84570bf
