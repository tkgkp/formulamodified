:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !poc_ofo_amoc.fml
:: Utworzony: 14.09.2017
:: Autor: RWR
::======================================================================================================================
:: Zawartość: Obsługa czynności POC_OFO_AMOC - Przypomnienie o ocenach.
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: RWR [17.42]
:: OPIS: Przypomnienie o ocenach - główna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
::# properties=SERVICE
::
::# kind=WE, symbol=ZO_OSOBA, type=_ZO_OSOBA, name=Wskazanie uczestnika sesji ocen, required=T, keyref=T
::
:: Wynik działania czynności. Parametr szczególnie istotny w przypadku uruchomienia czynności usługowej.
::# kind=WY, symbol=RESULT, type=STRING, name="Wynik czynności (OK,BŁĄD,POMIŃ|xxx)", required=N
::
::# kind=WY, symbol=SUB, type=STRING, name=Temat, required=N
::# kind=WY, symbol=TO, type=MEMO, name=Odbiorca, required=N
::# kind=WY, symbol=BODYH, type=MEMO, name=Treść w formacie HTML, required=N
::
_args:=exec('zo_osoba_main_a','phr_poczta');
_args.warunek:="exec('warunek','!poc_ofo_amoc')";
_args.tytul:="exec('tytul','!poc_ofo_amoc')";
_args.tresc:="exec('tresc','!poc_ofo_amoc')";
params_exec('zo_osoba_main','phr_poczta',_args)


\desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: RWR [17.42]
:: OPIS: Przypomnienie o ocenach - formuła opisu zadania.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
_tab:=params_exec('zo_osoba_desc','phr_poczta',,1);
{? _tab.ZAW_DANE='T'
|| 'Wyślij powiadomienie przypominające o ocenach [Program: %1 (%2) | Oceniany okres: %3 - %4 | Termin: %5 | %6 %7 (%8)]'@@
      [_tab.NAZWA,_tab.RODZAJ,_tab.OKRES_OD,_tab.OKRES_DO,_tab.PLAN_DO,_tab.ZZ_NAZWISKO,_tab.ZZ_PIERWSZE,_tab.ZZ_PESEL]
|| 'Wyślij powiadomienie przypominające o ocenach'@@
?}


\warunek
::----------------------------------------------------------------------------------------------------------------------
::  UTW: RWR [17.42]
:: OPIS: Formuła weryfikuje, czy bieżący rekord tabeli ZO_OSOBA może być podstawą wysłania powiadomienia.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
ZO_OSOBA.RODZAJ='E' & ZO_OSOBA.KOMPLET='N' & ZO_OSOBA.ZO_PROC().A='T' & ZO_PROC.Z<>'T'


\tytul
::----------------------------------------------------------------------------------------------------------------------
::  UTW: RWR [17.42]
:: OPIS: Formuła, dla bieżącego rekordu tabeli ZO_OSOBA, zwraca napis będący tytułem powiadomienia.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
'Oceny pracowników - przypomnienie'


\tresc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: RWR [17.42]
:: OPIS: Formuła, dla bieżącego rekordu tabeli ZO_OSOBA, zwraca napis będący treścią powiadomienia.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
_kobieta:=(ZZ_OSOBA.PLEC='K');

'<center><h4>Ocena pracownicza</h4></center>'+
'Dzień dobry.<br>'+
'Pragniemy przypomnieć, że zgodnie z obowiązującymi w <b>'+KST.NAZWA+'</b> procedurami w zakresie ocen pracowniczych '+
'został'+{? _kobieta || 'a' || '' ?}+' Pan'+{? _kobieta || 'i' || '' ?}+
' wyznaczon'+{? _kobieta || 'a' || 'y' ?}+' jako osoba '+
'odpowiedzialna za dokonanie ocen w ramach programu <b>"'+ZO_PROC.ZO_PROG().NAZWA+'"</b>. Oceny dotyczą okresu od <b>'+
ZO_PROC.OKRES_OD$6+' roku</b> do <b>'+ZO_PROC.OKRES_DO$6+' roku</b> i powinny zostać dokonane najpóźniej do dnia <b>'+
ZO_PROC.PLAN_DO$6+' roku</b>.'+
'<br><br>'+
'Formularze ocen zostały udostępnione Pan'+{? _kobieta || 'i' || 'u' ?}+' na stronach naszego portalu pracowniczego.'+
'<br><br>'+
'Ta wiadomość została wygenerowana automatycznie - prosimy na nią nie odpowiadać.'

:Sign Version 2.0 jowisz:1048 2020/10/16 15:19:18 3a7de4d75d7b8367cc595879dd4f96f423177c4272e57bb5d5d9ebe0f5d7383e5ba7951dd591464b3c02a9d2bb4d666c89e307d9da373f5d5fb8914865a894edc0a26ad6d425972bb7a7c4b48c8db52a48746f33a936dac399e51e893781c1d2c9e95ce8d8d47b0efbd8a225b6fa7699f97503e3d608ae6b5f6447c1ba4278ea
