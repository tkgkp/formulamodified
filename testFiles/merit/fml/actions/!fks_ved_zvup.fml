:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !fks_ved_zvup.fml
:: Utworzony: 12.08.2015
:: Autor: MB
::======================================================================================================================
:: Zawartość: Formuły czynności FKS_VED_ZVuP - Przeglądanie deklaracji VAT-UE
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [17.00]
:: OPIS: Przeglądanie deklaracji VAT-UE - główna formuła czynności FKS_VED_ZVUP.
::----------------------------------------------------------------------------------------------------------------------
::# permissions=FJKS


\add_tab
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AMK [17.00]
:: OPIS: Dodanie zakładki do okna grupowego obszaru deklaracji podatkowych (FKS_VED)
::   WE: _a - nazwa zakładki
::       _b - okno grupowe
::----------------------------------------------------------------------------------------------------------------------
VAT_DEK.grp_sel(_b,,'POD',_a,"",0,0,,"exec('bw','!fks_ved_zvup')","",,,'maximized_with_title');
exec('task_attach','fks_ved','U')


\bw
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [17.00]
:: OPIS: Przed obsługą okien okna grupowego obszaru FKS_VED
::----------------------------------------------------------------------------------------------------------------------
rodzdekl:='P';
VAT_DEK.index('VAT_DEKR');
VAT_DEK.prefix(rodzdekl,SIK.ROK1().POCZ_ROK);
vat_typ:='POD';
VAT_DEK.win_sel('POD');
VAT_DEK.hdr_sel();
VAT_DEK.hdr_sel(' podsumowujące z roku %1'@[ROK_F.NAZ]);
SKID.TYP_ZAP:=''; SKID.DEKL_NAZ:='POD'


\vat_dwy
::----------------------------------------------------------------------------------------------------------------------
::  UTW: RL [8.40]
:: OPIS: Formula Wydruk dla okienka wert. tabeli VAT_DEK
::  OLD: \vat_dwy/vat.fml
::----------------------------------------------------------------------------------------------------------------------
{? VAT_DEK.TYP='PODK'
|| {? VAT_DEK.NR().NR>4
   || exec('dek2html','fks_ved')
   |? VAT_DEK.NR().NR=4
   || exec('drukuj','fks_ved','fks_dek_'+(-VAT_DEK.TYP)+'4')
   |? VAT_DEK.NR().NR=1
   || exec('rep_exec','#b_report','FKS_VED_ZVUP','fks_dek_'+(-VAT_DEK.TYP),,,,,,,,'W')
   |? exec('rpm_as_pdf','rpm_pdf') & VAT_DEK.NR().NR>2
   || exec('rep_exec','#b_report','FKS_VED_ZVUP','fks_du'+form(VAT_VER.NR,-2)+'ppk',,,,,,,,'W')
   || exec('rep_exec','#b_report','FKS_VED_ZVUP','fks_du'+form(VAT_VER.NR,-2)+'pdk',,,,,,,,'W')
   ?}
|| {? VAT_DEK.NR().NR>4
   || exec('dek2html','fks_ved')
   |? VAT_DEK.NR().NR=4
   || exec('drukuj','fks_ved','fks_dek_'+(-VAT_DEK.TYP)+'4')
   |? exec('rpm_as_pdf','rpm_pdf') & VAT_DEK.NR().NR>2
   || exec('drukuj','fks_ved','fks_dek'+(-VAT_DEK.TYP)+'p')
   || exec('drukuj','fks_ved','fks_dek_'+(-VAT_DEK.TYP))
   ?}
?}


\vat_dekz
::----------------------------------------------------------------------------------------------------------------------
::  UTW: PB [8.50]
:: OPIS: Formula dla zmiany zakresu przy przegladaniu deklaracji podatkowych
::  OLD: \vat_dekz/vat.fml
::----------------------------------------------------------------------------------------------------------------------
VAR_DEL.delete('OknROKE2');
exec('okno_rok2','fks_ved');
SIK.win_edit(OknROKE2);
{? SIK.edit("")
|| VAT_DEK.hdr_sel();
   VAT_DEK.hdr_sel(' podsumowujące'@); SKID.TYP_ZAP:=''; SKID.DEKL_NAZ:='POD';
   VAT_DEK.index('VAT_DEKR');
   {? SIK.ROK1=null
   || VAT_DEK.hdr_sel(' ze wszystkich lat'@);
      VAT_DEK.prefix(rodzdekl)
   || VAT_DEK.hdr_sel(' z roku %1'@[SIK.ROK1().NAZ]);
      VAT_DEK.prefix(rodzdekl,ROK_F.POCZ_ROK)
   ?};
   AreaTitle.setTitle()
?};
SIK.win_edit();
VAR_DEL.delete('OknROKE2');
1

:Sign Version 2.0 jowisz:1048 2023/06/23 14:09:38 a1b4ab7681b55822b200eca132dcff11f16bcd1108cf9e9b271a2d7bb7ad7fc3c550e3965f65dbb0ce2906e5075e1dcbfabd5c5d9ea14602440b5fe2b8f36174bf8edcf229704600e3e276c7615b56b0cc57211cefe3767f2df56a958b6124a190037f40bfb8fe552e71eb01a4cc2687cdebf0150b6a45c82830841317efbc7b
