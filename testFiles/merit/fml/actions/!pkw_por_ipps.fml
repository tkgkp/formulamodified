:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !pkw_por_ipps.fml
:: Utworzony: 10.07.2023
:: Autor: IS
::======================================================================================================================
:: Zawartość: Obsługa czynności webTerm-owej PKW_POR_IPPS - Przeglądanie pracy poza siedzibą firmy.
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: IS [22.26]
:: OPIS: Przeglądanie pracy poza siedzibą firmy (webTerm) - główna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('pkw_por__pps','pkw_por')


\ppsfn_szczegoly_a
::----------------------------------------------------------------------------------------------------------------------
::  UTW: IS [22.26]
:: OPIS: Obsługa akcji "Szczegóły" w oknie WT_WER tabeli PPSFN.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? ~exec('exist','#record') || return(~~) ?};
exec('set_env','pkw_por');

_we:='WT_RED';
:: Pola pomocnicze (Osoba weryfikująca wniosek, status wniosku).
exec('ppsfn_pola_pom','ppsf');
:: Ustawienie maski EDOKUM
exec('ppsfn_edokum_mask','ppsf');
PPSFN.web_display(_we,,"web_top_tab().web_eclose(web_top_win())")


\ppsfn_stanlimitu_a
::----------------------------------------------------------------------------------------------------------------------
::  UTW: IS [22.26]
:: OPIS: Obsługa akcji "Szczegóły" w oknie WT_WER tabeli PPSFN.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? ~exec('exist','#record') || return(~~) ?};
exec('set_env','pkw_por');

:: Najpierw sprawdzamy czy limitowanie danego typu jest godzinowe czy dzienne:
_sl:=exec('limit_sl','ppsf',
   {? exec('is_pzd01','ppsf') || PPSFN.PPSFT().PPSFR || PPSFN.PPSFT().SLO_KOD ?},PPSFN.OD~1,PPSFN.P);

{? (',D,G,H,'*',%1,'[_sl]) & exec('wt_ppsfl_set','pkw','STAN_L','ROK',_sl)
|| _ws:='WT_WER%1'[_sl];
   {? exec('is_pzd01','ppsf')
   || PPSFR.cntx_psh();
      _tytul:='Limit typu "%1"'@[PPSFN.PPSFT().PPSFR().NAZWA];
      PPSFR.cntx_pop()
   || SLO_KOD.cntx_psh();
      _tytul:='Limit typu "%1"'@[PPSFN.PPSFT().SLO_KOD().NAZWA];
      SLO_KOD.cntx_pop()
   ?};
   WT_PPSFL.web_win_init(_ws,,'title= %1'[_tytul]);
   WT_PPSFL.web_select(_ws,,,,"
      exec('set_env','pkw_por');
      exec('wt_ppsfl_del','pkw',3);
      web_top_close();
      exec('web_title_clear','areatitle',1)
   ")
?}

:Sign Version 2.0 jowisz:1045 2023/07/21 13:25:24 9335a69fb0da71764e9659a8da14a80afcb1b22749fac11a9fc87fcb136e56784ab8500d3b7755f351cc46f30efc7cdf8766936e4d52885b760e02688e977a6663701cab27a686144e5bd87138085fb4d9598a513ededa25931514006f359058bc9015c637c91b39814f3e49251525ec61b1810de0be6ad5f0715088b9315f0f
