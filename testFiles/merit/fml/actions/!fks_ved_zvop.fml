:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !fks_ved_zvop.fml
:: Utworzony: 20.08.2015
:: Autor: MB
::======================================================================================================================
:: Zawartość: Formuły czynności FKS_VED_ZVOP - Przeglądanie deklaracji VAT-27
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [17.00]
:: OPIS: Przeglądanie deklaracji VAT-27 - główna formuła czynności FKS_VED_ZVOP.
::----------------------------------------------------------------------------------------------------------------------
::# permissions=FJKS


\add_tab
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AMK [17.00]
:: OPIS: Dodanie zakładki do okna grupowego obszaru deklaracji podatkowych (FKS_VED)
::   WE: _a - nazwa zakładki
::       _b - okno grupowe
::----------------------------------------------------------------------------------------------------------------------
VAT_DEK.grp_sel(_b,,'VAT27',_a,"",0,0,,"exec('bw','!fks_ved_zvop')","",,,'maximized_with_title');
exec('task_attach','fks_ved','O')


\bw
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [17.00]
:: OPIS: Przed obsługą okien okna grupowego obszaru FKS_VED
::----------------------------------------------------------------------------------------------------------------------
rodzdekl:={? SIK.ROZL_VAT='K' || 'I' || 'i' ?};
VAT_DEK.index('VAT_DEKR');
VAT_DEK.prefix(rodzdekl,SIK.ROK1().POCZ_ROK);
vat_typ:='VAT27';
VAT_DEK.win_sel('VAT27');
VAT_DEK.hdr_sel();
{? rodzdekl='I'
|| VAT_DEK.hdr_sel(' VAT-27 kwartalne'@)
|| VAT_DEK.hdr_sel(' VAT-27 miesięczne'@)
?};
VAT_DEK.hdr_sel(' z roku %1'@[ROK_F.NAZ]);
SKID.TYP_ZAP:=SKID.DEKL_NAZ:='VAT27'


\vat_dwy
::----------------------------------------------------------------------------------------------------------------------
::  UTW: RL [8.40]
:: OPIS: Formula Wydruk dla okienka wert. tabeli VAT_DEK
::  OLD: \vat_dwy/vat.fml
::----------------------------------------------------------------------------------------------------------------------
{? exec('rpm_as_pdf','rpm_pdf') & VAT_DEK.NR().NR=1
|| exec('drukuj','fks_ved','fks_d27'+form(VAT_DEK.NR().NR,-2)+'p')
|| exec('drukuj','fks_ved','fks_dvat27'+form(VAT_DEK.NR().NR,-2))
?}


\vat_dekz
::----------------------------------------------------------------------------------------------------------------------
::  UTW: PB [8.50]
:: OPIS: Formula dla zmiany zakresu przy przegladaniu deklaracji podatkowych
::  OLD: \vat_dekz/vat.fml
::----------------------------------------------------------------------------------------------------------------------
VAR_DEL.delete('OknROKE2');
exec('okno_rok2','fks_ved');
SIK.win_edit(OknROKE2);
{? SIK.edit("{? SIK.ROK1=null
             || FUN.info('Należy wybrać rok bilansowy.'@);
                0
             || exec('chk_sik_rozl','!fks_ved_zvop')
             ?}")
|| rodzdekl:={? SIK.ROZL_VAT='K' || 'I' || 'i' ?};
   VAT_DEK.win_sel('VAT27');
   VAT_DEK.hdr_sel();
   vat_typ:='VAT27';
   {? rodzdekl='i'
   || VAT_DEK.hdr_sel(' VAT-27 miesięczne'@)
   || VAT_DEK.hdr_sel(' VAT-27 kwartalne'@)
   ?};
   SKID.TYP_ZAP:=SKID.DEKL_NAZ:='VAT27';
   VAT_DEK.index('VAT_DEKR');
   {? SIK.ROK1=null
   || VAT_DEK.hdr_sel(' ze wszystkich lat'@);
      VAT_DEK.prefix(rodzdekl)
   || VAT_DEK.hdr_sel(' z roku %1'@[ROK_F.NAZ]);
      VAT_DEK.prefix(rodzdekl,ROK_F.POCZ_ROK)
   ?};
   AreaTitle.setTitle()
?};
SIK.win_edit();
VAR_DEL.delete('OknROKE2');
1


\chk_sik_rozl
::----------------------------------------------------------------------------------------------------------------------
::  UTW: BZ  [12.41]
:: OPIS: Sprawdzenie czy dla wybranego roku bylo ustawone choc raz wybrane rozliczenie VAT
::  OLD: \chk_sik_rozl/skid_sik.fml
::----------------------------------------------------------------------------------------------------------------------
{? exec('chk_sik_rozl','fks_ved')
|| rodzdekl:={? SIK.ROZL_VAT='K' || 'I' || 'i' ?};
   ''
|| 'ROZL_VAT'
?}

:Sign Version 2.0 jowisz:1028 2019/06/07 15:55:43 832fdfb9cd985adfaafdf28de3c7945049fe68fd1ab618d6c5c31954182c8fd5823142bb995106b9129151e22625173a944e1908584bcfa8f2304c632feca2e1f2cf899ba704b05ab00265439c59543858933b124403cbbfdf099990cab420df2856f1c6c23a9301f7e8ff406570a3b522455c53e11b9e1a18a2121d4e7eadfc
