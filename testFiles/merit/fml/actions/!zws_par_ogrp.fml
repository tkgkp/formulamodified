:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !zws_par_ogrp.fml
:: Utworzony: 17.05.2021
:: Autor: AFI
::======================================================================================================================
:: Zawartość: Grupy dokumentów w obiegu
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AFI [21.37]
:: OPIS: Formuła główna czynności ZWS_PAR_OGRP
::----------------------------------------------------------------------------------------------------------------------
ETYP_GRP.cntx_psh();
ETYP_GRP.index('N'); ETYP_GRP.prefix(REF.FIRMA);
ETYP_GRP.win_sel('WER');
ETYP_GRP.select();
ETYP_GRP.cntx_pop()


\add_grp
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AFI [21.37]
:: OPIS: Dołącz grupę faktur w obiegu
::----------------------------------------------------------------------------------------------------------------------
ETYP_GRP.win_edit('RED');
ETYP_GRP.blank();
{? ETYP_GRP.edit("exec('valid_grp','!zws_par_ogrp')") || ETYP_GRP.add() ?}


\valid_grp
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AFI [21.37]
:: OPIS: Walidacja po redakcji grupy
::----------------------------------------------------------------------------------------------------------------------
_dalej:='';
{? ETYP_GRP.N=''
|| FUN.info('Nie wprowadzono skrótu.'@); _dalej:='N'
?};
{? ETYP_GRP.NAZ='' & _dalej=''
|| FUN.info('Nie wprowadzono nazwy grupy.'@); _dalej:='NAZ'
?};
{? _dalej=''
|| _popraw:=(-menu_txt()='popraw');
   {? _popraw || _ref:=ETYP_GRP.ref() ?};
   ETYP_GRP.cntx_psh();
   ETYP_GRP.index('N'); ETYP_GRP.prefix(REF.FIRMA,ETYP_GRP.N,ETYP_GRP.N);
   {? ETYP_GRP.first() & {? _popraw || ETYP_GRP.ref()<>_ref || 1 ?}
   || FUN.info('Istnieje już skrót o podanej nazwie.'@); _dalej:='N'
   ?};
   ETYP_GRP.cntx_pop()
?};
_dalej


\edt_grp
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AFI [21.37]
:: OPIS: Edycja grupy
::----------------------------------------------------------------------------------------------------------------------
ETYP_GRP.win_edit('RED');
{? ETYP_GRP.edit("exec('valid_grp','!zws_par_ogrp')") || ETYP_GRP.put() ?}


\del_grp
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AFI [21.37]
:: OPIS: Usuwanie grupy
::----------------------------------------------------------------------------------------------------------------------
{? ETYP_GRP.count()<>0
|| FUN.info('Grupa wykorzystywana w systemie. Usunięcie niemożliwe.'@)
|? FUN.ask('Usunąć grupę?'@)
|| ETYP_GRP.del()
?}

:Sign Version 2.0 jowisz:1048 2023/06/23 14:09:40 741e44e6e1b73c61993e49a7411652d9bfc5bf68f311dccdb10807d88c18dad8dd0aa11992d58b14da1284588d4b897b1e607f49b18985484a8fb784d828f506f6adbe2888db57bf02fbda81be58034a590fec264885b75b24a596fbf1b22dae8f9ffcad6d7ea080a39858df3e48eb17f92a86bebf2e55d073106a6e056dfd35
