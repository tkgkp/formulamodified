:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !fks_ved_zvvp.fml
:: Utworzony: 21.09.2021
:: Autor: MB
::======================================================================================================================
:: Zawartość: Formuły czynności FKS_VED_ZVVP - Przeglądanie deklaracji VIU-DO
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [21.14]
:: OPIS: Przeglądanie deklaracji VIU-DO - główna formuła czynności FKS_VED_ZVVP.
::----------------------------------------------------------------------------------------------------------------------
::# permissions=FJKS


\add_tab
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [21.14]
:: OPIS: Dodanie zakładki do okna grupowego obszaru deklaracji podatkowych (FKS_VED)
::   WE: _a - nazwa zakładki
::       _b - okno grupowe
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('B_VIUDO',FINFO)>0
|| VAT_DEK.grp_sel(_b,,'VIUDO',_a,"",0,0,,"exec('bw','!fks_ved_zvvp')","",,,'maximized_with_title');
   exec('task_attach','fks_ved','V');
   exec('set_viudo_fml','fks_viudo')
?};
~~


\bw
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [21.14]
:: OPIS: Przed obsługą okien okna grupowego obszaru FKS_VED
::----------------------------------------------------------------------------------------------------------------------
rodzdekl:='Y';
{? var_pres('VatRok1')>0 & type_of(VatRok1)=type_of(null)
|| SIK.ROK1:=VatRok1
?};
VAT_DEK.index('VAT_DEKR');
VAT_DEK.prefix(rodzdekl,SIK.ROK1().POCZ_ROK);
vat_typ:='VIUDO';
VAT_DEK.win_sel('VIUDO');
VAT_DEK.hdr_sel();
VAT_DEK.hdr_sel(' VIU-DO kwartalne'@);
VAT_DEK.hdr_sel(' z roku %1'@[ROK_F.NAZ]);
SKID.TYP_ZAP:=SKID.DEKL_NAZ:='VIUDO'


\vat_dwy
::----------------------------------------------------------------------------------------------------------------------
::  UTW: RL [8.40]
:: OPIS: Formula Wydruk dla okienka wert. tabeli VAT_DEK
::  OLD: \vat_dwy/vat.fml
::----------------------------------------------------------------------------------------------------------------------
{? exec('rpm_as_pdf','rpm_pdf') & VAT_DEK.NR().NR=1
|| exec('drukuj','fks_ved','fks_d27'+form(VAT_DEK.NR().NR,-2)+'p')
|| exec('drukuj','fks_ved','fks_dvat27'+form(VAT_DEK.NR().NR,-2))
?}


\akc_zakres
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [21.14]
:: OPIS: Formula dla zmiany zakresu przy przegladaniu deklaracji podatkowych
::----------------------------------------------------------------------------------------------------------------------
VAR_DEL.delete('OknROKE2');
exec('okno_rok2','fks_ved');
SIK.win_edit(OknROKE2);
{? SIK.edit("{? SIK.ROK1=null
             || FUN.info('Należy wybrać rok bilansowy.'@);
                0
             || 1
             ?}")
|| VAT_DEK.win_sel('VIUDO');
   VAT_DEK.hdr_sel();
   vat_typ:='VIUDO';
   SKID.TYP_ZAP:=SKID.DEKL_NAZ:='VIUDO';
   VAT_DEK.index('VAT_DEKR');
   VAT_DEK.hdr_sel(' VIU-DO kwartalne'@);
   {? SIK.ROK1=null
   || VAT_DEK.hdr_sel(' ze wszystkich lat'@);
      VAT_DEK.prefix(rodzdekl)
   || VAT_DEK.hdr_sel(' z roku %1'@[ROK_F.NAZ]);
      VAT_DEK.prefix(rodzdekl,ROK_F.POCZ_ROK)
   ?};
   VatRok1:=SIK.ROK1;
   AreaTitle.setTitle()
?};
SIK.win_edit();
VAR_DEL.delete('OknROKE2');
1


\br_viudo_poz
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [21.14]
:: OPIS: Rekord przed dona VIUDO tabeli VAT_POZ
::----------------------------------------------------------------------------------------------------------------------
_gray:='';
{? VAT_POZ.TYP='S'
|| _gray+='Z'
?};
VAT_POZ.actions_grayed('VIUDO',_gray);
~~

:Sign Version 2.0 jowisz:1045 2021/10/06 13:25:22 1d98d8e8b7915c61eb516f36ac4549676e478b93f710c90e66849e0c794446ad41bcd5671b98c3ae0fb572a42ba161887f0a5f8ab08294b921533340f11630c9473a14c15556e2ffc2b6052f78981c16a5ea6eaee1b3699b42eace248a68fe94cfcd63ca9d6bc0f45df81be306ed88bd6a57ab82e19625eb5b097944df00a0d3
