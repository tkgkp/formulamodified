:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !zws_par_trkg.fml
:: Utworzony: 04.03.2019
:: Autor: TS
::======================================================================================================================
:: Zawartość: Formuły czynności ZWS_PAR_TRKG - Kategorie zgłoszeń remontowych
::            Obsługa tabeli REM_KATG
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [19.22]
:: OPIS: Formuła główna czynności parametryzacyjnej (nieprocesowej) - kategorie zgłoszeń remontowych
::----------------------------------------------------------------------------------------------------------------------
REM_KATG.cntx_psh();
REM_KATG.win_sel('WER');
REM_KATG.index('SYMBOL');
REM_KATG.prefix();
REM_KATG.select();
REM_KATG.cntx_pop();
~~


\action_delete
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [19.22]
:: OPIS: Akcja 'Usuń' w oknie REM_KATG.WER
::----------------------------------------------------------------------------------------------------------------------
{? FUN.ask('Czy usunąć bieżący wiersz?'@)
|| {? REM_KATG.count()>0
   ||
       do();
      _del:=1;
::    usuwam powiązane z kategorią osoby realizujące wnioski administracyjne
      {? exec('lic','#b_domain','POR')
      || WAOR.cntx_psh();
         WAOR.index('KAT');
         WAOR.prefix(REM_KATG.ref());
         {? WAOR.first()
         || {! |?
               _del:=WAOR.del(,1);
               {? _del=1 || 0 |? _del=0 || undo(); 0 || 1 ?}
            !}
         ?};
         WAOR.cntx_pop()
      ?};
      {? _del=0 | REM_KATG.count()>0
      || undo();
         FUN.info('Usunięcie nie jest możliwe — wskazana kategoria zgłoszenia remontowego jest już użyta w systemie.'@)
      || _del:=REM_KATG.del(,1);
         {? _del=0 || undo() ?}
      ?};
      end()
   || REM_KATG.del()
   ?}
?};
~~


\chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [19.22]
:: OPIS: Akcja 'Rekord po' w oknie REM_KATG.WER
::----------------------------------------------------------------------------------------------------------------------
exec('chk_rem_katg','remonty_zgloszenia',-menu_txt()='popraw')

:Sign Version 2.0 jowisz:1045 2021/01/22 13:20:06 b75c9ed50bd408b4e1eb7913a8a73dc366d758335964044a47c78d3388614384feffe704d8013432e2dd35306a88b79f28da28cbd3354538fe96ad83f39856bf60b38dd88214e135725759148932e2f2fca13c3b451dfe93ed59cc279ca3ddd05a8cccc317da02e2c7af5b4f937deb269c132c122db29aecc4b0a84a4a747b1e
