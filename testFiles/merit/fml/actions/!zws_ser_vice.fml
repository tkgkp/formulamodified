:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !zws_ser_vice.fml
:: Utworzony: 02.09.2016 [17.00]
:: Autor: TS
::======================================================================================================================
:: Zawartość: Formuły czynności serwisowej uniwersalnej ZWS_SER_VICE
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [17.00]
:: OPIS: Czynność serwisowa uniwersalna (ZWS_SER_VICE) - formuła główna
::----------------------------------------------------------------------------------------------------------------------
::# properties=SERVICE,~USER,GRP_FIRM

params_set(params_get());
_mp:=params_get().mp;
_out:=params_get().out;
{? _mp.bi_proc<>null() & _mp.bi_prel<>null() & _mp.buf_act.UID<>''
|| _biPrel:=exec('buffer','#bi_prel'); _biPrel.cntx_get(_mp.bi_prel);
   _bPrel:=exec('buffer','#b_prel'); _bPrel.cntx_get(_biPrel.B_PREL);
   {? _bPrel.FMANOUT<>''
   || _val:=exec('run','!zws_ser_vice',_bPrel.FMANOUT);
      {? type_of(_val)=type_of(null()) & _val<>null() & ref_tab(_val)=BI_BLOB
      || _blobs:=_mp.bl_get(_val);
         {? _blobs.first()
         || {!
            |? _mp.bl_add(_blobs.BLOB);
               _blobs.next()
            !}
         ?};
         exec('delete','#bi_blob',_val)
      || _out.OUT:=_val
      ?};
      _mp.save(,_out)
   ?};
   {? _bPrel.FMANOUT<>''
   || exec('run','!zws_ser_vice',_bPrel.FMANMAIN,_out.OUT)
   || exec('run','!zws_ser_vice',_bPrel.FMANMAIN)
   ?};
   _mp.done()
?};
~~


\desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [17.00]
:: OPIS: Opis czynności serwisowej uniwersalnej (ZWS_SER_VICE)
::   WY: Opis na To-Do
::----------------------------------------------------------------------------------------------------------------------
params_set(params_get());
_mp:=params_get().mp;
_desc:='';
{? _mp.bi_proc<>null() & _mp.bi_prel<>null() & _mp.buf_act.UID<>''
|| _biPrel:=exec('buffer','#bi_prel'); _biPrel.cntx_get(_mp.bi_prel);
   _bPrel:=exec('buffer','#b_prel'); _bPrel.cntx_get(_biPrel.B_PREL);
   {? _bPrel.FMANDESC<>''
   || _desc:=exec('run','!zws_ser_vice',_bPrel.FMANDESC);
      {? type_of(_desc)<>type_of('')
      || _mp.error('Błędny typ wyniku formuły dla opisu czynności usługowej.')
      ?}
   ?}
?};
_desc


\run
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [17.00]
:: OPIS: Uruchomienie formuły dla czynności serwisowej uniwersalnej
::   WE: _a - treść formuły
::       [_b] - parametr formuły
::----------------------------------------------------------------------------------------------------------------------
params_set(params_get());
{? var_pres('_b')>=0 || ($_a)(_b) || ($_a)() ?}

:Sign Version 2.0 jowisz:1028 2019/06/07 15:56:07 7a1f2d421f1684797ab4db5402a70c9e2921bc64959b75039bfc501e1b64b9bffde6d63b035671a0383559e09b389a9599c2d94d9a33cc73f9c0952376127ab2552e9f1184fde650ef9b5e784c78bdd1c211fa2348b6d23cf3e941c2be021ce38825c43cff090cacc2a0942b29f49342ef65ba193f91eb59858d623654d17f0e
