:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !zpr_snd_mail.fml
:: Utworzony: 13.05.2015 [17.00]
:: Autor: TS
::======================================================================================================================
:: Zawartość: Formuły czynności ZPR_SND_MAIL - wysłanie wiadomości e-mail
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [17.00]
:: OPIS: Czynność wysłania wiadomości e-mail (ZPR_SND_MAIL) - formuła główna
::       UWAGA: do pobrania parametrów stosować params_get() = tablica nazwana:
::       in  - [obj_new] - parametry wejściowe czynności
::       int - [obj_new] - parametry wewnętrzne czynności
::       out - [obj_new] - parametry wyjściowe czynności
::       mp  - obiekt odpowiedzialny za obsługę procesu
::----------------------------------------------------------------------------------------------------------------------
_out:=params_get().out;
_mp:=params_get().mp;

:: PARAMETRY WY:
::# kind=WY, symbol=RESULT, type=STRING, name="Wynik czynności (OK, gdy wszystkie wiadomości zostały wysłane, wpp. BŁĄD)", required=N
{? var_pres('RESULT',_out)<>type_of(~~) & var_pres('RESULT',_out)<>type_of('') || return() ?};
::# kind=WY, symbol=BODYT, type=MEMO, name=Treść raportu, required=N
{? var_pres('BODYT',_out)<>type_of(~~) & var_pres('BODYT',_out)<>type_of('') || return() ?};

:: WŁAŚCIWOŚCI CZYNNOŚCI
::# properties=SERVICE,GRP_FIRM

exec('MAIL','#object');

_result:=exec('send_all','#mailbox',_mp);

_out.RESULT:=_result.RESULT;
_out.BODYT:=_result.BODYT;

_mp.save(,_out);
_mp.done();
~~


\desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [17.00]
:: OPIS: Opis czynności wysłania wiadomości e-mail (ZPR_SND_MAIL)
::   WY: Opis na To-Do
::----------------------------------------------------------------------------------------------------------------------
_desc:='Wyślij wiadomości e-mail'@@;
_desc

:Sign Version 2.0 jowisz:1045 2022/06/30 14:22:55 3e304a935bf4902a6d43894ea5de4674c9a44e77324772c5e226409949a57fce2cf775a234c74d328cdae4a062fabd0af5d0ff30009100a0d4f5e8e120109eeab4c3b4a94a6972b2910a5f0779c4681864cd17e59e62e2f0ec4c90fee7b53b3c6e9da76ddf6e3ed7a85992dfd64a4f0a4eea675b9cb8fa2099cabf19125ba230
