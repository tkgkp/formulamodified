:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !tpp_pps_dspa.fml
:: Utworzony: 21.06.2016
:: Autor: TS
::======================================================================================================================
:: Zawartość: Formuły czynności TPP_PPS_DSPA - Przeliczenie planu
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [17.00]
:: OPIS: Główna formuła czynności przeliczenia planu strategicznego (TPP_PPS_DSPA)
::       UWAGA: do pobrania parametrów stosować params_get() = tablica nazwana:
::       in  - [obj_new] - parametry wejściowe czynności
::       int - [obj_new] - parametry wewnętrzne czynności
::       out - [obj_new] - parametry wyjściowe czynności
::       mp  - obiekt odpowiedzialny za obsługę procesu
::----------------------------------------------------------------------------------------------------------------------
_out:=params_get().out;
_mp:=params_get().mp;

::# permissions=ODDZ
::# properties=SERVICE,~USER

::# kind=WY, symbol=RESULT, type=STRING, name="Wynik czynności (OK, gdy plan został poprawnie przeliczony)", required=N
{? var_pres('RESULT',_out)<>type_of(~~) & var_pres('RESULT',_out)<>type_of('') || return() ?};

_result:=0;
_can_continue:=1;

_one_ver:=exec('is_one_version','px_param');

:: Jedna wersja planu - przeliczanie wersji głównej
{? _one_ver>0
|| _ok:=exec('mainver_replan','px_logix',0);
   {? _ok
   || _out.RESULT:='OK';
      _mp.save(,_out);
      _mp.done()
   || _out.RESULT:='BŁĄD';
      _mp.save(,_out);
      _mp.done()
   ?}

:: Wiele wersji planu - przeliczanie symulacji
|| _res:=exec('plan_licz','px_task');
   {? _res[1]>0
   || _out.RESULT:='OK';
      _mp.save(,_out);
      _mp.done()
   || _out.RESULT:='BŁĄD';
      _mp.save(,_out);
      _mp.done()
   ?}
?};
~~


\desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [17.00]
:: OPIS: Opis dla czynności przeliczenia planu strategicznego (TPP_PPS_DSPA)
::       UWAGA: do pobrania parametrów stosować params_get() = tablica nazwana:
::       mp  - obiekt odpowiedzialny za obsługę procesu
::   WY: zwraca opis Zadania
::----------------------------------------------------------------------------------------------------------------------
_desc:='Przelicz plan strategiczny'@@;
_desc

:Sign Version 2.0 jowisz:1048 2020/10/16 15:19:21 75cb773535d84a6578b1594956a83994493652b82303df34c3cf9711bdc1369b69d35b8082e24fba34c21fd24a04eb1fc84744206c79522babc8c87118834b91b58681bddc4482d52bfc5e109bf7984470ca9a66d8185afaf04a5acc416077fe2752b53a9c1814fe105e3477c4ff741ae77ea3b51de997003191aa8b336a6f7f
