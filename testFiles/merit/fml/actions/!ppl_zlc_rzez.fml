:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !ppl_zlc_rzez.fml
:: Utworzony: 24.06.2016
:: Autor: jaws
::======================================================================================================================
:: Zawartość: Formuły czynności PPL_ZLC_RZEZ — Tworzenie zestawień zbiorczych.
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.00]
:: OPIS: Tworzenie zestawień zbiorczych - główna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
::# kind=WE, symbol=O, type=_O, name=Nagłówek listy płac, required=N, keyref=T
::
::# permissions=F_ZATR,UD_SKL
::# properties=GRP_FIRM

_par:=params_get();
params_set(_par);

_in:=_par.in;
_ib:=_par.int;
_rv:=_par.out;
_mp:=_par.mp;

_result:='';

{? _in.O=~~ | _in.O=null
|| exec('ustawienia','zbiorowk');
   {? _mp.isMicro()
   || _mp.cancel()
   || _mp.done()
   ?};
   return()

|| _mp.save(_ib,_rv);
   _id:=exec('ref2uid','#table',_in.O);
   _mp.keyRef(_id,0,0);
   _value:=exec('zestawienia','zbiorowk',_in.O);
   {? type_of(_value)=type_of(0)
   || {? _mp.isMicro()
      || _mp.cancel()
      || {? _value<>0
         || _mp.done()
         || _mp.keep()
         ?}
      ?}
   || _result:=_value
   ?}
?};

{? _result<>''
:  obsługa błędów
|| _mp.error(_result);
   FUN.emsg(_result)
?};
~~


\desc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.00]
:: OPIS: Tworzenie zestawień zbiorczych - formuła opisu zadania.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
_in:=params_get().mp.load(exec('kind_in','#b_port'));
_lt:='';

{? type_of(_in.O)=type_of(null) & _in.O<>null
|| SEEK.O:=_in.O;
   _lt+=~SEEK.O().LT
?};

{? +_lt
|| 'Tworzenie zestawień zbiorczych %1'@@[_lt]
|| 'Tworzenie zestawień zbiorczych'@@
?}


\error
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.00]
:: OPIS: Treść komunikatu o błędzie
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
'Tworzenie zestawień zbiorczych niemożliwe'@

:Sign Version 2.0 jowisz:1048 2020/10/16 15:19:20 71eea55c36f4325841600da41cd6b8cb52dc14ad7dc2d23cb9cc926f6ae3825d7b6d6019adb9795c02a834dec16c7721d6227f066e8e8555ce413594e814a34a65f58ab1355559e4ebb490647e1bd194cbc472b3e8e74c5dfe03358a444ce2469d207d172e3243f3f7bf4d7a4fb7ba19c5bdc83992d990d1f2a986f291213fa8
