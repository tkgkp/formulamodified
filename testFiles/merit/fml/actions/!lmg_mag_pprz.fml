:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: !lmg_mag_pprz.fml
:: Utworzony: 07.12.2015
:: Autor: AWI
::======================================================================================================================
:: Zawartość: Przegląd przecen
::======================================================================================================================


\main
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AWI [17.00]
:: OPIS: Formuła główna czynności
::       UWAGA. Do pobrania parametrów stosować params_get() = tablica nazwana:
::       in  - [obj_new] - parametry wejściowe czynności
::       int - [obj_new] - parametry wewnętrzne czynności
::       out - [obj_new] - parametry wyjściowe czynności
::       mp  - obiekt odpowiedzialny za obsługę procesu
::----------------------------------------------------------------------------------------------------------------------
::# permissions=ODDZ,LMG
~~


\przecena
::----------------------------------------------------------------------------------------------------------------------
::  UTW: [Mario] [2008]
:: OPIS: menu funkcje pomocnicze - Przecena
::  OLD: \przecen/pomoc.fml
::----------------------------------------------------------------------------------------------------------------------
POMOC.RODZ:='T';
{? (ST.MAG().TYP*'EWI')
||
   _ok:=1;
   _txt:='';
   _typy_upr:=exec('get','#params',1001,2,OPERATOR.USER);
   {? _typy_upr*'PRC+'=0 || _ok:=0; _txt+='PRC+ ' ?};
   {? _typy_upr*'PRC-'=0 || _ok:=0; _txt+='PRC- ' ?};
   {? _typy_upr='' || _ok:=1 ?};
   {? _ok=1
   ||
      _refnd:=ND.ref();
      _typydok:=TYPYDOK.ref();
      ND.cntx_psh();
      TYPYDOK.cntx_psh();
      exec('prz_psh','open_tab');
::    wykorzystanie baz do przeceny
      exec('prz_open','open_tab');
      INN.win_sel('WYC');
      INN.win_edit('DAT');
      INP.win_sel('WYC');
      INP.win_edit();
      INN.hdr_sel();
      INN.hdr_sel(' w magazynie : '+ST.MAG().SYM);
      INN.index('INN');
      INN.prefix(ST.MAG);
      INN.select();
      exec('prz_pop','open_tab');
      ND.cntx_pop();
      TYPYDOK.cntx_pop();
      BEER.TYPYDOK:=null();
      exec('typydok_'+{? ZAKR.PLMINALL='P' || 'plus' |? ZAKR.PLMINALL='M' || 'minus' || 'all' ?},'lmg');
      TYPYDOK.f_seek(_typydok);
      exec('pd_grp_typydok','lmg');
      ND.seek(_refnd);
      ''
   ||
      FUN.info('Brak uprawnień do dokumentów przeceny typu: %1.'@[_txt])
   ?}
|| FUN.info('Funkcja dostępna tylko w magazynie typu \'EWIDEN\' lub \'DOSTEWI\'.'@)
?};
''

:Sign Version 2.0 jowisz:1028 2019/06/07 15:55:46 62d7585c5376a40dc5c7397c240ee4a3240d573b376c725e1ca94ed8d16d705289535ee92ba2bb9655d37b3e2603181dcc79022d7dc8908d370247c90e276a7a59483435c57bcc501c11b81763939cd770082562b3f1ffa18019a26428fb5a42473103dcf8b1445ad4fcdef6091ab2e61a38b9386258152260da1a35f40360a8
