:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: #link.fml
:: Utworzony: 13.11.2018
:: Autor: TS
::======================================================================================================================
:: Zawartość: Formuły do obsługi linków (część core)
::======================================================================================================================


\decl_links
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [19.02]
:: OPIS: Deklaracja klasy obsługującej linki
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('Links',@.CLASS)>0
|| return()
?};

obj_decl('Links',
:: --POLA---------------------------------------------------------------------------------------------------------------
   obj_fld('FORMULA',""),

:: --KONSTRUKTOR/DESTRUKTOR---------------------------------------------------------------------------------------------
   obj_meth('__init',
      "
      "),

:: --METODY-------------------------------------------------------------------------------------------------------------
   obj_meth('run',
      "
      ")
);
~~


\get_link
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [19.02]
:: OPIS: Pobiera link do rekordu (jego uidref) i umieszcza w schowku
::   WE: _a - ref rekordu, jeśli brak to bieżący rekord w oknie
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=type_of(null())
|| _tab:=ref_tab(_a)
|| _tab:=cur_tab(1,1)
?};
_link:=_tab.uidref();

_ctr_id:=exec('create','#desktop',SYSLOG,'ctr_confirm',,5,20,FUN.TYT,,'normal',,0,0);
SYSLOG.win_ctr(_ctr_id);

:: Takie czary, żeby zadziałały tłumaczenia poniżej (teksty MUSZĄ być identyczne)
'Kopiuj do schowka'@;
_before:="
   exec('load','#desktop','ctr_confirm','#link_confirm.dsk',,,,,,0);
   exec('set_value','#desktop','','ctr_confirm','button@panel','Kopiuj do schowka'@);
   1
";
_win_id:='id_confirm_link';
params_set('link',_link);
SYSLOG.control(_win_id,'modal=false,pack=false',_before);
~~


\copy_to_clipboard
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [19.02]
:: OPIS: Kopiuje link do schowka
::----------------------------------------------------------------------------------------------------------------------
exec('clip_set_txt','#desktop','','ctr_confirm',params_get().link);
sel_exit();
~~

:Sign Version 2.0 jowisz:1045 2022/06/30 14:23:09 5dc9d4a1bca7969251fc8ca0ab0c878519c320a1cba54a5b4f142c688538a7f32c21cf0167906630c0632a926322a44492ab60ac243796d4d023853e0034608aa9341886dfbc4a7570909c5020f46711acd3cce120c0c0c1f651a87320f0259773244f86d557acc9f32c58e631578d2780ba979357fc6f9b0264cdf474fa63a4
