:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: zasoby_biling.fml
:: Utworzony: 13.06.2017
:: Autor: MB
::======================================================================================================================
:: Zawartość: Obsługa bilingów dla telefonów
::======================================================================================================================


\xls_split_decl
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [17.28]
:: OPIS: Definicja klasy i powolanie obiektu XlsSplit do dzielenia arkuszy excela
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('XSSCLASS',@.CLASS)<0
|| obj_decl('XSSCLASS',
            obj_fld('LIB', 0),
            obj_fld('F1', 0),
            obj_fld('F2', 0),
            obj_fld('F3', 0),
            obj_fld('F4', 0),
            obj_fld('F5', 0),
            obj_fld('F6', 0),
            obj_fld('F7', 0),
            obj_fld('F8', 0),
            obj_meth('__init',"
               _Interm := exec('interm','#system');
               {? _Interm
               ||
                  .LIB:=lib_load_srv_jar('excelspliter.jarl',0)
               ||
                  .LIB:=lib_load('excelspliter.dll',1)
               ?}
            "),
            obj_meth('__done',"
               {? .LIB
               || lib_free(.LIB)
               ?}
            "),
            obj_meth('addCell',"
               {? .LIB
               || {? ~.F1
                  || .F1:=lib_decl(.LIB,,'void','addCell','char *','char *')
                  ?};
                  {? .F1
                  || lib_call(.F1,_a,_b)
                  || ''
                  ?}
               || ''
               ?}
            ",type_of(''),type_of('')),
            obj_meth('add',"
               {? .LIB
               || {? ~.F2
                  || .F2:=lib_decl(.LIB,,'int','add','char *')
                  ?};
                  {? .F2
                  || lib_call(.F2,_a)
                  || ''
                  ?}
               || ''
               ?}
            ",type_of('')),
            obj_meth('addDir',"
               {? .LIB
               || {? ~.F8
                  || .F8:=lib_decl(.LIB,,'int','addDir','char *')
                  ?};
                  {? .F8
                  || lib_call(.F8,_a)
                  ?}
               ?}
            ",type_of('')),
            obj_meth('first',"
               {? .LIB
               || {? ~.F3
                  || .F3:=lib_decl(.LIB,,'int','first')
                  ?};
                  {? .F3
                  || lib_call(.F3)
                  ?}
               ?}
            "),
            obj_meth('next',"
               {? .LIB
               || {? ~.F4
                  || .F4:=lib_decl(.LIB,,'int','next')
                  ?};
                  {? .F4
                  || lib_call(.F4)
                  || ''
                  ?}
               || ''
               ?}
            "),
            obj_meth('getCell',"
               {? .LIB
               || {? ~.F5
                  || .F5:=lib_decl(.LIB,,'char *','getCell','char *')
                  ?};
                  {? .F5
                  || lib_call(.F5,_a)
                  ?}
               ?}
            ",type_of('')),
            obj_meth('setTypeOut',"
               {? .LIB
               || {? ~.F6
                  || .F6:=lib_decl(.LIB,,'void','setTypeOut','char *')
                  ?};
                  {? .F6
                  || lib_call(.F6,_a)
                  || ''
                  ?}
               || ''
               ?}
            ",type_of('')),
            obj_meth('save',"
               {? .LIB
               || {? ~.F7
                  || .F7:=lib_decl(.LIB,,'char *','save','char *','char *')
                  ?};
                  {? .F7
                  || lib_call(.F7,_a,_b)
                  || ''
                  ?}
               || ''
               ?}
            ",type_of(''),type_of(''))
   )
?}


\set_biling
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [17.28]
:: OPIS: Ustawia pola bilingu na podstawie numeru karty SIM
::   WE: _a - numer karty SIM
::----------------------------------------------------------------------------------------------------------------------
NRKRTSIM.cntx_psh();
NRKRTSIM.index('DISP'); NRKRTSIM.prefix(REF.FIRMA,_a,);
BILINGI.NRKRTSIM:={? NRKRTSIM.first() || NRKRTSIM.ref() || null ?};
{? BILINGI.NRKRTSIM<>null
|| ZASOBY.cntx_psh();
   ZASOBY.index('TYP'); ZASOBY.prefix('S',BILINGI.NRKRTSIM().ID);
   {? ZASOBY.first()
   || ZASOB_ZM.cntx_psh();
      ZASOB_ZM.index('DISP'); ZASOB_ZM.prefix(ZASOBY.ref());
      {? ZASOB_ZM.find_le(SSTALE.AO().KON)
      || BILINGI.OSOBA:=ZASOB_ZM.OSOBA
      ?};
      ZASOB_ZM.cntx_pop()
   ?};
   ZASOBY.cntx_pop()
?};
NRKRTSIM.cntx_pop()

:Sign Version 2.0 jowisz:1045 2022/06/30 14:23:26 6d2224be2910f0f7e589339566584811a144d1ed3282890af3264c16b206d0d9a4a02b9f370d28cade00043ba69b9eb9137a901214107d118c09988491e027b39d1f5a60c7ffa1f4a407773350e5370aac1087f579fa3100ce1d7dbcbc96e0dd501252429c75cfd3f1136fa3462481f1097b4ff6ae7acf512ee5c6c4f4b652df
