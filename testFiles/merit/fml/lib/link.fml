:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: link.fml
:: Utworzony: 26.11.2018
:: Autor: TS
::======================================================================================================================
:: Zawartość: Formuły do obsługi linków (część lib)
::======================================================================================================================


\rule_area
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [19.02]
:: OPIS: Zwraca kod obszaru roboczego i kod formuły
::   WE: _a - link
::   WY: obj_new()
:: ~OST: INSYSEXEC
::----------------------------------------------------------------------------------------------------------------------
_link:=_a;
_result:=obj_new('status','rule','area','link');
_result.status:=1;
_result.rule:=_result.area:='';
_result.link:=_link;

{? +_link<>48 | type_of(ref_tab(_link))<=0
|| _result.status:=0;
   FUN.info('Przekazano niepoprawny odsyłacz: %1.'@[_link])

|? ref_tab(_link)=FAKS & exec('FindAndGet','#table',FAKS,_link,,"T().ZAK",'')='N'
   | ref_tab(_link)=FAP
     & exec('FindAndGet','#table',FAP,_link,,"exec('FindAndGet','#table',@.FAKS,FAKS,,\"T().ZAK\",'')",'')='N'
   | ref_tab(_link)=FAKZ
|| _result.rule:='LSP_FAK';
   _result.area:='LSP_FAK'

|? ref_tab(_link)=FAKS & exec('FindAndGet','#table',FAKS,_link,,"T().ZAK",'')='T'
   | ref_tab(_link)=FAP
     & exec('FindAndGet','#table',FAP,_link,,"exec('FindAndGet','#table',@.FAKS,FAKS,,\"T().ZAK\",'')",'')='T'
|| _result.rule:='LZK_ZAK';
   _result.area:='LZK_ZAK'

|? ref_tab(_link)=FAKS
|| _result.status:=0;
   FUN.info('Dokument o identyfikatorze %1 nie został odnaleziony.'@[_link])

|? ref_tab(_link)=FAP
|| _result.status:=0;
   FUN.info('Pozycja dokumentu o identyfikatorze %1 nie została odnaleziona.'@[_link])

|? ref_tab(_link)=ZL & exec('FindAndGet','#table',ZL,_link,,"TYP().WP",'')='P'
|| _result.rule:='TTE_PZL';
   _result.area:='TTE_PZL'

|? ref_tab(_link)=ZL & exec('FindAndGet','#table',ZL,_link,,"TYP().WP",'')='W'
|| _result.rule:='TTE_WZL';
   _result.area:='TTE_WZL'

|? ref_tab(_link)=ZL
|| _result.status:=0;
   FUN.info('Zlecenie o identyfikatorze %1 nie zostało odnalezione.'@[_link])

|? ref_tab(_link)=SRST
|| _result.rule:='FST_EWI';
   _result.area:='FST_EWI'

|? ref_tab(_link)=SRDO
|| _result.rule:='FST_EWI';
   _result.area:='FST_EWI'

|? ref_tab(_link)=REM_ZAS
|| _result.rule:='ZWS_ZAS';
   _result.area:='ZWS_ZAS'

|? ref_tab(_link)=REM_ZGL
|| _result.rule:='TRE_ZGL';
   _result.area:='TRE_ZGL'

|? ref_tab(_link)=M
|| _result.rule:='ZWS_MAT';
   _result.area:='ZWS_MAT'

|? ref_tab(_link)=KH
|| _result.rule:='ZWS_KHR';
   _result.area:='ZWS_KHR'

|? ref_tab(_link)=KH_ODB
|| _result.rule:='ZWS_KHR';
   _result.area:='ZWS_KHR'

|? ref_tab(_link)=KH_OSOB
|| _result.rule:='ZWS_KHR';
   _result.area:='ZWS_KHR'

|? ref_tab(_link)=ND
|| _result.rule:='LMG_MAG';
   _result.area:='LMG_MAG'

|? ref_tab(_link)=DK
|| _result.rule:='LMG_MAG';
   _result.area:='LMG_MAG'

|? ref_tab(_link)=ZLP
|| _result.rule:='LUM_ZGL';
   _result.area:='LUM_ZGL'

|? ref_tab(_link)=UM
|| _result.rule:='LUM_UMO';
   _result.area:='LUM_UMO'

|? ref_tab(_link)=UP
|| _result.rule:='LUM_UMO';
   _result.area:='LUM_UMO'

|? ref_tab(_link)=OFE
   | ref_tab(_link)=OFP
|| _result.rule:='LSP_OFE';
   _result.area:='LSP_OFE'

|? ref_tab(_link)=ZK_N &
   exec('FindAndGet','#table',ZK_N,_link,,"T().R",'')='Z'
   | ref_tab(_link)=ZK_P &
     (_link_p:=exec('FindAndGet','#table',ZK_P,_link,,"N",'');
     exec('FindAndGet','#table',ZK_N,_link_p,,"T().R",'')='Z')
|| _result.rule:='LSP_ZKN';
   _result.area:='LSP_ZKN'

|? ref_tab(_link)=ZK_N &
   exec('FindAndGet','#table',ZK_N,_link,,"T().R",'')='W'
   | ref_tab(_link)=ZK_P &
     (_link_p:=exec('FindAndGet','#table',ZK_P,_link,,"N",'');
     exec('FindAndGet','#table',ZK_N,_link_p,,"T().R",'')='W')
|| _result.rule:='LMG_ZAM';
   _result.area:='LMG_ZAM'

|? ref_tab(_link)=ZK_P
|| FUN.info('Rekord w tabeli ZK_P nie jest dostepny.'@);
   _result.status:=0

|? ref_tab(_link)=ZK_N
|| FUN.info('Rekord w tabeli ZK_N nie jest dostepny.'@);
   _result.status:=0

|? ref_tab(_link)=ZD_NAG
|| _result.rule:='LZK_ZDS';
   _result.area:='LZK_ZDS'

|? ref_tab(_link)=ZD_POZ
|| _result.rule:='LZK_ZDS';
   _result.area:='LZK_ZDS'

|? ref_tab(_link)=TKTL & exec('FindAndGet','#table',TKTL,_link,,"TORW",'')='T'
|| _result.rule:='TTE_TEC';
   _result.area:='TTE_TEC'

|? ref_tab(_link)=TKTL & exec('FindAndGet','#table',TKTL,_link,,"TORW",'')='W'
|| _result.rule:='TTE_WTE';
   _result.area:='TTE_WTE'

|? ref_tab(_link)=TKTL & exec('FindAndGet','#table',TKTL,_link,,"TORW",'')='Z'
|| _result.status:=0;
   FUN.info('Odsyłacze do kart technologicznych zleceń nie są obsługiwane.'@)

|? ref_tab(_link)=TKTL
|| _result.status:=0;
   FUN.info('Karta technologiczna lub wzorzec technologii o identyfikatorze %1 nie został odnaleziony.'@[_link])

|? ref_tab(_link)=TKTLW
|| _result.rule:='TTE_TEC';
   _result.area:='TTE_TEC'

|? ref_tab(_link)=PROJEKTY
|| _result.rule:='ZWS_PRJ';
   _result.area:='ZWS_PRJ'

|? ref_tab(_link)=UDT
|| _result.rule:='ZWS_UMO';
   _result.area:='ZWS_UMO'

|? ref_tab(_link)=TAP & exec('FindAndGet','#table',TAP,_link,,"TAR().SD",'')='S'
|| _result.rule:='LSP_CEN';
   _result.area:='LSP_CEN'

|? ref_tab(_link)=TAP & exec('FindAndGet','#table',TAP,_link,,"TAR().SD",'')='G'
|| _result.rule:='LSP_CEN';
   _result.area:='LSP_CEN'

|? ref_tab(_link)=TAP & exec('FindAndGet','#table',TAP,_link,,"TAR().SD",'')='D'
|| _result.rule:='LZK_DST';
   _result.area:='LZK_DST'

|? ref_tab(_link)=TAP
|| FUN.info('Rekord w tabeli TAP nie jest dostepny.'@);
   _result.status:=0

|? ref_tab(_link)=TAR & exec('FindAndGet','#table',TAR,_link,,"SD",'')='S'
|| _result.rule:='LSP_CEN';
   _result.area:='LSP_CEN'

|? ref_tab(_link)=TAR & exec('FindAndGet','#table',TAR,_link,,"SD",'')='G'
|| _result.rule:='LSP_CEN';
   _result.area:='LSP_CEN'

|? ref_tab(_link)=TAR & exec('FindAndGet','#table',TAR,_link,,"SD",'')='D'
|| _result.rule:='LZK_DST';
   _result.area:='LZK_DST'

|? ref_tab(_link)=TAR
|| FUN.info('Rekord w tabeli TAR nie jest dostepny.'@);
   _result.status:=0

|? ref_tab(_link)=EDOKUM & exec('FindAndGet','#table',EDOKUM,_link,,"TYPOBIEG().NAZWA",'')='Obieg wniosków'
|| _result.rule:='OBE_FAD';
   _result.area:='OBE_FAD'

|? ref_tab(_link)=EDOKUM
|| _result.rule:='OBG_FZO';
   _result.area:='OBG_FZO'

|? var_pres('MERITHUB',DOK)>0 & ref_tab(_link)=DOK & exec('FindAndGet','#table',DOK,_link,,"@.DOK.MERITHUB",'')<>''
|| _result.rule:='FKS_HUB';
   _result.area:='FKS_HUB'

|? ref_tab(_link)=DOK
|| _result.rule:='FKS_DKS';
   _result.area:='FKS_DKS'

|? ref_tab(_link)=JPK
|| _result.rule:='FKS_JPK';
   _result.area:='FKS_JPK'

|? ref_tab(_link)=VAT_DEK
|| _result.rule:='FKS_VED';
   _result.area:='FKS_VED'

|? ref_tab(_link)=SRST
|| _result.rule:='FST_EWI';
   _result.area:='FST_EWI'

|? ref_tab(_link)=VPOZ
|| _result.rule:='FKS_DKS';
   _result.area:='FKS_DKS'

|? ref_tab(_link)=POZ
|| _result.rule:='FKS_DKS';
   _result.area:='FKS_DKS'

|? ref_tab(_link)=OP
|| _result.rule:='FKS_ROZ';
   _result.area:='FKS_ROZ'

|? ref_tab(_link)=ZAP_OP
|| _result.rule:='FKS_ROZ';
   _result.area:='FKS_ROZ'

|? ref_tab(_link)=SM
|| _result.rule:='LMG_DSM';
   _result.area:='LMG_DSM'

|? ref_tab(_link)=OSOBA
|| _result.rule:='ZWS_DOS';
   _result.area:='ZWS_DOS'

|? ref_tab(_link)=OS_ADRES
|| _result.rule:='ZWS_DOS';
   _result.area:='ZWS_DOS'

|? ref_tab(_link)=RD
|| _result.rule:='ZWS_DOS';
   _result.area:='ZWS_DOS'

|? ref_tab(_link)=PKO
|| _result.rule:='ZWS_DOS';
   _result.area:='ZWS_DOS'

|? ref_tab(_link)=OS_US
|| _result.rule:='ZWS_DOS';
   _result.area:='ZWS_DOS'

|? ref_tab(_link)=P_INFO
|| _result.rule:='ZWS_DOS';
   _result.area:='ZWS_DOS'

|? ref_tab(_link)=STAZ
|| _result.rule:='ZWS_DOS';
   _result.area:='ZWS_DOS'

|? ref_tab(_link)=OS_SZKOL
|| _result.rule:='ZWS_DOS';
   _result.area:='ZWS_DOS'

|? ref_tab(_link)=N
|| _result.rule:='PKD_EZK';
   _result.area:='PKD_EZK'

|? ref_tab(_link)=BDO
|| _result.rule:='PKD_EZK';
   _result.area:='PKD_EZK'

|? ref_tab(_link)=H_UM
|| _result.rule:='PKD_EZK';
   _result.area:='PKD_EZK'

|? ref_tab(_link)=UPR_ZAWO
|| _result.rule:='ZWS_DOS';
   _result.area:='ZWS_DOS'

|? ref_tab(_link)=NWU
|| _result.rule:='PKD_EZK';
   _result.area:='PKD_EZK'

|? ref_tab(_link)=PPSFN
|| _result.rule:='PRC_HAR';
   _result.area:='PRC_HAR'

|? ref_tab(_link)=ZC
|| _result.rule:='PPL_ZLC';
   _result.area:='PPL_ZLC'

|? ref_tab(_link)=H_ODDE
|| _result.rule:='PKD_EZK';
   _result.area:='PKD_EZK'

|? ref_tab(_link)=DOKUMZ
||
   DOKUMZ.seek(32-_link);
   _dokum_uid:=DOKUMZ.DOK().uidref();
   DOKUM.seek(DOKUMZ.DOK);
   _nazwa:=DOKUMZ.NAZWA;
   {? DOKUM.DLA_KH
   ||
::      FUN.info(_nazwa);
      {? exec('cli_functions','#system')=0
      || FUN.emsg(exec('indevice_nacc_msg','#system'))
      || DOKUMZ.bl_get('DOKUM', pth_dir(_nazwa)+'\\'+ _nazwa);
         sys_exec(DOKUMZ.NAZWA, DOKUMZ.NAZWA,0)
      ?};
      _result.rule:='ZWS_KHR';
      _result.area:='ZWS_KHR';
      _result.link:=_dokum_uid
   ||
      _ref:=DOKUM.REFSQL;
      _tab:=ref_tab(_ref);
      {? exec('cli_functions','#system')=0
      || FUN.emsg(exec('indevice_nacc_msg','#system'))
      || DOKUMZ.bl_get('DOKUM', pth_dir(_nazwa)+'\\'+ _nazwa);
         sys_exec('!tmp'+DOKUMZ.NAZWA, DOKUMZ.NAZWA,0)
      ?};
      {? _tab=M
      ||
         M.seek(_ref);
         _result.rule:='ZWS_MAT';
         _result.area:='ZWS_MAT';
         _result.link:=M.uidref()
      ?}
   ?}
|? ref_tab(_link)=DOKUM
||
::ustalenie tabeli której dotyczy załącznik
::DOKUM.REFSQL<>'' (wskazanie na M) -> Materiały/Usługi ZWS_MAT
::DOKUM.DLA_KH=1, DOKUM.TYP='D', DOKUM.BL='T' -> Dokumenty Businesslink ZBL_DOK
::DOKUM.DLA_KH=1, DOKUM.TYP='D', DOKUM.BL='N' -> Kontrahenci ZWS_KHR
::DOKUM.DLA_KH=1, DOKUM.TYP='K' -> Kontrahenci ZWS_KHR
::W innych przypadkach link nie jest obsługiwany.
   {? DOKUM.seek(32-_link)
   ||
      _ref:=DOKUM.REFSQL;
      {? DOKUM.DLA_KH=1
      ||
         {? DOKUM.TYP='K' | DOKUM.BL='N'
         ||
            _result.status:=1;
            _result.rule:='ZWS_KHR';
            _result.area:='ZWS_KHR'
         |? DOKUM.BL='T' & DOKUM.TYP='D'
         ||
            _result.status:=1;
            _result.rule:='ZBL_DOK';
            _result.area:='ZBL_DOK'
         ?}
      |? _ref<>'' & ref_tab(_ref)=M
      ||
         _nazwa:='!tmp'+DOKUM.NAZWA;
         {? exec('cli_functions','#system')=0
         || FUN.emsg(exec('indevice_nacc_msg','#system'))
         || DOKUM.bl_get('DOKUM', pth_dir(_nazwa)+'\\'+ _nazwa);
            sys_exec('!tmp'+DOKUM.NAZWA, DOKUM.NAZWA,0)
         ?};
         M.seek(_ref);
         _result.rule:='ZWS_MAT';
         _result.area:='ZWS_MAT';
         _result.link:=M.uidref()
      ||
         _result.status:=0
      ?}
   ||
      _result.status:=0;
      FUN.info('Nie znaleziono rekordu: %1'@[32-_link])
   ?}

|? ref_tab(_link)=REK_N & exec('FindAndGet','#table',REK_N,_link,,"SZ",'')='S'
|| _result.rule:='TRE_REK';
   _result.area:='TRE_REK'

|? ref_tab(_link)=REK_N & exec('FindAndGet','#table',REK_N,_link,,"SZ",'')='Z'
|| _result.rule:='TRE_RDO';
   _result.area:='TRE_RDO'

|? ref_tab(_link)=BI_TODO
|| _result.rule:='BI_TODO';
   _result.area:=''

|? ref_tab(_link)=ZGH
|| _result.rule:='TTE_PRZ';
   _result.area:='TTE_PRZ'

|? ref_tab(_link)=USERS
|| _result.rule:='ZWS_USR';
   _result.area:='ZWS_USR'

|? ref_tab(_link)=USERSF
|| _result.rule:='ZWS_USR';
   _result.area:='ZWS_USR'

|? ref_tab(_link)=TR_NAG
|| _result.rule:='LTR_MOB';
   _result.area:='LTR_MOB'

|| _result.status:=0;
   FUN.info('Odsyłacze do tabeli %1 nie są obsługiwane.'@[ref_name(_link)])
?};
_result


\definicje
::----------------------------------------------------------------------------------------------------------------------
::  UTW: PJ [19.22]
:: OPIS: Definicje dla tabel, które mają obsługiwać tworzenie linków
::----------------------------------------------------------------------------------------------------------------------
exec('czytaj','#stalesys',,XINFO,'LINK_SRV','LINK_PRT','LINK_INT');
_address_jterm:='';
_address_interm:='';
{? XINFO.LINK_SRV<>'' & XINFO.LINK_PRT<>0
|| _address_jterm:='mbase://%1:%2'[XINFO.LINK_SRV,$XINFO.LINK_PRT]
?};
{? XINFO.LINK_INT<>''
|| {? exec('valid_link_int','zws',XINFO.LINK_INT)=0
   || FUN.emsg('Nieprawidłowy zewnętrzny adres serwera (html): \'%1\'. Kopiowanie odsyłaczy do rekordu (html) niedostępne.'@[XINFO.LINK_INT])
   || _address_interm:=XINFO.LINK_INT
   ?}
?};

SRST.win_link('WER',"
   _a:=obj_new('LINK','text');
   _a.LINK:=SRST.uidref();
   _a.text:='Odsyłacz do środka trwałego: '+SRST.NRI;
   _a
",_address_interm,_address_jterm);
SRST.win_link('WER_E',"
   _a:=obj_new('LINK','text');
   _a.LINK:=SRST.uidref();
   _a.text:='Odsyłacz do środka trwałego: '+SRST.NRI;
   _a
",_address_interm,_address_jterm);
SRST.win_link('DWER_O',"
   _a:=obj_new('LINK','text');
   _a.LINK:=SRST.uidref();
   _a.text:='Odsyłacz do środka trwałego: '+SRST.NRI;
   _a
",_address_interm,_address_jterm);
SRST.win_link('DWER',"
   _a:=obj_new('LINK','text');
   _a.LINK:=SRST.uidref();
   _a.text:='Odsyłacz do środka trwałego: '+SRST.NRI;
   _a
",_address_interm,_address_jterm);
SRDO.win_link('WER',"
   _a:=obj_new('LINK','text');
   _a.LINK:=SRDO.uidref();
   _a.text:='Odsyłacz do dokumentu środka trwałego: '+SRDO.SYMBOL;
   _a
",_address_interm,_address_jterm);
FAKS.win_link('WER1',"
   _a:=obj_new('LINK');
   _a.LINK:=FAKS.uidref();
   _a
",_address_interm,_address_jterm);
FAKS.win_link('WER2',"
   _a:=obj_new('LINK');
   _a.LINK:=FAKS.uidref();
   _a
",_address_interm,_address_jterm);
FAKS.win_link('WERS',"
   _a:=obj_new('LINK');
   _a.LINK:=FAKS.uidref();
   _a
",_address_interm,_address_jterm);
FAKS.win_link('WERZ',"
   _a:=obj_new('LINK');
   _a.LINK:=FAKS.uidref();
   _a
",_address_interm,_address_jterm);
FAP.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=FAP.uidref();
   _a
",_address_interm,_address_jterm);
FAP.win_link('WER_DOK',"
   _a:=obj_new('LINK');
   _a.LINK:=FAP.uidref();
   _a
",_address_interm,_address_jterm);
FAP.win_link('WER_I',"
   _a:=obj_new('LINK');
   _a.LINK:=FAP.uidref();
   _a
",_address_interm,_address_jterm);
FAP.win_link('WER_IDOK',"
   _a:=obj_new('LINK');
   _a.LINK:=FAP.uidref();
   _a
",_address_interm,_address_jterm);
FAP.win_link('WERK',"
   _a:=obj_new('LINK');
   _a.LINK:=FAP.uidref();
   _a
",_address_interm,_address_jterm);
FAP.win_link('WERK_DOK',"
   _a:=obj_new('LINK');
   _a.LINK:=FAP.uidref();
   _a
",_address_interm,_address_jterm);
FAP.win_link('WERKZ',"
   _a:=obj_new('LINK');
   _a.LINK:=FAP.uidref();
   _a
",_address_interm,_address_jterm);
FAP.win_link('WERKZB',"
   _a:=obj_new('LINK');
   _a.LINK:=FAP.uidref();
   _a
",_address_interm,_address_jterm);
FAP.win_link('WERKZDOK',"
   _a:=obj_new('LINK');
   _a.LINK:=FAP.uidref();
   _a
",_address_interm,_address_jterm);
FAP.win_link('TALLS',"
   _a:=obj_new('LINK');
   _a.LINK:=FAP.uidref();
   _a
",_address_interm,_address_jterm);
FAP.win_link('ALLZ',"
   _a:=obj_new('LINK');
   _a.LINK:=FAP.uidref();
   _a
",_address_interm,_address_jterm);
FAKZ.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=FAKZ.uidref();
   _a
",_address_interm,_address_jterm);
FAKZ.win_link('TWER',"
   _a:=obj_new('LINK');
   _a.LINK:=FAKZ.uidref();
   _a
",_address_interm,_address_jterm);
ZL.win_link('PWER_P',"
   _a:=obj_new('LINK');
   _a.LINK:=ZL.uidref();
   _a
",_address_interm,_address_jterm);
ZL.win_link('PWER_W',"
   _a:=obj_new('LINK');
   _a.LINK:=ZL.uidref();
   _a
",_address_interm,_address_jterm);
ZL.win_link('STRUCT',"
   _a:=obj_new('LINK');
   _a.LINK:=ZL.uidref();
   _a
",_address_interm,_address_jterm);
REM_ZAS.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=REM_ZAS.uidref();
   _a
",_address_interm,_address_jterm);
REM_ZAS.win_link('WER_SLO',"
   _a:=obj_new('LINK');
   _a.LINK:=REM_ZAS.uidref();
   _a
",_address_interm,_address_jterm);
REM_ZAS.win_link('WERT',"
   _a:=obj_new('LINK');
   _a.LINK:=REM_ZAS.uidref();
   _a
",_address_interm,_address_jterm);
REM_ZGL.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=REM_ZGL.uidref();
   _a
",_address_interm,_address_jterm);
REM_ZGL.win_link('WERC',"
   _a:=obj_new('LINK');
   _a.LINK:=REM_ZGL.uidref();
   _a
",_address_interm,_address_jterm);
REM_ZGL.win_link('WERP',"
   _a:=obj_new('LINK');
   _a.LINK:=REM_ZGL.uidref();
   _a
",_address_interm,_address_jterm);
M.win_link('NL_WER',"
   _a:=obj_new('LINK');
   _a.LINK:=M.uidref();
   _a
",_address_interm,_address_jterm);
M.win_link('NL_WERU',"
   _a:=obj_new('LINK');
   _a.LINK:=M.uidref();
   _a
",_address_interm,_address_jterm);
KH.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=KH.uidref();
   _a
",_address_interm,_address_jterm);
KH.win_link('WER_ALL',"
   _a:=obj_new('LINK');
   _a.LINK:=KH.uidref();
   _a
",_address_interm,_address_jterm);
KH_ODB.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=KH_ODB.uidref();
   _a
",_address_interm,_address_jterm);
KH_OSOB.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=KH_OSOB.uidref();
   _a
",_address_interm,_address_jterm);
KH_OSOB.win_link('WER1',"
   _a:=obj_new('LINK');
   _a.LINK:=KH_OSOB.uidref();
   _a
",_address_interm,_address_jterm);
KH_OSOB.win_link('WER2',"
   _a:=obj_new('LINK');
   _a.LINK:=KH_OSOB.uidref();
   _a
",_address_interm,_address_jterm);
KH_DOD.win_link('WER',"
   _a:=obj_new('LINK');
   KH.cntx_psh();
   _a.LINK:=KH_DOD.KH().uidref();
   KH.cntx_pop();
   _a
",_address_interm,_address_jterm);
ND.win_link('WER1',"
   _a:=obj_new('LINK');
   _a.LINK:=ND.uidref();
   _a
",_address_interm,_address_jterm);
ND.win_link('WER1_ALL',"
   _a:=obj_new('LINK');
   _a.LINK:=ND.uidref();
   _a
",_address_interm,_address_jterm);
ND.win_link('WERP',"
   _a:=obj_new('LINK');
   _a.LINK:=ND.uidref();
   _a
",_address_interm,_address_jterm);
DK.win_link('ALL',"
   _a:=obj_new('LINK');
   _a.LINK:=DK.uidref();
   _a
",_address_interm,_address_jterm);
DK.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=DK.uidref();
   _a
",_address_interm,_address_jterm);
DK.win_link('WER_DOK',"
   _a:=obj_new('LINK');
   _a.LINK:=DK.uidref();
   _a
",_address_interm,_address_jterm);
DK.win_link('WER_KOO',"
   _a:=obj_new('LINK');
   _a.LINK:=DK.uidref();
   _a
",_address_interm,_address_jterm);
DK.win_link('WER_POZ',"
   _a:=obj_new('LINK');
   _a.LINK:=DK.uidref();
   _a
",_address_interm,_address_jterm);
DK.win_link('WER_REA',"
   _a:=obj_new('LINK');
   _a.LINK:=DK.uidref();
   _a
",_address_interm,_address_jterm);
DK.win_link('WERSC',"
   _a:=obj_new('LINK');
   _a.LINK:=DK.uidref();
   _a
",_address_interm,_address_jterm);
DK.win_link('WERU',"
   _a:=obj_new('LINK');
   _a.LINK:=DK.uidref();
   _a
",_address_interm,_address_jterm);
DK.win_link('WES',"
   _a:=obj_new('LINK');
   _a.LINK:=DK.uidref();
   _a
",_address_interm,_address_jterm);
DK.win_link('WESU',"
   _a:=obj_new('LINK');
   _a.LINK:=DK.uidref();
   _a
",_address_interm,_address_jterm);
DK.win_link('WER_SMM',"
   _a:=obj_new('LINK');
   _a.LINK:=DK.uidref();
   _a
",_address_interm,_address_jterm);
ZLP.win_link('WER_ZGL',"
   _a:=obj_new('LINK');
   _a.LINK:=ZLP.uidref();
   _a
",_address_interm,_address_jterm);
ZLP.win_link('UZUP',"
   _a:=obj_new('LINK');
   _a.LINK:=ZLP.uidref();
   _a
",_address_interm,_address_jterm);
ZLP.win_link('UZUPD',"
   _a:=obj_new('LINK');
   _a.LINK:=ZLP.uidref();
   _a
",_address_interm,_address_jterm);
UM.win_link('WER_I',"
   _a:=obj_new('LINK');
   _a.LINK:=UM.uidref();
   _a
",_address_interm,_address_jterm);
UM.win_link('WER_KH',"
   _a:=obj_new('LINK');
   _a.LINK:=UM.uidref();
   _a
",_address_interm,_address_jterm);
UM.win_link('WER_KHP',"
   _a:=obj_new('LINK');
   _a.LINK:=UM.uidref();
   _a
",_address_interm,_address_jterm);
UP.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=UP.uidref();
   _a
",_address_interm,_address_jterm);
UP.win_link('WER3',"
   _a:=obj_new('LINK');
   _a.LINK:=UP.uidref();
   _a
",_address_interm,_address_jterm);
OFE.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=OFE.uidref();
   _a
",_address_interm,_address_jterm);
OFE.win_link('WER1',"
   _a:=obj_new('LINK');
   _a.LINK:=OFE.uidref();
   _a
",_address_interm,_address_jterm);
OFP.win_link('WER_DOK',"
   _a:=obj_new('LINK');
   _a.LINK:=OFP.uidref();
   _a
",_address_interm,_address_jterm);
OFP.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=OFP.uidref();
   _a
",_address_interm,_address_jterm);
ZK_N.win_link('WER1',"
   _a:=obj_new('LINK');
   _a.LINK:=ZK_N.uidref();
   _a
",_address_interm,_address_jterm);
ZK_N.win_link('WERW',"
   _a:=obj_new('LINK');
   _a.LINK:=ZK_N.uidref();
   _a
",_address_interm,_address_jterm);
ZK_N.win_link('WERZ',"
   _a:=obj_new('LINK');
   _a.LINK:=ZK_N.uidref();
   _a
",_address_interm,_address_jterm);
ZK_P.win_link('ALLW',"
   _a:=obj_new('LINK');
   _a.LINK:=ZK_P.uidref();
   _a
",_address_interm,_address_jterm);
ZK_P.win_link('ALLZ',"
   _a:=obj_new('LINK');
   _a.LINK:=ZK_P.uidref();
   _a
",_address_interm,_address_jterm);
ZK_P.win_link('DZAM',"
   _a:=obj_new('LINK');
   _a.LINK:=ZK_P.uidref();
   _a
",_address_interm,_address_jterm);
ZK_P.win_link('ZAMW',"
   _a:=obj_new('LINK');
   _a.LINK:=ZK_P.uidref();
   _a
",_address_interm,_address_jterm);
ZK_P.win_link('ZAMW_DOK',"
   _a:=obj_new('LINK');
   _a.LINK:=ZK_P.uidref();
   _a
",_address_interm,_address_jterm);
ZK_P.win_link('ZAMZ',"
   _a:=obj_new('LINK');
   _a.LINK:=ZK_P.uidref();
   _a
",_address_interm,_address_jterm);
ZK_P.win_link('ZAMZ_DOK',"
   _a:=obj_new('LINK');
   _a.LINK:=ZK_P.uidref();
   _a
",_address_interm,_address_jterm);
ZD_NAG.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=ZD_NAG.uidref();
   _a
",_address_interm,_address_jterm);
ZD_NAG.win_link('WER1',"
   _a:=obj_new('LINK');
   _a.LINK:=ZD_NAG.uidref();
   _a
",_address_interm,_address_jterm);
ZD_POZ.win_link('ALL',"
   _a:=obj_new('LINK');
   _a.LINK:=ZD_POZ.uidref();
   _a
",_address_interm,_address_jterm);
ZD_POZ.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=ZD_POZ.uidref();
   _a
",_address_interm,_address_jterm);
TKTL.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=TKTL.uidref();
   _a
",_address_interm,_address_jterm);
TKTL.win_link('WER_',"
   _a:=obj_new('LINK');
   _a.LINK:=TKTL.uidref();
   _a
",_address_interm,_address_jterm);
TKTLW.win_link('WER_K',"
   _a:=obj_new('LINK');
   _a.LINK:=TKTLW.uidref();
   _a
",_address_interm,_address_jterm);
TKTLW.win_link('WER_M',"
   _a:=obj_new('LINK');
   _a.LINK:=TKTLW.uidref();
   _a
",_address_interm,_address_jterm);
PROJEKTY.win_link('WER_E',"
   _a:=obj_new('LINK');
   _a.LINK:=PROJEKTY.uidref();
   _a
",_address_interm,_address_jterm);
PROJEKTY.win_link('WER_PE',"
   _a:=obj_new('LINK');
   _a.LINK:=PROJEKTY.uidref();
   _a
",_address_interm,_address_jterm);
UDT.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=UDT.uidref();
   _a
");
UDT.win_link('WER_SLO',"
   _a:=obj_new('LINK');
   _a.LINK:=UDT.uidref();
   _a
");
TAP.win_link('WER_G',"
   _a:=obj_new('LINK');
   _a.LINK:=TAP.uidref();
   _a
",_address_interm,_address_jterm);
TAP.win_link('WER_KD',"
   _a:=obj_new('LINK');
   _a.LINK:=TAP.uidref();
   _a
",_address_interm,_address_jterm);
TAP.win_link('WER_KH',"
   _a:=obj_new('LINK');
   _a.LINK:=TAP.uidref();
   _a
",_address_interm,_address_jterm);
TAP.win_link('WERMKH',"
   _a:=obj_new('LINK');
   _a.LINK:=TAP.uidref();
   _a
",_address_interm,_address_jterm);
EDOKUM.win_link('FWPR',"
   _a:=obj_new('LINK','text');
   _a.LINK:=EDOKUM.uidref();
   _a.text:='Odsyłacz do faktury w obiegu: '+EDOKUM.SYM;
   _a
",_address_interm,_address_jterm);
EDOKUM.win_link('FAKC',"
   _a:=obj_new('LINK','text');
   _a.LINK:=EDOKUM.uidref();
   _a.text:='Odsyłacz do faktury w obiegu: '+EDOKUM.SYM;
   _a
",_address_interm,_address_jterm);
EDOKUM.win_link('FDEK',"
   _a:=obj_new('LINK','text');
   _a.LINK:=EDOKUM.uidref();
   _a.text:='Odsyłacz do faktury w obiegu: '+EDOKUM.SYM;
   _a
",_address_interm,_address_jterm);
EDOKUM.win_link('FPRZ',"
   _a:=obj_new('LINK','text');
   _a.LINK:=EDOKUM.uidref();
   _a.text:='Odsyłacz do faktury w obiegu: '+EDOKUM.SYM;
   _a
",_address_interm,_address_jterm);
DOK.win_link('C_REN',"
   _a:=obj_new('LINK','text');
   _a.LINK:=DOK.uidref();
   _a.text:='Odsyłacz do dokumentu księgowego: '+DOK.NK;
   _a
",_address_interm,_address_jterm);
DOK.win_link('C_REN2',"
   _a:=obj_new('LINK','text');
   _a.LINK:=DOK.uidref();
   _a.text:='Odsyłacz do dokumentu księgowego: '+DOK.NK;
   _a
",_address_interm,_address_jterm);
DOK.win_link('C_REN1',"
   _a:=obj_new('LINK','text');
   _a.LINK:=DOK.uidref();
   _a.text:='Odsyłacz do dokumentu księgowego: '+DOK.NK;
   _a
",_address_interm,_address_jterm);
DOK.win_link('C_REN4',"
   _a:=obj_new('LINK','text');
   _a.LINK:=DOK.uidref();
   _a.text:='Odsyłacz do dokumentu księgowego: '+DOK.NK;
   _a
",_address_interm,_address_jterm);
DOK.win_link('C_REN5',"
   _a:=obj_new('LINK','text');
   _a.LINK:=DOK.uidref();
   _a.text:='Odsyłacz do dokumentu księgowego: '+DOK.NK;
   _a
",_address_interm,_address_jterm);
DOK.win_link('C_REN3',"
   _a:=obj_new('LINK','text');
   _a.LINK:=DOK.uidref();
   _a.text:='Odsyłacz do dokumentu księgowego: '+DOK.NK;
   _a
",_address_interm,_address_jterm);
VPOZ.win_link('SEL',"
   _a:=obj_new('LINK','text');
   _a.LINK:=VPOZ.uidref();
   _a.text:='Odsyłacz do pozycji VAT dokumentu księgowego: '+VPOZ.DOK().NK;
   _a
",_address_interm,_address_jterm);
VPOZ.win_link('Z_SEL',"
   _a:=obj_new('LINK','text');
   _a.LINK:=VPOZ.uidref();
   _a.text:='Odsyłacz do pozycji VAT dokumentu księgowego: '+VPOZ.DOK().NK;
   _a
",_address_interm,_address_jterm);
POZ.win_link('VSEL',"
   _a:=obj_new('LINK','text');
   _a.LINK:=POZ.uidref();
   _a.text:='Odsyłacz do pozycji dokumentu księgowego: '+POZ.DOK().NK;
   _a
",_address_interm,_address_jterm);
POZ.win_link('SEL',"
   _a:=obj_new('LINK','text');
   _a.LINK:=POZ.uidref();
   _a.text:='Odsyłacz do pozycji dokumentu księgowego: '+POZ.DOK().NK;
   _a
",_address_interm,_address_jterm);
OP.win_link('WER2',"
   _a:=obj_new('LINK','text');
   _a.LINK:=OP.uidref();
   _a.text:='Odsyłacz do rozrachunku: '+OP.SYM;
   _a
",_address_interm,_address_jterm);
ZAP_OP.win_link('ROZL1',"
   _a:=obj_new('LINK','text');
   _a.LINK:=ZAP_OP.uidref();
   _a.text:='Odsyłacz do pozycji rozrachunku: '+ZAP_OP.OP().SYM;
   _a
",_address_interm,_address_jterm);
SM.win_link('STANY_MG',"
   _a:=obj_new('LINK');
   _a.LINK:=SM.uidref();
   _a
",_address_interm,_address_jterm);
SM.win_link('STANY_ML',"
   _a:=obj_new('LINK');
   _a.LINK:=SM.uidref();
   _a
",_address_interm,_address_jterm);
OSOBA.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=OSOBA.uidref();
   _a
",_address_interm,_address_jterm);
OS_ADRES.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=OS_ADRES.uidref();
   _a
",_address_interm,_address_jterm);
RD.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=RD.uidref();
   _a
",_address_interm,_address_jterm);
PKO.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=PKO.uidref();
   _a
",_address_interm,_address_jterm);
OS_US.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=OS_US.uidref();
   _a
",_address_interm,_address_jterm);
P_INFO.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=P_INFO.uidref();
   _a
",_address_interm,_address_jterm);
STAZ.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=STAZ.uidref();
   _a
",_address_interm,_address_jterm);
OS_SZKOL.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=OS_SZKOL.uidref();
   _a
",_address_interm,_address_jterm);
N.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=N.uidref();
   _a
",_address_interm,_address_jterm);
BDO.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=BDO.uidref();
   _a
",_address_interm,_address_jterm);
H_UM.win_link({? PAR_SKID.get(180)='T' || 'WER_PD' || 'WER_PR' ?},"
   _a:=obj_new('LINK');
   _a.LINK:=H_UM.uidref();
   _a
",_address_interm,_address_jterm);
UPR_ZAWO.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=UPR_ZAWO.uidref();
   _a
",_address_interm,_address_jterm);
NWU.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=NWU.uidref();
   _a
",_address_interm,_address_jterm);
PPSFN.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=PPSFN.uidref();
   _a
",_address_interm,_address_jterm);
ZC.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=ZC.uidref();
   _a
",_address_interm,_address_jterm);
H_ODDE.win_link('WER',"
   _a:=obj_new('LINK');
   _a.LINK:=H_ODDE.uidref();
   _a
",_address_interm,_address_jterm);
DOKUM.win_link('WERK1',"
   _a:=obj_new('LINK','text');
   _a.LINK:=DOKUM.uidref();
   _a.text:='Odsyłacz do kontaktu: '+DOKUM.SYM;
   _a
",_address_interm,_address_jterm);
DOKUM.win_link('WERK2',"
   _a:=obj_new('LINK','text');
   _a.LINK:=DOKUM.uidref();
   _a.text:='Odsyłacz do kontaktu: '+DOKUM.SYM;
   _a
",_address_interm,_address_jterm);
DOKUM.win_link('WERK3',"
   _a:=obj_new('LINK','text');
   _a.LINK:=DOKUM.uidref();
   _a.text:='Odsyłacz do kontaktu: '+DOKUM.SYM;
   _a
",_address_interm,_address_jterm);
DOKUM.win_link('WERK4',"
   _a:=obj_new('LINK','text');
   _a.LINK:=DOKUM.uidref();
   _a.text:='Odsyłacz do kontaktu: '+DOKUM.SYM;
   _a
",_address_interm,_address_jterm);
REK_N.win_link('WERS',"
   _a:=obj_new('LINK','text');
   _a.LINK:=REK_N.uidref();
   _a.text:='Odsyłacz do reklamacji: '+REK_N.SYM;
   _a
",_address_interm,_address_jterm);
REK_N.win_link('WERZ',"
   _a:=obj_new('LINK','text');
   _a.LINK:=REK_N.uidref();
   _a.text:='Odsyłacz do reklamacji: '+REK_N.SYM;
   _a
",_address_interm,_address_jterm);
REK_N.win_link('SELS',"
   _a:=obj_new('LINK','text');
   _a.LINK:=REK_N.uidref();
   _a.text:='Odsyłacz do reklamacji: '+REK_N.SYM;
   _a
",_address_interm,_address_jterm);
REK_N.win_link('SELZ',"
   _a:=obj_new('LINK','text');
   _a.LINK:=REK_N.uidref();
   _a.text:='Odsyłacz do reklamacji: '+REK_N.SYM;
   _a
",_address_interm,_address_jterm);
BI_TODO.win_link('WER',"
   _a:=obj_new('LINK','text');
   _a.LINK:=BI_TODO.uidref();
   _desc:={? exec('lang','#bi_todo') || BI_TODO.DESC || BI_TODO.BI_PREL().DESC ?};
   _a.text:='Odsyłacz do lsity zadań: '+_desc;
   _a
");
ZGH.win_link('WERP',"
   _a:=obj_new('LINK');
   _a.LINK:=ZGH.uidref();
   _a
",_address_interm,_address_jterm);
ZGH.win_link('WERW',"
   _a:=obj_new('LINK');
   _a.LINK:=ZGH.uidref();
   _a
",_address_interm,_address_jterm);
ZGH.win_link('WERZP',"
   _a:=obj_new('LINK');
   _a.LINK:=ZGH.uidref();
   _a
",_address_interm,_address_jterm);
ZGH.win_link('WERZW',"
   _a:=obj_new('LINK');
   _a.LINK:=ZGH.uidref();
   _a
",_address_interm,_address_jterm);
ZGH.win_link('WER_ALL',"
   _a:=obj_new('LINK');
   _a.LINK:=ZGH.uidref();
   _a
",_address_interm,_address_jterm);
USERS.win_link('CALL',"
   _a:=obj_new('LINK');
   _a.LINK:=USERS.uidref();
   _a
",_address_interm,_address_jterm);
TR_NAG.win_link('REAL',"
   _a:=obj_new('LINK');
   _a.LINK:=TR_NAG.uidref();
   _a
",_address_interm,_address_jterm);
~~

:Sign Version 2.0 jowisz:1045 2023/12/21 13:22:35 759ce72c3734f97bc8c50121bce4b9be0ab21c48901cda44aa3af2e03be981a9117d9331368499455829184a75446bc13008d291f92597161da1c24222f7468a2ad6923743da14d97333d46c505968ec124ba9b463deef1d475be1b730034c540f789e79ae5474abd957df165392741eb10edccd867d38c8ae98dcffa747e5fd
