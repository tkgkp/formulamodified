:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: prc_actions.fml
:: Utworzony: 14.12.2017
:: Autor: TMR
::======================================================================================================================
:: Zawartość: Formuły do obsługi akcji wywoływanych z planowania i grafików.
::======================================================================================================================

\tab
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.42]
:: OPIS: Formuła zwraca tabelę z identyfikatorami formuł wykorzystywanymi jako akcje w planowaniu lub grafikach
::   WE:
::   WY:
::  OLD: \actions/prc_dane.fml
::----------------------------------------------------------------------------------------------------------------------
_tab:=tab_tmp(,
   'NAME'   ,'STRING[50]',,
   'FML_ID' ,'STRING[31]',
);
_sSource:=exec('source4ses_get','prc_ws');

:: - - RUN - -

:: formuła do wstępnego uruchamiania kontrolki planowania
_tab.NAME:='run';
_fml:=''+"exec('after_refresh','prc_dane')";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: - - USTAWIENIA - -
:: formuła do podtrzymania sesji
_tab.NAME:='online';
_fml:=''+"'online';1";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania wybranego okresu rozliczeniowego
_tab.NAME:='zapisz_okres';
_fml:=''+"exec('okres_set','prc_ws',_a.myParam);
          exec('wszystkie_dane','prc_dane')";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania stanu checkboxa "Pracownicy z okresu"
_tab.NAME:='zapisz_prac_z_okresu';
_fml:=''+"exec('prac_z_okresu_set','prc_ws',_a.myParam);
          exec('wszystkie_dane','prc_dane')";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania stanu checkboxa "Pracownicy z błędami"
_tab.NAME:='zapisz_prac_z_bledami';
_fml:=''+"exec('prac_z_bledami_set','prc_ws',_a.myParam);
          _ctrl_id:=exec('ctrl_id','prc_dane');
          web_ctrl_call(_ctrl_id,,'showPracWithError')";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania sposobu prezentacji godzin w kafelku
_tab.NAME:='zapisz_prezentacja_godzin';
_fml:=''+"exec('prezentacja_godzin_set','prc_ws',_a.myParam)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania stanu checkboxa dot. prezentacji ruchomego czasu pracy
_tab.NAME:='zapisz_prezentacja_rczp';
_fml:=''+"exec('prezentacja_rczp_set','prc_ws',_a.myParam)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania stanu checkboxa dot. prezentacji symbolu dla zmian w pracy
_tab.NAME:='zapisz_prezentacja_sz';
_fml:=''+"exec('prezentacja_sz_set','prc_ws',_a.myParam)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania stanu checkboxa dot. prezentacji koloru dla zmian w pracy
_tab.NAME:='zapisz_prezentacja_kz';
_fml:=''+"exec('prezentacja_kz_set','prc_ws',_a.myParam)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania stanu checkboxa dot. prezentacji podziałów w widoku
_tab.NAME:='zapisz_prezentacja_podzialy';
_fml:=''+"exec('prezentacja_podzialy_set','prc_ws',_a.myParam)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania sposobu prezentacji widoku norm (okres/miesiąc)
_tab.NAME:='zapisz_prezentacja_normy';
_fml:=''+"exec('prezentacja_normy_set','prc_ws',_a.myParam)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania sposobu prezentacji widoku zakładek (tydzień/miesiąc)
_tab.NAME:='zapisz_prezentacja_widoku';
_fml:=''+"exec('prezentacja_widoku_set','prc_ws',_a.myParam)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania wybranej lokalizacji
_tab.NAME:='zapisz_lokalizacje';
_fml:=''+"exec('lokalizacja_set','prc_ws',_a.myParam);
          _ctrl_id:=exec('ctrl_id','prc_dane');
          web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania wybranego kontekstu pracy (plob - obiekt do planowania)
_tab.NAME:='zapisz_plob';
_fml:=''+"exec('plob_set','prc_ws',_a.myParam);
          _ctrl_id:=exec('ctrl_id','prc_dane');
          web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

{? _sSource='G'
||
:: formuła do zapisywania stanu checkboxa "Plan"
   _tab.NAME:='zapisz_warstwa_plan';
   _fml:=''+"exec('warstwa_set','prc_ws','plan',_a.myParam)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do zapisywania stanu checkboxa "Grafik"
   _tab.NAME:='zapisz_warstwa_grafik';
   _fml:=''+"exec('warstwa_set','prc_ws','grafik',_a.myParam)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do zapisywania stanu checkboxa "Wykonanie"
   _tab.NAME:='zapisz_warstwa_wykonanie';
   _fml:=''+"exec('warstwa_set','prc_ws','wykonanie',_a.myParam)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do zapisywania nieobecności ad-hoc
   _tab.NAME:='zapisz_grafiki_ah';
   _fml:=''+"exec('grafiki_ah_set','prc_ws',_a.myParam)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do zapisywania sposobu weryfikacji
   _tab.NAME:='zapisz_grafiki_weryfikacja';
   _fml:=''+"exec('grafiki_weryfikacja_set','prc_ws',_a.myParam)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add()
?};

:: formuła do zapisywania stanu checkboxa dot. wyświetlania komunikatów typu MESSAGE
_tab.NAME:='zapisz_komm_msg';
_fml:=''+"exec('komm_msg_set','prc_ws',_a.myParam)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania sposobu prezentacji zakresu dat w operacjach grupowych
_tab.NAME:='zapisz_zakres_dat';
_fml:=''+"exec('zakres_dat_set','prc_ws',_a.myParam)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: - - ZAPISYWANIE - -

:: formuła do zapisywania zmodyfikowanych dni
_tab.NAME:='zapisz_paczke';
_fml:=''+"_sPrac:=exec('zapisz_paczke','prc_dane',_a.myParam);
         _ctrl_id:=exec('ctrl_id','prc_dane');
         web_ctrl_call(_ctrl_id,,'callback',_a.myCallback,_sPrac)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania błędów planowania
_tab.NAME:='zapisz_paczke_ver';
_fml:=''+"_sStatus:=exec('zapisz_paczke_ver','prc_dane',_a.myParam);
         _ctrl_id:=exec('ctrl_id','prc_dane');
         web_ctrl_call(_ctrl_id,,'callback',_a.myCallback,_sStatus)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania oddelegowań
_tab.NAME:='zapisz_paczke_oddel';
_fml:=''+"_sPrac:=exec('zapisz_paczke_oddel','prc_dane',_a.myParam);
          _ctrl_id:=exec('ctrl_id','prc_dane');
          web_ctrl_call(_ctrl_id,,'callback',_a.myCallback,_sPrac)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zapisywania podziałów
_tab.NAME:='zapisz_paczke_podzialy';
_fml:=''+"_sPrac:=exec('zapisz_paczke_podzialy','prc_dane',_a.myParam);
         _ctrl_id:=exec('ctrl_id','prc_dane');
         web_ctrl_call(_ctrl_id,,'callback',_a.myCallback,_sPrac)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do kasowania planu
_tab.NAME:='del_kal_buff';
_fml:=''+"_sStatus:=exec('del_kal_buff','prc_dane',_a.myParam);
          _ctrl_id:=exec('ctrl_id','prc_dane');
          web_ctrl_call(_ctrl_id,,'callback',_a.myCallback,_sStatus)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do kasowania wykonania
_tab.NAME:='usun_paczke_wewy';
_fml:=''+"_sPrac:=exec('usun_paczke_wewy','prc_dane',_a.myParam);
          _ctrl_id:=exec('ctrl_id','prc_dane');
          web_ctrl_call(_ctrl_id,,'callback',_a.myCallback,_sPrac)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do zakończenia planowania pracownika w okresie
_tab.NAME:='zakoncz_planowanie';
_fml:=''+"_sStatus:=exec('zakoncz_planowanie','prc_dane',_a.myParam);
          _ctrl_id:=exec('ctrl_id','prc_dane');
          web_ctrl_call(_ctrl_id,,'callback',_a.myCallback,_sStatus)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do otwierania planowania pracownika w okresie
_tab.NAME:='ponow_planowanie';
_fml:=''+"_sStatus:=exec('ponow_planowanie','prc_dane',_a.myParam);
          _ctrl_id:=exec('ctrl_id','prc_dane');
          web_ctrl_call(_ctrl_id,,'callback',_a.myCallback,_sStatus)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do otwierania planowania pracownika w okresie
_tab.NAME:='otworz_korekte';
_fml:=''+"_sStatus:=exec('otworz_korekte','prc_dane',_a.myParam);
          _ctrl_id:=exec('ctrl_id','prc_dane');
          web_ctrl_call(_ctrl_id,,'callback',_a.myCallback,_sStatus)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

{? _sSource='G'
||
:: formuła do zapisywania nieobecności ad-hoc
   _tab.NAME:='zapisz_paczke_ah';
   _fml:=''+"_sPrac:=exec('zapisz_paczke_ah','prc_dane',_a.myParam);
             _ctrl_id:=exec('ctrl_id','prc_dane');
             web_ctrl_call(_ctrl_id,,'callback',_a.myCallback,_sPrac)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do zapisywania danych do wewy
   _tab.NAME:='zapisz_paczke_wewy';
   _fml:=''+"_sPrac:=exec('zapisz_paczke_wewy','prc_dane',_a.myParam);
            _ctrl_id:=exec('ctrl_id','prc_dane');
            web_ctrl_call(_ctrl_id,,'callback',_a.myCallback,_sPrac)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do dodawania wniosku o odbiór
   _tab.NAME:='wodb_add';
   _fml:=''+"_tab:=exec('wodb_add','prc_dane',_a.myParam);
            _ctrl_id:=exec('ctrl_id','prc_dane');
            web_ctrl_set_table(_ctrl_id,,'tabWniosekOdbioru',_tab);
            web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do usuwania wniosku o odbiór
   _tab.NAME:='wodb_del';
   _fml:=''+"_tab:=exec('wodb_del','prc_dane',_a.myParam);
            _ctrl_id:=exec('ctrl_id','prc_dane');
            web_ctrl_set_table(_ctrl_id,,'tabWniosekOdbioru',_tab);
            web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do pobierania wniosku o odbiór
   _tab.NAME:='wodb_get';
   _fml:=''+"exec('wodb_get','prc_actions',_a)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do dodawania wniosku o odbiór
   _tab.NAME:='wodb_in_day';
   _fml:=''+"_tab:=exec('wodb_in_day','prc_dane',_a.myParam);
            _ctrl_id:=exec('ctrl_id','prc_dane');
            web_ctrl_set_table(_ctrl_id,,'tabWnioskiOdbioruWDniu',_tab);
            web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do dodawania wniosku o czas wolny
   _tab.NAME:='r_odn_add';
   _fml:=''+"_tab:=exec('r_odn_add','prc_dane',_a.myParam);
            _ctrl_id:=exec('ctrl_id','prc_dane');
            web_ctrl_set_table(_ctrl_id,,'tabWniosekOCzasWolny',_tab);
            web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do pobierania wniosku o czas wolny
   _tab.NAME:='r_odn_get';
   _fml:=''+"exec('r_odn_get','prc_actions',_a)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do usuwania wniosku o odbiór
   _tab.NAME:='r_odn_del';
   _fml:=''+"_tab:=exec('r_odn_del','prc_dane',_a.myParam);
            _ctrl_id:=exec('ctrl_id','prc_dane');
            web_ctrl_set_table(_ctrl_id,,'tabWniosekOCzasWolny',_tab);
            web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do dodawania wniosku o czas wolny
   _tab.NAME:='r_odn_in_day';
   _fml:=''+"_tab:=exec('r_odn_in_day','prc_dane',_a.myParam);
            _ctrl_id:=exec('ctrl_id','prc_dane');
            web_ctrl_set_table(_ctrl_id,,'tabWnioskiOCzasWolnyWDniu',_tab);
            web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add()
?};

:: - - POBIERANIE - -

:: formuła do ponownego pobrania danych
_tab.NAME:='reload_dane';
_fml:=''+"exec('wszystkie_dane','prc_dane')";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do ponownego pobrania danych tylko dla wybranego pracownika
_tab.NAME:='reload_dane4prac';
_fml:=''+"_tab:=exec('graf_dni','prc_dane',_a.myParam);
          _ctrl_id:=exec('ctrl_id','prc_dane');
          web_ctrl_set_table(_ctrl_id,,'tabDane4Prac',&_tab);
          web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do ponownego pobrania danych tylko dla wybranego pracownika
_tab.NAME:='plan_bez_korekt';
_fml:=''+"_tab:=exec('graf_dni','prc_dane',_a.myParam);
          _ctrl_id:=exec('ctrl_id','prc_dane');
          web_ctrl_set_table(_ctrl_id,,'tabPlanPierwotny',&_tab);
          web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do pobierania wydziałów do oddelegowań
_tab.NAME:='oddel_wydz';
_fml:=''+"_tab:=exec('oddel_wydz','prc_dane');
         _ctrl_id:=exec('ctrl_id','prc_dane');
         web_ctrl_set_table(_ctrl_id,,'tabOddelWydz',_tab);
         web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do pobierania kierowników do oddelegowań
_tab.NAME:='oddel_kier';
_fml:=''+"_tab:=exec('oddel_kier','prc_dane');
         _ctrl_id:=exec('ctrl_id','prc_dane');
         web_ctrl_set_table(_ctrl_id,,'tabOddelKier',_tab);
         web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do pobierania informacji o oddelegowaniach
_tab.NAME:='oddel_info';
_fml:=''+"_tab:=exec('oddel_info','prc_dane',_a.myParam);
         _ctrl_id:=exec('ctrl_id','prc_dane');
         web_ctrl_set_table(_ctrl_id,,'tabOddelInfo',_tab);
         web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do pobierania informacji o pracy zdalnej
_tab.NAME:='zdalna_info';
_fml:=''+"_tab:=exec('zdalna_info','prc_dane',_a.myParam);
         _ctrl_id:=exec('ctrl_id','prc_dane');
         web_ctrl_set_table(_ctrl_id,,'tabZdalnaInfo',_tab);
         web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do pobierania informacji o korektach pracownika
_tab.NAME:='korekty_prac';
_fml:=''+"_tab:=exec('get_kor_prac','prc_dane',_a.myParam);
         _ctrl_id:=exec('ctrl_id','prc_dane');
         web_ctrl_set_table(_ctrl_id,,'tabKorektyPrac',_tab);
         web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do pobierania informacji o korektach w okresie
_tab.NAME:='korekty_okres';
_fml:=''+"_tab:=exec('korekty','prc_dane',_a.myParam);
         _ctrl_id:=exec('ctrl_id','prc_dane');
         web_ctrl_set_table(_ctrl_id,,'tabKorektyOkres',_tab);
         web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: formuła do pobierania informacji o podziałach w dniu dla pracownika
_tab.NAME:='pobierz_podzialy4prac';
_fml:=''+"exec('podzialy','prc_actions',_a)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

{? _sSource='G'
||
:: formuła do pobierania informacji o nadgodzinach w roku pracownika
   _tab.NAME:='nadgodz_prac_w_roku';
   _fml:=''+"_tab:=exec('get_nadgodz','prc_dane',_a.myParam);
            _ctrl_id:=exec('ctrl_id','prc_dane');
            web_ctrl_set_table(_ctrl_id,,'tabNadgodzinyPrac',_tab);
            web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do pobierania informacji o nadmiarach pracowników
   _tab.NAME:='statusy_nadmiarow';
   _fml:=''+"_tab:=exec('statusy_nadmiarow','prc_dane',_a.myParam);
            _ctrl_id:=exec('ctrl_id','prc_dane');
            web_ctrl_set_table(_ctrl_id,,'tabStatusyNadmiarow',_tab);
            web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do pobierania informacji o nadmiarach pracownika
   _tab.NAME:='nadmiary_prac';
   _fml:=''+"_tab:=exec('nadmiary_prac','prc_dane',_a.myParam);
            _ctrl_id:=exec('ctrl_id','prc_dane');
            web_ctrl_set_table(_ctrl_id,,'tabNadmiaryPrac',_tab);
            web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add();

:: formuła do pobierania informacji o pierwotnych zapisach z czytników
   _tab.NAME:='wewy_zp_info';
   _fml:=''+"_tab:=exec('wewy_zp_info','prc_dane',_a.myParam);
            _ctrl_id:=exec('ctrl_id','prc_dane');
            web_ctrl_set_table(_ctrl_id,,'tabWeWyZpInfo',_tab);
            web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
   _tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
   _tab.add()
?};

:: - - RAPORTY - -
:: formuła do pobierania plików
_tab.NAME:='getFile';
_fml:=''+"exec('getFileAction','prc_actions',_a)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: - - INNE - -

:: formuła do wyświetlania okna z obsługą grup pracowników podwładnych
_tab.NAME:='grupy_podwl';
_fml:=''+"_tab:=exec('select','prc_gpdwl');
          _ctrl_id:=exec('ctrl_id','prc_dane');
          web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

:: logowanie błędów javascript
_tab.NAME:='jslog';
_fml:=''+"exec('write','%logger','prc_plan_js.log',_a.myParam);
          _ctrl_id:=exec('ctrl_id','prc_dane');
          web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)";
_tab.FML_ID:=exec('HTML_click_action','#web_srv',_fml,'F');
_tab.add();

_tab


\wodb_get
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [18.02]
:: OPIS: Formuła obsługująca akcję pobierania wniosku o odbiór nadgodzin
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
_ctrl_id:=exec('ctrl_id','prc_dane');
_tab:=exec('wodb_get','prc_dane',_a.myParam);
web_ctrl_set_table(_ctrl_id,,'tabWniosekOdbioru',_tab);
_tab2:=exec('rwyk_get','prc_dane',_a.myParam);
web_ctrl_set_table(_ctrl_id,,'tabOdbioryNadgodzin',_tab2);
web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)


\r_odn_get
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [18.02]
:: OPIS: Formuła obsługująca akcję pobierania wniosku o czas wolny
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
_ctrl_id:=exec('ctrl_id','prc_dane');
_tab:=exec('r_odn_get','prc_dane',_a.myParam);
web_ctrl_set_table(_ctrl_id,,'tabWniosekOCzasWolny',_tab);
_tab2:=exec('r_odp_get','prc_dane',_a.myParam);
web_ctrl_set_table(_ctrl_id,,'tabOdpracowania',_tab2);
web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)


\podzialy
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [18.42]
:: OPIS: Formuła obsługująca akcję pobierania podziałów
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
_ctrl_id:=exec('ctrl_id','prc_dane');
_html:=exec('podzialy','prc_html',_a.myParam);
web_ctrl_set_obj(_ctrl_id,,'podzialy','html',_html);
_tab:=exec('podzialy','prc_dane',_a.myParam);
web_ctrl_set_table(_ctrl_id,,'tabPodzialy',_tab);
web_ctrl_call(_ctrl_id,,'callback',_a.myCallback)


\getFileAction
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [21.14]
:: OPIS: Formuła obsługi akcji pobierania pliku
::   WE: _a [OBJ] - obiekt z parametrami przekazanymi z kontrolki
::   WY:
::----------------------------------------------------------------------------------------------------------------------
_res:=exec('getFile','prc_actions',_a.myParam);
_ctrl_id:=exec('ctrl_id','prc_dane');
web_ctrl_set_obj(_ctrl_id,,'getFile','errMsg',_res.errMsg);
web_ctrl_call(_ctrl_id,,'callback',_a.myCallback);
{? +_res.errMsg=0
|| _res.TAB.web_bl_download('PLIK')
?}


\getFile
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [21.14]
:: OPIS: Formuła obsługująca pobieranie plików
::   WE: _paczka [STRING] - paczka z parametrami wywołania w postaci "PAR=VAL#PAR=VAL#PAR=VAL#PAR=VAL#"
::   WY:
::----------------------------------------------------------------------------------------------------------------------
_res:=obj_new('kod','fileName','pth','errMsg','params','TAB','id');
_res.kod:='';
_res.fileName:='';
_res.pth:=1;
_res.errMsg:='';
_paczka:={? var_pres('_a')=type_of('')
         || _a
         || _res.errMsg:='Błędne parametry wywołania metody "getFile';return(_res)
         ?};
_res.params:=exec('getParamsFromPaczka','prc_dane',_paczka);
_res.kod:=exec('getParamForName','prc_dane',_res.params,'KOD');
_res.id:=exec('getParamForName','prc_dane',_res.params,'ID');

_code:='PRC_POR_DOWNLOAD';
{? Plugin.exists(_code) || Plugin.run(_code,_res) ?};

:: jeżeli plugins nic nie zwrócił to próbujemy ze standardową obsługą
{? _res.fileName=''
|| {? _res.kod='PRC_POR_RCGW_RAP_WEWYZP'
   || exec('rap_wewyzp','prc_dane',_res)
   || _res.errMsg:='Nie obsługiwany kod "%1" wywołania metody "getFile"'[_res.kod]
   ?}
?};

{? +_res.fileName & fexists(_res.fileName,_res.pth)
|| _res.TAB:=tab_tmp(,'PLIK','BLOBRAW','Plik','NAZWA','STRING[100]','Nazwa');
   _res.TAB.NAZWA:=_res.fileName;
   {? _res.TAB.add() & _res.TAB.bl_put('PLIK',_res.fileName,_res.pth)
   || ferase(_res.fileName,_res.pth)
   || _res.errMsg:='Wystąpił błąd podczas pobierania pliku "%1"'@[_res.fileName]
   ?}
|? _res.errMsg=''
|| _res.errMsg:='Nie znaleziono pliku %1'@[_res.fileName]
?};
_res


:Sign Version 2.0 jowisz:1048 2023/06/23 14:14:36 b01fa04aef2706a82192aff8e37d0c026a92b6df9724a64a5cbf5d1ae046f847b1520860e33d5cc7a991460adab47685920510443bf35e094a3dc5058bf58a14223b77417467e12a06fff75513efae5284f41ca06b9c96050e6842e34db2eec9b6ec4d0e20c96af338b3eddb8ac0eda9e3dcf8b81d5b161b567a7d4d26956c6d
