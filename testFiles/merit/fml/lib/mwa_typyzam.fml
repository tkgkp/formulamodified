:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: mwa_typyzam.fml
:: Utworzony: 18.10.2018
:: Autor: TS
::======================================================================================================================
:: Zawartość: Formuły do obsługi typów zamówień przez MacroWebAPI
::======================================================================================================================


\serialize_typyzam
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [19.02]
:: OPIS: Formuła pomocnicza do serializacji typów zamówień do XML
::       Kontekst wywołania: ustawiona dziedzina tabeli TYPYZAM
::   WE: _a - obiekt???
::----------------------------------------------------------------------------------------------------------------------
_resp:=fopen(null(),'Uw',,1,1);

_data:="
   TYPYZAM.xml_records(,,'data','p',,'noheader=1,norecord=0,nodata=1,indentation=1'
      ,'REFERENCE',,'IDADD',
      ,'R',,'T',,'NAZ',
   )
";
_tab:=tab_tmp(,'STATUS','STRING[20]','');
_tab.STATUS:='OK'; _tab.add();
_tab.xml_records(_resp,_a.METHOD+'Response',,'p',_a.OUTNSPC,'norecord=1'
   ,'STATUS:status',
   ,'',_data
);

_resp


\read_typyzam
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [19.02]
:: OPIS: Odczytuje (wszystkie / wskazane rodzajem) typy zamówień
::----------------------------------------------------------------------------------------------------------------------
_par:=params_get();
_rodzaj:=exec('get_option','mwapi',_par,'rodzaj').value;

{? _rodzaj=''
|| TYPYZAM.index('TYPN');
   TYPYZAM.prefix()
|| TYPYZAM.index('TYP');
   TYPYZAM.prefix(_rodzaj)
?};
_result:=exec('serialize_typyzam','mwa_typyzam',_par);

_result

:Sign Version 2.0 jowisz:1028 2019/06/07 15:59:55 cb3643616d507b68f23f4357d8cce9cc36120708d7ae798bd889ed54e70308c0e369e9e57a7dca0ca453c1bb1b53e786df9afcbfeb4a9c84b15700964cd30b80ce703e36776baf10c9547efea881c938d0d81e7ddfbf46b839cd7a0c7c87a569279c0ac2ef1c6714d7be1ade70f031682bcab9c1b22993a889467b2703928b68
