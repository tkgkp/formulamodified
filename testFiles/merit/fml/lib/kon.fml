:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: fks.fml
:: Utworzony: 09.03.2015
:: Autor: MB
::======================================================================================================================
:: Zawartość: Formuły obszaru FKS
::======================================================================================================================


\init
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [17.00]
:: OPIS: Formuła inicjująca dla obszaru FKS
::----------------------------------------------------------------------------------------------------------------------
exec('rach_slo','rachunki');
exec('F','object');
exec('RB','object');
:: Formuła podczytująca dane specyficzne dla firmy
__War_f:="exec('FindInSet','#table',_a,_a,_c,REF.FIRMA,$(_a+'.'+_b))";
exec('czytaj','#stalesys',,FINFO);
exec('czytaj','#stalesys',,XINFO);
exec('czytaj','#stalesys',,INFO);
exec('ud_typ4gr_sik','konsolidacja');
~~


\kon_spr
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [17.00]
:: OPIS: Główna formuła obszaru roboczego KON_SPR - Konsolidacja sprawozdań
::----------------------------------------------------------------------------------------------------------------------
exec('init','kon');
{? ROK_F.FIRMA().TYP='C'
|| _naz_trig:='konsolidacja';
    ALG_PAR.trig_a('add',"{? _a || exec('t_alg_par','konsolidacja',1) || ~~ ?}",_naz_trig);
    ALG_PAR.trig_a('put',"{? _a || exec('t_alg_par','konsolidacja',2) || ~~ ?}",_naz_trig);
    ALG_PAR.trig_b('del',"exec('t_alg_par','konsolidacja',3)",_naz_trig);
    WERSJE_W.trig_a('add',"{? _a || exec('t_wersje_w','konsolidacja',1) || ~~ ?}",_naz_trig);
    WERSJE_W.trig_a('put',"{? _a || exec('t_wersje_w','konsolidacja',2) || ~~ ?}",_naz_trig)
?};
Konsolid:=1;
exec('load_war','sprfin');
REF.WYKON:=exec('wykon_firmy','konsolidacja',REF.FIRMA);
_tab:=GR_SIK;
_grp:=_tab.grp_make('',"",'#fkskspwork',,,"exec('exit','zws','Esc')");
:: Zakładka sprawozdania
exec('add_tab','sprfin','Sprawozdania'@,_tab,_grp);
:: Przedglądanie wartości
exec('add_tab','!fks_ksp_zspr','Przegląd wartości'@,_tab,_grp);
:: Definicje
exec('add_tab_def','sprfin','Definicje'@,_tab,_grp);
:: Modele sprawozdań
exec('add_tab','!kon_spr_cmod','Modele sprawozdań'@,_tab,_grp);
:: Raporty kontrolne do wyłączeń
{? REF.S_FIRMA=REF.GRUPA
|| exec('add_tab','!kon_spr_wrap','Raporty kontrolne do wyłączeń'@,_tab,_grp)
?};

_tab.win_sel(_grp);
AreaTitle.setTabWin(_tab,~~);
AreaTitle.setTitle();
exec('set_fml','#field',SIK,'AKC',"GR_SIK.cntx_psh();SIK.AKC:=USRGRSIK.GR_SIK().AKC; GR_SIK.cntx_pop();~~");
_tab.select();
exec('set_fml','#field',SIK,'AKC')

:Sign Version 2.0 jowisz:1028 2019/10/14 09:21:28 b9fdff079335ac665131b1c870e5c952a162797e1f3be5b257dc30f68bac9a3c14a37fd6ca81ba82edb14fb2886fdc952f018ecc7657c25f67e4ae502fe7901af3f4980142e9f94e8d7c7a397a503650b1b060e14802fa998fda72c36d1b2c48021188fca5f7f6929554c494f85315920f3474840fa28cb47e82ab27b2e5e4c7
