:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: ppk_rbl.fml [12.51]
:: Utworzony: 2019/05/20
:: Autor: jaws
:: Systemy: PPK
::======================================================================================================================
:: Zawartość: Formuły odpowiedzialne za obsługę listy błędów/ostrzeżeń.
::======================================================================================================================


\_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.51]
:: OPIS: Wyzwalacz przed dołączeniem wiersza tabeli PPK_RBL.
::   WE:
::   WY: 0/1 - wiersz błędny/poprawny
::----------------------------------------------------------------------------------------------------------------------
{? PPK_RBL.PPK_RPL=null | PPK_RBL.SLO_KOD=null | PPK_RBL.MIEJSCE=''
:: nie dodawaj niekompletnych informacji
|| return(0)
?};

_numer:=0;
PPK_RBL.cntx_psh();
PPK_RBL.index('NUMER');
PPK_RBL.prefix(PPK_RBL.PPK_RPL);
{? PPK_RBL.last()
|| _numer:=PPK_RBL.NUMER
?};
PPK_RBL.cntx_pop();
PPK_RBL.NUMER:=_numer+1;

_kod:=PPK_RBL.SLO_KOD().KOD;
{? _kod<>'' & PPK_RBL.PPK_RPL<>null
|| PPK_RPL.cntx_psh();
   PPK_RPL.prefix();
   PPK_RBL.PPK_RPL();
   {? {? -_kod='b' || PPK_RPL.LICZ_BL+=1
      |? -_kod='o' || PPK_RPL.LICZ_OS+=1
      ?}
   || PPK_RPL.put()
   ?};
   PPK_RPL.cntx_pop()
?};
1


\dodaj
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.51]
:: OPIS: Dodaje komunikat.
::   WE: _a _PPK_RPL - plik raportu
::       _b STRING - rodzaj zapisu: [B/O/I] - Błąd/Ostrzeżenie/Informacja
::       _c STRING - miejsce wystąpienia
::       _d [STRING] - opis
::   WY: wskazanie dodanego zapisu lub null
::----------------------------------------------------------------------------------------------------------------------
:: mapa argumentów
_rpl:=_a;
_kod:=exec('kod','ext_slo','PPK_RBL',~-_b);
_miejsce:={? var_pres('_c')=type_of('') || _c || '' ?};
_opis:={? var_pres('_d')=type_of('') || _d || '' ?};

_ref:=null;
PPK_RBL.cntx_psh();
PPK_RBL.prefix();
PPK_RBL.PPK_RPL:=_rpl;
PPK_RBL.SLO_KOD:=_kod;
PPK_RBL.MIEJSCE:=_miejsce;
PPK_RBL.OPIS:=_opis;
PPK_RBL.add();
PPK_RBL.cntx_pop();
_ref

:Sign Version 2.0 jowisz:1045 2020/04/03 17:16:43 6962781a44270efdfafa258d14f1f2cf7bdee9d1335fbc7b8a9d41d8ba65c83a14b0c11175eb55c20da3106b604ecdc8b48eb51b1f446949c18c048caf5c4ae5cec84d00f57b29fb434e23011090db263dd8bbbe6e4dbf3aac0b080328e51a787b6c14d21a79d96c47ead0d90a2334ee905ff0712f2c33f2d23e22ba349af3fd
