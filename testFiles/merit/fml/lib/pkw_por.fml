:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: pkw_por.fml
:: Utworzony: 17.11.2016
:: Autor: TMR
::======================================================================================================================
:: Zawartość: Formuły wspólne dla czynności przeglądania danych własnych i podwładnych PKW dla webterma.
::======================================================================================================================

\pkw_por__pdo
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie danych osobowych - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por') & exec('osoba_ustaw','p_web',P.OSOBA)
|| {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || OSOBA.web_display('WEB_RED',,"web_top_tab().web_eclose(web_top_win())")
   ?}
?};
~~


\pkw_por__zat
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie danych o zatrudnieniu - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
|| H_UM.index('OD');
   H_UM.prefix(P.ref());
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || H_UM.web_select('WEB_GR')
   ?}
?};
~~


\pkw_por__adr
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie adresów na portalu - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
|| OS_ADRES.index('OD');
   OS_ADRES.prefix(P.OSOBA);
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || OS_ADRES.web_select('WEB_ADR')
   ?}
?};
~~


\pkw_por__ban
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie rachunków bankowych - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
|| PKO.index('_PKO');
   PKO.prefix(P.OSOBA);
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || PKO.web_select('WEB_GR')
   ?}
?};
~~


\pkw_por__bok
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie wyników badań - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
:: Odczytuję zapamiętany kontekst tabeli P.
|| POLA_GRP.TXT_1:='';
   BDO.index('PDTO');
   BDO.prefix(P.ref());
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || BDO.web_select('WEB_GRP')
   ?}
?};
~~


\pkw_por__bpp
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie szkoleń BHP i PPOŻ - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
|| {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || exec('select','kart_dod',P.OSOBA,'SZKOLBHP',,'PKW_POR_IBPP')
   ?}
?};
~~


\pkw_por__kur
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie kart urlopowych (webTerm) - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
:: Odczytuję zapamiętany kontekst tabeli P.
|| _ndx:={? PAR_SKID.get(236)='T' || 'PRAC_ROX' || 'PRAC_ROK' ?};
   KART_URL.index(_ndx);
   KART_URL.prefix(P.ref());
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || KART_URL.web_select('WEB_WER')
   ?}
?};
~~


\pkw_por__lst
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie list płac (webTerm) - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
:: Odczytuję zapamiętany kontekst tabeli P.
|| O_P.index('ZP_RMK');
   O_P.prefix('T','T',P.ref());
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || O_P.web_select('WEB_CTRL')
   ?}
?};
~~


\pkw_por__nie
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie nieobecności (webTerm) - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
:: Odczytuję zapamiętany kontekst tabeli P.
|| _ndx:={? PAR_SKID.get(236)='T' || 'NIEOBECX' || 'NIEOBECN' ?};
   N.index(_ndx);
   N.prefix('N',P.ref());
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || N.web_select('WEB_WER')
   ?}
?};
~~


\pkw_por__poz
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie pożyczek (webTerm) - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
:: Odczytuję zapamiętany kontekst tabeli P.
|| _ndx:={? PAR_SKID.get(236)='T' || 'KREDYTYX' || 'KREDYTY' ?};
   K.index(_ndx);
   K.prefix(P.ref());
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || K.web_select('WEB_GRP')
   ?}
?};
~~


\pkw_por__rda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie stanu rodzinnego (webTerm) - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
:: Odczytuję zapamiętany kontekst tabeli P.
|| RD.index('_RODZINA');
   RD.prefix(P.OSOBA);
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || RD.web_select('WEB_WER')
   ?}
?};
~~


\pkw_por__tyn
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie tytułów naukowych (webTerm) - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
:: Odczytuję zapamiętany kontekst tabeli P.
|| OS_TYT.index('UNIQ');
   OS_TYT.prefix(P.OSOBA);
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || OS_TYT.web_select('WEB_WER')
   ?}
?};
~~


\pkw_por__uzc
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przegl. umów cywilnoprawnych (webTerm) - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
:: Odczytuję zapamiętany kontekst tabeli P.
|| ZC.index('ZLECPRAC');
   ZC.prefix(P.ref());
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || ZC.web_select('WEB_GRP')
   ?}
?};
~~


\pkw_por__zal
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie załączników - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
|| exec('zalacz_prefix_web','zalacz',,P.OSOBA);
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || ZALACZ.web_select('WEB_WER')
   ?}
?};
~~


\pkw_por__kwa
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie kwalifikacji - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
|| {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || exec('select','kart_dod',P.OSOBA,'DOD_KWAL',,'PKW_POR_IKAR')
   ?}
?};
~~


\pkw_por__wyk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Przeglądanie wyróżnień i kar - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
|| {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || exec('select','kart_dod',P.OSOBA,'WYR_KAR',,'PKW_POR_IKAR')
   ?}
?};
~~


\set_env
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [17.00]
:: OPIS: Ustawienie środowiska
::   WE: [_a] [INTEGER] - czy przekazywać parametry przez web_params_set (domyślnie tak)
::   WY:
::----------------------------------------------------------------------------------------------------------------------
_push:={? var_pres('_a')=type_of(0) || _a || 1 ?};
{? +app_info('web_sesid')
||
:: Przekazanie parametrów "dalej".
   {? _push
   || web_params_set(web_params_get())
   ?};
:: Ustawiam środowisko i odczytuje zapamiętany kontekst tabeli P
   exec('env_wt','b_proces') & exec('init','pkw') & exec('load_cur_prac','p_web') & exec('open_pkw','open_tab')
?}


\pkw_por__inn
::----------------------------------------------------------------------------------------------------------------------
::  UTW: IS [21.37]
:: OPIS: Przeglądanie innych danych - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
|| {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)=-1
   || web_msg('Brak formuły wtyczki. Skontaktuj się z administratorem systemu.'@)
   ?}
?};

~~


\pkw_por__rss
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TMR [22.26]
:: OPIS: Rejestracja start / stop - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
|| _date:=date();
   _year:=($(_date~1))+2;
   _month:={? (_mc:=_date~2)>=10 || $_mc || '0%1'[$_mc] ?};
   R_POR_WW.use('r_ph%1%2'[_year,_month]);
   R_POR_WW.index('NRX');
   R_POR_WW.prefix(P.ref());
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || R_POR_WW.web_select('WT_WER')
   ?}
?};

~~


\pkw_por__pzd
::----------------------------------------------------------------------------------------------------------------------
::  UTW: IS [22.26]
:: OPIS: Przeglądanie pracy zdalnej stałej (webTerm) - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
:: Odczytuję zapamiętany kontekst tabeli P.
|| PPSF_H.index('PRAX');
   PPSF_H.prefix(P.ref());
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || PPSF_H.web_select('WT_WER')
   ?}
?};
~~


\pkw_por__pps
::----------------------------------------------------------------------------------------------------------------------
::  UTW: IS [22.26]
:: OPIS: Przeglądanie pracy pracy poza siedzibą firmy (webTerm) - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
:: Odczytuję zapamiętany kontekst tabeli P.
|| PPSFN.index('PRAX');
   PPSFN.prefix(exec('firma','ustawienia'),P.ref());
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || PPSFN.web_select('WT_WER')
   ?}
?};
~~


\pkw_por__pad
::----------------------------------------------------------------------------------------------------------------------
::  UTW: IS [22.26]
:: OPIS: Przeglądanie adresów pracy zdalnej stałej (webTerm) - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
:: Odczytuję zapamiętany kontekst tabeli P.
|| PPSF_ADR.index('PRAX');
   PPSF_ADR.prefix(P.ref());
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || PPSF_ADR.web_select('WT_WER')
   ?}
?};
~~


\pkw_por__ppo
::----------------------------------------------------------------------------------------------------------------------
::  UTW: IS [22.26]
:: OPIS: Przeglądanie oświadczeń pracy zdalnej stałej (webTerm) - wspólna formuła czynności.
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('set_env','pkw_por')
:: Odczytuję zapamiętany kontekst tabeli P.
|| PPSF_PO.index('PRAX');
   PPSF_PO.prefix(P.ref());
   {? Plugin.run('PKW_POR_PKD_WINS',form_stack(0).name)<>1
   || PPSF_PO.web_select('WT_WER')
   ?}
?};
~~

:Sign Version 2.0 jowisz:1045 2023/07/21 13:25:29 ba7fc33714a033af213122d3bcac7554dbd735852bb9e4d429a026074564a25624236bf194e6690be0256ca1680ec564205e1d1533ba86c5da15164a9eda957918f80175e946b751b11e0de705f645595e0fb52156ef5d0715c49554c9587c31570337b3ebc786ba858a7c7f012d1e6d0477d9ce1f7b2bcfefaea0d6bb84d86e
