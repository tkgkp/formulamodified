:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzezone
::======================================================================================================================
:: Nazwa pliku: kon_syn.fml
:: Utworzony: 04.10.2000
:: Autor: AMA
::======================================================================================================================
:: Zawartosc: Procedury do obslugi kont syntetycznych
::======================================================================================================================


\spr_an
::----------------------------------------------------------------------------------------------------------------------
::  UTW: JS [7.20]
:: OPIS: Funkcja sprawdza, czy w tabeli AN roku o kodzie _b
::       istnieja konta analityczne do konta syntetycznego _a.
::   WE: _a - ref konta syntetycznego, _b - kod roku (ROK_F.KOD)
::   WY: O - sa konta, 1 - nie ma kont
::----------------------------------------------------------------------------------------------------------------------
AN.cntx_psh();
AN.use('koan__'+_b);
AN.index('KS'); AN.prefix(_a); _jest:=~AN.first();
AN.cntx_pop();
_jest


\spr_dok
::----------------------------------------------------------------------------------------------------------------------
::  UTW: JS [7.20]
:: OPIS: Funkcja sprawdza, czy na aktualnym koncie syntetycznym
::       istnieja zapisy ksiegowe (zaakceptowane lub wszystkie)
::       w roku _b. Sprawdzane sa tylko okresy nie zamkniete,
::       poniewaz dla okresow zakmnietych wystarczy sprawdzic
::       obecnosc konta w tabeli AN (funkcja spr_an).
::   WE: _a - ref konta syntetycznego,
::       _b - ref roku
::       _c - 1 - zaakceptowane, 2 - wszystkie
::   WY: O - sa dokumenty na koncie, 1 - nie ma dokumentow na koncie.
::----------------------------------------------------------------------------------------------------------------------
_jest:=1;
DOK.cntx_psh(); POZ.cntx_psh(); POW.cntx_psh();
KS.cntx_psh();
KS.index('SYM'); KS.prefix(_b);
{? KS.seek(_a) & ROK_F.seek(_b)
|| _kod:=ROK_F.KOD;
   OKRO_F.cntx_psh();
   OKRO_F.index('ZAM'); OKRO_F.prefix(_b);
   {? OKRO_F.first
   || {! |?
         {? OKRO_F.ZAM<>'T'
         || DOK.use('doku'+_kod+form(OKRO_F.NR,-2));
            POZ.use('pozy'+_kod+form(OKRO_F.NR,-2));
            POW.use('pow_'+_kod+form(OKRO_F.NR,-2));
            DOK.prefix;
            POZ.index('KON');
            POZ.prefix(KS.SYM);
            {? _jest & POZ.first
            || {? _c=1
               || {! |?
                     {? -POZ.DOK().A='t' || _jest:=0 ?};
                     POZ.next & _jest
                  !}
               || _jest:=0
               ?}
            ?}
         ?};
         OKRO_F.next & _jest
      !}
   ?};
   OKRO_F.cntx_pop()
?};
KS.cntx_pop();
DOK.cntx_pop(); POZ.cntx_pop(); POW.cntx_pop();
_jest


\users_ks
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [12.10]
:: OPIS: Ustawienie parametrow wyswietlania wierszy sprawozdan
::----------------------------------------------------------------------------------------------------------------------
WYDRUKI.KSOD:=KS.ref();
KS.cntx_psh();
{? KS.last() || WYDRUKI.KSDO:=KS.ref() ?};
KS.cntx_pop();
KS.cntx_psh();
GR_SIK.win_sel('SLO2');
GR_SIK.win_dict('SLO2');
exec('f_set_gr_sik','sprfin','');
USERS_KS.win_edit('RED_KS');
{? USERS_KS.edit("{? WYDRUKI.KSDO().SYM>=WYDRUKI.KSOD().SYM || 1 || FUN.error('Błędny zakres kont'); 0 ?}")
|| USERS_KS.put();
   exec('ks_spr','!zws_par_fask')
?};
KS.cntx_pop()


\users_ks2
::----------------------------------------------------------------------------------------------------------------------
::  UTW: KW [23.25]
:: OPIS: Ustawienie parametrow wyswietlania wierszy sprawozdan - z akcji.
::----------------------------------------------------------------------------------------------------------------------
GR_SIK.win_sel('SLO2');
GR_SIK.win_dict('SLO2');
exec('f_set_gr_sik','sprfin','');
USERS_KS.win_edit('RED');
{? USERS_KS.edit()
|| USERS_KS.put();
   exec('ks_spr_put','!zws_par_fask')
?}


\ks2defw
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [12.10]
:: OPIS: Dodanie konta do definicji wiersza sprawozdania
::----------------------------------------------------------------------------------------------------------------------
WYRAZ.GRUPA:={? KS.TYP='BL' || USERS_KS.SPR_BIL || USERS_KS.SPR_WYN ?};
_ok:=1;
{? WYRAZ.GRUPA & WYRAZ.GRUPA().AKC='T'
|| _ok:=0;
   {? GR_SIK.FIRMA=REF.GRUPA
   || FUN.info('Sprawozdanie grupy kapitałowej %1 jest zaakceptowane.'@[GR_SIK.SKROT])
   || {? FUN.ask('Sprawozdanie %1 jest zaakceptowane.\nCzy anulować akceptację sprawozdania?'@[GR_SIK.SKROT])
      || ssize_s:=1;
         bledy_s:=l_pow:=sl_pow:=0;
         exec('gr_anakc','!zws_par_fspr',1);
         VAR_DEL.delete('ssize_s','bledy_s','l_pow','sl_pow');
         _ok:=GR_SIK.AKC='N'
      ?}
   ?}
?};
{? _ok
|| KS.cntx_psh();
   WYRAZ.LP:=ALG_PAR.LP+1;
   SIK.ROK2:=ALG_PAR.ROK;
   kolumna2:=ALG_PAR.GR_KOL;
   SIK.ROK1:=ROK_F.ref();
   WYRAZ.WIERSZ:=null;
   WYRAZ.KOLUMNA:=null;
   GR_SIK.win_dict('SLO2');
   DEFW.win_dict('WER1');
   exec('f_set_gr_sik','sprfin','N');
   ALG_PAR.prefix();
   ALG_PAR.win_edit('RED2');
   ALG_PAR.blank(); ALG_PAR.LP:=-1; ALG_PAR.add();
   ks2alg_par:=KS.SYM;
   {? ALG_PAR.edit("
         _a:=chk_rec('GRUPA','WIERSZ','KOLUMNA','FORM_ALG');
         {? _a='' || _a:=exec('spr_par','!zws_par_fspr') ?};
         {? _a='' & WYRAZ.GRUPA().AKC='T'
         || FUN.info('Sprawozdanie jest zaakceptowane.'@);
            _a:='GRUPA'
         ?};
         _a
      ")
   || ALG_PAR.cntx_psh();
      ALG_PAR.index('ALG_PAR1'); ALG_PAR.prefix(REF.FIRMA,WYRAZ.WIERSZ,WYRAZ.KOLUMNA,ROK_F.NAZ);
      _lp:={? ALG_PAR.last() || ALG_PAR.LP+1 || 1 ?};
      ALG_PAR.cntx_pop();
      ALG_PAR.LP:=_lp;
      ALG_PAR.DEFW:=WYRAZ.WIERSZ;
      ALG_PAR.GR_KOL:=WYRAZ.KOLUMNA;
      ALG_PAR.ROK:=SIK.ROK1;
      {? ALG_PAR.WYL='' || ALG_PAR.WYL:='N' ?};
      ALG_PAR.put()
   || ALG_PAR.del()
   ?};
   KS.cntx_pop();
   VAR_DEL.delete('ks2alg_par')
?}


\ks2defw2
::----------------------------------------------------------------------------------------------------------------------
::  UTW: KW [23.25]
:: OPIS: Dodanie konta do definicji wiersza sprawozdania.
::----------------------------------------------------------------------------------------------------------------------
KS.cntx_psh();
KSSPRAN.cntx_psh();
_ind1:=KSSPRAN.ndx_tmp(,,'SYM',,);
KSSPRAN.index(_ind1);
{? ~KS.seek(KSSPRAN.KS_REF)
|| FUN.info('Nie znaleziono konta.');
   KS.cntx_pop();
   KSSPRAN.cntx_pop();
   return(0)
?};
WYRAZ.GRUPA:={? KS.TYP='BL' || USERS_KS.SPR_BIL || USERS_KS.SPR_WYN ?};
_ok:=1;
{? WYRAZ.GRUPA & WYRAZ.GRUPA().AKC='T'
|| _ok:=0;
   {? GR_SIK.FIRMA=REF.GRUPA
   || FUN.info('Sprawozdanie grupy kapitałowej %1 jest zaakceptowane.'@[GR_SIK.SKROT])
   || {? FUN.ask('Sprawozdanie %1 jest zaakceptowane.\nCzy anulować akceptację sprawozdania?'@[GR_SIK.SKROT])
      || ssize_s:=1;
         bledy_s:=l_pow:=sl_pow:=0;
         exec('gr_anakc','!zws_par_fspr',1);
         VAR_DEL.delete('ssize_s','bledy_s','l_pow','sl_pow');
         _ok:=GR_SIK.AKC='N'
      ?}
   ?}
?};
{? _ok
|| KS.cntx_psh();
   WYRAZ.LP:=ALG_PAR.LP+1;
   SIK.ROK2:=ALG_PAR.ROK;
   kolumna2:=ALG_PAR.GR_KOL;
   SIK.ROK1:=ROK_F.ref();
   WYRAZ.WIERSZ:=null;
   WYRAZ.KOLUMNA:=null;
   GR_SIK.win_dict('SLO2');
   DEFW.win_dict('WER1');
   exec('f_set_gr_sik','sprfin','N');
   ALG_PAR.prefix();
   ALG_PAR.win_edit('RED2');
   ALG_PAR.blank(); ALG_PAR.LP:=-1; ALG_PAR.add();
   ks2alg_par:=KS.SYM;
   {? ALG_PAR.edit("
         _a:=chk_rec('GRUPA','WIERSZ','KOLUMNA','FORM_ALG');
         {? _a='' || _a:=exec('spr_par','!zws_par_fspr') ?};
         {? _a='' & WYRAZ.GRUPA().AKC='T'
         || FUN.info('Sprawozdanie jest zaakceptowane.'@);
            _a:='GRUPA'
         ?};
         _a
      ")
   || ALG_PAR.cntx_psh();
      ALG_PAR.index('ALG_PAR1'); ALG_PAR.prefix(REF.FIRMA,WYRAZ.WIERSZ,WYRAZ.KOLUMNA,ROK_F.NAZ);
      _lp:={? ALG_PAR.last() || ALG_PAR.LP+1 || 1 ?};
      ALG_PAR.cntx_pop();
      ALG_PAR.LP:=_lp;
      ALG_PAR.DEFW:=WYRAZ.WIERSZ;
      ALG_PAR.GR_KOL:=WYRAZ.KOLUMNA;
      ALG_PAR.ROK:=SIK.ROK1;
      {? ALG_PAR.WYL='' || ALG_PAR.WYL:='N' ?};
      ALG_PAR.put()
   || ALG_PAR.del()
   ?};
   KS.cntx_pop();
   VAR_DEL.delete('ks2alg_par')
?};
KS.cntx_pop();
KSSPRAN.cntx_pop();
KSSPRAN.ndx_drop(_ind1);
exec('ks_spr_put2','!zws_par_fask');
&_ind1


\ks_in_gr_sik
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [12.10]
:: OPIS: Wyświetla wiersze sprawozdania ze wskazanym kontem
::----------------------------------------------------------------------------------------------------------------------
{? KS.TYP<>'BL' & KS.TYP<>'BW'
|| FUN.info('Akcja dotyczy kont bilansowych lub wynikowych.'@)
|? KS.TYP='BL' & USERS_KS.SPR_BIL=null
|| FUN.info('Nie wskazano sprawozdania bilansowego\nw opcjach przeglądania.'@)
|? KS.TYP='BW' & USERS_KS.SPR_WYN=null
|| FUN.info('Nie wskazano sprawozdania wynikowego\nw opcjach przeglądania.'@)
|| VAR_DEL.delete('TKSINGR');
   ks2alg_par:=KS.SYM;
   TKSINGR:=tab_tmp(1,
      'DEFW','INTEGER',,
      'GR_SIK','STRING[15]',,
      'DEFW_K','STRING[15]',,
      'DEFW_N','STRING[80]',
   );
   _gr:=
   {? KS.TYP='BL'
   || USERS_KS.SPR_BIL
   || USERS_KS.SPR_WYN
   ?};
   GR_KOL.index('LP'); GR_KOL.prefix(_gr);
   DEFW.index('GRUPA'); DEFW.prefix(_gr);
   {? DEFW.first()
   || {!
      |? {? GR_KOL.first()
         || {!
            |? exec('ks_in_gr_sik1','kon_syn');
               GR_KOL.next()
            !}
         ?};
         DEFW.next()
      !}
   ?};
   _o:=TKSINGR.mk_sel('Wiersze sprawozdań z kontem: %1'@[KS.SYM],,,'tksingr');
   TKSINGR.win_fld(_o,,'GR_SIK');
   TKSINGR.win_fld(_o,,'DEFW_K');
   TKSINGR.win_fld(_o,,'DEFW_N');
   TKSINGR.win_act(_o,,'Formuła','Algorytm'@@,,,,"
      DEFW.prefix();
      {? DEFW.seek(TKSINGR.DEFW,)
      || WYRAZ.WIERSZ:=DEFW.ref();
         WYRAZ.GRUPA:=WYRAZ.WIERSZ().GRUPA;
         ALG_PAR.index('ALG_PAR3'); ALG_PAR.prefix(REF.FIRMA,TKSINGR.DEFW,ROK_F.NAZ);
         ALG_PAR.win_sel('PAR_ALL');
         exec('alg_par_fld','kon_syn');
         UNPAR.P1_AE:=exec('get_lang','lang',WYRAZ.WIERSZ);
         UNPAR.P2_AE:=exec('get_lang','lang',WYRAZ.GRUPA);
         ALG_PAR.win_edit('RED1');
         {? DEFW.GRUPA().AKC='T'
         || ALG_PAR.select(,,,'cdUPO:d')
         || ALG_PAR.select(,,,'O')
         ?}
      ?}
   ",1,,,,'A');
   TKSINGR.win_sel(_o);
   TKSINGR.select();
   VAR_DEL.delete('TKSINGR','ks2alg_par')
?}


\ks_in_gr_sik2
::----------------------------------------------------------------------------------------------------------------------
::  UTW: KW [23.25]
:: OPIS: Wyświetla wiersze sprawozdania ze wskazanym kontem.
::----------------------------------------------------------------------------------------------------------------------
KS.cntx_psh();
KS.prefix();
{? ~KS.seek(KSSPRAN.KS_REF)
|| FUN.info('Nie znaleziono konta.');
   KS.cntx_pop();
   return(0)
?};
{? KS.TYP<>'BL' & KS.TYP<>'BW'
|| FUN.info('Akcja dotyczy kont bilansowych lub wynikowych.'@)
|? KS.TYP='BL' & USERS_KS.SPR_BIL=null
|| FUN.info('Nie wskazano sprawozdania bilansowego\nw opcjach przeglądania.'@)
|? KS.TYP='BW' & USERS_KS.SPR_WYN=null
|| FUN.info('Nie wskazano sprawozdania wynikowego\nw opcjach przeglądania.'@)
|| VAR_DEL.delete('TKSINGR');
   ks2alg_par:=KS.SYM;
   TKSINGR:=tab_tmp(1,
      'DEFW','INTEGER','Definicja wierszy sprawozdań',
      'GR_SIK','STRING[15]','Sprawozdanie',
      'DEFW_K','STRING[15]','Grupa',
      'DEFW_N','STRING[80]','Wiersz sprawozdania'
   );
   TKSINGR.fld_attr('DEFW',2,2);
   _gr:=
   {? KS.TYP='BL'
   || USERS_KS.SPR_BIL
   || USERS_KS.SPR_WYN
   ?};
   GR_KOL.index('LP'); GR_KOL.prefix(_gr);
   DEFW.index('GRUPA'); DEFW.prefix(_gr);
   {? DEFW.first()
   || {!
      |? {? GR_KOL.first()
         || {!
            |? exec('ks_in_gr_sik1','kon_syn');
               GR_KOL.next()
            !}
         ?};
         DEFW.next()
      !}
   ?};
   _o:=TKSINGR.mk_sel('Wiersze sprawozdań z kontem: %1'@[KS.SYM],,,'tksingr',,,,,'U');
   TKSINGR.win_fld(_o,,'GR_SIK',,,,,,'Sprawozdanie');
   TKSINGR.win_fld(_o,,'DEFW_K',,,,,,'Grupa');
   TKSINGR.win_fld(_o,,'DEFW_N',,,,,,'Wiersz sprawozdania');
   TKSINGR.win_act(_o,,'Formuła','Algorytm'@@,,,,"
      ALG_PAR.cntx_psh();
      DEFW.prefix();
      {? DEFW.seek(TKSINGR.DEFW,)
      || WYRAZ.WIERSZ:=DEFW.ref();
         WYRAZ.GRUPA:=WYRAZ.WIERSZ().GRUPA;
         ALG_PAR.index('ALG_PAR3'); ALG_PAR.prefix(REF.FIRMA,TKSINGR.DEFW,ROK_F.NAZ);
         ALG_PAR.win_sel('PAR_ALL2');
         exec('alg_par_fld2','kon_syn');
         UNPAR.P1_AE:=exec('get_lang','lang',WYRAZ.WIERSZ);
         UNPAR.P2_AE:=exec('get_lang','lang',WYRAZ.GRUPA);
         ROK_F.cntx_psh();
         ALG_PAR.win_edit('RED1');
         {? DEFW.GRUPA().AKC='T'
         || ALG_PAR.select(,,,'cdUPO:d')
         || ALG_PAR.select(,,,'O')
         ?};
         ROK_F.cntx_pop()
      ?};
      {? var_pres('anal_rok')>0 || anal_rok:=SSTALE.AR ?};
      ALG_PAR.cntx_pop()
   ",1,,,,'A');
   TKSINGR.win_act(_o,,'Kolejność');
   TKSINGR.win_sel(_o);
   TKSINGR.select();
   VAR_DEL.delete('TKSINGR','ks2alg_par')
?};
KS.cntx_pop()


\alg_par_fld
::----------------------------------------------------------------------------------------------------------------------
::  UTW: KN  [21.14]
:: OPIS: W zależności od skróconej nazwy formuły (pole ALG_PAR.FORMULA)
::       ustawia odpowiednie nagłówki pól P1... P5 tabeli ALG_PAR)
::   WY:
::----------------------------------------------------------------------------------------------------------------------
ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P1');
ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P2');
ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P3');
ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P4');
ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P5');
_skrot:=ALG_PAR.FORMULA().SKROT;
{? _skrot='R_ROZNIC' | _skrot='R_SALDO'
|| ALG_PAR.fld_opt('PAR_ALL','col_name=Maska konta',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Waluta (symbol)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Typ rozrachunku',ALG_PAR,'P5')
|? (_skrot*'SAL'>0 | _skrot*'OBR'>0 | (4+_skrot)*'BO'>0 | _skrot*'ROZNI'>0
   | _skrot*'ZM_STA'>0) & (_skrot*'SALB'=0 & _skrot*'OBRB'=0)
|| _p:={? 1+_skrot='_' || '' || 'Maska konta'?};
   ALG_PAR.fld_opt('PAR_ALL','col_name="%1"'[_p],ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   {? 1+GR_SIK.TYP_KLIK<>'T'
   || ALG_PAR.fld_opt('PAR_ALL','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3')
   ?};
   {? 1+_skrot<>'^' & 1+GR_SIK.TYP_KLIK<>'T'
   || ALG_PAR.fld_opt('PAR_ALL','col_name=Waluta (symbol)',ALG_PAR,'P4');
      ALG_PAR.fld_opt('PAR_ALL','col_name=Wyróżnik (słownik)',ALG_PAR,'P5')
   || ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P4');
      ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P5')
   ?}
|? _skrot*'SALB'>0 | _skrot*'OBRB'>0
|| _p:={? 1+_skrot='_' || '' || 'Maska struktury'?};
   ALG_PAR.fld_opt('PAR_ALL','col_name="%1"'[_p],ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   {? 1+_skrot<>'^'
   || ALG_PAR.fld_opt('PAR_ALL','col_name=Waluta (symbol)',ALG_PAR,'P4');
      _p:={?_skrot*'ML'||'Hierarchia słowników'||'Tabela budżetu'?};
      ALG_PAR.fld_opt('PAR_ALL','col_name="%1"'[_p],ALG_PAR,'P5')
   || ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P4');
      ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P5')
   ?}
|? _skrot*'MSDB'>0
|| _p:={? 1+_skrot='_' || '' || 'Sprawozdanie MSDB'?};
   ALG_PAR.fld_opt('PAR_ALL','col_name="%1"'[_p],ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Kolumna MSDB',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Wiersz MSDB',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P5')
|? _skrot*'PLANW'>0
|| ALG_PAR.fld_opt('PAR_ALL','col_name=Paragraf',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Status zatrudnienia',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P5')
|? _skrot*'PLANZ'>0
|| ALG_PAR.fld_opt('PAR_ALL','col_name=Paragraf',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Status zatrudnienia',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P5')
|? _skrot='ML_SUM'
|| ALG_PAR.fld_opt('PAR_ALL','col_name=Formuła',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Cdn.1',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Cdn.2',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Cdn.3',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Cdn.4',ALG_PAR,'P5')
|? _skrot='ML_RBNZ'
|| ALG_PAR.fld_opt('PAR_ALL','col_name=Maska konta',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Waluta (symbol)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Typ rozrachunku',ALG_PAR,'P5')
|? _skrot='ML_RBNZR'
|| ALG_PAR.fld_opt('PAR_ALL','col_name=Maska konta',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Waluta (symbol)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Typ rozrachunku',ALG_PAR,'P5')
|? _skrot='ML_RBRN'
|| ALG_PAR.fld_opt('PAR_ALL','col_name=Maska konta',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Waluta (symbol)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Typ rozrachunku',ALG_PAR,'P5')
|? _skrot*'ML_NZ'
|| _p:={? 1+_skrot='_' || '' || 'Maska struktury'?};
   ALG_PAR.fld_opt('PAR_ALL','col_name="%1"'[_p],ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   {? 1+_skrot<>'^'
   || ALG_PAR.fld_opt('PAR_ALL','col_name=Waluta (symbol)',ALG_PAR,'P4');
      ALG_PAR.fld_opt('PAR_ALL','col_name=Typ (prefix)',ALG_PAR,'P5')
   || ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P4');
      ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P5')
   ?}
|? _skrot*'BZPLAN'>0
|| ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Typ planu',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Poziom planu',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Maska planu',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Korekta',ALG_PAR,'P5')
|? _skrot='DL_NALEZ' | _skrot='DL_ZOBOW'
|| ALG_PAR.fld_opt('PAR_ALL','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Waluta (symbol)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P5')
|? (3+(~-_skrot)='VAT') | (3+(~-_skrot)='VAN')
|| ALG_PAR.fld_opt('PAR_ALL','col_name=Klasa ewidencji VAT',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Grupa podatkowa',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Rejestr VAT',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P5')
|? _skrot='WYNIKF'
|| ALG_PAR.fld_opt('PAR_ALL','col_name=Uwzględniać konto wyniku finansowego?',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Symbol konta "Wynik finansowy"',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Waluta (symbol)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P5')
|? _skrot='%POD.DOC'
|| ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL','col_name=',ALG_PAR,'P5')
?}

\ks_in_gr_sik1
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [12.10]
:: OPIS: Wyświetla wiersze sprawozdania ze wskazanym kontem
::----------------------------------------------------------------------------------------------------------------------
DEFW.cntx_psh(); GR_KOL.cntx_psh();
{? DEFW.ALGORYTM='F' & ~TKSINGR.find_key(DEFW.ref())
|| _jest:=0;
   ALG_PAR.index('ALG_PAR1'); ALG_PAR.prefix(REF.FIRMA,DEFW.ref(),GR_KOL.ref(),ROK_F.NAZ);
   {? ALG_PAR.first()
   || {!
      |? _s:=ALG_PAR.FORMULA().SKROT;
         {? _s*'SAL'>0 | _s*'OBR'>0 | (4+_s)*'BO'>0 | _s*'ROZNI'>0 | _s*'ZM_STA'>0
         || WYDRUKI.MASKA:=ALG_PAR.P1;
            WYDRUKIN.DLKON:=+KS.SYM;
            {? exec('mask','konto',KS.SYM)
            || TKSINGR.GR_SIK:=DEFW.GRUPA().SKROT;
               TKSINGR.DEFW_K:=DEFW.KOD;
               TKSINGR.DEFW_N:=DEFW.NAZWA;
               TKSINGR.DEFW:=DEFW.ref();
               _jest:=TKSINGR.add()
            ?}
         ?};
         _jest=0 & ALG_PAR.next()
      !}
   ?}
|| DEFA.index('WIERSZ'); DEFA.prefix(DEFW.ref(),GR_KOL.LP);
   {? DEFA.first()
   || {!
      |? DEFA.ARGUMENT();
         DEFA.ARG_KOL();
         exec('ks_in_gr_sik1','kon_syn');
         DEFA.next()
      !}
   ?}
?};
DEFW.cntx_pop(); GR_KOL.cntx_pop


\ks_in_gr
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MB [12.10]
:: OPIS: Przygotowanie danych na potrzeby wierszy sprawozdan w kontach
::   WE: _a - typ operacji
::----------------------------------------------------------------------------------------------------------------------
GR_SIK.win_dict('SLO2');
DEFW.win_dict('SLO');
GR_KOL.win_dict('WER2');
USERS.index('USR_KKOD'); USERS.prefix();
{? USERS.find_key(OPERATOR.USER().KOD,OPERATOR.USER().KOD)
|| USERS_KS.index('ROK_F');
   USERS_KS.prefix(USERS.ref(),ROK_F.ref());
   {? ~USERS_KS.first()
   || USERS_KS.blank();
      USERS_KS.USERS:=USERS.ref();
      USERS_KS.ROK_F:=ROK_F.ref();
      USERS_KS.add()
   ?}
?}


\wyr_kol
::----------------------------------------------------------------------------------------------------------------------
:: OPIS: Przed redakcja pola WYRAZ.KOLUMNA
::OLD \wyr_kol/wskaznik
::----------------------------------------------------------------------------------------------------------------------
{? PARAM.WSZYSTKO='W'
|| WYRAZ.KOLUMNA:=null;0
|| {? WYRAZ.KOLUMNA=null & WYRAZ.GRUPA<>null
   || GR_KOL.index('LP');
      GR_KOL.prefix(WYRAZ.GRUPA);
      {? GR_KOL.last()
      || WYRAZ.KOLUMNA:=GR_KOL.ref
      ?}
   |? WYRAZ.KOLUMNA<>null & WYRAZ.GRUPA<>null & WYRAZ.KOLUMNA().GRUPA<>WYRAZ.GRUPA
   || WYRAZ.KOLUMNA:=null
   ?}; 1
?}


\czy_wielo
::----------------------------------------------------------------------------------------------------------------------
::  UTW: IFZ [21.37]
:: OPIS: Przed redakcją/wyświetleniem pola KS.MW
::----------------------------------------------------------------------------------------------------------------------
KsMw:=KS.MW;
KS.WIELO='T'


\ae_mw
::----------------------------------------------------------------------------------------------------------------------
::  UTW: IFZ [21.37]
:: OPIS: Po redakcji pola KS.MW
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('KsMw')<=0 || KsMw:='N' ?};
{? KsMw='N' & fld()='T'
|| {? FUN.ask('Czy włączyć dodatkową ewidencję przychodów i rozchodów w walutach obcych dla konta %1?'@[KS.SYM])
   || {? KS.put()
        & FUN.ask('Czy uzupełnić dane w magazynie walut na podstawie zapisów walutowych w roku %1 dla konta %2?'@[ROK_F.NAZ,KS.SYM])
      || exec('akt_mw','magwal')
      || FUN.info('Zrezygnowano z aktualizacji stanów walut od początku roku.\n'+
                  'Stany walut będą uaktualnianie na bieżąco podczas księgowania i wycofywania dokumentów'@)
      ?}
   || KS.MW:='N'
   ?}
|? KsMw='T' & fld()='N'
|| _ret:=0;
   _fmaska:={? +REF.FIRMA().SYMBOL>3 || -REF.FIRMA().SYMBOL || 'r'+REF.FIRMA().SYMBOL ?};
   MAGWALP.use('mwp'+_fmaska);
   MAGWALR.use('mwr'+_fmaska);
   MAGWALP.index('KON');
   MAGWALP.prefix(KS.SYM);
   MAGWALR.index('KON');
   MAGWALR.prefix(KS.SYM);
   _CzySaRoz:=sql('select * from MAGWALR where MAGWALR.KON like \':_a\' '+
                  'and MAGWALR.DATA between to_date(:_b) and to_date(:_c) '+
                  'and MAGWALR.POZR is not null ',exec('str_sql','#sql',KS.SYM),ROK_F.POCZ_ROK,ROK_F.KON_ROK);
   _ret:=MAGWALP.first();

::   Uwaga, gdy zostały naliczone różnice (rozliczono przynajmniej jeden rozchód)
   {? _CzySaRoz.size
   || _ret:=FUN.choice('Zostały zaksięgowane dokumenty rozliczające różnice kursowe.'@,,'Usuń dane dla konta z magazynu walut'@)
   ?};
   {? _ret
   || {? FUN.ask('Magazyn walut zawiera dane.\n'+
                 'Wyłączenie opcji wiąże się z usunięciem danych z magazynu walut! \n'+
                 'Czy wyłączyć możliwość ewidencji w magazynie walut w roku %1 dla konta %2?'@[ROK_F.NAZ,KS.SYM])
      || KS.MW:='N';
         {? KS.put()
         || {? MAGWALR.first()
            || {! |? {? MAGWALR.DATA>=ROK_F.POCZ_ROK & MAGWALR.DATA<=ROK_F.KON_ROK
                     || MAGWALR.del()
                     || MAGWALR.next()
                     ?}
               !}
            ?};
            {? MAGWALP.first()
            || {! |? {? MAGWALP.DATA>=ROK_F.POCZ_ROK & MAGWALP.DATA<=ROK_F.KON_ROK
                     || MAGWALP.del()
                     || MAGWALP.next()
                     ?}
               !}
            ?};
            FUN.info('Operacja zakończona.\nStany w magazynie walut w roku %1 dla konta %2 zostały usunięte.'@[ROK_F.NAZ,KS.SYM])
         ?}
      || KS.MW:='T'
      ?}
   ?}
?};
win_disp();
1


\alg_par_fld2
::----------------------------------------------------------------------------------------------------------------------
::  UTW: PBS [23.25]
:: OPIS: Ustawia nazwy kolumn w okienku PAR_ALL2
::----------------------------------------------------------------------------------------------------------------------
ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P1');
ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P2');
ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P3');
ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P4');
ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P5');
_skrot:=ALG_PAR.FORMULA().SKROT;
{? _skrot='R_ROZNIC' | _skrot='R_SALDO'
|| ALG_PAR.fld_opt('PAR_ALL2','col_name=Maska konta',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Waluta (symbol)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Typ rozrachunku',ALG_PAR,'P5')
|? (_skrot*'SAL'>0 | _skrot*'OBR'>0 | (4+_skrot)*'BO'>0 | _skrot*'ROZNI'>0
   | _skrot*'ZM_STA'>0) & (_skrot*'SALB'=0 & _skrot*'OBRB'=0)
|| _p:={? 1+_skrot='_' || '' || 'Maska konta'?};
   ALG_PAR.fld_opt('PAR_ALL2','col_name="%1"'[_p],ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   {? 1+GR_SIK.TYP_KLIK<>'T'
   || ALG_PAR.fld_opt('PAR_ALL2','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3')
   ?};
   {? 1+_skrot<>'^' & 1+GR_SIK.TYP_KLIK<>'T'
   || ALG_PAR.fld_opt('PAR_ALL2','col_name=Waluta (symbol)',ALG_PAR,'P4');
      ALG_PAR.fld_opt('PAR_ALL2','col_name=Wyróżnik (słownik)',ALG_PAR,'P5')
   || ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P4');
      ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P5')
   ?}
|? _skrot*'SALB'>0 | _skrot*'OBRB'>0
|| _p:={? 1+_skrot='_' || '' || 'Maska struktury'?};
   ALG_PAR.fld_opt('PAR_ALL2','col_name="%1"'[_p],ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   {? 1+_skrot<>'^'
   || ALG_PAR.fld_opt('PAR_ALL2','col_name=Waluta (symbol)',ALG_PAR,'P4');
      _p:={?_skrot*'ML'||'Hierarchia słowników'||'Tabela budżetu'?};
      ALG_PAR.fld_opt('PAR_ALL2','col_name="%1"'[_p],ALG_PAR,'P5')
   || ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P4');
      ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P5')
   ?}
|? _skrot*'MSDB'>0
|| _p:={? 1+_skrot='_' || '' || 'Sprawozdanie MSDB'?};
   ALG_PAR.fld_opt('PAR_ALL2','col_name="%1"'[_p],ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Kolumna MSDB',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Wiersz MSDB',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P5')
|? _skrot*'PLANW'>0
|| ALG_PAR.fld_opt('PAR_ALL2','col_name=Paragraf',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Status zatrudnienia',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P5')
|? _skrot*'PLANZ'>0
|| ALG_PAR.fld_opt('PAR_ALL2','col_name=Paragraf',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Status zatrudnienia',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P5')
|? _skrot='ML_SUM'
|| ALG_PAR.fld_opt('PAR_ALL2','col_name=Formuła',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Cdn.1',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Cdn.2',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Cdn.3',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Cdn.4',ALG_PAR,'P5')
|? _skrot='ML_RBNZ'
|| ALG_PAR.fld_opt('PAR_ALL2','col_name=Maska konta',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Waluta (symbol)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Typ rozrachunku',ALG_PAR,'P5')
|? _skrot='ML_RBNZR'
|| ALG_PAR.fld_opt('PAR_ALL2','col_name=Maska konta',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Waluta (symbol)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Typ rozrachunku',ALG_PAR,'P5')
|? _skrot='ML_RBRN'
|| ALG_PAR.fld_opt('PAR_ALL2','col_name=Maska konta',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Waluta (symbol)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Typ rozrachunku',ALG_PAR,'P5')
|? _skrot*'ML_NZ'
|| _p:={? 1+_skrot='_' || '' || 'Maska struktury'?};
   ALG_PAR.fld_opt('PAR_ALL2','col_name="%1"'[_p],ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Strona konta (Wn lub Ma)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P3');
   {? 1+_skrot<>'^'
   || ALG_PAR.fld_opt('PAR_ALL2','col_name=Waluta (symbol)',ALG_PAR,'P4');
      ALG_PAR.fld_opt('PAR_ALL2','col_name=Typ (prefix)',ALG_PAR,'P5')
   || ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P4');
      ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P5')
   ?}
|? _skrot*'BZPLAN'>0
|| ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Typ planu',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Poziom planu',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Maska planu',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Korekta',ALG_PAR,'P5')
|? _skrot='DL_NALEZ' | _skrot='DL_ZOBOW'
|| ALG_PAR.fld_opt('PAR_ALL2','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Waluta (symbol)',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P5')
|? (3+(~-_skrot)='VAT') | (3+(~-_skrot)='VAN')
|| ALG_PAR.fld_opt('PAR_ALL2','col_name=Klasa ewidencji VAT',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Grupa podatkowa',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Rejestr VAT',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P5')
|? _skrot='WYNIKF'
|| ALG_PAR.fld_opt('PAR_ALL2','col_name=Uwzględniać konto wyniku finansowego?',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Symbol konta "Wynik finansowy"',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Waluta (symbol)',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=Jednostka księgowa (skrót)',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P5')
|? _skrot='%POD.DOC'
|| ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P1');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P2');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P3');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P4');
   ALG_PAR.fld_opt('PAR_ALL2','col_name=',ALG_PAR,'P5')
?}

:Sign Version 2.0 jowisz:1048 2023/06/23 14:14:37 8c61775963ff635849fdf599fe30a695c9438ccf4c5f392ba1a011d1d2badd55c6785a32865342217445b3804f37a9b28fb7afd95bf6ffaaaa816d975847e4810722d38503223123563aef5a982133884eb0970ce31879aa21b3316346240c8aab5e6e17c184b5fa5f1add7d988b1179d64fe9589865e2cf03c717f40721a50e
