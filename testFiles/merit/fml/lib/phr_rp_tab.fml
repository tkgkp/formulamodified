:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: phr_rp_tab.fml
:: Utworzony: 09.03.2017
:: Autor: jaws
::======================================================================================================================
:: Zawartość: Formuły wyzwalaczy dla tabel obszarów PRE.
::======================================================================================================================


\rp_etap_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RP_ETAP.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('dok_addb','phr_tab',RP_ETAP) & exec('rp_etap_chk','phr_rp_tab')


\rp_etap_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RP_ETAP.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RP_ETAP*'PUTB|'
|| return(1)
?};
exec('dok_putb','phr_tab',RP_ETAP) & exec('rp_etap_chk','phr_rp_tab')


\rp_etap_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RP_ETAP.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
1


\rp_etap_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RP_ETAP.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_adda','phr_tab',RP_ETAP,_a);
~~


\rp_etap_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RP_ETAP.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_puta','phr_tab',RP_ETAP,_a);
~~


\rp_etap_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RP_ETAP.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_dela','phr_tab',_a);
~~


\rp_etap_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.42]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::   WE:
::   WY: 1 - rekord poprawny
::       0 - błędne dane
::  OLD: \rp_etoc_nn/zz_table.fml
::  OLD: \rp_etap_ck/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
: dozwolone wartości: P - początek, S - środek, Z - zakończenie
__CHK.record(RP_ETAP,,'ZZ_TYP','DOD_P')='' &
__CHK.in_set(RP_ETAP,'RODZAJ',,'P','S','Z')


\rp_etoc_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RP_ETOC.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('rp_etoc_modb','phr_rp_tab');

exec('dok_addb','phr_tab',RP_ETOC) & exec('rp_etoc_chk','phr_rp_tab')


\rp_etoc_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RP_ETOC.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RP_ETOC*'PUTB|'
|| return(1)
?};
exec('rp_etoc_modb','phr_rp_tab');

exec('dok_putb','phr_tab',RP_ETOC) & exec('rp_etoc_chk','phr_rp_tab')


\rp_etoc_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RP_ETOC.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
1


\rp_etoc_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RP_ETOC.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_etoc_aa/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? exec('dok_adda','phr_tab',RP_ETOC,_a)
|| exec('ank_rp_gen','phr_rp_tab',RP_ETOC.ZZ_LINK)
?};
~~


\rp_etoc_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RP_ETOC.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_puta','phr_tab',RP_ETOC,_a);
~~


\rp_etoc_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RP_ETOC.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_dela','phr_tab',_a);
~~


\rp_etoc_modb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Wywoływana z wyzwalaczy przed dołącz i popraw, przed przeprowadzeniem testów poprawności rekordu.
::  OLD: \rp_etoc_bw/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
RP_ETOC.DOD_OS:=RP_ETOC.DOD_P().OSOBA


\rp_etoc_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::  OLD: \rp_etoc_nn/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
__CHK.record(RP_ETOC,,'ZZ_TYP','DOD_P')=''


\rp_etze_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RP_ETZE.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('dok_addb','phr_tab',RP_ETZE) & exec('rp_etze_chk','phr_rp_tab')


\rp_etze_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RP_ETZE.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RP_ETZE*'PUTB|'
|| return(1)
?};
exec('dok_putb','phr_tab',RP_ETZE) & exec('rp_etze_chk','phr_rp_tab')


\rp_etze_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RP_ETZE.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
1


\rp_etze_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RP_ETZE.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_etze_aa/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? exec('dok_adda','phr_tab',RP_ETZE,_a)
:  utwórz formularze dołączonej ankiety
|| exec('ank_rp_gen','phr_rp_tab',RP_ETZE.ZZ_LINK)
?};
~~


\rp_etze_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RP_ETZE.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_puta','phr_tab',RP_ETZE,_a);
~~


\rp_etze_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RP_ETZE.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_dela','phr_tab',_a);
~~


\rp_etze_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::  OLD: \rp_etze_nn/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
__CHK.record(RP_ETZE,,'ZZ_LINK','ZZ_TYP','ZA_ZEST')=''


\rp_lok_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RP_LOK.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('dok_addb','phr_tab',RP_LOK) & exec('rp_lok_chk','phr_rp_tab')


\rp_lok_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RP_LOK.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RP_LOK*'PUTB|'
|| return(1)
?};
exec('dok_putb','phr_tab',RP_LOK) & exec('rp_lok_chk','phr_rp_tab')


\rp_lok_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RP_LOK.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
1


\rp_lok_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RP_LOK.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_adda','phr_tab',RP_LOK,_a);
~~


\rp_lok_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RP_LOK.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_puta','phr_tab',RP_LOK,_a);
~~


\rp_lok_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RP_LOK.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_dela','phr_tab',_a);
~~


\rp_lok_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::  OLD: \rp_lok_nn/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
__CHK.record(RP_LOK,,'ZZ_LINK','SLO_NAZ')=''


\rp_ofe_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RP_OFE.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('rp_ofe_modb','phr_rp_tab');

exec('dok_addb','phr_tab',RP_OFE) & exec('rp_ofe_chk','phr_rp_tab')


\rp_ofe_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RP_OFE.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RP_OFE*'PUTB|'
|| return(1)
?};
exec('rp_ofe_modb','phr_rp_tab');

exec('dok_putb','phr_tab',RP_OFE) & exec('rp_ofe_chk','phr_rp_tab')


\rp_ofe_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RP_OFE.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('set_null','#table',RP_ZAP,'RP_OFE',RP_OFE.ref()) &
exec('del_ndx','#table',RP_PROC,'RP_OFE',RP_OFE.ref()) &
exec('del_ndx','#table',RP_LOK,'UNIQUE',RP_OFE.NP_DOK,RP_OFE.ZZ_DOK) &
exec('del_ndx','#table',RPW_DEF,'UNIQUE',RP_OFE.NP_DOK,RP_OFE.ZZ_DOK)


\rp_ofe_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RP_OFE.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_adda','phr_tab',RP_OFE,_a);
~~


\rp_ofe_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RP_OFE.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_puta','phr_tab',RP_OFE,_a);
~~


\rp_ofe_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RP_OFE.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_dela','phr_tab',_a);
~~


\rp_ofe_modb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Wywoływana z wyzwalaczy przed dołącz i popraw, przed przeprowadzeniem testów poprawności rekordu.
::  OLD: \rp_ofe_bw/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? RP_OFE.TYTUL=''
|| RP_OFE.TYTUL:=RP_OFE.STN().ST
?};
1


\rp_ofe_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::  OLD: \rp_ofe_nn/zz_table.fml
::  OLD: \rp_ofe_ck/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? __CHK.record(RP_OFE,,'ID','STN','TYTUL','OD','STATUS','RODZAJ')<>''
|| 0
|? RP_OFE.DO<>date(0,0,0) & RP_OFE.DO<RP_OFE.OD
|| __CHK.err_msg('Podano niespójne daty publikacji oferty.'@);
   0
|| 1
?}


\rp_oset_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RP_OSET.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::  OLD: \rp_oset_aa/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
exec('rp_oset_modb','phr_rp_tab');

{? exec('dok_addb','phr_tab',RP_OSET) & exec('rp_oset_chk','phr_rp_tab')
|| exec('zz_ocena_add','phr_tab',RP_OSET,'ZZ_OCENA')
?}


\rp_oset_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RP_OSET.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RP_OSET*'PUTB|'
|| return(1)
?};
exec('rp_oset_modb','phr_rp_tab');

exec('dok_putb','phr_tab',RP_OSET) & exec('rp_oset_chk','phr_rp_tab')


\rp_oset_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RP_OSET.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::  OLD: \rp_oset_del/zz_link.fml
::----------------------------------------------------------------------------------------------------------------------
exec('set_null','#table',ZZ_OCENA,'ZZ_LINK',RP_OSET.ZZ_DOK) &
exec('del_ndx','#table',ZA_FORM,'ZZ_LINK',RP_OSET.NP_DOK,RP_OSET.ZZ_DOK) &
exec('del_ndx','#table',ZA_ZEST,'NAZWA',RP_OSET.NP_DOK,RP_OSET.ZZ_DOK)


\rp_oset_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RP_OSET.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_oset_aa/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? exec('dok_adda','phr_tab',RP_OSET,_a)
|| exec('rp_oset_moda','phr_rp_tab',RP_OSET.RP_PRET);
:  utwórz formularze ankiet oceny kandydata
   exec('ank_rp_gen','phr_rp_tab',RP_OSET.RP_PRET().ZZ_DOK)
?};
~~


\rp_oset_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RP_OSET.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_oset_ap/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? exec('dok_puta','phr_tab',RP_OSET,_a)
|| {? RP_OSET.WER_STAN<>bfld('WER_STAN')
   || exec('rp_oset_moda','phr_rp_tab',RP_OSET.RP_PRET)
   ?}
?};
~~


\rp_oset_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RP_OSET.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_oset_ad/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? exec('dok_dela','phr_tab',_a)
|| exec('zz_ocena_del','phr_tab','ZZ_OCENA');
   exec('rp_oset_moda','phr_rp_tab',bfld('RP_PRET'))
?};
~~


\rp_oset_modb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Wywoływana z wyzwalaczy przed dołącz i popraw, przed przeprowadzeniem testów poprawności rekordu.
::  OLD: \rp_oset_bw/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
RP_OSET.WER_OS:=RP_OSET.WER_P().OSOBA


\rp_oset_moda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Formuła dla wyzwalaczy po dołączeniu i po usunieciu.
::   WE: _a - wskazanie etapu procesu
::  OLD: \rp_oset_mod/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
RP_PRET.cntx_psh();
RP_PRET.clear();
{? RP_PRET.seek(_a)
|| RP_PRET.put()
?};
RP_PRET.cntx_pop()


\rp_oset_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::  OLD: \rp_oset_nn/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
__CHK.record(RP_OSET,,'RP_PRET','RP_OSOBA','WER_P')=''


\rp_osoba_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RP_OSOBA.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::  OLD: \rp_osoba_ba/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
exec('rp_osoba_modb','phr_rp_tab');

{? exec('dok_addb','phr_tab',RP_OSOBA) & exec('rp_osoba_chk','phr_rp_tab')
|| RP_OSOBA.DATA:=date();
   exec('zz_ocena_add','phr_tab',RP_OSOBA,'ZZ_OCENA')
?}


\rp_osoba_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RP_OSOBA.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::  OLD: \rp_osoba_bp/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RP_OSOBA*'PUTB|'
|| return(1)
?};
exec('rp_osoba_modb','phr_rp_tab');

{? ~exec('dok_putb','phr_tab',RP_OSOBA) | ~exec('rp_osoba_chk','phr_rp_tab')
|| return(0)
?};

{? RP_OSOBA.ZOSTAW<>'T' & RP_OSOBA.RP_PROC().WER_STAN().KOD='Z'
|| _none:=255*'?';
   RP_OSOBA.NAZWISKO:=_none;
   RP_OSOBA.RODOWE:=_none;
   RP_OSOBA.PIERWSZE:=_none;
   RP_OSOBA.DRUGIE:=_none;
   RP_OSOBA.TEL:=_none;
   RP_OSOBA.EMAIL:=_none;
   RP_OSOBA.KOD:=_none;
   RP_OSOBA.MIASTO:=_none;
   RP_OSOBA.ULICA:=_none;
   RP_OSOBA.DOM:=_none;
   RP_OSOBA.LOKAL:=_none;
   RP_OSOBA.DATA_UR:=date(0,0,0);
   RP_OSOBA.WIDOK:='N'
?};

1


\rp_osoba_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RP_OSOBA.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::  OLD: \rp_osoba_del/zz_link.fml
::----------------------------------------------------------------------------------------------------------------------
exec('set_null','#table',ZZ_OCENA,'ZZ_LINK',RP_OSOBA.ZZ_DOK) &
exec('del_ndx','#table',ZZ_OSOBA,'ZZ_LINK',RP_OSOBA.NP_DOK,RP_OSOBA.ZZ_DOK) &
exec('del_ndx','#table',RP_OSET,'FK_OSOBA',RP_OSOBA.ref()) &
exec('del_ndx','#table',RP_WOW,'OPIS',RP_OSOBA.ref()) &
exec('del_ndx','#table',ZA_ZEST,'NAZWA',RP_OSOBA.NP_DOK,RP_OSOBA.ZZ_DOK)


\rp_osoba_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RP_OSOBA.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_osoba_aa/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? ~exec('dok_adda','phr_tab',RP_OSOBA,_a)
|| return()
?};

exec('rp_wow_uzup','phr_rp_tab',RP_OSOBA.ref(),RP_OSOBA.RP_PROC().ZZ_DOK);

RP_PRET.cntx_psh();
RP_PRET.index('NUMER');
RP_PRET.prefix(RP_OSOBA.RP_PROC);
{? RP_PRET.first()
|| RP_OSET.cntx_psh();
   RP_OSET.clear();
   RP_OSET.blank();
   RP_OSET.RP_PRET:=RP_PRET.ref();
   RP_OSET.RP_OSOBA:=RP_OSOBA.ref();
   RP_OSET.WER_P:=RP_PRET.WER_P;
   RP_OSET.add();
   RP_OSET.cntx_pop()
?};
RP_PRET.cntx_pop();
~~


\rp_osoba_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RP_OSOBA.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_puta','phr_tab',RP_OSOBA,_a);
~~


\rp_osoba_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RP_OSOBA.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_osoba_ad/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? exec('dok_dela','phr_tab',_a)
|| exec('zz_ocena_del','phr_tab','ZZ_OCENA')
?};
~~


\rp_osoba_modb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Wywoływana z wyzwalaczy przed dołącz i popraw, przed przeprowadzeniem testów poprawności rekordu.
::  OLD: \rp_osoba_bw/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
RP_OSOBA.RP_OFE:=RP_OSOBA.RP_PROC().RP_OFE;
RP_OSOBA.STN:=RP_OSOBA.RP_PROC().RP_OFE().STN


\rp_osoba_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::  OLD: \rp_osoba_nn/zz_table.fml
::  OLD: \rp_osoba_ck/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? __CHK.record(RP_OSOBA,,'NAZWISKO','PIERWSZE','TEL','ZGODA','ZOSTAW','WIDOK')<>''
|| return(0)
?};
__CHK.in_set(RP_OSOBA,'ZGODA',,'T','N') &
__CHK.in_set(RP_OSOBA,'ZOSTAW',,'T','N') &
__CHK.in_set(RP_OSOBA,'WIDOK',,'T','N')


\rp_owym_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RP_OWYM.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('dok_addb','phr_tab',RP_OWYM) & exec('rp_owym_chk','phr_rp_tab')


\rp_owym_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RP_OWYM.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RP_OWYM*'PUTB|'
|| return(1)
?};
exec('dok_putb','phr_tab',RP_OWYM) & exec('rp_owym_chk','phr_rp_tab')


\rp_owym_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RP_OWYM.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
1


\rp_owym_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RP_OWYM.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_adda','phr_tab',RP_OWYM,_a);
~~


\rp_owym_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RP_OWYM.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_puta','phr_tab',RP_OWYM,_a);
~~


\rp_owym_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RP_OWYM.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_dela','phr_tab',_a);
~~


\rp_owym_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::  OLD: \rp_owym_nn/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
__CHK.record(RP_OWYM,,'RPW_POZ','ZA_TEST')<>''


\rp_pret_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RP_PRET.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('rp_pret_modb','phr_rp_tab');

exec('dok_addb','phr_tab',RP_PRET) & exec('rp_pret_chk','phr_rp_tab')


\rp_pret_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RP_PRET.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::  OLD: \rp_pret_bp/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RP_PRET*'PUTB|'
|| return(1)
?};
exec('rp_pret_modb','phr_rp_tab');

{? ~exec('dok_putb','phr_tab',RP_PRET) | ~exec('rp_pret_chk','phr_rp_tab')
|| return(0)
?};

_zak:=0;
RP_OSET.cntx_psh();
RP_OSET.index('OSOBA');
RP_OSET.prefix(RP_PRET.ref());
_loop:=RP_OSET.first();
RP_PRET.ILE:=RP_OSET.size();
{!
|? _loop
|! _zak+=(RP_OSET.WER_STAN().KOD<>'O');
   _loop:=RP_OSET.next()
!};
RP_OSET.cntx_pop();
RP_PRET.POSTEP:={? RP_PRET.ILE<>0 || (100*_zak/RP_PRET.ILE)$2 ?};
1


\rp_pret_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RP_PRET.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('del_ndx','#table',RP_OSET,'OSOBA',RP_PRET.ref()) &
exec('del_ndx','#table',RP_ETZE,'UNIQUE',RP_PRET.NP_DOK,RP_PRET.ZZ_DOK) &
exec('del_ndx','#table',RP_ETOC,'UNIQUE',RP_PRET.NP_DOK,RP_PRET.ZZ_DOK)


\rp_pret_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RP_PRET.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_pret_aa/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? exec('dok_adda','phr_tab',RP_PRET,_a)
|| exec('rp_pret_moda','phr_rp_tab',RP_PRET.RP_PROC)
?};
~~


\rp_pret_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RP_PRET.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_pret_ap/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? exec('dok_puta','phr_tab',RP_PRET,_a)
|| exec('rp_pret_moda','phr_rp_tab',RP_PRET.RP_PROC)
?};
~~


\rp_pret_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RP_PRET.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_pret_ad/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? exec('dok_dela','phr_tab',_a)
|| exec('rp_pret_moda','phr_rp_tab',bfld('RP_PROC'))
?};
~~


\rp_pret_modb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Wywoływana z wyzwalaczy przed dołącz i popraw, przed przeprowadzeniem testów poprawności rekordu.
::  OLD: \rp_pret_bw/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
RP_PRET.WER_OS:=RP_PRET.WER_P().OSOBA;
1


\rp_pret_moda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Wykorzystywana w wyzwalaczach do aktualizacji procesu rekrutacji.
::  OLD: \rp_pret_mod/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
RP_PROC.cntx_psh();
RP_PROC.clear();
{? RP_PROC.seek(_a)
|| RP_PROC.put()
?};
RP_PROC.cntx_pop();
~~


\rp_pret_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::  OLD: \rp_pret_nn/zz_table.fml
::  OLD: \rp_pret_ck/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
__CHK.record(RP_PRET,,'RP_PROC','RP_ETAP','WER_P','WER_STAN')<>'' &
{? RP_PRET.PLAN_DO<RP_PRET.PLAN_OD
|| __CHK.err_msg('Podano niespójny planowany okres przeprowadzenia rekrutacji.'@);
   0
|? RP_PRET.OD<>date(0,0,0) & RP_PRET.DO<>date(0,0,0) & RP_PRET.DO<RP_PRET.OD
|| __CHK.err_msg('Podano niespójne daty przeprowadzenia rekrutacji.'@);
   0
|| 1
?}


\rp_proc_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RP_PROC.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('dok_addb','phr_tab',RP_PROC) & exec('rp_proc_chk','phr_rp_tab')


\rp_proc_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RP_PROC.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::  OLD: \rp_proc_bp/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RP_PROC*'PUTB|'
|| return(1)
?};
{? ~exec('dok_putb','phr_tab',RP_PROC) | ~exec('rp_proc_chk','phr_rp_tab')
|| return(0)
?};

_zak:=_wsz:=0;
RP_PRET.cntx_psh;
RP_PRET.index('NUMER');
RP_PRET.prefix(RP_PROC.ref());
_loop:=RP_PRET.first();
_wsz:=RP_PRET.size();
{!
|? _loop
|! _zak+=(RP_PRET.WER_STAN().KOD='Z');
   _loop:=RP_PRET.next()
!};
RP_PRET.cntx_pop();
RP_PROC.POSTEP:={? _wsz<>0 || (100*_zak/_wsz)$2 ?};
1


\rp_proc_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RP_PROC.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::  OLD: \rp_proc_del/zz_link.fml
::----------------------------------------------------------------------------------------------------------------------
exec('set_null','#table',RP_ZAP,'RP_PROC',RP_PROC.ref()) &
exec('del_ndx','#table',RP_PRET,'NUMER',RP_PROC.ref()) &
exec('del_ndx','#table',RP_OSOBA,'OSOBA',RP_PROC.ref()) &
exec('del_ndx','#table',RP_LOK,'UNIQUE',RP_PROC.NP_DOK,RP_PROC.ZZ_DOK) &
exec('del_ndx','#table',RPW_DEF,'UNIQUE',RP_PROC.NP_DOK,RP_PROC.ZZ_DOK) &
exec('del_ndx','#table',RPW_POZ,'LP',RP_PROC.NP_DOK,RP_PROC.ZZ_DOK) &
exec('del_ndx','#table',ZA_WAR,'UNIQUE',RP_PROC.NP_DOK,RP_PROC.ZZ_DOK) &
exec('del_ndx','#table',ZA_ZEST,'NAZWA',RP_PROC.NP_DOK,RP_PROC.ZZ_DOK)


\rp_proc_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RP_PROC.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_proc_aa/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? ~exec('dok_adda','phr_tab',RP_PROC,_a)
|| return(0)
?};

: przypisz etapy początkowy i końcowy
RP_ETAP.cntx_psh();
RP_ETAP.index('NUMER');
RP_ETAP.prefix();
RP_PRET.cntx_psh();
RP_PRET.index('NUMER');
RP_PRET.prefix(RP_PROC.ref);

_loop:=RP_ETAP.first();
{!
|? _loop
|! {? RP_ETAP.RODZAJ<>'S'
   || RP_PRET.blank();
      RP_PRET.RP_PROC:=RP_PROC.ref();
      RP_PRET.RP_ETAP:=RP_ETAP.ref();
      RP_PRET.WER_P:=RP_PROC.WER_P;
      RP_PRET.add()
   ?};
   _loop:=RP_ETAP.next()
!};

RP_PRET.cntx_pop();
RP_ETAP.cntx_pop();

: przypisz pozycje wymagań
RPW_DEF.cntx_psh();
RPW_DEF.index('WYMOG');
RPW_DEF.prefix(RP_PROC.RP_OFE().ZZ_DOK);
_loop:=RPW_DEF.first();
_lp:=0;
{!
|? _loop
|! RPW_POZ.cntx_psh();
   RPW_POZ.index('LP');
   RPW_POZ.prefix(RPW_DEF.ZZ_DOK);
   _loop:=RPW_POZ.first();
   {!
   |? _loop
   |! RPW_POZ.ZZ_DOK:=null;
      RPW_POZ.ZZ_LINK:=RP_PROC.ZZ_DOK;
      RPW_POZ.LP:=(_lp+=1);
      RPW_POZ.cntx_psh();
      RPW_POZ.clear();
      RPW_POZ.add();
      RPW_POZ.cntx_pop();
      _loop:=RPW_POZ.next()
   !};
   RPW_POZ.cntx_pop();
   _loop:=RPW_DEF.next()
!};
RPW_DEF.cntx_pop();
~~


\rp_proc_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RP_PROC.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_proc_ap/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? ~exec('dok_puta','phr_tab',RP_PROC,_a)
|| return()
?};

{? RP_PROC.WER_STAN<>bfld('WER_STAN') & RP_PROC.WER_STAN().KOD='Z'
|| _stan:=exec('kod','ext_slo','RP_PRET','Z');
   RP_PRET.cntx_psh();
   RP_PRET.index('NUMER');
   RP_PRET.prefix(RP_PROC.ref());
   _loop:=RP_PRET.first();
   {!
   |? _loop
   |! {? RP_PRET.WER_STAN<>_stan
      || RP_PRET.WER_STAN:=_stan;
         RP_PRET.put()
      ?};
      _loop:=RP_PRET.next()
   !};
   _wer:=exec('kod','ext_slo','RP_OSET','N');
:: !!! powiadomienia dla uczestników procesu
:: _EMAIL:=exec('mail_tab','zz_mail');
:: _EMAIL.add();
   RP_PRET.cntx_pop();
   RP_OSET.cntx_psh();
   RP_OSET.index('FK_OSOBA');
   RP_OSOBA.cntx_psh();
   RP_OSOBA.index('RP_PROC');
   RP_OSOBA.prefix(RP_PROC.ref());
   _loop:=RP_OSOBA.first();
   {!
   |? _loop
   |! {? RP_OSOBA.WYSLANO<>'N' & RP_OSOBA.EMAIL<>''
      ||
::       _EMAIL[1]:=RP_OSOBA.EMAIL;
::       _EMAIL.put();
::       exec('add_eml','skid_eml','RP_ODMOWA',_EMAIL,,,1);
         RP_OSOBA.WYSLANO:='T'
      ?};
      RP_OSOBA.put();
      RP_OSET.prefix(RP_OSOBA.ref());
      _loop:=RP_OSET.first();
      {!
      |? _loop
      |! _kod:=RP_OSET.WER_STAN().KOD;
         {? _kod<>'T' & _kod<>'N'
         || RP_OSET.WER_STAN:=_wer;
            RP_OSET.put()
         ?};
         _loop:=RP_OSET.next()
      !};
      _loop:=RP_OSOBA.next()
   !};
   RP_OSOBA.cntx_pop();
   RP_OSET.cntx_pop()
:: obj_del(_EMAIL)
?};
~~


\rp_proc_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RP_PROC.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_dela','phr_tab',_a);
~~


\rp_proc_modb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Wywoływana z wyzwalaczy przed dołącz i popraw, przed przeprowadzeniem testów poprawności rekordu.
::  OLD: \rp_proc_bw/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
RP_PROC.WER_OS:=RP_PROC.WER_P().OSOBA


\rp_proc_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::  OLD: \rp_proc_nn/zz_table.fml
::  OLD: \rp_proc_ck/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
__CHK.record(RP_PROC,,'RP_OFE','WER_P','WER_STAN')='' &
{? RP_PROC.PLAN_DO<RP_PROC.PLAN_OD
|| __CHK.err_msg('Podano niespójny planowany okres przeprowadzenia rekrutacji.'@);
   0
|? RP_PROC.OD<>date(0,0,0) & RP_PROC.DO<>date(0,0,0) & RP_PROC.DO<RP_PROC.OD
|| __CHK.err_msg('Podano niespójne daty przeprowadzenia rekrutacji.'@);
   0
|| 1
?}


\rp_wow_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RP_WOW.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? exec('dok_addb','phr_tab',RP_WOW) & exec('rp_wow_chk','phr_rp_tab')
|| exec('zz_ocena_add','phr_tab',RP_WOW,'ZZ_OCENA')
?}


\rp_wow_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RP_WOW.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RP_WOW*'PUTB|'
|| return(1)
?};
exec('dok_putb','phr_tab',RP_WOW) & exec('rp_wow_chk','phr_rp_tab')


\rp_wow_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RP_WOW.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
1


\rp_wow_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RP_WOW.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_adda','phr_tab',RP_WOW,_a);
~~


\rp_wow_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RP_WOW.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_puta','phr_tab',RP_WOW,_a);
~~


\rp_wow_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RP_WOW.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('dok_dela','phr_tab',_a)
|| exec('zz_ocena_del','phr_tab','ZZ_OCENA')
?};
~~


\rp_wow_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::  OLD: \rp_wow_nn/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
__CHK.record(RP_WOW,,'RP_OSOBA','RPW_POZ')=''


\rp_zap_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RP_ZAP.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('rp_zap_modb','phr_rp_tab');

exec('dok_addb','phr_tab',RP_ZAP) & exec('rp_zap_chk','phr_rp_tab')


\rp_zap_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RP_ZAP.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RP_ZAP*'PUTB|'
|| return(1)
?};
exec('rp_zap_modb','phr_rp_tab');

exec('dok_putb','phr_tab',RP_ZAP) & exec('rp_zap_chk','phr_rp_tab')


\rp_zap_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RP_ZAP.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('del_ndx','#table',RPW_DEF,'UNIQUE',RP_ZAP.NP_DOK,RP_ZAP.ZZ_DOK) &
exec('del_ndx','#table',RP_LOK,'UNIQUE',RP_ZAP.NP_DOK,RP_ZAP.ZZ_DOK)


\rp_zap_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RP_ZAP.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_zap_aa/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? ~exec('dok_adda','phr_tab',RP_ZAP,_a)
|| return()
?};

exec('rp_zap_moda','phr_rp_tab');

: kopiuj wymagania właściwe dla stanowiska w jednostce
exec('kopiuj_wym_str','phr_dane',RP_ZAP.ZZ_DOK,RP_ZAP.UD_SKL,RP_ZAP.STN);

: uzupełnij lokalizacje na podstawie jednostki org.
RP_LOK.cntx_psh();
RP_LOK.clear();
UD_LOK.cntx_psh();
UD_LOK.index('NAZWA');
UD_LOK.prefix(RP_ZAP.UD_SKL);
_loop:=UD_LOK.first();
{!
|? _loop
|! RP_LOK.blank();
   RP_LOK.ZZ_LINK:=RP_ZAP.ZZ_DOK;
   RP_LOK.SLO_NAZ:=UD_LOK.SLO_NAZ;
   RP_LOK.add();
   _loop:=UD_LOK.next()
!};
UD_LOK.cntx_pop();
RP_LOK.cntx_pop();

{? _a.ZP_WZP
|| ZP_WZP.cntx_psh();
   ZP_WZP.clear();
   _a.ZP_WZP();
   ZP_WZP.put();
   ZP_WZP.cntx_pop()
?};
~~


\rp_zap_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RP_ZAP.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? ~exec('dok_puta','phr_tab',RP_ZAP,_a)
|| return()
?};

exec('rp_zap_moda','phr_rp_tab');
~~


\rp_zap_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RP_ZAP.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::  OLD: \rp_zap_ad/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? ~exec('dok_dela','phr_tab',_a)
|| return()
?};

{? bfld('ZP_WZP')<>null
|| ZP_WZP.cntx_psh();
   ZP_WZP.clear();
   ZP_WZP.seek(bfld('ZP_WZP'));
   ZP_WZP.put();
   ZP_WZP.cntx_pop()
?};
~~


\rp_zap_modb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Wywoływana z wyzwalaczy przed dołącz i popraw, przed przeprowadzeniem testów poprawności rekordu.
::  OLD: \rp_zap_bw/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? RP_ZAP.ZP_WZP<>null
|| ZP_WZP.cntx_psh();
   RP_ZAP.ZP_POZ:=RP_ZAP.ZP_WZP().ZP_POZ;
   ZP_WZP.cntx_pop()
?};
{? RP_ZAP.ZP_POZ<>null
|| ZP_POZ.cntx_psh();
   RP_ZAP.ZP_OKR:=RP_ZAP.ZP_POZ().ZP_OKR;
   ZP_POZ.cntx_pop();
   exec('rp_zap_prac','phr_rp_tab')
|| exec('rp_zap_plan','phr_rp_tab')
?};

: ustal stan przeglądania
{? RP_ZAP.AKC_STAN='N'
|| RP_ZAP.WER_STAN:='N';
   RP_ZAP.OBIEG:='N'
|? RP_ZAP.AKC_STAN='T'
|| RP_ZAP.OBIEG:='N'
|? RP_ZAP.ZAP_STAN='?' | RP_ZAP.AKC_STAN='?'
|| RP_ZAP.WER_STAN:='?';
   RP_ZAP.OBIEG:='T'
?};

: wylicz wymiar zatrudnienia
RP_ZAP.WY:={? RP_ZAP.WYM || RP_ZAP.WYL/RP_ZAP.WYM ?}$3;

{? RP_ZAP.AKC_WYM='?'
|| {? RP_ZAP.ZP_POZ=null | RP_ZAP.AKC_P=null
   || RP_ZAP.AKC_WYM:='T'
   || ZP_POZ.cntx_psh();
      {? RP_ZAP.ZP_POZ().AKC_P=RP_ZAP.ZAP_P
      || RP_ZAP.AKC_WYM:='N'
      || {? ZP_POZ.SUM_OS+RP_ZAP.ILE<=0 & ZP_POZ.SUM_ET+(RP_ZAP.ILE*RP_ZAP.WY)<=0
         || RP_ZAP.AKC_WYM:='N'
         || RP_ZAP.AKC_WYM:='T'
         ?}
      ?};
      ZP_POZ.cntx_pop()
   ?}
?};
: ustal status akceptacji zapotrzebowania
{? RP_ZAP.AKC_WYM='N' & RP_ZAP.ZAP_STAN='T'
|| RP_ZAP.AKC_STAN:='T'
?};

: przypisz dane osobowe
P.cntx_psh();
RP_ZAP.ZAP_OS:=RP_ZAP.ZAP_P().OSOBA;
RP_ZAP.AKC_OS:=RP_ZAP.AKC_P().OSOBA;
RP_ZAP.WER_OS:=RP_ZAP.WER_P().OSOBA;
P.cntx_pop();

~~


\rp_zap_moda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: GS [12.30]
:: OPIS: Wywoływana z wyzwalaczy po dołącz i popraw.
::  OLD: \rp_zap_aw/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? RP_ZAP.RP_OFE<>null
|| RP_OFE.cntx_psh();
   exec('kopiuj_wym','phr_dane',RP_ZAP.RP_OFE().ZZ_DOK,RP_ZAP.ZZ_DOK);
   exec('kopiuj_lok','phr_dane',RP_ZAP.RP_OFE().ZZ_DOK,RP_ZAP.ZZ_DOK);
   RP_OFE.cntx_pop()
?};
{? RP_ZAP.RP_PROC<>null
|| RP_PROC.cntx_psh();
   exec('kopiuj_wym','phr_dane',RP_ZAP.RP_PROC().ZZ_DOK,RP_ZAP.ZZ_DOK);
   exec('kopiuj_lok','phr_dane',RP_ZAP.RP_PROC().ZZ_DOK,RP_ZAP.ZZ_DOK);
   RP_PROC.cntx_pop()
?}


\rp_zap_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: GS [12.30]
:: OPIS: Sprawdza wypelnienie wymaganych pol. Wykorzystywana w wyzwalaczach przed dolacz i popraw.
::  OLD: \rp_zap_nn/zz_table.fml
::  OLD: \rp_zap_ck/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
_zd:=date(0,0,0);
__CHK.record(RP_ZAP,,'OD_DNIA','UD_SKL','STN','WYL','WYM','ILE','ZAP_P','ZAP_STAN','AKC_WYM')='' &
{? RP_ZAP.AKC_WYM='T' || __CHK.record(RP_ZAP,,'AKC_P')='' || 1 ?} &
{? RP_ZAP.ZP_WZP<>null & (RP_ZAP.ZP_WZP().ZAT_OS<RP_ZAP.ILE | RP_ZAP.ZP_WZP().ZAT_ET<(RP_ZAP.WY*RP_ZAP.ILE))
|| __CHK.err_msg('Przekroczono wartości określone we wniosku zmiany planu.'@);
   0
|? RP_ZAP.WYL<0
|| __CHK.err_msg('Licznik wymiaru zatrudnienia nie może być mniejszy od zera.'@);
   0
|? RP_ZAP.WYM<0
|| __CHK.err_msg('Mianownik wymiaru zatrudnienia nie może być mniejszy od zera.'@);
   0
|? RP_ZAP.ILE<0
|| __CHK.err_msg('Liczba pracowników nie może być mniejszy od zera.'@);
   0
|? RP_ZAP.WER_DATA<>_zd & RP_ZAP.WER_DATA<RP_ZAP.ZAP_DATA
|| __CHK.err_msg('Data weryfikacji nie może być wcześniejsza od daty zgłoszenia.'@);
   0
|? RP_ZAP.AKC_DATA<>_zd & RP_ZAP.AKC_DATA<RP_ZAP.ZAP_DATA
|| __CHK.err_msg('Data akceptacji nie może być wcześniejsza od daty zgłoszenia.'@);
   0
|| 1
?}


\rp_zap_plan
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Ustala pozycje planu zatrudnienia dla zapotrzebowania
::  OLD: \rp_zap_plan/zz_data.fml
::----------------------------------------------------------------------------------------------------------------------
{? RP_ZAP.UD_SKL=null | RP_ZAP.STN=null
|| return()
?};

ZP_POZ.cntx_psh();
ZP_POZ.index('STRORG');
ZP_POZ.prefix(RP_ZAP.UD_SKL,RP_ZAP.STN);
{? ZP_POZ.find_le(RP_ZAP.OD_DNIA) & RP_ZAP.OD_DNIA<=ZP_POZ.ZP_OKR().OKRES_DO
|| RP_ZAP.ZP_OKR:=ZP_POZ.ZP_OKR;
   RP_ZAP.ZP_POZ:=ZP_POZ.ref();
   exec('rp_zap_prac','phr_rp_tab')
|| RP_ZAP.ZP_POZ:=null;
   RP_ZAP.ZP_WZP:=null;
   {? RP_ZAP.ZP_OKR=null
   || ZP_OKR.cntx_psh();
      ZP_OKR.index('OKRES_OD');
      ZP_OKR.prefix();
      {? ZP_OKR.find_le(RP_ZAP.OD_DNIA) & RP_ZAP.OD_DNIA<=ZP_OKR.OKRES_DO
      || RP_ZAP.ZP_OKR:=ZP_OKR.ref()
      ?};
      ZP_OKR.cntx_pop()
   ?}
?};
ZP_POZ.cntx_pop()


\rp_zap_prac
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Ustala pracowników i osoby odpowiedzialne za edycję i weryfikację zapotrzebowania
::  OLD: \rp_zap_prac/zz_data.fml
::----------------------------------------------------------------------------------------------------------------------
{? RP_ZAP.ZP_POZ=null
|| return
?};
{? RP_ZAP.ZAP_P=null
|| RP_ZAP.ZAP_P:=ZP_POZ.RED_P;
   RP_ZAP.ZAP_OS:=RP_ZAP.ZAP_P().OSOBA
?};
{? RP_ZAP.AKC_P=null
|| RP_ZAP.AKC_P:=ZP_POZ.AKC_P;
   RP_ZAP.AKC_OS:=RP_ZAP.AKC_P().OSOBA
?}


\ank_rp_gen
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Uzupełnia formularze ankiety w module rekrutacji
::   WE: _a - wskazanie na dokument etapu procesu
::  OLD: \ank_rp_gen/zz_data.fml
::----------------------------------------------------------------------------------------------------------------------
RP_PRET.cntx_psh();
RP_PRET.clear();
RP_PRET.index('ZZ_DOK');
{? ~RP_PRET.find_key(ref_name(_a),_a)
|| RP_PRET.cntx_pop();
   return()
?};

RP_ETZE.cntx_psh();
RP_ETZE.index('NAZWA');
RP_ETZE.prefix(ref_name(RP_PRET.ZZ_DOK),RP_PRET.ZZ_DOK);
: przeglądaj ankiety etapu
_loop:=RP_ETZE.first();
{!
|? _loop
|! RP_ETOC.cntx_psh();
   RP_ETOC.index('UNIQUE');
   RP_ETOC.prefix(ref_name(RP_PRET.ZZ_DOK),RP_PRET.ZZ_DOK,RP_ETZE.ZZ_TYP);
:  przeglądaj oceniających w etapie
   _loop:=RP_ETOC.first();
   {!
   |? _loop
   |! RP_OSET.cntx_psh();
      RP_OSET.index('OSOBA');
      RP_OSET.prefix(RP_PRET.ref());
:     przeglądaj kandydatów w etapie
      _loop:=RP_OSET.first();
      {!
      |? _loop
      |! exec('ank_rp_form','phr_rp_tab',RP_ETZE.ZA_ZEST,RP_OSET.ref(),RP_ETOC.DOD_P);
         _loop:=RP_OSET.next()
      !};
      RP_OSET.cntx_pop();
      _loop:=RP_ETOC.next()
   !};
   RP_ETOC.cntx_pop();
   _loop:=RP_ETZE.next()
!};
RP_ETZE.cntx_pop();
RP_PRET.cntx_pop();
~~


\ank_rp_form
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Tworzy formularz oceny kandydata
::   WE: _a - wskazanie na ankietę (ZA_ZEST)
::       _b - wskazanie na kandydata na etapie (RP_OSET)
::       _c - wskazanie na oceniającego (P)
::  OLD: \ank_rp_form/zz_data.fml
::----------------------------------------------------------------------------------------------------------------------
ZA_ZEST.cntx_psh();
ZA_ZEST.prefix();
RP_OSET.cntx_psh();
RP_OSET.prefix();
P.cntx_psh();
P.prefix();

{? ~ZA_ZEST.seek(_a) | ~RP_OSET.seek(_b) | ~P.seek(_c)
|| P.cntx_pop();
   RP_OSET.cntx_pop();
   ZA_ZEST.cntx_pop();
   return()
?};

RP_OSET.RP_OSOBA();

:: !!! obsługa powiadomień, tu i poniżej
:: _EMAIL:=exec('mail_tab','zz_mail');
:: _EMAIL.add();
:: I_USERS.cntx_psh();
:: I_USERS.index('OSOBA');
:: I_USERS.prefix();

_kto:=exec('czy_osoba','phr_dane',P,1);
_kogo:=exec('czy_osoba','phr_dane',RP_OSOBA,1);

ZA_FORM.cntx_psh();
ZA_FORM.clear();
ZA_FORM.blank(1);
ZA_FORM.ZZ_LINK:=RP_OSET.ZZ_DOK;
ZA_FORM.ZA_ZEST:=ZA_ZEST.ref();
ZA_FORM.ZZ_KTO:=_kto;
ZA_FORM.ZZ_KOGO:=_kogo;
{? ~ZA_FORM.find_rec()
|| ZA_FORM.blank();
   ZA_FORM.ZZ_LINK:=RP_OSET.ZZ_DOK;
   ZA_FORM.ZA_ZEST:=ZA_ZEST.ref();
   ZA_FORM.ZZ_KTO:=_kto;
   ZA_FORM.ZZ_KOGO:=_kogo;
   ZA_FORM.DRUK:='T';
   ZA_FORM.add()
:: {? I_USERS.find_key(P.OSOBA) & I_USERS.EMAIL<>''
:: || _EMAIL[1]:=I_USERS.EMAIL;
::    _EMAIL.put;
::    ZA_FORM.DRUK:='N'
:: || ZA_FORM.DRUK:='T'
:: ?};
:: {? ZA_FORM.add() & _EMAIL[1]<>''
:: || exec('add_eml','skid_eml','ANKIETA',_EMAIL,,,1)
:: ?}
?};
ZA_FORM.cntx_pop();

:: I_USERS.cntx_pop();
P.cntx_pop();
RP_OSET.cntx_pop();
ZA_ZEST.cntx_pop();
~~


\rp_wow_uzup
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Uzupełnia zawartość tabeli wartości oceny wymagań
::   WE: _a - wskazanie kandydata
::       _b - wskazanie dokument procesu
::  OLD: \rp_wow_uzup/zz_data.fml
::----------------------------------------------------------------------------------------------------------------------
RP_WOW.cntx_psh();
RP_WOW.index('RPW_POZ');
RP_WOW.prefix(_a);
RPW_POZ.cntx_psh();
RPW_POZ.index('LP');
RPW_POZ.prefix(_b);

_loop:=RPW_POZ.first();
{!
|? _loop
|! {? ~RP_WOW.find_key(RPW_POZ.ref())
   || RP_WOW.blank(1);
      RP_WOW.RP_OSOBA:=_a;
      RP_WOW.RPW_POZ:=RPW_POZ.ref();
      RP_WOW.add()
   ?};
   _loop:=RPW_POZ.next()
!};

RPW_POZ.cntx_pop();
RP_WOW.cntx_pop()


\rpw_def_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RPW_DEF.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('dok_addb','phr_tab',RPW_DEF) & exec('rpw_def_chk','phr_rp_tab')


\rpw_def_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RPW_DEF.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RPW_DEF*'PUTB|'
|| return(1)
?};
exec('dok_putb','phr_tab',RPW_DEF) & exec('rpw_def_chk','phr_rp_tab')


\rpw_def_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RPW_DEF.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::  OLD: \rpw_def_del/zz_link.fml
::----------------------------------------------------------------------------------------------------------------------
exec('del_ndx','#table',RPW_POZ,'LP',RPW_DEF.NP_DOK,RPW_DEF.ZZ_DOK)


\rpw_def_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RPW_DEF.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_adda','phr_tab',RPW_DEF,_a);
~~


\rpw_def_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RPW_DEF.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_puta','phr_tab',RPW_DEF,_a);
~~


\rpw_def_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RPW_DEF.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_dela','phr_tab',_a);
~~


\rpw_def_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::  OLD: \rpw_def_nn/zz_table.fml
::  OLD: \rpw_def_ck/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
__CHK.record(RPW_DEF,,'ZZ_LINK','RPW_TYP','TYTUL')='' &
__CHK.in_set(RPW_DEF,'TYTUL',,'T','N')


\rpw_poz_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RPW_POZ.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('dok_addb','phr_tab',RPW_POZ) & exec('rpw_poz_chk','phr_rp_tab')


\rpw_poz_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RPW_POZ.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RPW_POZ*'PUTB|'
|| return(1)
?};
exec('dok_putb','phr_tab',RPW_POZ) & exec('rpw_poz_chk','phr_rp_tab')


\rpw_poz_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RPW_POZ.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::  OLD: \rpw_poz_del/zz_link.fml
::----------------------------------------------------------------------------------------------------------------------
exec('del_ndx','#table',RP_WOW,'UNIQUE',RPW_POZ.ref()) &
exec('del_ndx','#table',RP_OWYM,'TRESC',RPW_POZ.ref())


\rpw_poz_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RPW_POZ.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('dok_adda','phr_tab',RPW_POZ,_a)
|| exec('rpw_poz_moda','phr_rp_tab')
?};
~~


\rpw_poz_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RPW_POZ.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
{? exec('dok_puta','phr_tab',RPW_POZ,_a)
|| exec('rpw_poz_moda','phr_rp_tab')
?};
~~


\rpw_poz_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RPW_POZ.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_dela','phr_tab',_a);
~~


\rpw_poz_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::  OLD: \rpw_poz_nn/zz_table.fml
::  OLD: \rpw_poz_ck/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
__CHK.record(RPW_POZ,,'ZZ_LINK','RODZAJ','OPIS','NADPISZ')='' &
{? RPW_POZ.RODZAJ='ZZ_KOMP' || __CHK.record(RPW_POZ,,'ZZ_KOMP')=''
|? RPW_POZ.RODZAJ='ZZ_STAN' || __CHK.record(RPW_POZ,,'ZZ_STAN')=''
|| 1
?} &
__CHK.in_set(RPW_POZ,'NADPISZ',,'T','N') &
__CHK.in_set(RPW_POZ,'RODZAJ',,'RPW_POZ','ZZ_KOMP','ZZ_STAN')


\rpw_poz_moda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Wywoływana z wyzwalaczy po dołącz i popraw.
::  OLD: \rpw_poz_aw/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? RPW_POZ.NADPISZ='T' & RPW_POZ.RODZAJ<>'ZZ_STAN'
|| _old:=RPW_POZ.memo_txt(0,1,'TRESC');
   {? RPW_POZ.OPIS<>_old
   || RPW_POZ.memo_set(RPW_POZ.OPIS,'TRESC');
      RPW_POZ.memo_put()
   ?}
?};
~~


\rpw_stn_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RPW_STN.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('rpw_stn_modb','phr_rp_tab');

exec('dok_addb','phr_tab',RPW_STN) & exec('rpw_stn_chk','phr_rp_tab')


\rpw_stn_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RPW_STN.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RPW_STN*'PUTB|'
|| return(1)
?};
exec('rpw_stn_modb','phr_rp_tab');

exec('dok_putb','phr_tab',RPW_STN) & exec('rpw_stn_chk','phr_rp_tab')


\rpw_stn_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RPW_STN.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::  OLD: \rpw_stn_del/zz_link.fml
::----------------------------------------------------------------------------------------------------------------------
exec('del_ndx','#table',RPW_STN,'OPIS',#RPW_STN.ref()) &
exec('del_ndx','#table',RPW_DEF,'LP',RPW_STN.NP_DOK,RPW_STN.ZZ_DOK)


\rpw_stn_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RPW_STN.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_adda','phr_tab',RPW_STN,_a);
~~


\rpw_stn_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RPW_STN.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_puta','phr_tab',RPW_STN,_a);
~~


\rpw_stn_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RPW_STN.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_dela','phr_tab',_a);
~~


\rpw_stn_modb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Wywoływana z wyzwalaczy przed dołącz i popraw.
::  OLD: \rpw_stn_bw/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
: ustawienie opisu wymagan
RPW_STN.OPIS:=
   {? RPW_STN.RODZAJ='UD_SKL'
   || RPW_STN.UD_SKL().SYMBOL
   |? RPW_STN.RODZAJ='STN'
   || RPW_STN.STN().ST
   || ''
   ?};

: ustalenie jednostki dla stanowiska
{? RPW_STN.RPW_STN & RPW_STN.RODZAJ='STN'
|| RPW_STN.cntx_psh();
   RPW_STN.clear();
   _skl:=null;
   {? RPW_STN.seek(RPW_STN.RPW_STN,)
   || _skl:=RPW_STN.UD_SKL
   ?};
   RPW_STN.cntx_pop();
   RPW_STN.UD_SKL:=_skl
?}


\rpw_stn_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypelnienie wymaganych pol. Wykorzystywana w wyzwalaczach przed dolacz i popraw.
::  OLD: \rpw_stn_nn/zz_table.fml
::  OLD: \rpw_stn_ck/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
{? __CHK.record(RPW_STN,,'OPIS','RODZAJ','UD_SKL')<>''
|| return(0)
?};
{? RPW_STN.RODZAJ='STN'
|| {? __CHK.record(RPW_STN,,'STN')<>''
   || return(0)
   ?}
?};
{? ~__CHK.in_set(RPW_STN,'RODZAJ',,'UD_SKL','STN')
|| return(0)
?};
_test:=1;
: sprawdzenie spójności logicznej
: stanowiska można "podpiąć" tylko do jednostek,
: jednostki organizacyjne tylko do jednostek
{? RPW_STN.RPW_STN
|| RPW_STN.cntx_psh();
   RPW_STN.clear();
   {? RPW_STN.seek(RPW_STN.RPW_STN,)
   || _rodzaj:=RPW_STN.RODZAJ;
      RPW_STN.cntx_pop();
      _test:=0;
      {? RPW_STN.RODZAJ='UD_SKL' & RPW_STN.RODZAJ<>_rodzaj
      || undo('Jednostka organizacyjna musi być przypisana do innej jednostki organizacyjnej.'@)
      |? RPW_STN.RODZAJ='STN' & _rodzaj<>'UD_SKL'
      || undo('Stanowisko musi być przypisane do jednostki organizacyjnej.'@)
      || _test:=1
      ?}
   || RPW_STN.cntx_pop()
   ?}
?};
_test


\rpw_typ_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz przed" tabeli RPW_TYP.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('dok_addb','phr_tab',RPW_TYP) & exec('rpw_typ_chk','phr_rp_tab')


\rpw_typ_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw przed" tabeli RPW_TYP.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
{? TRIG_OFF.RPW_TYP*'PUTB|'
|| return(1)
?};
exec('dok_putb','phr_tab',RPW_TYP) & exec('rpw_typ_chk','phr_rp_tab')


\rpw_typ_delb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń przed" tabeli RPW_TYP.
::   WE:
::   WY: zgodna ze specyfikacją narzędzi
::  OLD: \rpw_typ_del/zz_link.fml
::----------------------------------------------------------------------------------------------------------------------
exec('del_tmp','#table',RPW_DEF,'RPW_TYP',RPW_DEF.ref())


\rpw_typ_adda
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "dołącz po" tabeli RPW_TYP.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_adda','phr_tab',RPW_TYP,_a);
~~


\rpw_typ_puta
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "popraw po" tabeli RPW_TYP.
::   WE: zgodne ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_puta','phr_tab',RPW_TYP,_a);
~~


\rpw_typ_dela
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [17.14]
:: OPIS: Formuła wyzwalacza "usuń po" tabeli RPW_TYP.
::   WE: zgodna ze specyfikacją narzędzi
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('dok_dela','phr_tab',_a);
~~


\rpw_typ_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [12.30]
:: OPIS: Sprawdza wypelnienie wymaganych pol. Wykorzystywana w wyzwalaczach przed dolacz i popraw.
::  OLD: \rpw_typ_nn/zz_table.fml
::  OLD: \rpw_typ_ck/zz_table.fml
::----------------------------------------------------------------------------------------------------------------------
__CHK.record(RPW_TYP,,'NAZWA','WYMOG','OFERTA')='' &
__CHK.in_set(RPW_TYP,'WYMOG',,'T','N') &
__CHK.in_set(RPW_TYP,'OFERTA',,'T','N')

:Sign Version 2.0 jowisz:1048 2023/06/23 14:14:36 4b60a5715d0391b66a4be3e0c5c919c1f8f262da9b40bd0e37955a66c21dfda943ed4cf49c54374b5a6f09fb7baa0e4cc5aae04435e21e71fcf75620afbf7806989156449b70e3f141d192ce8ef34f66b5d867a1bc06c09578408c580dbf97fde8af5f1ca1cdcd6c058a27cca1a1ef32869ff28c63c53587d5a5f3e0f7ed940f
