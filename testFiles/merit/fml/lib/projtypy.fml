:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: projtypy.fml
:: Utworzony: 28.02.2017
:: Autor: AWI
::======================================================================================================================
:: Zawartość: Typy projektów
::======================================================================================================================


\def
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AWI [17.14]
:: OPIS: Definiowanie typów projektów
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
BEER.NRDOK_AB:='PRJ';
PROJTYPY.index('T');
PROJTYPY.prefix();
PROJTYPY.select()


\chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AWI [17.14]
:: OPIS: Sprawdza poprawność wypełnienia rekordu tabeli PROJTYPY
::   WE:
::   WY: ''-prawidłowo wypełniony lub akronim nieprawidłowo wypełnionego pola
::----------------------------------------------------------------------------------------------------------------------
_wyn:=__CHK.record(PROJTYPY,,'T','NAZ','KOD');
{? _wyn=''
|| _kod:=PROJTYPY.T;
   _ref:=PROJTYPY.ref();
   PROJTYPY.cntx_psh();
   PROJTYPY.index('T');
   PROJTYPY.prefix(_kod,_kod);
   {? PROJTYPY.first()
   ||
      {!
      |?
         {? PROJTYPY.ref()<>_ref | -(1+menu_txt())='d'
         || FUN.info('Istnieje już typ '@ +_kod+'.');
            _wyn:='T'
         ?};
         _wyn='' & PROJTYPY.next()
      !}
   ?};
   PROJTYPY.cntx_pop()
?};
_wyn


\wewnetrzny
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AWI [17.14]
:: OPIS: Stała 'Wewnętrzny'
::   WE:
::   WY: 'Wewnętrzny'
::----------------------------------------------------------------------------------------------------------------------
'Wewnętrzny'


\zewnetrzny
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AWI [17.14]
:: OPIS: Stała 'Zewnętrzny'
::   WE:
::   WY: 'Zewnętrzny'
::----------------------------------------------------------------------------------------------------------------------
'Zewnętrzny'


\t_be
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AWI [17.14]
:: OPIS: Przed redakcją PROJTYPY.T
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
exec('count','projtypy')


\t_ae
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AWI [17.14]
:: OPIS: sprawdzenie typu dokumentu magazynowego
::----------------------------------------------------------------------------------------------------------------------
{? TYPYSP.T*' '
|| FUN.info('W typie projektu nie może być znaku SPACJI.'@);
   0
|| 1
?}


\count
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AWI [17.14]
:: OPIS: czy mozna edytować pola w TYPYSP
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
PROJTYPY.cntx_psh();
{? 1+menu_txt='D'
|| _wyn:=1
|| _wyn:=~PROJTYPY.count()
?};
PROJTYPY.cntx_pop();
_wyn


\sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AWI [17.14]
:: OPIS: Wybór typu projektu
::   WE:
::   WY:
::----------------------------------------------------------------------------------------------------------------------
PROJTYPY.win_sel('SLO');
{? PROJZ.PROJZAKR=exec('projzakr_zewnetrzne','projekty')
|| PROJTYPY.index('R');
   PROJTYPY.prefix(exec('zewnetrzny','projtypy'))
|? PROJZ.PROJZAKR=exec('projzakr_wewnetrzne','projekty')
|| PROJTYPY.index('R');
   PROJTYPY.prefix(exec('wewnetrzny','projtypy'))
|| PROJTYPY.index('T');
   PROJTYPY.prefix()
?};
{? PROJTYPY.first() & ~PROJTYPY.next()
|| PROJTYPY.ref()
|? PROJTYPY.select()
|| PROJTYPY.ref()
|| null()
?}

:Sign Version 2.0 jowisz:1028 2019/06/07 15:59:59 041c9f7cf18d1fc397e2ef575964393d2b60f51805fec8082e8cd18febe801d642ed49577e80f77d8b54c4ffcce5798a7f432384ff0dc04b43eb97c6506b333d793bdc8ca96846e1f3e6333c8de918adf480ad02cfe8f1fffb23b4a691ecbe8b74ed57d0154b96158ed0ff24d7d19d83e761fa601f997efecab5ae62cbbc53c8
