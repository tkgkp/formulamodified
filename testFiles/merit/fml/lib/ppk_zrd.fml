:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: ppk_zrd.fml [19.22]
:: Utworzony: 2019/06/28
:: Autor: jaws
:: Systemy: PPK
::======================================================================================================================
:: Zawartość: Formuły odpowiedzialne za obsługę słownika rodzajów załączników.
::======================================================================================================================


\_chk
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [19.22]
:: OPIS: Sprawdza wypełnienie wymaganych pól. Wykorzystywana w wyzwalaczach przed dołącz i popraw.
::   WE: _a [INTEGER] - Tryb modyfikacji danych
::          0 - dołączanie (domyślnie)
::          1 - poprawianie
::   WY: wynik testu poprawności danych zależny od kontekstu wywołania:
::       - jako formuła "rekord po"
::          - akronim niewypełnionego pola
::          - akronim pola o błędnej wartości
::          - 0 w przypadku powielenia unikalnego klucza
::       - jako formuła sprawdzająca dla wyzwalaczy "dołącz przed" i "popraw przed"
::          - 1 wiersz poprawny
::          - 0 niewypełnione wymagane pole, błędna wartość pola, powielony unikalny klucz
::----------------------------------------------------------------------------------------------------------------------
:: mapa argumentów
_mode:={? var_pres('_a')=type_of(0) || _a<>0 ?};

__CHK.validate(PPK_ZRD,
   "_a.field(_b,'RODZAJ')",
   $("_a.table(_b,"+$_mode+",,'SYMBOL','OPIS','PORTAL')"),
   "_a.in_set(_b,'PORTAL',,'T','N')"
)


\_addb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [19.22]
:: OPIS: Wyzwalacz "przed dołącz" tabeli PPK_ZRD.
::   WE:
::   WY: zgodny ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('_chk','ppk_zrd',0)


\_putb
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [19.22]
:: OPIS: Wyzwalacz "przed popraw" tabeli PPK_ZRD.
::   WE:
::   WY: zgodny ze specyfikacją narzędzi
::----------------------------------------------------------------------------------------------------------------------
exec('_chk','ppk_zrd',1)


\rek_a
::----------------------------------------------------------------------------------------------------------------------
::  UTW: jaws [19.22]
:: OPIS: Po edycji wiersza tabeli PPK_ZRD.
::   WE: _a INTEGER - rodzaj edycji: 0/1 - dołączenie/poprawianie
::   WY: 1 w przypadku gdy rekord jest poprawny, akronim wymaganego pola lub 0 gdy doszło do powielenia klucza.
::----------------------------------------------------------------------------------------------------------------------
exec('_chk','ppk_zrd',-menu_txt()='popraw')

:Sign Version 2.0 jowisz:1028 2019/10/14 09:21:33 5c48e192a0d0024a8283c55aafeea9e7cecca95db5b5bcd10e8eda04dffea00e4bf4504bf16925242dc002197859234b8b61e2808fdd6e1289f30a8d51b26f9bdfc3342f05345f7609be8f80268f3e76c8e3d12b77dd577d5c8ee1f44a4e904ea9693cf8978c326447c8af4f2555b2679131e0ab8bde5814f71a71bce6dc3ea8
