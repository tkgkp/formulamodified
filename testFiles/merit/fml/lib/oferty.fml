:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: oferty.fml
:: Utworzony: 03.08.2016
:: Autor: AWI
::======================================================================================================================
:: Zawartość: Obsługa ofert
::======================================================================================================================


\ofe_prn
::----------------------------------------------------------------------------------------------------------------------
::  UTW: [rr] [17.00]
:: OPIS: Zamówienie sprzedaży - Utwórz PDF
::   WE: [_a] - akcja
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')<>type_of('') || _a:='Area Drukuj' ?};

_params:=exec('mp_run_a','#b__box');
_params.ACT_UID:='LSP_OFE_WWOF';
_params.UIDREF:=OFE.uidref();
_params.AKCJA:=_a;
_params.PORTS_IN:=exec('portsIn','#b__box',_params.ACT_UID);
exec('portsInSet','#b__box',_params.PORTS_IN,_params.ACT_UID,'OFE',OFE.ref());

exec('mp_run','#b__box',_params)


\ofe_pdf
::----------------------------------------------------------------------------------------------------------------------
::  UTW:[rr] [17.00]
:: OPIS: Zamówienie sprzedaży - Utwórz PDF
::   WE: [_a] - akcja
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')<>type_of('') || _a:='Area Utwórz PDF' ?};

_params:=exec('mp_run_a','#b__box');
_params.ACT_UID:='LSP_OFE_WWOF';
_params.UIDREF:=OFE.uidref();
_params.AKCJA:=_a;
_params.PORTS_IN:=exec('portsIn','#b__box',_params.ACT_UID);
exec('portsInSet','#b__box',_params.PORTS_IN,_params.ACT_UID,'OFE',OFE.ref());

exec('mp_run','#b__box',_params)


\ofe_word
::----------------------------------------------------------------------------------------------------------------------
::  UTW: TS [20.14]
:: OPIS: Wydruk oferty do WORD
::----------------------------------------------------------------------------------------------------------------------
_env:=obj_new('DOKL'); _env.DOKL:=ST.DOKL;
params_set('env',_env);

OFE.KH(); OFE.ODB();
params_exec('generuj','szablon_zws','LSP_OFERTA',$OFE.ref())


\oferta_akceptuj
::----------------------------------------------------------------------------------------------------------------------
::  UTW: [rr] [23.25]
:: OPIS: Auto-Akceptacja oferty
::----------------------------------------------------------------------------------------------------------------------
_params:=exec('mp_run_a','#b__box');
_params.ACT_UID:='LSP_OFE_AAOF';
_params.UIDREF:=OFE.uidref();
_params.AKCJA:='AkceptujAuto';
_params.PORTS_IN:=exec('portsIn','#b__box',_params.ACT_UID);
exec('portsInSet','#b__box',_params.PORTS_IN,_params.ACT_UID,'OFE',OFE.ref());

exec('mp_run','#b__box',_params)

:Sign Version 2.0 jowisz:1048 2023/06/23 14:14:36 097ef782b145d6cb1148fead11bf62080d92362fe3336bdc42bee9cfba4c132b4b8f4a622c0fdcaa2e7f1e1c8debebc38496cc54aaa6b55d9d25d5cc5c9ddd0a65d933efd25646cd11120c709ab16e0c801f94315c41fa800599f4ffaa7e55becbd7948edef125e6474bc46699a25fd0b400d5ff696df085fb97a64d570d7982
