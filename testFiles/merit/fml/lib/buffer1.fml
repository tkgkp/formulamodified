:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: buffer1.fml
:: Autor: TS
::======================================================================================================================
:: UWAGA: W przypadku konieczności dodania kolejnych definicji buforów, można dodać tutaj kolejne wpisy,
::        można też użyć w kodzie bezpośrednio wywołań _buffer:=exec('obj_new','#buf',akronim_tabeli,[dodatkowe_pola])
::======================================================================================================================
:: Dostępne metody:
::   _buffer.blank() - czyszczenie bufora (dla parametru ~~ równoznaczne z bl_void())
::   _buffer.bl_void() - czyszczenie bufora typem pustym ~~
::   _buffer.bl_table() - czyszczenie bufora za pomocą wartości pól jak dla blank() tabeli
::   _buffer.get() - pobieranie zawartości bufora
::   _buffer.set() - pola<>~~ nanoszone do tabeli
::   _buffer.setf() - wszystkie pola nanoszone do tabeli
::   _buffer.cntx_get(ref()/#ref()[,maska]) - wczytuje bufor podanych parametrów
::   _buffer.memo_put() - zapisuje wszystkie pola sys_memo tabeli
::   _buffer.ref() - zwraca wartość .Ref
::   _buffer.name() - zwraca akronim tabeli
::   _buffer.this() - zwraca formułę służącą do powołania obiektu dla tej samej tabeli
::   _buffer.acronyms() - zwraca tablicę akronimów pól
::   _buffer.types() - zwraca tablicę typów pól
::   _buffer.methods() - wyświetla listę metod obiektu z możliwością podejrzenia ich treści
::======================================================================================================================


\REM_ZAS
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli REM_ZAS
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','REM_ZAS',_a)
|| _buffer:=exec('obj_new','#buf','REM_ZAS',)
?};
_buffer


\REM_ZASA
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli REM_ZASA
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','REM_ZASA',_a)
|| _buffer:=exec('obj_new','#buf','REM_ZASA',)
?};
_buffer


\REM_ZGLA
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli REM_ZGLA
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','REM_ZGLA',_a)
|| _buffer:=exec('obj_new','#buf','REM_ZGLA',)
?};
_buffer


\REM_GWAZ
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli REM_GWAZ
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','REM_GWAZ',_a)
|| _buffer:=exec('obj_new','#buf','REM_GWAZ',)
?};
_buffer


\REM_GWAR
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli REM_GWAR
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','REM_GWAR',_a)
|| _buffer:=exec('obj_new','#buf','REM_GWAR',)
?};
_buffer


\REM_CYKL
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli REM_CYKL
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','REM_CYKL',_a)
|| _buffer:=exec('obj_new','#buf','REM_CYKL',)
?};
_buffer


\REM_HARM
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli REM_HARM
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','REM_HARM',_a)
|| _buffer:=exec('obj_new','#buf','REM_HARM',)
?};
_buffer


\ND
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli ND
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','ND',_a)
|| _buffer:=exec('obj_new','#buf','ND',)
?};
_buffer


\DK
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli DK
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','DK',_a)
|| _buffer:=exec('obj_new','#buf','DK',)
?};
_buffer


\M
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli M
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','M',_a)
|| _buffer:=exec('obj_new','#buf','M',)
?};
_buffer


\PL_EVENT
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli PL_EVENT
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','PL_EVENT',_a)
|| _buffer:=exec('obj_new','#buf','PL_EVENT',)
?};
_buffer


\PX_OBJ
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli PX_OBJ
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','PX_OBJ',_a)
|| _buffer:=exec('obj_new','#buf','PX_OBJ',)
?};
_buffer


\PX_POINT
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli PX_POINT
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','PX_POINT',_a)
|| _buffer:=exec('obj_new','#buf','PX_POINT',)
?};
_buffer


\PX_WYK
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli PX_WYK
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','PX_WYK',_a)
|| _buffer:=exec('obj_new','#buf','PX_WYK',)
?};
_buffer


\PX_VIEW
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli PX_VIEW
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','PX_VIEW',_a)
|| _buffer:=exec('obj_new','#buf','PX_VIEW',)
?};
_buffer


\px_grp4jw
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto> [17.14]
:: OPIS: tablica buforowa dla tabeli _a
::   WE: FORMULA [_a] - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: tablica buforowa o następującej strukturze
::            INTEGER      REF - #PX_GRP.ref()
::               REAL     LP_Q - what lp
::            INTEGER      DIR - zwrot
::               REAL    ORDER - Nowy porządek

::  OLD: \px_grp4jw/buffer.fml
::----------------------------------------------------------------------------------------------------------------------
::               _a.ref()
_buffer:=$("obj_new('Ref'
::  INTEGER      #PX_GRP.ref()
                   ,'REF'
::  REAL         what lp
                   ,'LP_Q'
::  INTEGER      zwrot
                   ,'DIR'
::  REAL         Nowy porządek
                   ,'ORDER'
::  metoda          czyszczenie bufora blank(), gdy podany parametr ~~, to bl_void()
                   ,'blank'
::  metoda          czyszczenie bufora typem pustym bl_void()
                   ,'bl_void'
::  metoda          czyszczenie bufora za pomocą bufora tabeli bl_table(alias_tabeli)
                   ,'bl_table'
::  metoda          _buffer.voidize(alias_tabeli) - void dla pustych pól bufora
                   ,'voidize'
::  metoda          _buffer.get(alias_tabeli) - pobieranie zawartości bufora
                   ,'get'
::  metoda          _buffer.set(alias_tabeli) - pola<>~~ nanoszone do tabeli
                   ,'set'
::  metoda          _buffer.mask(alias_tabeli) - pola<>~~ nanoszone do bufora
                   ,'mask'
::  metoda          _buffer.setf(alias_tabeli) - wszystkie pola nanoszone do tabeli
                   ,'setf'
::  metoda          _buffer.cntx_get(alias_tabeli,ref()/#ref()[,maska]) - wczytuje bufor wg podanych parametrów
                   ,'cntx_get'
::  metoda          _buffer.ref() - zwraca wartosc .Ref
                   ,'ref'
::  metoda          _buffer.name() - zwraca akronim tabeli której dotyczy bufor
                   ,'name'
::  metoda          _buffer.this() - zwraca formułę która utworzy ten bufor
                   ,'this'
::  metoda          pobiera tablicę z akronimami pól bufora. Uwaga! Pierwszym elementem jest Ref
                   ,'acronyms'
::  metoda          pobiera tablicę z typami pól bufora. Uwaga! Pierwszym elementem jest STRING - SQL ref rekordu reprezentowanego przez bufor
                   ,'types'
                   "+{? var_pres('_a')=3 & form(_a)<>'' || ","+_a || "" ?}+"
                   )");
_buffer:=_buffer();

:: metody - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

_buffer.blank:="
                {? var_pres('_a')=0   || .bl_void()
                |? var_pres('_a')>100 || .bl_table(_a)
                || 0
                ?}
               ";

_buffer.bl_void:="
                  .REF:=~~;
                  .LP_Q:=~~;
                  .DIR:=~~;
                  .ORDER:=~~;
                  .Ref:=null();
                  1
                 ";

_buffer.bl_table:="
                  _tab:=_a;
                  _tab.cntx_psh();
                  _tab.blank(1);
                  .get(1);
                  _tab.cntx_pop();
                  _tab.get();
                  .Ref:=null();
                   1
                  ";

_buffer.voidize:="
              {? exec('is_empty_value','#var',.Ref)>0 || .Ref:=~~ ?};              {? exec('is_empty_value','#var',.REF)>0 || .REF:=~~ ?};
              {? exec('is_empty_value','#var',.LP_Q)>0 || .LP_Q:=~~ ?};
              {? exec('is_empty_value','#var',.DIR)>0 || .DIR:=~~ ?};
              {? exec('is_empty_value','#var',.ORDER)>0 || .ORDER:=~~ ?};
                  ~~
                 ";

_buffer.get:="
              .REF:=_a.REF;
              .LP_Q:=_a.LP_Q;
              .DIR:=_a.DIR;
              .ORDER:=_a.ORDER;
              .Ref:=_a.ref();
              (.)
             ";

_buffer.set:="
              {? .REF<>~~        || _a.REF:=.REF ?};
              {? .LP_Q<>~~       || _a.LP_Q:=.LP_Q ?};
              {? .DIR<>~~        || _a.DIR:=.DIR ?};
              {? .ORDER<>~~      || _a.ORDER:=.ORDER ?};
              ~~
             ";

_buffer.mask:="
              {? var_pres('_a')>100 || _target:=_a || _target:=_a ?};

              {? .REF<>~~        || _target.REF:=.REF ?};
              {? .LP_Q<>~~       || _target.LP_Q:=.LP_Q ?};
              {? .DIR<>~~        || _target.DIR:=.DIR ?};
              {? .ORDER<>~~      || _target.ORDER:=.ORDER ?};
               ~~
              ";

_buffer.setf:="
               _a.REF:=.REF;
               _a.LP_Q:=.LP_Q;
               _a.DIR:=.DIR;
               _a.ORDER:=.ORDER;
               ~~
              ";

_buffer.cntx_get:="
                   _tab:=_a;
                   {? type_of(_b)=7 || _ref:=#_b; _mask:=ref_name(_b)
                   |? type_of(_b)=1 || _ref:=_b;  _mask:={? var_pres('_c')=2 || _c || _tab.name() ?}
                   || .blank(~~); return(.)
                   ?};
                   _tab.cntx_psh();
                   {? {? _tab.name()<>_mask
                      || _tab.use(_mask)
                      || 1
                      ?}
                   || _tab.prefix();
                      {? _tab.seek(_ref,)
                      || .get()
                      || .blank(~~)
                      ?}
                   || .blank(~~)
                   ?};
                   _tab.cntx_pop();
                   (.)
                  ";

_buffer.ref:=".Ref";

_buffer.name:="'_a'";

_buffer.this:="exec('_a','buffer')";

_buffer.acronyms:="
                   _tab:=obj_new(5);
                   _tab[1]:='Ref';
                   _tab[2]:='REF';
                   _tab[3]:='LP_Q';
                   _tab[4]:='DIR';
                   _tab[5]:='ORDER';
                   _tab
                  ";

_buffer.types:="
                   _tab:=obj_new(5);
                   _tab[1]:='__a';
                   _tab[2]:='INTEGER';
                   _tab[3]:='REAL';
                   _tab[4]:='INTEGER';
                   _tab[5]:='REAL';
                _tab
               ";
:: czyszczenie bufora
_buffer.bl_void();

:: zwracam bufor
_buffer


\DOKUMENT
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli DOKUMENT
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','DOKUMENT',_a)
|| _buffer:=exec('obj_new','#buf','DOKUMENT',)
?};
_buffer


\WEB_DOK
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli WEB_DOK
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','WEB_DOK',_a)
|| _buffer:=exec('obj_new','#buf','WEB_DOK',)
?};
_buffer


\WEB_VPOZ
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli WEB_VPOZ
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','WEB_VPOZ',_a)
|| _buffer:=exec('obj_new','#buf','WEB_VPOZ',)
?};
_buffer


\WEB_POZF
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli WEB_POZF
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','WEB_POZF',_a)
|| _buffer:=exec('obj_new','#buf','WEB_POZF',)
?};
_buffer


\WEB_SKXD
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli WEB_SKXD
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','WEB_SKXD',_a)
|| _buffer:=exec('obj_new','#buf','WEB_SKXD',)
?};
_buffer


\WEB_POZ
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli WEB_POZ
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','WEB_POZ',_a)
|| _buffer:=exec('obj_new','#buf','WEB_POZ',)
?};
_buffer


\WEB_DPLA
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli WEB_DPLA
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','WEB_DPLA',_a)
|| _buffer:=exec('obj_new','#buf','WEB_DPLA',)
?};
_buffer


\WEB_FKH
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli WEB_FKH
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','WEB_FKH',_a)
|| _buffer:=exec('obj_new','#buf','WEB_FKH',)
?};
_buffer


\POZDOK
::----------------------------------------------------------------------------------------------------------------------
::  UTW: <auto>
:: OPIS: bufor tabeli POZDOK
::   WE: [_a] FORMULA - dodatkowe pola do obiektu - umieszczane na końcu - nie obsługiwane przez standardowe metody [""]
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
{? var_pres('_a')=3
|| _buffer:=exec('obj_new','#buf','POZDOK',_a)
|| _buffer:=exec('obj_new','#buf','POZDOK',)
?};
_buffer

:Sign Version 2.0 jowisz:1048 2023/06/23 14:14:38 da6803d6627cb2b3edc2cd3c1c8b82ff3119f17c0f8f1a206aa3b4e2bae8049b1aa85233581efb3321d69fb561f9386c68b7cf128ce45c645e001b3a299fa5c2188339c41df5692bac16f2cf6a539f162d12dcc71ad7f565dc08fe4e440719c3314733718baa3eb213ec5d6d5ee6e88e6ab91152ec24b7e43b47964c59fa0ad9
