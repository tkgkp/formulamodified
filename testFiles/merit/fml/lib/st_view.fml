:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: st_view.fml
:: Utworzony: 01.06.2020
:: Autor: AKUL
::======================================================================================================================
:: Zawartość: Obsługa filtrowania (zakresów) i widoków dla statystyk
::======================================================================================================================


\load
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Ładowanie środowiska
::----------------------------------------------------------------------------------------------------------------------

:: Inicjalizacja obiektów i otwarcie masek
exec('init','st_common');

_fb:="
   ST_ARCH.index('MASK');
   ST_ARCH.prefix();
   ST_ARCH.first();
   grp_disp(ST_ARCH,'WER_GRP',1);
   ~~
";
_grp:=ST_LOG.grp_make('',_fb,'st_log_grp',,,"",,'maximized');
_fb:="
   ~~
";
_fa:="
   ~~
";
_after_rfr:="
   {? ST_ARCH.MASK<>''
   ||
      exec('open','st_arch',ST_ARCH.MASK,0);
      ST_SRC.index('LP');
      ST_SRC.prefix();
      ST_SRC.first();
      win_set('cur_row_pos=1',ST_SRC,'WER_GRP');

      ST_LOG.index('LP');
      ST_LOG.prefix();
      ST_LOG.first();
      win_set('cur_row_pos=1',ST_LOG,'WER');
      ~~
   ?};
   grp_disp(ST_SRC,'WER_GRP',1);
   grp_disp(ST_LOG,'WER',1);
   ~~
";
ST_LOG.grp_sel(_grp,ST_ARCH,'WER_GRP',,_after_rfr,,,,_fb,_fa,,,,'st_arch_grp_wer');
ST_LOG.grp_splt(_grp,,'vertical','st_src');
_fb:="
   _result:=~~;
   {? grp_empty(ST_ARCH,'WER_GRP')>0
   || _result:='#disable'
   ?};
   _result
";
_fa:="
   ~~
";
ST_LOG.grp_sel(_grp,ST_SRC,'WER_GRP',,,,,,_fb,_fa,,,,'st_src_grp_wer');
ST_LOG.grp_splt(_grp,'st_src','vertical','st_log');
_fb:="
   _result:=~~;
   {? grp_empty(ST_ARCH,'WER_GRP')>0
   || _result:='#disable'
   ?};
   _result
";
_fa:="
   ~~
";
ST_LOG.grp_sel(_grp,,'WER',,,,,,_fb,_fa,,,,'st_log_grp_wer');
ST_LOG.win_sel(_grp);ST_LOG.win_edit('RED');
:: Przypisanie domyślnych okien wertowania i redagowania
ST_APL.win_sel('WER');ST_APL.win_edit('RED');
ST_GHW.win_sel('WER');ST_GHW.win_edit('RED');
ST_ARCH.win_sel('WER');ST_ARCH.win_edit('RED');
ST_KH.win_sel('WER');ST_KH.win_edit('RED');
ST_KHI.win_sel('WER');ST_KHI.win_edit('RED');
ST_OBJ.win_sel('WER');ST_OBJ.win_edit('RED');
ST_OBJ_W.win_sel('WER');ST_OBJ_W.win_edit('RED');
ST_OBS.win_sel('WER');ST_OBS.win_edit('RED');
ST_PTH.win_sel('WER');ST_PTH.win_edit('RED');
ST_PTH_W.win_sel('WER');ST_PTH_W.win_edit('RED');
ST_RODZ.win_sel('WER');ST_RODZ.win_edit('RED');
ST_SESJ2.win_sel('WER');ST_SESJ2.win_edit('RED');
ST_SEST2.win_sel('WER');ST_SEST2.win_edit('RED');
ST_SRC.win_sel('WER');ST_SRC.win_edit('RED');
ST_SZEFO.win_sel('WER');ST_SZEFO.win_edit('RED');
ST_WER.win_sel('WER');ST_WER.win_edit('RED');

ST_LOG.select();
~~


\st_apl_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik aplikacji dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_APL.index('SYMBOL');
ST_APL.prefix();
ST_APL.win_sel('WER');
ST_APL.win_edit('RED');
ST_APL.select()


\st_arch_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik archiwum dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_ARCH.index('MASK');
ST_ARCH.prefix();
ST_ARCH.win_sel('WER');
ST_ARCH.win_edit('RED');
ST_ARCH.select()


\st_ghw_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik GHW dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_GHW.index('DANE');
ST_GHW.prefix();
ST_GHW.win_sel('WER');
ST_GHW.win_edit('RED');
ST_GHW.select()


\st_kh_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik Kontrahentów dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_KH.cntx_psh();
ST_KHI.cntx_psh();
VAR.A_ST_KH:=null();
ST_KHI.efld_opt('RED','editable=0',,'ST_KH');
_fb:="
   ST_KH.win_dict('WER');
   ST_KH.index('DANE');
   ST_KH.prefix();
   ST_KH.first();
   grp_disp(ST_KH,'WER_GRP',1);
   ~~
";
_grp:=ST_KH.grp_make('Kontrahenci'@,_fb,'st_kh_grp',,,,,'maximized');

_after_rfr:="
   {? ST_KH.size()>0
   ||
      VAR.A_ST_KH:=ST_KH.ref();
      ST_KHI.index('KH');
      ST_KHI.prefix(ST_KH.ref());
      ST_KHI.first();
      ~~
   ?};
   grp_disp(ST_KHI,'WER_GRP',1);
   ~~
";

ST_KH.grp_sel(_grp,ST_KH,'WER_GRP',,_after_rfr,,,,,,,,,'st_kh_grp_wer');
ST_KH.grp_splt(_grp,,'vertical','ST_KHI');

ST_KH.grp_sel(_grp,ST_KHI,'WER_GRP',,,,,,,,,,,'st_khi_grp_wer');
ST_KH.win_sel(_grp);

ST_KH.select();

ST_KHI.efld_opt('RED','editable=1',,'ST_KH');
VAR.A_ST_KH:=null();
ST_KH.cntx_pop();
ST_KHI.cntx_pop();
~~


\st_khi_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik Kontrahentów dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_KHI.index('KH');
ST_KHI.prefix();
ST_KHI.win_sel('WER');
ST_KHI.win_edit('RED');
ST_KHI.select()


\st_obj_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik Obiektów dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_OBJ.cntx_psh();
ST_OBJ_W.cntx_psh();
VAR.A_ST_OBJ:=null();
ST_OBJ_W.efld_opt('RED','editable=0',,'ST_OBJ');
_fb:="
   ST_OBJ.win_dict('WER');
   ST_OBJ.index('OPIS');
   ST_OBJ.prefix();
   ST_OBJ.first();
   grp_disp(ST_OBJ,'WER_GRP',1);
   ~~
";
_grp:=ST_OBJ.grp_make('Obiekty'@,_fb,'st_obj_grp',,,,,'maximized');

_after_rfr:="
   {? ST_OBJ.size()>0
   ||
      VAR.A_ST_OBJ:=ST_OBJ.ref();
      ST_OBJ_W.index('UNIQ');
      ST_OBJ_W.prefix(ST_OBJ.ref());
      ST_OBJ_W.first();
      ~~
   ?};
   grp_disp(ST_OBJ_W,'WER_GRP',1);
   ~~
";

ST_OBJ.grp_sel(_grp,ST_OBJ,'WER_GRP',,_after_rfr,,,,,,,,,'st_obj_grp_wer');
ST_OBJ.grp_splt(_grp,,'vertical','st_obj_w');

ST_OBJ.grp_sel(_grp,ST_OBJ_W,'WER_GRP',,,,,,,,,,,'st_obj_w_grp_wer');
ST_OBJ.win_sel(_grp);

ST_OBJ.select();

ST_OBJ_W.efld_opt('RED','editable=1',,'ST_OBJ');
VAR.A_ST_OBJ:=null();
ST_OBJ.cntx_pop();
ST_OBJ_W.cntx_pop();
~~


\st_obj_w_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik wersji obiektów dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_OBJ_W.index('UNIQ');
ST_OBJ_W.prefix();
ST_OBJ_W.win_sel('WER');
ST_OBJ_W.win_edit('RED');
ST_OBJ_W.select()


\st_obs_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik Obszarów dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_OBS.index('SYMBOL');
ST_OBS.prefix();
ST_OBS.win_sel('WER');
ST_OBS.win_edit('RED');
ST_OBS.select()


\st_pth_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik Ścieżek dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_PTH.cntx_psh();
ST_PTH_W.cntx_psh();
VAR.A_ST_PTH:=null();
ST_PTH_W.efld_opt('RED','editable=0',,'ST_PTH');
_fb:="
   ST_PTH.win_dict('WER');
   ST_PTH.index('ID');
   ST_PTH.prefix();
   ST_PTH.first();
   grp_disp(ST_PTH,'WER_GRP',1);
   ~~
";
_grp:=ST_PTH.grp_make('Ścieżki'@,_fb,'st_pth_grp',,,,,'maximized');

_after_rfr:="
   {? ST_PTH.size()>0
   ||
      VAR.A_ST_PTH:=ST_PTH.ref();
      ST_PTH_W.index('UNIQ');
      ST_PTH_W.prefix(ST_PTH.ref());
      ST_PTH_W.first();
      ~~
   ?};
   grp_disp(ST_PTH_W,'WER_GRP',1);
   ~~
";

ST_PTH.grp_sel(_grp,ST_PTH,'WER_GRP',,_after_rfr,,,,,,,,,'st_pth_grp_wer');
ST_PTH.grp_splt(_grp,,'vertical','ST_PTH_W');

ST_PTH.grp_sel(_grp,ST_PTH_W,'WER_GRP',,,,,,,,,,,'st_pth_w_grp_wer');
ST_PTH.win_sel(_grp);

ST_PTH.select();

ST_PTH_W.efld_opt('RED','editable=1',,'ST_PTH');
VAR.A_ST_PTH:=null();
ST_PTH.cntx_pop();
ST_PTH_W.cntx_pop();
~~


\st_pth_w_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik wersji ścieżek dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_PTH_W.index('UNIQ');
ST_PTH_W.prefix();
ST_PTH_W.win_sel('WER');
ST_PTH_W.win_edit('RED');
ST_PTH_W.select()


\st_rodz_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik rodzajów obiektów dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_RODZ.index('SYMBOL');
ST_RODZ.prefix();
ST_RODZ.win_sel('WER');
ST_RODZ.win_edit('RED');
ST_RODZ.select()


\st_sesja_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik Sesji dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_SESJ2.cntx_psh();
ST_SEST2.cntx_psh();
VAR.A_ST_SES:=null();
ST_SEST2.efld_opt('RED','editable=0',,'ST_SESJ2');
_fb:="
   ST_SESJ2.win_dict('WER');
   ST_SESJ2.index('PID');
   ST_SESJ2.prefix();
   ST_SESJ2.first();
   grp_disp(ST_SESJ2,'WER_GRP',1);
   ~~
";
_grp:=ST_SESJ2.grp_make('Sesje'@,_fb,'st_sesja_grp',,,,,'maximized');

_after_rfr:="
   {? ST_SESJ2.size()>0
   ||
      VAR.A_ST_SES:=ST_SESJ2.ref();
      ST_SEST2.index('ST_SESJ2');
      ST_SEST2.prefix(ST_SESJ2.ref());
      ST_SEST2.first();
      ~~
   ?};
   grp_disp(ST_SEST2,'WER_GRP',1);
   ~~
";

ST_SESJ2.grp_sel(_grp,ST_SESJ2,'WER_GRP',,_after_rfr,,,,,,,,,'ST_SESJ2_grp_wer');
ST_SESJ2.grp_splt(_grp,,'vertical','ST_SEST2');

ST_SESJ2.grp_sel(_grp,ST_SEST2,'WER_GRP',,,,,,,,,,,'ST_SEST2_grp_wer');
ST_SESJ2.win_sel(_grp);

ST_SESJ2.select();

ST_SEST2.efld_opt('RED','editable=1',,'ST_SESJ2');
VAR.A_ST_SES:=null();
ST_SESJ2.cntx_pop();
ST_SEST2.cntx_pop();
~~


\st_sesta_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik Sesji dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_SEST2.index('ST_SESJ2');
ST_SEST2.prefix();
ST_SEST2.win_sel('WER');
ST_SEST2.win_edit('RED');
ST_SEST2.select()


\st_src_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik Zapisów źródłowych dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_SRC.index('TM_STAMP');
ST_SRC.prefix();
ST_SRC.win_sel('WER');
ST_SRC.win_edit('RED');
ST_SRC.select()


\st_szefo_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik Szefów obszarów dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_SZEFO.index('DANE');
ST_SZEFO.prefix();
ST_SZEFO.win_sel('WER');
ST_SZEFO.win_edit('RED');
ST_SZEFO.select()


\st_wer_sel
::----------------------------------------------------------------------------------------------------------------------
::  UTW: AKUL [20.42]
:: OPIS: Formula wyswietla slownik Wersji dla statystyk
::----------------------------------------------------------------------------------------------------------------------
ST_WER.index('SYMBOL');
ST_WER.prefix();
ST_WER.win_sel('WER');
ST_WER.win_edit('RED');
ST_WER.select()

:Sign Version 2.0 jowisz:1048 2021/04/09 15:26:32 b045ceca85e6a398984b76007e243597dfa898b240711b7aac7211052966d80d2077efe1bef6c5132495859772e8a0f7320663b701b7bb7cf1964a038fb2e21ff63a7ae909a155f76a690635f9f6dc9459b68cf2e7c3d127e1ccb9f50149f1efcba35214f2130907544c30ce9508ec51f880de82f07d5d777163acd02833bdae
