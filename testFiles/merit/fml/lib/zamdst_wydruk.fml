:!UTF-8
:: (c) Macrologic S.A. Wszelkie prawa zastrzeżone
::======================================================================================================================
:: Nazwa pliku: zamdst_wydruk.fml
:: Utworzony: 29.04.2020
:: Autor: DG
::======================================================================================================================
:: Zawartość: Obsługa wydruku zamówienia sprzedaży
::======================================================================================================================

\zdnag_word
::----------------------------------------------------------------------------------------------------------------------
::  UTW: DG [20.42]
:: OPIS: Wydruk zamówienia dostaw do WORD
::----------------------------------------------------------------------------------------------------------------------
_env:=obj_new('DOKL'); _env.DOKL:=ST.DOKL;
params_set('env',_env);

ZD_NAG.KH();
:ZK_N.ODB();
params_exec('generuj','szablon_zws','LZK_ZAMOWIENIE',$ZD_NAG.ref())


\wydrukil_prefix
::----------------------------------------------------------------------------------------------------------------------
::  UTW: MW [23.25]
:: OPIS: WYDRUKIL.prefix
::   WE: _a  - nazwa wydruku
::       _b - 0/1 pokaż parametry wydruku
::       _c - 0/1 Edokument
::   WY: obj_new
::----------------------------------------------------------------------------------------------------------------------
_return:=obj_new('SHOW_PARAM','EXIT');
_return.SHOW_PARAM:=_b;
_return.EXIT:=0;
_typ_edok:=exec('typ_edokument','dp_wydrukow');
{? _c
||
:: Edokument
   _tz:=exec('FindAndGet','#table',TYPYZAM,ZD_NAG.T,,"TYPYZAM.uidref()",'');
   _nwydr:=gsub(rep_name(),'.rpt','');
   WYDRUKIL.index('DP');
   WYDRUKIL.prefix('T',_tz,_typ_edok,_nwydr,);
   {? WYDRUKIL.find_key(ZD_NAG.KH,'',)
   ||
:: pobrano domyślne parametry wydruku dla kontrahenta
      WYDRUKIL.prefix('T',_tz,_typ_edok,_nwydr,ZD_NAG.KH,'',);
      _return.SHOW_PARAM:=0
   |? WYDRUKIL.find_key(null(),'',)
   ||
:: pobrano domyślne parametry wydruku
      WYDRUKIL.prefix('T',_tz,_typ_edok,_nwydr,null,'',);
      _return.SHOW_PARAM:=0
   ||
:: brak domyślnych parametrów wydruku
      WYDRUKIL.index('WYDRUKI');
      WYDRUKIL.prefix(OPERATOR.USER().KOD,_a)
   ?}
||
:: Wydruk lub PDF
   WYDRUKIL.index('WYDRUKI');
   WYDRUKIL.prefix(OPERATOR.USER().KOD,_a)
?};
_return

:Sign Version 2.0 jowisz:1048 2023/06/23 14:14:38 1bc66791c206e2d6bf7cff1726f4a8cb2353b6dca217ba10efa68c50582eed53fb82c1befa96248158e233eecec894cc3716184634dc17fa152b7a5cf06a232f7959be2ff9dd3172912ce5e37373ec203f289c54c13fea407253ce1f4e1b53b64b4bd9d261c5d430d8ae953bb0d969ac9fc5b70cd46177f9c0af6c84ef87286d
