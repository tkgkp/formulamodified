:!UTF-8
{TITLE: Grupowy wydruk komunikatów}
{PRINTER: exec('prt','param_wydr','h',KST),,,,,'I','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   PAR_WYDR.TITLE:='';
   PPK_KOM.cntx_psh;
   PPK_KOM.prefix();
   VAR_DEL.delete('__PPKREF','__TXT','__exit');
   __PPKREF:=exec('powiadom','ppk_rep');
   __exit:=(~__PPKREF.size());
   {? __exit
   || FUN.info('Brak komunikatów do wydruku.'@)
   ?};
   ~~
}
{END:
   VAR_DEL.delete('__PPKREF','__TXT','__exit');
   PPK_KOM.cntx_pop()
}
{EXIT: __exit}
{COMMENT}OLD: ppklos55.rpm{COMMENT-}
{COMMENT}OLD: ppk_pow.rpi{COMMENT-}
{COMMENT}OLD: skid_pw.rpi{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{INCLUDE: ppk_xpowiadomienie.rpi}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{LINE}
{HEADER-}
{FOR: __PPKREF}
{DO}
   {IF: PPK_KOM.seek(__PPKREF.REF,)}
      {SUBSTITUTE: 'powiadom'}
      {  exec('przekaz','ppk_kom','N'); ~~ }
   {FI}
{OD}