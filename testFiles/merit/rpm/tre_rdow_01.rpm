:!UTF-8
{TITLE:A. Wydruk reklamacji do dostawcy}
{PRINTER: exec('set_parw','param_wydr');exec('prt','param_wydr','v'),,,,,'Q','C',,,,,,1,
   PAR_WYDR.MBOT,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,0,1}
{BEGIN:
   POLA.NAZ_WYDR:='Reklamacja do dostawcy '+exec('str_to_pth','#string',REK_N.SYM)+'.pdf';
   {? exec('czy_grp_dr','faktury_wydruk_new')
   || __GRP_DR.WZ:='tre_rdow_01';
      exec('begin','reklamacje','rdow_01',__GRP_DR.FIRST)
   || exec('begin','reklamacje','rdow_01')
   ?};stron1:=0}
{END: exec('end','reklamacje');VAR_DEL.delete('stron1')}
{IF: wyjscie=1}{EXIT}{FI}
{INCLUDE: tre_rek_rdo.rpi}
{INCLUDE: wsp_pw.rpi}
{INCLUDE: wsp_strony.rpi}
{IF: ~exec('czy_grp_dr','faktury_wydruk_new') | __GRP_DR.PDF}
   {SUBSTITUTE: 'druk'}
{ELSE}
   {
   REK_N.cntx_psh();
   __loop:=__GRP_DR.SEL.first();
   ~~}
   {WHILE: __loop}
   {DO}
      {IF: REK_N.seek(__GRP_DR.SEL.REF,)}
         {
         exec('begin','reklamacje','rdow_01',0);
         _v:=$int((100-PAR_WYDR.SHAD)*2.55);
         color:=_v+':'+_v+':'+_v;
         pages:=page-1; stron:=stron1;
         ~~}
         {IF: wyjscie=0}{SUBSTITUTE: 'druk'}{FI}
         { stron1:=stron;~~}
      {FI}
      { __loop:=__GRP_DR.SEL.next();~~}
   {OD}
   {
   REK_N.cntx_pop();
   VAR_DEL.delete('__loop');
   ~~}
{FI}
