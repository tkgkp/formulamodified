:!UTF-8
{TITLE: Informacja VAT-UE}
{PRINTER: 'port_std',,,,,,,,,,,,1,
  15,12,15,12,,1}
{BEGIN:
   na_str:={? VAT_DEK.NR().NR=3 || 59 || 53 ?};
   na_strC:={? VAT_DEK.NR().NR=3 || 54 || 53 ?};
   sd:=obj_new(na_str); nd:=obj_new(na_str); kd:=obj_new(na_str); td:=obj_new(na_str);
   sn:=obj_new(na_str); nn:=obj_new(na_str); kn:=obj_new(na_str); tn:=obj_new(na_str);
   su:=obj_new(na_str); nu:=obj_new(na_str); ku:=obj_new(na_str);
   kl:='0:0:0,60:100:200'; bl:='0:0:0,255:255:255'; ks:='0:0:0,200:200:200';
   ko:='0:0:0,225:225:225';l:=-1; STR.split(XINFO.NAZ+', '+XINFO.REGON); {! |? l+=1; STR.line(71); STR.next() !};
   us:=-1; STR.split(XINFO.URZAD().NU+', '+XINFO.URZAD().UK+' '+XINFO.URZAD().MU+', '+XINFO.URZAD().UU);
   {! |? us+=1; STR.line(71); STR.next() !};
   i:=j:=la:=lb:=lc:=0;
   NIPY.index('SNIP_F'); NIPY.prefix(REF.S_FIRMA,'PL');
   nipuelic:={? NIPY.first() || 2-NIPY.SNIP || XINFO.NIP ?};
   prfx_rpi:=''
}
{END:
   &kl; &bl; &ks; &ko; &nipuelic;
   &i; &j; &la; &lb; &lc; &l;
   VAR_DEL.delete('prfx_rpi','sd','nd','kd','td','sn','nn','kn','tn','su','nu','ku','us');
   VAR_DEL.delete('na_str','na_strC')
}
{COMMENT}
gr - tekst pogrubiony dla poszczególnych pozycji sprawozdania
zw - tekst zwykły dla poszczególnych pozycji sprawozdania
tyt - tytuł sprawozdania
ptyt - podtytuł sprawozdania
ppkt - podpunkt sprawozdania np. E.1.
op - tytuł dla tekstu wolnego (objaśnienia lub pouczenia)
{COMMENT-}
{DEFINEFONT: 'gr=Arial,110,r,8'}
{DEFINEFONT: 'tyt=Arial,120,f,8'}
{DEFINEFONT: 'ptyt=Arial,80,m,8'}
{DEFINEFONT: 'zw=Arial,100,q,8'}
{DEFINEFONT: 'zwn=Arial,120,q,8'}
{DEFINEFONT: 'ppkt=Arial,80,e,8'}
{DEFINEFONT: 'op=Arial,110,f,8'}
{SPACE: 'd'}{FONT: 'q'}
{  _wer:=VAT_DEK.NR().NR;
   prfx_rpi:={? _wer<2 || 'fks_dek_' || 'fks_du'+form(_wer,-2) ?};
   VAT_POZ.index('VAT_POZ'); VAT_POZ.prefix(VAT_DEK.ref(),'VAT-UE/A');
   {? VAT_POZ.first()
   || la:=ceil(VAT_POZ.size()/na_str)
   ?};
   VAT_POZ.prefix(VAT_DEK.ref(),'VAT-UE/B');
   {? VAT_POZ.first()
   || lb:=ceil(VAT_POZ.size()/na_str)
   ?};
   VAT_POZ.prefix(VAT_DEK.ref(),'VAT-UE/C');
   {? VAT_POZ.first()
   || lc:=ceil(VAT_POZ.size()/na_strC)
   ?};
   {! _i:=1..na_str |!
      sd[_i]:=nd[_i]:=td[_i]:=sn[_i]:=nn[_i]:=tn[_i]:=''; kd[_i]:=kn[_i]:=0;
      su[_i]:=nu[_i]:=''; ku[_i]:=0
   !};
   VAT_POZ.prefix(VAT_DEK.ref(),'VAT-UE C');
   {? VAT_POZ.first()
   || _i:=1;
      {! |?
         nd[_i]:=VAT_POZ.OP; kd[_i]:=VAT_POZ.NETTO$0; td[_i]:=VAT_POZ.Z;
         {? exec('kod_pl','slo_slu',2+nd[_i])
         || sd[_i]:=2+nd[_i]; nd[_i]:=2-nd[_i]
         ?};
         _i+=1;
         VAT_POZ.next()
      !}
   ?};
   VAT_POZ.prefix(VAT_DEK.ref(),'VAT-UE D');
   {? VAT_POZ.first()
   || _i:=1;
      {! |?
         nn[_i]:=VAT_POZ.OP; kn[_i]:=VAT_POZ.NETTO$0; tn[_i]:=VAT_POZ.Z;
         {? exec('kod_pl','slo_slu',2+nn[_i])
         || sn[_i]:=2+nn[_i]; nn[_i]:=2-nn[_i]
         ?};
         _i+=1;
         VAT_POZ.next()
      !}
   ?};
   VAT_POZ.prefix(VAT_DEK.ref(),'VAT-UE E');
   {? VAT_POZ.first()
   || _i:=1;
      {!
      |? nu[_i]:=VAT_POZ.OP; ku[_i]:=VAT_POZ.NETTO$0;
         {? exec('kod_pl','slo_slu',2+nu[_i])
         || su[_i]:=2+nu[_i]; nu[_i]:=2-nu[_i]
         ?};
         _i+=1;
         VAT_POZ.next()
      !}
   ?}; ~~}
   {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'ue1w.rpi}'}{DIRECT-}
   {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'ue2w.rpi}'}{DIRECT-}
{  {! i:=1..na_str |!
      sd[i]:=nd[i]:=td[i]:=sn[i]:=nn[i]:=tn[i]:=''; kd[i]:=kn[i]:=0;
      su[i]:=nu[i]:=''; ku[i]:=0
   !};
   i:=j:=1; ~~}
{FOR: VAT_POZ}
{INDEX: 'VAT_POZ'}
{PREFIX: VAT_DEK.ref(),'VAT-UE/A'}
{DO}
   {IF: _v:=9-VAT_POZ.LP; _pos:=_v*' '; _v:=(_pos-1)+_v; #_v<>j}
      {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'ua1w.rpi}'}{DIRECT-}
      {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'ua2w.rpi}'}{DIRECT-}
      {  {! i:=1..na_str |!
            sd[i]:=nd[i]:=td[i]:=sn[i]:=nn[i]:=tn[i]:=''; kd[i]:=kn[i]:=0;
            su[i]:=nu[i]:=''; ku[i]:=0
         !};
         i:=1; j+=1; ~~}
   {FI}
   {  nd[i]:=VAT_POZ.OP; kd[i]:=VAT_POZ.NETTO$0; td[i]:=VAT_POZ.Z;
      {? exec('kod_pl','slo_slu',2+nd[i])
      || sd[i]:=2+nd[i]; nd[i]:=2-nd[i]
      ?};
      i+=1; ~~}
{OD}
{IF: i>1}
   {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'ua1w.rpi}'}{DIRECT-}
   {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'ua2w.rpi}'}{DIRECT-}
{FI}
{  {! i:=1..na_str |!
      sd[i]:=nd[i]:=td[i]:=sn[i]:=nn[i]:=tn[i]:=''; kd[i]:=kn[i]:=0;
      su[i]:=nu[i]:=''; ku[i]:=0
   !};
   i:=j:=1; ~~}
{FOR: VAT_POZ}
{INDEX: 'VAT_POZ'}
{PREFIX: VAT_DEK.ref(),'VAT-UE/B'}
{DO}
   {IF: _v:=9-VAT_POZ.LP; _pos:=_v*' '; _v:=(_pos-1)+_v; #_v<>j}
      {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'ub1w.rpi}'}{DIRECT-}
      {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'ub2w.rpi}'}{DIRECT-}
      {  {! i:=1..na_str |!
            sd[i]:=nd[i]:=td[i]:=sn[i]:=nn[i]:=tn[i]:=''; kd[i]:=kn[i]:=0;
            su[i]:=nu[i]:=''; ku[i]:=0
         !};
         i:=1; j+=1; ~~}
   {FI}
   {  nn[i]:=VAT_POZ.OP; kn[i]:=VAT_POZ.NETTO$0; tn[i]:=VAT_POZ.Z;
      {? exec('kod_pl','slo_slu',2+nn[i])
      || sn[i]:=2+nn[i]; nn[i]:=2-nn[i]
      ?};
      i+=1; ~~}
{OD}
{IF: i>1}
   {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'ub1w.rpi}'}{DIRECT-}
   {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'ub2w.rpi}'}{DIRECT-}
{FI}
{  {! i:=1..na_str |!
      sd[i]:=nd[i]:=td[i]:=sn[i]:=nn[i]:=tn[i]:=''; kd[i]:=kn[i]:=0;
      su[i]:=nu[i]:=''; ku[i]:=0
   !};
   i:=j:=1; ~~}
{FOR: VAT_POZ}
{INDEX: 'VAT_POZ'}
{PREFIX: VAT_DEK.ref(),'VAT-UE/C'}
{DO}
   {IF: _v:=9-VAT_POZ.LP; _pos:=_v*' '; _v:=(_pos-1)+_v; #_v<>j}
      {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'uc1w.rpi}'}{DIRECT-}
      {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'uc2w.rpi}'}{DIRECT-}
      {  {! i:=1..na_str |!
            sd[i]:=nd[i]:=td[i]:=sn[i]:=nn[i]:=tn[i]:=''; kd[i]:=kn[i]:=0;
            su[i]:=nu[i]:=''; ku[i]:=0
         !};
         i:=1; j+=1; ~~}
   {FI}
   {  nu[i]:=VAT_POZ.OP; ku[i]:=VAT_POZ.NETTO$0;
      {? exec('kod_pl','slo_slu',2+nu[i])
      || su[i]:=2+nu[i]; nu[i]:=2-nu[i]
      ?};
      i+=1; ~~}
{OD}
{IF: i>1}
   {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'uc1w.rpi}'}{DIRECT-}
   {DIRECT}{<1}{REP: '{INCLUDE: '+prfx_rpi+'uc2w.rpi}'}{DIRECT-}
{FI}