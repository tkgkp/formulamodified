:!UTF-8
{TITLE:Raport możliwości zamknięcia zlecenia}
{PRINTER: INFO.W_PRN,,,,,'E','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
      PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   dalej:=0;
   PRN2:=obj_new(@.CLASS.PRINT,10); PRN2.s_frame();
   PRN3:=obj_new(@.CLASS.PRINT,10); PRN3.s_frame();
   PRN4:=obj_new(@.CLASS.PRINT,10); PRN4.s_frame();
   PRN5:=obj_new(@.CLASS.PRINT,10); PRN5.s_frame();
   PRN6:=obj_new(@.CLASS.PRINT,11); PRN6.sl_frame();
   PRN7:=obj_new(@.CLASS.PRINT,10); PRN7.s_frame();
   __TAB2:=params_get().tab2;
   __TAB3:=params_get().tab3;
   __TAB4:=params_get().tab4;
   __TAB5:=params_get().tab5;
   __TAB6:=params_get().tab6;
   __TAB7:=params_get().tab7;
   prn1:='PRN1';
   color:='';
   licznik:=0;
   lm:=ll:=vp:=lmt:=rsep:=0;
   tabs:=0
}
{END:
   &dalej;
   VAR_DEL.delete('PRN2','PRN3','PRN4','PRN5','PRN6','PRN7');
   VAR_DEL.delete('__TAB2','__TAB3','__TAB4','__TAB5','__TAB6','__TAB7');
   &prn1;
   &color;
   &licznik;
   &lm; &ll; &vp; &lmt; &rsep;
   &tabs
}
{COMMENT}
  Raport możliwości zamknięcia zlecenia
  [TS] - 2002/12/10 - [7.62]
  Wywołanie: Zlecenia (produkcyjne, warsztatowe) -> Funkcje -> Kontrola zamknięcia zlecenia
{COMMENT-}
{  'niezaakceptowane limity';
   PRN2.add("__TAB2[1].KOD",15,'Kod surowca'@);
   PRN2.add("__TAB2[1].NAZ",40,'Nazwa surowca'@);
   PRN2.add("form(__TAB2[1].ILOSC,,4)",15,'Ilość'@,1);
   'limity';
   PRN3.add("__TAB3[1].KOD",15,'Kod surowca'@);
   PRN3.add("__TAB3[1].NAZ",35,'Nazwa surowca'@);
   PRN3.add("form(__TAB3[1].ILL,,4)",15,'Ilość limitowana'@,1);
   PRN3.add("form(__TAB3[1].ILP,,4)",15,'Ilość pobrana'@,1);
   PRN3.add("__TAB3[1].MX",8,'Pobrania poniżej limitu'@);
   PRN3.add("__TAB3[1].DX",8,'Pobrania powyżej limitu'@);
   'niezaakceptowane dokumenty magazynowe';
   PRN4.add("__TAB4[1].WPM",3,'R'@);
   PRN4.add("__TAB4[1].KOD",15,'Kod materiału'@);
   PRN4.add("__TAB4[1].NAZ",40,'Nazwa materiału'@);
   PRN4.add("__TAB4[1].SYMDOK",15,'Symbol dokumentu'@);
   PRN4.add("$__TAB4[1].DATA",10,'Data'@);
   PRN4.add("__TAB4[1].SLO",8,'Wydział'@);
   'surowce nielimitowane';
   PRN5.add("__TAB5[1].KOD",15,'Kod surowca'@);
   PRN5.add("__TAB5[1].NAZ",30,'Nazwa surowca'@);
   PRN5.add("form(__TAB5[1].ILL,,4)",15,'Norma brutto'@,1);
   PRN5.add("form(__TAB5[1].ILP,,4)",15,'Pobrano'@,1);
   PRN5.add("__TAB5[1].MX",8,'Pobrania poniżej limitu'@);
   PRN5.add("__TAB5[1].DX",8,'Pobrania powyżej limitu'@);
   PRN5.add("__TAB5[1].REJ_MAT",8,'Nierozliczony na wykonaniach'@);
   'rejestracja robocizny';
   PRN6.add("__TAB6[1].NRPRZ",20,'Przewodnik'@);
   PRN6.add("__TAB6[1].POZ",7,'Pozycja'@,1);
   PRN6.add("__TAB6[1].OPIS",20,'Operacja'@);
   PRN6.add("form(__TAB6[1].TIME_N,,4)",15,'Norma'@,1);
   PRN6.add("form(__TAB6[1].TIME,,4)",15,'Zarejestrowany czas faktyczny'@,1);
   PRN6.add("__TAB6[1].MTX",8,'Poniżej normy'@);
   PRN6.add("__TAB6[1].DTX",8,'Przekro- czenie normy'@);
   PRN6.add("form(__TAB6[1].TIME_P,,4)",15,'Zarejestrowany czas wg normy'@,1);
   PRN6.add("__TAB6[1].MPX",8,'Poniżej normy'@);
   PRN6.add("__TAB6[1].DPX",8,'Przekro- czenie normy'@);
   PRN6.add("__TAB6[1].ZAK",8,'Zakończone'@);
   'ilosci na przewodnikach';
   PRN7.add("__TAB7[1].NRPRZ",20,'Przewodnik'@);
   PRN7.add("__TAB7[1].POZ",7,'Pozycja'@,1);
   PRN7.add("__TAB7[1].OPIS",40,'Operacja'@);
   PRN7.add("form(__TAB7[1].ILNPRZ,,4)",15,'Ilość na przewodniku'@,1);
   PRN7.add("form(__TAB7[1].IL_KOOP,,4)",15,'Ilość w kooperacji'@,1);
   PRN7.add("form(__TAB7[1].ILOSC,,4)",15,'Ilość zare- jestrowana'@,1);
   PRN7.add("__TAB7[1].MX",8,'Niedobór'@);
   PRN7.add("__TAB7[1].DX",8,'Przekro- czenie'@);
   PAR_WYDR.TITLE:='RAPORT MOŻLIWOŚCI ZAMKNIĘCIA ZLECENIA'@; ~~}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{ prn1:='PRN1'; ~~}
{FONT: 'T8G'}{SPACE: 'B'}
{<1 'PARAMETRY WYDRUKU:'@}
{<1 'Zlecenie: %1'@[VAR.A_ZLEC().SYM]}
{<1 'Ilość planowana na zlecenie: %1'@[form(ZL.IL,,4)]}
{<1 'Ilość zarejestrowana raportami produkcji: %1'@[form(ZL.ILWYK,,4)]}
{<1 'Podczas kontroli zlecenia sprawdzono:'@}
{IF: ZL.TYP().K_NZL='T'}
{<10 'Akceptację limitów zlecenia'@}
{FI}
{IF: ZL.TYP().K_PDP='T'}
{<10 'Akceptację dokumentów produkcyjnych'@}
{FI}
{IF: ZL.TYP().K_LIM='T'}
{<10 'Poprawność rozliczenia surowców limitowanych'@}
{FI}
{IF: ZL.TYP().K_NLI='T'}
{<10 'Poprawność rozliczenia surowców nielimitowanych'@}
{FI}
{IF: ZL.TYP().K_ROB='T'}
{<10 'Poprawność rejestracji robocizny'@}
{FI}
{IF: ZL.TYP().K_ILO='T'}
{<10 'Poprawność rejestracji ilości do przewodników'@}
{FI}

{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{IF: var_pres('__TAB2')>100}
  { prn1:='PRN2'; ~~}
  {FOOTER: 0}
    {SUBSTITUTE: 'LINIAF'}
    {LINE: 1}
  {FOOTER-}
  {FONT: 'T8G'}{SPACE: 'B'}
{  lmt:=int((charleft()-PRN2.width())/2); ~~}
  {<{lmt+1} 'NIEZAAKCEPTOWANE LIMITY DO ZLECENIA'@}
  {FONT: 'T8GB'}
  {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
  {FONT: 'T8G'}{SPACE: 'B'}
  { rsep:=PAR_WYDR.RSEP; ~~}
  {FOR: __TAB2[1]}
  {DO}
  {FIRST}
   {HEADER}
    {SUBSTITUTE: 'HEAD'}
    {FONT: 'T8GB'}{SPACE: 'B'}
    {SUBSTITUTE: 'TABHEAD'}
   {HEADER-}
  {FIRST-}
    {SUBSTITUTE: 'LINIA0'}
    { licznik+=1; ~~}
  {OD}
  {FOOTER: 0}
    {LINE: 1}
  {FOOTER-}
  {HEADER}
    {SUBSTITUTE: 'HEAD'}
  {HEADER-}
  {SUBSTITUTE: 'LINIAF'}
  {IF:lineleft()>=1 & lineleft()<=2}{PAGE}{FI}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{IF: var_pres('__TAB4')>100}
  { prn1:='PRN4'; ~~}
  {FOOTER: 0}
    {SUBSTITUTE: 'LINIAF'}
    {LINE: 1}
  {FOOTER-}
  {FONT: 'T8G'}{SPACE: 'B'}
{  lmt:=int((charleft()-PRN4.width())/2); ~~}
  {<{lmt+1} 'NIEZAAKCEPTOWANE DOKUMENTY PRODUKCYJNE'@}
  {FONT: 'T8GB'}
  {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
  {FONT: 'T8G'}{SPACE: 'B'}
  { rsep:=PAR_WYDR.RSEP; ~~}
  {FOR: __TAB4[1]}
  {DO}
  {FIRST}
   {HEADER}
    {SUBSTITUTE: 'HEAD'}
    {FONT: 'T8GB'}{SPACE: 'B'}
    {SUBSTITUTE: 'TABHEAD'}
   {HEADER-}
  {FIRST-}
    {SUBSTITUTE: 'LINIA0'}
    { licznik+=1; ~~}
  {OD}
  {FOOTER: 0}
    {LINE: 1}
  {FOOTER-}
  {HEADER}
    {SUBSTITUTE: 'HEAD'}
  {HEADER-}
  {SUBSTITUTE: 'LINIAF'}
  {IF:lineleft()>=1 & lineleft()<=2}{PAGE}{FI}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{IF: var_pres('__TAB3')>100}
  { prn1:='PRN3'; ~~}
  {FOOTER: 0}
    {SUBSTITUTE: 'LINIAF'}
    {LINE: 1}
  {FOOTER-}
  {FONT: 'T8G'}{SPACE: 'B'}
{  lmt:=int((charleft()-PRN3.width())/2); ~~}
  {<{lmt+1} {? ZL.TYP().WP='P' || 'NIEZGODNOŚCI LIMITÓW ZLECENIA (przeliczone do ilości wykonanej)'@ || 'NIEZGODNOŚCI LIMITÓW ZLECENIA'@ ?}}
  {FONT: 'T8GB'}
  {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
  {FONT: 'T8G'}{SPACE: 'B'}
  { rsep:=PAR_WYDR.RSEP; ~~}
  {FOR: __TAB3[1]}
  {DO}
  {FIRST}
   {HEADER}
    {SUBSTITUTE: 'HEAD'}
    {FONT: 'T8GB'}{SPACE: 'B'}
    {SUBSTITUTE: 'TABHEAD'}
   {HEADER-}
  {FIRST-}
    {SUBSTITUTE: 'LINIA0'}
    { licznik+=1; ~~}
  {OD}
  {FOOTER: 0}
    {LINE: 1}
  {FOOTER-}
  {HEADER}
    {SUBSTITUTE: 'HEAD'}
  {HEADER-}
  {SUBSTITUTE: 'LINIAF'}
  {IF:lineleft()>=1 & lineleft()<=2}{PAGE}{FI}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{IF: var_pres('__TAB5')>100}
  { prn1:='PRN5'; ~~}
  {FOOTER: 0}
    {SUBSTITUTE: 'LINIAF'}
    {LINE: 1}
  {FOOTER-}
  {FONT: 'T8G'}{SPACE: 'B'}
{  lmt:=int((charleft()-PRN5.width())/2); ~~}
  {<{lmt+1} 'NIEZGODNOŚCI W ROZLICZENIU SUROWCÓW NIELIMITOWANYCH'@}
  {FONT: 'T8GB'}
  {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
  {FONT: 'T8G'}{SPACE: 'B'}
  { rsep:=PAR_WYDR.RSEP; ~~}
  {FOR: __TAB5[1]}
  {DO}
  {FIRST}
   {HEADER}
    {SUBSTITUTE: 'HEAD'}
    {FONT: 'T8GB'}{SPACE: 'B'}
    {SUBSTITUTE: 'TABHEAD'}
   {HEADER-}
  {FIRST-}
    {SUBSTITUTE: 'LINIA0'}
    { licznik+=1; ~~}
  {OD}
  {FOOTER: 0}
    {LINE: 1}
  {FOOTER-}
  {HEADER}
    {SUBSTITUTE: 'HEAD'}
  {HEADER-}
  {SUBSTITUTE: 'LINIAF'}
  {IF:lineleft()>=1 & lineleft()<=2}{PAGE}{FI}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{IF: var_pres('__TAB6')>100}
  { prn1:='PRN6'; ~~}
  {FOOTER: 0}
    {SUBSTITUTE: 'LINIAF'}
    {LINE: 1}
  {FOOTER-}
  {FONT: 'T8G'}{SPACE: 'B'}
{  lmt:=int((charleft()-PRN6.width())/2); ~~}
  {<{lmt+1} {? ZL.TYP().WP='P' || 'NIEZGODNOŚCI W ROZLICZENIU ROBOCIZNY (przeliczone do ilości wykonanej)'@ || 'NIEZGODNOŚCI W ROZLICZENIU ROBOCIZNY'@ ?}}
  {FONT: 'T8GB'}
  {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
  {FONT: 'T8G'}{SPACE: 'B'}
  { rsep:=PAR_WYDR.RSEP; ~~}
  {FOR: __TAB6[1]}
  {DO}
  {FIRST}
   {HEADER}
    {SUBSTITUTE: 'HEAD'}
    {FONT: 'T8GB'}{SPACE: 'B'}
    {SUBSTITUTE: 'TABHEAD'}
   {HEADER-}
  {FIRST-}
    {SUBSTITUTE: 'LINIA0'}
    { licznik+=1; ~~}
  {OD}
  {HEADER}
    {SUBSTITUTE: 'HEAD'}
  {HEADER-}
  {FOOTER: 0}
    {LINE: 1}
  {FOOTER-}
  {SUBSTITUTE: 'LINIAF'}
  {IF:lineleft()>=1 & lineleft()<=2}{PAGE}{FI}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{IF: var_pres('__TAB7')>100}
  { prn1:='PRN7'; ~~}
  {FOOTER: 0}
    {SUBSTITUTE: 'LINIAF'}
    {LINE: 1}
  {FOOTER-}
  {FONT: 'T8G'}{SPACE: 'B'}
{  lmt:=int((charleft()-PRN7.width())/2); ~~}
  {<{lmt+1} 'NIEZGODNOŚCI W ROZLICZENIU ILOŚCI DO PRZEWODNIKÓW'@}
  {FONT: 'T8GB'}
  {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
  {FONT: 'T8G'}{SPACE: 'B'}
  { rsep:=PAR_WYDR.RSEP; ~~}
  {FOR: __TAB7[1]}
  {DO}
  {FIRST}
   {HEADER}
    {SUBSTITUTE: 'HEAD'}
    {FONT: 'T8GB'}{SPACE: 'B'}
    {SUBSTITUTE: 'TABHEAD'}
   {HEADER-}
  {FIRST-}
    {SUBSTITUTE: 'LINIA0'}
    { licznik+=1; ~~}
  {OD}
  {HEADER}
    {SUBSTITUTE: 'HEAD'}
  {HEADER-}
  {FOOTER: 0}
    {LINE: 1}
  {FOOTER-}
  {SUBSTITUTE: 'LINIAF'}
  {IF:lineleft()>=1 & lineleft()<=2}{PAGE}{FI}
{FI}
{IF: licznik=0}
{FONT: 'T8G'}{SPACE: 'B'}
{<1 'Nie znaleziono niezgodności.'@}
{FI}
