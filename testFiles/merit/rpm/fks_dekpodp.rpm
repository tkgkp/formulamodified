:!UTF-8
{TITLE: Informacja VAT-UE}
{PRINTER: 'port_std',,,,,'Q','C',,,,,,1,0,0,0,0,1,1,'A4'}
{BEGIN:
   na_str:={? VAT_DEK.NR().NR=3 || 59 || 53 ?};
   na_strC:={? VAT_DEK.NR().NR=3 || 54 || 53 ?};
   sd:=obj_new(na_str); nd:=obj_new(na_str); kd:=obj_new(na_str); td:=obj_new(na_str);
   sn:=obj_new(na_str); nn:=obj_new(na_str); kn:=obj_new(na_str); tn:=obj_new(na_str);
   su:=obj_new(na_str); nu:=obj_new(na_str); ku:=obj_new(na_str);
   l:=-1; STR.split(XINFO.NAZ+', '+XINFO.REGON); {! |? l+=1; STR.line(71); STR.next() !};
   us:=-1; STR.split(XINFO.URZAD().NU+', '+XINFO.URZAD().UK+' '+XINFO.URZAD().MU+', '+XINFO.URZAD().UU);
   {! |? us+=1; STR.line(71); STR.next() !};
   i:=j:=la:=lb:=lc:=0;
   NIPY.index('SNIP_F'); NIPY.prefix(REF.S_FIRMA,'PL');
   nipuelic:={? NIPY.first() || 2-NIPY.SNIP || XINFO.NIP ?};
   prfx_rpi:='';
   exec('rpm_as_pdf_ini','rpm_pdf')
}
{END:
   exec('rpm_as_pdf_end','rpm_pdf');
   &nipuelic;
   &i; &j; &la; &lb; &lc; &l;
   VAR_DEL.delete('prfx_rpi','sd','nd','kd','td','sn','nn','kn','tn','su','nu','ku','us');
   VAR_DEL.delete('na_str','na_strC')
}
{  _wer:=VAT_DEK.NR().NR;
   prfx_rpi:='fks_du'+form(_wer,-2);
   VAT_POZ.index('VAT_POZ'); VAT_POZ.prefix(VAT_DEK.ref(),'VAT-UE/A');
   {? VAT_POZ.first()
   || la:=ceil(VAT_POZ.size()/na_str)
   ?};
   VAT_POZ.prefix(VAT_DEK.ref(),'VAT-UE/B');
   {? VAT_POZ.first()
   || lb:=ceil(VAT_POZ.size()/na_str)
   ?};
   VAT_POZ.prefix(VAT_DEK.ref(),'VAT-UE/C');
   {? VAT_POZ.first()
   || lc:=ceil(VAT_POZ.size()/na_strC)
   ?};
   {! _i:=1..na_str |!
      sd[_i]:=nd[_i]:=td[_i]:=sn[_i]:=nn[_i]:=tn[_i]:=''; kd[_i]:=kn[_i]:=0;
      su[_i]:=nu[_i]:=''; ku[_i]:=0
   !};
   VAT_POZ.prefix(VAT_DEK.ref(),'VAT-UE C');
   {? VAT_POZ.first()
   || _i:=1;
      {! |?
         nd[_i]:=VAT_POZ.OP; kd[_i]:=VAT_POZ.NETTO$0; td[_i]:=VAT_POZ.Z;
         {? exec('kod_pl','slo_slu',2+nd[_i])
         || sd[_i]:=2+nd[_i]; nd[_i]:=2-nd[_i]
         ?};
         _i+=1;
         VAT_POZ.next()
      !}
   ?};
   VAT_POZ.prefix(VAT_DEK.ref(),'VAT-UE D');
   {? VAT_POZ.first()
   || _i:=1;
      {! |?
         nn[_i]:=VAT_POZ.OP; kn[_i]:=VAT_POZ.NETTO$0; tn[_i]:=VAT_POZ.Z;
         {? exec('kod_pl','slo_slu',2+nn[_i])
         || sn[_i]:=2+nn[_i]; nn[_i]:=2-nn[_i]
         ?};
         _i+=1;
         VAT_POZ.next()
      !}
   ?};
   VAT_POZ.prefix(VAT_DEK.ref(),'VAT-UE E');
   {? VAT_POZ.first()
   || _i:=1;
      {!
      |? nu[_i]:=VAT_POZ.OP; ku[_i]:=VAT_POZ.NETTO$0;
         {? exec('kod_pl','slo_slu',2+nu[_i])
         || su[_i]:=2+nu[_i]; nu[_i]:=2-nu[_i]
         ?};
         _i+=1;
         VAT_POZ.next()
      !}
   ?}; ~~}
{REP: '{INCLUDE: '+prfx_rpi+'pe1w.rpi}'}
{REP: '{INCLUDE: '+prfx_rpi+'pe2w.rpi}'}
{  {! i:=1..na_str |!
      sd[i]:=nd[i]:=td[i]:=sn[i]:=nn[i]:=tn[i]:=''; kd[i]:=kn[i]:=0;
      su[i]:=nu[i]:=''; ku[i]:=0
   !};
   i:=j:=1;~~}
{FOR: VAT_POZ}
{INDEX: 'VAT_POZ'}{PREFIX: VAT_DEK.ref(),'VAT-UE/A'}
{DO}
{IF: _v:=9-VAT_POZ.LP; _pos:=_v*' '; _v:=(_pos-1)+_v; #_v<>j}
{REP: '{INCLUDE: '+prfx_rpi+'pa1w.rpi}'}
{REP: '{INCLUDE: '+prfx_rpi+'pa2w.rpi}'}
{        {! i:=1..na_str |!
            sd[i]:=nd[i]:=td[i]:=sn[i]:=nn[i]:=tn[i]:=''; kd[i]:=kn[i]:=0;
            su[i]:=nu[i]:=''; ku[i]:=0
         !};
         i:=1; j+=1; ~~}
{FI}
{  nd[i]:=VAT_POZ.OP; kd[i]:=VAT_POZ.NETTO$0; td[i]:=VAT_POZ.Z;
      {? exec('kod_pl','slo_slu',2+nd[i])
      || sd[i]:=2+nd[i]; nd[i]:=2-nd[i]
      ?};
      i+=1; ~~}
{OD}
{IF: i>1}
{REP: '{INCLUDE: '+prfx_rpi+'pa1w.rpi}'}
{REP: '{INCLUDE: '+prfx_rpi+'pa2w.rpi}'}
{FI}
{  {! i:=1..na_str |!
      sd[i]:=nd[i]:=td[i]:=sn[i]:=nn[i]:=tn[i]:=''; kd[i]:=kn[i]:=0;
      su[i]:=nu[i]:=''; ku[i]:=0
   !};
   i:=j:=1; ~~}
{FOR: VAT_POZ}
{INDEX: 'VAT_POZ'}
{PREFIX: VAT_DEK.ref(),'VAT-UE/B'}
{DO}
{IF: _v:=9-VAT_POZ.LP; _pos:=_v*' '; _v:=(_pos-1)+_v; #_v<>j}
{REP: '{INCLUDE: '+prfx_rpi+'pb1w.rpi}'}
{REP: '{INCLUDE: '+prfx_rpi+'pb2w.rpi}'}
{  {! i:=1..na_str |!
            sd[i]:=nd[i]:=td[i]:=sn[i]:=nn[i]:=tn[i]:=''; kd[i]:=kn[i]:=0;
            su[i]:=nu[i]:=''; ku[i]:=0
         !};
         i:=1; j+=1; ~~}
{FI}
{  nn[i]:=VAT_POZ.OP; kn[i]:=VAT_POZ.NETTO$0; tn[i]:=VAT_POZ.Z;
      {? exec('kod_pl','slo_slu',2+nn[i])
      || sn[i]:=2+nn[i]; nn[i]:=2-nn[i]
      ?};
      i+=1; ~~}
{OD}
{IF: i>1}
{REP: '{INCLUDE: '+prfx_rpi+'pb1w.rpi}'}
{REP: '{INCLUDE: '+prfx_rpi+'pb2w.rpi}'}
{FI}
{  {! i:=1..na_str |!
      sd[i]:=nd[i]:=td[i]:=sn[i]:=nn[i]:=tn[i]:=''; kd[i]:=kn[i]:=0;
      su[i]:=nu[i]:=''; ku[i]:=0
   !};
   i:=j:=1; ~~}
{FOR: VAT_POZ}
{INDEX: 'VAT_POZ'}
{PREFIX: VAT_DEK.ref(),'VAT-UE/C'}
{DO}
{IF: _v:=9-VAT_POZ.LP; _pos:=_v*' '; _v:=(_pos-1)+_v; #_v<>j}
{REP: '{INCLUDE: '+prfx_rpi+'pc1w.rpi}'}
{REP: '{INCLUDE: '+prfx_rpi+'pc2w.rpi}'}
{  {! i:=1..na_str |!
            sd[i]:=nd[i]:=td[i]:=sn[i]:=nn[i]:=tn[i]:=''; kd[i]:=kn[i]:=0;
            su[i]:=nu[i]:=''; ku[i]:=0
         !};
         i:=1; j+=1; ~~}
{FI}
{  nu[i]:=VAT_POZ.OP; ku[i]:=VAT_POZ.NETTO$0;
      {? exec('kod_pl','slo_slu',2+nu[i])
      || su[i]:=2+nu[i]; nu[i]:=2-nu[i]
      ?};
      i+=1; ~~}
{OD}
{IF: i>1}
{REP: '{INCLUDE: '+prfx_rpi+'pc1w.rpi}'}
{REP: '{INCLUDE: '+prfx_rpi+'pc2w.rpi}'}
{FI}