:!UTF-8
{TITLE:Wydruk dokumentu zmiany właściwości}
{PRINTER: FINFO.W_PRN,,,,,'M','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   VAR_DEL.delete('czy_szablon');
   czy_szablon:=exec('rep_set','rap_zew','FST_DOKEW',1)='T';
   PRN:=obj_new(@.CLASS.PRINT,15); PRN.s_frame();
   PRN1:=obj_new(@.CLASS.PRINT,1); PRN1.s_frame();
   c:=obj_new(15);
   {! _i:=1..15 |! c[_i] := '' !};
   i:=0;
   color:=prn1:=prn2:=''; nagl:=0;
   lm:=ll:=vp:=lmt:=rsep:=0;
   par1:=0; par2:=0; par3:=0; par4:=0; par5:=0;
   exec('set_srdo_pom','fst2');

   VAR_DEL.delete('__SRDO');
   __SRDO:=tab_tmp(1,'LP','INTEGER','Lp',
                     'CECHA','STRING[25]','Cecha',
                     'WARTOSC','STRING[255]','Wartość',
                     'NAGL','INTEGER','Nagl');
   __SRDO.LP:=1; __SRDO.CECHA:='Dla środka';
   __SRDO.WARTOSC:='['+SRDO.SRSR().NRI+'] '+SRDO.SRSR().NST;
   __SRDO.add();
   __SRDO.LP+=1; __SRDO.CECHA:='Typ dokumentu'; __SRDO.WARTOSC:=SRDO.TYP().NAZWA; __SRDO.NAGL:=0;
   __SRDO.add();
   __SRDO.LP+=1; __SRDO.CECHA:='Jedn. księg. dokumentu'; __SRDO.WARTOSC:=SRDO.ODD_DOK().OD; __SRDO.NAGL:=0;
   __SRDO.add();
   __SRDO.LP+=1; __SRDO.CECHA:='Data wprowadzenia'; __SRDO.WARTOSC:=$SRDO.DW; __SRDO.NAGL:=0;
   __SRDO.add();
   __SRDO.LP+=1; __SRDO.CECHA:='Data obowiązywania'; __SRDO.WARTOSC:=$SRDO.DO; __SRDO.NAGL:=0;
   __SRDO.add();
   __SRDO.LP+=1; __SRDO.CECHA:='Obowiązuje od okresu'; __SRDO.WARTOSC:=SRDO.OKRO_F().NAZ+' '+SRDO.ROK_F().NAZ; __SRDO.NAGL:=0;
   __SRDO.add();
   __SRDO.LP+=1; __SRDO.CECHA:='Komisja'; __SRDO.WARTOSC:=SRDO.KOMISJA; __SRDO.NAGL:=0;
   __SRDO.add();
   __SRDO.LP+=1; __SRDO.CECHA:='Przewodniczący'; __SRDO.WARTOSC:=SRDO.PRZ_KOM; __SRDO.NAGL:=0;
   __SRDO.add();
   __SRDO.LP+=1; __SRDO.CECHA:='Orzeczenie komisji'; __SRDO.WARTOSC:=SRDO.ORZ_KOM; __SRDO.NAGL:=0;
   __SRDO.add();

   __SRDO.LP+=1; __SRDO.CECHA:='Przed korektą'; __SRDO.WARTOSC:=''; __SRDO.NAGL:=1;
   __SRDO.add();
   {? SRDO.TYP().NST='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Nazwa środka'; __SRDO.WARTOSC:=SRDO_POM.NST; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().NRI='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Numer inwentarzowy'; __SRDO.WARTOSC:=SRDO_POM.NRI; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().JORG='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Jednostka organizacyjna'; __SRDO.WARTOSC:=SRDO_POM.JORG().SYMBOL; __SRDO.NAGL:=0;
      __SRDO.add();
      __SRDO.LP+=1; __SRDO.CECHA:='Jednostka księgowa'; __SRDO.WARTOSC:=SRDO_POM.ODD().OD; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().POM='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Pomieszczenie'; __SRDO.WARTOSC:=SRDO_POM.POM().S; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().OSOBA='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Użytkownik'; __SRDO.WARTOSC:=SRDO_POM.OSOBA().PIERWSZE+' '+SRDO_POM.OSOBA().NAZWISKO; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().GR='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Grupa'; __SRDO.WARTOSC:=SRDO_POM.GR().GR; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().KONPOD='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Konta podatkowe'; __SRDO.WARTOSC:=SRDO_POM.KONPOD().KOD; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().KONFIN='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Konta bilansowe'; __SRDO.WARTOSC:=SRDO_POM.KONFIN().KOD; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? FINFO.TOR_D='T' & SRDO.TYP().KONDOD='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Konta dodatkowe'; __SRDO.WARTOSC:=SRDO_POM.KONDOD().KOD; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};

   __SRDO.LP+=1; __SRDO.CECHA:='Po korekcie'; __SRDO.WARTOSC:=''; __SRDO.NAGL:=1;
   __SRDO.add();
   {? SRDO.TYP().NST='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Nazwa środka'; __SRDO.WARTOSC:=SRDO.NST; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().NRI='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Numer inwentarzowy'; __SRDO.WARTOSC:=SRDO.NRI; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().JORG='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Jednostka organizacyjna'; __SRDO.WARTOSC:=SRDO.JORG().SYMBOL; __SRDO.NAGL:=0;
      __SRDO.add();
      __SRDO.LP+=1; __SRDO.CECHA:='Jednostka księgowa'; __SRDO.WARTOSC:=SRDO.ODD().OD; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().POM='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Pomieszczenie'; __SRDO.WARTOSC:=SRDO.POM().S; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().OSOBA='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Użytkownik'; __SRDO.WARTOSC:=SRDO.OSOBA().PIERWSZE+' '+SRDO.OSOBA().NAZWISKO; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().GR='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Grupa'; __SRDO.WARTOSC:=SRDO.GR().GR; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().KONPOD='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Konta podatkowe'; __SRDO.WARTOSC:=SRDO.KONPOD().KOD; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? SRDO.TYP().KONFIN='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Konta bilansowe'; __SRDO.WARTOSC:=SRDO.KONFIN().KOD; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   {? FINFO.TOR_D='T' & SRDO.TYP().KONDOD='T'
   || __SRDO.LP+=1; __SRDO.CECHA:='Konta dodatkowe'; __SRDO.WARTOSC:=SRDO.KONDOD().KOD; __SRDO.NAGL:=0;
      __SRDO.add()
   ?};
   1
}
{END:
   obj_del(PRN);
   obj_del(c);
   obj_del(PRN1);
   &i; &color; &prn1; &prn2;
   &lm; &ll; &vp; &lmt; &rsep; &nagl;
   &par1; &par2; &par3;&par4;&par5;
   VAR_DEL.delete('__SRDO','czy_szablon');
   1
}
{EXIT:
   exec('set_var','param_wydr');
   {? OPERATOR.DEPT<>null
      || PAR_WYDR.ODD:=OPERATOR.DEPT
      || PAR_WYDR.ODD:=0
   ?};
   0
}
{IF: czy_szablon}
   {exec('wypelnij','szablon','FST_DOKEW',
   {? SRDO.TYP().TYP='MG'
   || 'FST_DOKEW_MG'
   |? SRDO.TYP().TYP='MT'
   || 'FST_DOKEW_MT'
   |? SRDO.TYP().TYP='PU'
   || 'FST_DOKEW_PU'
   ?}
   ,,,);~~}
   {EXIT}
{FI}
{COMMENT}
==================================================
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
Nazwa pliku: fst_dok_ot.rpm
Utworzony  : 2015-11-26
Zawartość  : Wydruk dokumentu przyjęcia
==================================================
{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{COMMENT}--Definicja wiersza wydruku--------------------{COMMENT-}
{  prn1:='PRN'; prn2:='PRN'; ~~}
{
      PRN.add("c[1]",30,'Cecha',,' ');
      PRN.add("c[2]",100,'Wartość',,' ');
      PRN1.add("c[1]",133,'',,'');

      PAR_WYDR.TITLE:='Symbol dokumentu: '+SRDO.SYMBOL; ~~}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{COMMENT}------------------------------Parametry wydruku------------{COMMENT-}
{FONT: 'W8'}{SPACE: 'C'}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FOR: __SRDO}
 {DO}
{COMMENT} ---- zwykłe wiersze ---- {COMMENT-}
 {
      c[1]:=__SRDO.CECHA;
      c[2]:=__SRDO.WARTOSC;
      {? nagl=0
      || prn1:='PRN'; prn2:='PRN'
      || prn1:='PRN1'; prn2:='PRN'; nagl:=0
      ?}; rsep:=1 ;~~}
 {IF: lineleft() <> 0 & lineleft() <=4}{PAGE}{FI}
 {IF: __SRDO.NAGL<>1}
 {FONT: 'T8G'}{SPACE: 'C'}{SUBSTITUTE: 'LINIA02'}
 {ELSE}
 {FONT: 'T8GB'}{SPACE: 'C'}{nagl:=1; prn1:='PRN'; prn2:='PRN1';~~}{SUBSTITUTE: 'LINIA02'}
 {FI}
 {rsep:=PAR_WYDR.RSEP;~~}
 {OD}
 {prn1:='PRN';~~}
{COMMENT}------------------------------FOOTER-LAST------------------{COMMENT-}
{FOOTER}{FOOTER-}
{REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}