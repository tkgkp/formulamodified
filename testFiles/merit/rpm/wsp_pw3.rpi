:!UTF-8
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzezone
==============================================================================
Nazwa pliku: wsp_pw3.rpi
  Utworzony: 2005-11-17 [MB]
==============================================================================
Zawartosc: Moduł pomocniczy do sporządzania wydruków
{COMMENT-}
{COMMENT}------------------------------CHARHEAD-----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania naglowka strony w trybie znakowym.
Nalezy zainicjonowac zmienne: lm i mdc oraz ustawic tytul w zmiennej PAR_WYDR.TITLE.
Opcjonalna zmienna font do ustawienie czcionki tytulu - domyslnie 'F'
{COMMENT-}
{MACRO: 'CHARHEAD'}
{FONT: 'I'}{SPACE: 'B'}
{mdc:=XINFO.MIA+', '+date$1; lm:=charleft();~~}
{IF: +XINFO.NAZ+4>lm-(+mdc) & lm}
   {>{lm} mdc}{STR.split(XINFO.NAZ);~~}
   {<1 STR.line(lm)}
   {WHILE: STR.next()}
   {DO}
      {<1 STR.line(lm)}
   {OD}
{ELSE}
   {<1 XINFO.NAZ}{>{lm} mdc}
{FI}{LINE: 1}
{IF: var_pres('font')>0 }{FONT: font}{ELSE}{FONT: 'F'}{FI}{SPACE: 'A'}{lm:=charleft();~~}
{<1>{lm} _poz:=PAR_WYDR.TITLE*'\n';
         {? _poz
            || (_poz-1)+PAR_WYDR.TITLE
            || PAR_WYDR.TITLE
         ?}}
{IF: PAR_WYDR.TITLE*'\n'}
   {<1>{lm} _poz:=PAR_WYDR.TITLE*'\n';
         PAR_WYDR.TITLE+(+PAR_WYDR.TITLE-_poz)}
{FI}
{MACRO-}
{COMMENT}------------------------------CHARFOOT-----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania stopki strony w trybie znakowym.
Nalezy zainicjonowac zmienna: lm.
{COMMENT-}
{MACRO: 'CHARFOOT'}
{COMMENT}
{FONT: 'M'}{SPACE: 'C'}{_proc:={? var_press('CFPROC')>0 || CFPROC || 0.75 ?}; lm:=charleft()*_proc;~~}
{<1 exec('nazwa','#system')+' '+menu_pth()+' v.ST'}{FONT: 'I'}{SPACE: 'B'}{>{lm} 'Strona '+$page}
{FONT: 'Q'}{SPACE: 'C'}
{COMMENT-}
{MACRO-}
