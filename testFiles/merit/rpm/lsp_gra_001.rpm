:!UTF-8
{TITLE:A. Gratis}
{PRINTER: exec('set_parw','param_wydr');exec('prt','param_wydr','h'),,,,,'Q','C',,,,,,1,
   PAR_WYDR.MBOT,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,0,1}
{BEGIN:
   cen_001:="
      VAR_DEL.delete('color','prn1','prn2');
      VAR_DEL.delete('lm','ll','vp','lmt','rsep');

      VAR_DEL.delete('k','w','dokl','doklw','PRN');
      VAR_DEL.delete('wydr_naz','wydr_edi');
      VAR_DEL.delete('wyjscie','X_Xd');
      VAR_DEL.delete('p_il','p_ildo','p_war','p_wardo','p_gil','p_gcen')";
   cen_001();

   k:=obj_new(15); "--szerokosci kolumn--";
   w:=obj_new(15); "--wartosci kolumn--";

   dokl:=3; "--dokladnosc ilosci--";
   doklw:=2; "--dokladnosc wartosc--";

   PRN:=obj_new(@.CLASS.PRINT,15); PRN.s_frame();

   k[1]:=5;
   k[2]:=8;
   k[3]:=8;
   k[4]:=39;
   k[5]:=5;
   k[6]:=10;
   k[7]:=10;
   k[8]:=10;
   k[9]:=10;
   k[10]:=10;
   k[11]:=10;
   k[12]:=39;
   k[13]:=10;
   k[14]:=10;
   k[15]:=10;

   wyjscie:=0;

   color:=prn1:=prn2:='';
   lm:=ll:=vp:=lmt:=0;
   rsep:=PAR_WYDR.RSEP
}
{END:
   cen_001(); VAR_DEL.delete('cen_001')
}
{INCLUDE: wsp_pw.rpi}
{
PRN.add("w[1]",k[1],'Lp.'@,1);
PRN.add("w[2]",k[2],'Grupa'@);
PRN.add("w[3]",k[3],'Podgrupa'@);
PRN.add("w[4]",k[4],'Indeks'@);
PRN.add("w[5]",k[5],'Jm'@);
PRN.add("w[6]",k[6],'Ważny od'@);
PRN.add("w[7]",k[7],'Ważny do'@);
PRN.add("w[8]",k[8],'Ilść od'@,1);
PRN.add("w[9]",k[9],'Ilść do'@,1);
PRN.add("w[10]",k[10],'Wartość od'@,1);
PRN.add("w[11]",k[11],'Wartość do'@,1);
PRN.add("w[12]",k[12],'Gratis'@,1);
PRN.add("w[13]",k[13],'Jm'@,1);
PRN.add("w[14]",k[14],'Ilość'@,1);
PRN.add("w[15]",k[15],'Cena'@,1);

TAP.index('TM'); TAP.prefix(DISP.TAR);
p_il:=exec('fld_prec','#field',TAP,'IL');
p_ildo:=exec('fld_prec','#field',TAP,'IL_DO');
p_war:=exec('fld_prec','#field',TAP,'WAR');
p_wardo:=exec('fld_prec','#field',TAP,'WAR_DO');
p_gil:=exec('fld_prec','#field',TAP,'GRA_IL');
p_gcen:=exec('fld_prec','#field',TAP,'GRA_CEN');

PAR_WYDR.TITLE:='GRATISY '+TAR.KOD+' '+TAR.NAZ;
prn1:='PRN';
~~}
{
TAP.index('TM'); TAP.prefix(DISP.TAR);
{? ~TAP.first || wyjscie:=1; FUN.info('Brak danych spełniających kryteria.'@) ?};~~}
{EXIT: wyjscie=1}
{COMMENT}   SIGNATURE          1                                      {COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}   REPORT-HEADER                                            {COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2);~~}
{<{lmt+1}}{'Parametry wydruku:'}
{IF: TAZ.SD='G'}
   {<{lmt+1}}{IF: TAP.name+2='__'}{'Gratisy'}{ELSE}{'Archiwum'}{FI}
{ELSE}
   {<{lmt+1}}{IF: TAP.name+2='__'}{'Cennik'}{ELSE}{'Archiwum'}{FI}
{FI}
{LINE}
{FONT: 'T8GB'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1;~~}
{COMMENT}   HEADER                                                   {COMMENT-}
{HEADER}
   {SUBSTITUTE: 'HEAD'}
   {FONT: 'T8GB'}{SPACE: 'C'}
   {SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}   FOOTER                                                   {COMMENT-}
{FOOTER: 0}
   {SUBSTITUTE: 'LINIAF'}
   {LINE: 1}
{FOOTER-}
{COMMENT}   drukowanie pozycji                                       {COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{FOR: TAP}
{INDEX: 'TM'}
{PREFIX: DISP.TAR}
{DO}
   {FIRST}{ rsep:=PAR_WYDR.RSEP; lp:=1;~~}{FIRST-}
   {
   lp+=1;
   w[1]:=form(lp,,0,'99');
   w[2]:=form(TAP.MGR().KOD);
   w[3]:=form(TAP.MGRP().KOD);
   w[4]:=form(TAP.M().KTM);
   w[5]:=form(TAP.JM().KOD);
   w[6]:=form(TAP.OD);
   w[7]:={? TAP.DO=date(0,0,0) || '' || form(TAP.DO) ?};
   w[8]:={? TAP.IL | TAP.IL_DO || form(TAP.IL,,p_il,'.,') || '' ?};
   w[9]:={? TAP.IL_DO || form(TAP.IL_DO,,p_ildo,'.,') || '' ?};
   w[10]:={? TAP.WAR | TAP.WAR_DO || form(TAP.WAR,,p_war,'.,') || '' ?};
   w[11]:={? TAP.WAR_DO || form(TAP.WAR_DO,,p_wardo,'.,') || '' ?};
   w[12]:=form(TAP.GRATIS().KTM);
   w[13]:=form(M.J().KOD);
   w[14]:={? TAP.GRA_IL || form(TAP.GRA_IL,,p_gil,'.,') || '' ?};
   w[15]:={? TAP.GRA_CEN || form(TAP.GRA_CEN,,p_gcen,'.,') || '' ?};
   ~~}
   {SUBSTITUTE: 'LINIA0'}
   {TOTAL}
      { VAR_DEL.delete('lp');~~}
{OD}