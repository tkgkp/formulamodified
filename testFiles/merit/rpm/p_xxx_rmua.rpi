:!UTF-8
{MACRO: 'cont'}
{IF: hs6}
{FONT:'H1'}{SPACE:'B'}
VI. ZESTAWIENIE WYPŁACONYCH ŚWIADCZEŃ I WYNAGRODZEŃ ZA CZAS ABSENCJI CHOROBOWEJ ORAZ
RODZAJE I OKRESY PRZERW W OPŁACANIU SKŁADEK
{FONT: 'T2'}{SPACE:'C'}

┌─────────────────────────────────────────────────────────────────────────────────────────┬────────────┬────────────┬────────────────────┬─────────────────────┐
│ Rodzaj świadczenia/przerwy                                                              │  Okres od  │  Okres do  │ L.dni zasiłkowych/ │       Kwota         │
│                                                                                         │            │            │ liczba wypłat      │                     │
├─────────────────────────────────────────────────────────────────────────────────────────┼────────────┼────────────┼────────────────────┼─────────────────────┤
{hs6:=0;~~}
{FI}
{
   STR.split(par[2][1]);
   par[12]:=1;
   ~~
}
{WHILE: +(Text:=STR.line(88))}{DO}
│ {<3Text} {>91}│ {>102,4{?par[12]||par[2][2]||''?}} {>104}│ {>115,4{?par[12]||par[2][3]||''?}} {>117}│ {<136{?par[12]||par[2][4]||''?}} {>138}│ {>158,2{?par[12]||form(par[2][6],,2)||''?}} {>160}│
{par[12]:=0;~~}
{OD}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'Lista'}
{
   '::       UWAGA: Procedura korzysta z numerow rubryk!';
   _ls:="_suma:=0; LS.prefix(P.ref(),_a); {? LS.first() || {! |? _suma+=LS.KW; LS.next() !} ?}; _suma";

   par[1][1]:=_ls(465);                'choroba';
   par[1][13]:=_ls(467);               'wyrównanie choroba';
   par[1][2]:={? dk<=date(2003,1,0) || _ls(468) ?};  'choroba wypadek';
   par[1][20]:={? dk<=date(2003,1,0) || _ls(469) ?}; 'wyrównanie choroba wypadek';
   par[1][3]:=_ls(510);                'zasiłek chorobowy';
   par[1][14]:=_ls(511);               'wyrównanie zasiłek chorobowy';
   par[1][4]:=_ls(512);                'zasiłek chorobowy wypadek';
   par[1][15]:=_ls(513);               'wyrównanie zasiłek chorobowy wypadek';
   par[1][5]:=_ls(523);                'zasiłek macierzynski';
   par[1][16]:=_ls(524);               'wyrównanie zasiłek macierzyński';
   par[1][6]:=_ls(529);                'zasiłek opiekuńczy';
   par[1][17]:=_ls(530);               'wyrównanie zasiłek opiekuńczy';
   par[1][7]:=_ls(531);                'świadczenie rehabilitacyjne';
   par[1][18]:=_ls(537);               'wyrównanie świadczenie rehabilitacyjne';
   par[1][8]:={? dk<date(2002,1,0) || _ls(541) ?};   'zasiłek porodowy';
   par[1][9]:=_ls(533);                'zasiłek wyrównawczy';
   par[1][12]:=_ls(516);               'choroba szpital';
   par[1][19]:=_ls(517);               'wyrównanie choroba szpital';
   ~~
}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'Nieobec'}
   {par[5]:=0;~~}
   {FOR: N}
   {INDEX:'NIEOBECL'}
   {PREFIX:'N',P.ref(),~O.LT}
   {DO}
      { par[8]:=N.NB().RN; ~~}
      {IF: ~__RUB.sys_attr(par[8],113,dk)}
         {IF: ~par[5]}
            {  par[5]:=1;
               N.cntx_psh();
               N.index('NIEOBECL');
               N.prefix('N',P.ref(),~O.LT);
               {? N.first()
               || {!
                  |? par[7]:=N.NB().RN;
                     {? __RUB.sys_attr(par[7],1211,dk) || par[6][1]+=1
                     |? __RUB.sys_attr(par[7],1212,dk) || par[6][2]+=1
                     |? __RUB.sys_attr(par[7],12211,dk) || par[6][3]+=1
                     |? __RUB.sys_attr(par[7],12213,dk) || par[6][4]+=1
                     |? __RUB.sys_attr(par[7],1227,dk) || par[6][5]+=1
                     |? __RUB.sys_attr(par[7],1225,dk) || par[6][6]+=1
                     |? __RUB.sys_attr(par[7],12212,dk) || par[6][7]+=1
                     |? __RUB.sys_attr(par[7],1222,dk) || par[6][8]+=1
                     ?};
                     N.next()
                  !}
               ?};
               N.cntx_pop();
               ~~
            }
         {FI}
         {
            par[2][2]:=N.OD; par[2][3]:=N.DO;
            par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',N.KDSW);
            par[2][4]:=N.NR; 'liczba dni';
            par[2][5]:=N.KDCH().KOD; ' kod ZUS';
            par[2][6]:=0;
            ~~
         }
         {IF: __RUB.sys_attr(par[8],1211,dk)}
            {
               'choroba wynagrodzenie';
               par[10][1]+=1;
               par[9]:=(N.NK-N.DN-N.DK-N.OP*0.25); {? par[9]<0 || par[9]:=0 ?};
               'wyliczenie zasiłku';
               par[2][6]+=N.STD*par[9]$2;
               {? par[2][6]>par[1][1]
               || par[2][6]:=par[1][1]; par[1][1]:=0
               || {? par[10][1]=par[6][1]
                  || par[2][6]:=par[1][1]; par[1][1]:=0
                  || par[1][1]-=par[2][6]
                  ?}
               ?};
               par[2][4]:=N.NK;
               ~~
            }
            {IF: par[1][13]>0 & par[1][1]=0}
               { 'wyrównanie choroba';~~}
               {FOR: LSW}
               {INDEX: 'R'}
               {PREFIX: P.ref(),467,~O.LT}
               {DO}
                  {SUBSTITUTE: 'cont'}
                  {
                     par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
                     par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
                     par[2][4]:=' '; 'liczba dni';
                     par[2][5]:=' ';
                     par[2][6]:=LSW.KW;
                     par[1][13]-=LSW.KW;
                     ~~
                  }
               {OD}
            {FI}
         {ELIF: __RUB.sys_attr(par[8],1212,dk)}
            {
               'choroba wynagrodzenie wypadek';
               par[10][2]+=1;
               par[9]:=(N.NK-N.DN-N.DK-N.OP*0.25); {? par[9]<0 || par[9]:=0 ?};
               'wyliczenie zasiłku';
               par[2][6]+=N.STD*par[9]$2;
               {? par[2][6]>par[1][2]
               || par[2][6]:=par[1][2]; par[1][2]:=0
               || {? par[10][2]=par[6][2]
                  || par[2][6]:=par[1][2]; par[1][2]:=0
                  || par[1][2]-=par[2][6]
                  ?}
               ?};
               par[2][4]:=N.NK;
               ~~
            }
            {IF: par[1][20]>0 & par[1][2]=0}
               { 'wyrównanie choroba wypadek';~~}
               {FOR: LSW}
               {INDEX: 'R'}
               {PREFIX: P.ref(),469,~O.LT}
               {DO}
                  {SUBSTITUTE: 'cont'}
                  {
                     par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
                     par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
                     par[2][4]:=' '; 'liczba dni';
                     par[2][5]:=' ';
                     par[2][6]:=LSW.KW;
                     par[1][20]-=LSW.KW;
                     ~~
                  }
               {OD}
            {FI}
         {ELIF: __RUB.sys_attr(par[8],12211,dk)}
            {
               'zasiłek chorobowy';
               par[10][3]+=1;
               par[9]:=(N.NK-N.DN-N.DK-N.OP*0.25); {? par[9]<0 || par[9]:=0 ?};
               'wyliczenie zasiłku';
               par[2][6]+=N.STD*par[9]$2;
               {? par[2][6]>par[1][3]
               || par[2][6]:=par[1][3]; par[1][3]:=0
               || {? par[10][3]=par[6][3]
                  || par[2][6]:=par[1][3]; par[1][3]:=0
                  || par[1][3]-=par[2][6]
                  ?}
               ?};
               par[2][4]:=N.NK;
               ~~
            }
            {IF: par[1][14]>0 & par[1][3]=0}
               { 'wyrównanie zasiłek chorobowy';~~}
               {FOR: LSW}
               {INDEX: 'R'}
               {PREFIX: P.ref(),511,~O.LT}
               {DO}
                  {SUBSTITUTE: 'cont'}
                  {
                     par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
                     par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
                     par[2][4]:=' '; 'liczba dni';
                     par[2][5]:=' ';
                     par[2][6]:=LSW.KW;
                     par[1][14]-=LSW.KW;
                     ~~
                  }
               {OD}
            {FI}
         {ELIF: __RUB.sys_attr(par[8],12213,dk)}
            {
               'zasiłek chorobowy wypadek';
               par[10][4]+=1;
               par[9]:=(N.NK-N.DN-N.DK-N.OP*0.25); {? par[9]<0 || par[9]:=0 ?};
               'wyliczenie zasiłku';
               par[2][6]+=N.STD*par[9]$2;
               {? par[2][6]>par[1][4]
               || par[2][6]:=par[1][4]; par[1][4]:=0
               || {? par[10][4]=par[6][4]
                  || par[2][6]:=par[1][4]; par[1][4]:=0
                  || par[1][4]-=par[2][6]
                  ?}
               ?};
               par[2][4]:=N.NK;
               ~~
            }
            {IF: par[1][15]>0 & par[1][4]=0}
               { 'wyrównanie zasiłek chorobowy wypadek';~~}
               {FOR: LSW}
               {INDEX: 'R'}
               {PREFIX: P.ref(),513,~O.LT}
               {DO}
                  {SUBSTITUTE: 'cont'}
                  {
                     par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
                     par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
                     par[2][4]:=' '; 'liczba dni';
                     par[2][5]:=' ';
                     par[2][6]:=LSW.KW;
                     par[1][15]-=LSW.KW;
                     ~~
                  }
               {OD}
            {FI}
         {ELIF: __RUB.sys_attr(par[8],1227,dk)}
            {
               'zasiłek macierzyński';
               par[10][5]+=1;
               par[9]:=(N.NK-N.DN-N.DK-N.OP*0.25); {? par[9]<0 || par[9]:=0 ?};
               'wyliczenie zasiłku';
               par[2][6]+=N.STD*par[9]$2;
               {? par[2][6]>par[1][5]
               || par[2][6]:=par[1][5]; par[1][5]:=0
               || {? par[10][5]=par[6][5]
                  || par[2][6]:=par[1][5]; par[1][5]:=0
                  || par[1][5]-=par[2][6]
                  ?}
               ?};
               par[2][4]:=N.NK;
               ~~
            }
            {IF: par[1][16]>0 & par[1][5]=0}
               { 'wyrównanie zasiłek macierzyński';~~}
               {FOR: LSW}
               {INDEX: 'R'}
               {PREFIX: P.ref(),524,~O.LT}
               {DO}
                  {SUBSTITUTE: 'cont'}
                  {
                     par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
                     par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
                     par[2][4]:=' '; 'liczba dni';
                     par[2][5]:=' ';
                     par[2][6]:=LSW.KW;
                     par[1][16]-=LSW.KW;
                     ~~
                  }
               {OD}
            {FI}
         {ELIF: __RUB.sys_attr(par[8],1225,dk)}
            {
               'zasiłek opiekuńczy';
               par[10][6]+=1;
               par[9]:=(N.NK-N.DN-N.DK-N.OP*0.25); {? par[9]<0 || par[9]:=0 ?};
               'wyliczenie zasiłku';
               par[2][6]+=N.STD*par[9]$2;
               {? par[2][6]>par[1][6]
               || par[2][6]:=par[1][6]; par[1][6]:=0
               || {? par[10][6]=par[6][6]
                  || par[2][6]:=par[1][6]; par[1][6]:=0
                  || par[1][6]-=par[2][6]
                  ?}
               ?};
               par[2][4]:=N.NK;
               ~~
            }
            {IF: par[1][17]>0 & par[1][6]=0}
               { 'wyrównanie zasiłek opiekuńczy';~~}
               {FOR: LSW}
               {INDEX: 'R'}
               {PREFIX: P.ref(),530,~O.LT}
               {DO}
                  {SUBSTITUTE: 'cont'}
                  {
                     par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
                     par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
                     par[2][4]:=' '; 'liczba dni';
                     par[2][5]:=' ';
                     par[2][6]:=LSW.KW;
                     par[1][17]-=LSW.KW;
                     ~~
                  }
               {OD}
            {FI}
         {ELIF: __RUB.sys_attr(par[8],12212,dk)}
            {
               'choroba szpital';
               par[10][7]+=1;
               par[9]:=(N.NK-N.DN-N.DK-N.OP*0.25); {? par[9]<0 || par[9]:=0 ?};
               'wyliczenie zasiłku';
               par[2][6]+=N.STD*par[9]$2;
               {? par[2][6]>par[1][12]
               || par[2][6]:=par[1][12]; par[1][12]:=0
               || {? par[10][7]=par[6][7]
                  || par[2][6]:=par[1][12]; par[1][12]:=0
                  || par[1][12]-=par[2][6]
                  ?}
               ?};
               par[2][4]:=N.NK;
               ~~
            }
            {IF: par[1][19]>0 & par[1][12]=0}
               { 'wyrównanie choroba szpital';~~}
               {FOR: LSW}
               {INDEX: 'R'}
               {PREFIX: P.ref(),517,~O.LT}
               {DO}
                  {SUBSTITUTE: 'cont'}
                  {
                     par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
                     par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
                     par[2][4]:=' '; 'liczba dni';
                     par[2][5]:=' ';
                     par[2][6]:=LSW.KW;
                     par[1][19]-=LSW.KW;
                     ~~
                  }
               {OD}
            {FI}
         {ELIF: __RUB.sys_attr(par[8],1222,dk)}
            {
               'świadczenie rehabilitacyjne';
               par[10][8]+=1;
               par[9]:=(N.NK-N.DN-N.DK-N.OP*0.25); {? par[9]<0 || par[9]:=0 ?};
               'wyliczenie zasiłku';
               par[2][6]+=N.STD*par[9]$2;
               {? par[2][6]>par[1][7]
               || par[2][6]:=par[1][7]; par[1][7]:=0
               || {? par[10][8]=par[6][8]
                  || par[2][6]:=par[1][7]; par[1][7]:=0
                  || par[1][7]-=par[2][6]
                  ?}
               ?};
               par[2][4]:=N.NK;
               ~~
            }
            {IF: par[1][18]>0 & par[1][7]=0}
               { 'wyrównanie świadczenie rehabilitacyjne';~~}
               {FOR: LSW}
               {INDEX: 'R'}
               {PREFIX: P.ref(),537,~O.LT}
               {DO}
                  {SUBSTITUTE: 'cont'}
                  {
                     par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
                     par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
                     par[2][4]:=' '; 'liczba dni';
                     par[2][5]:=' ';
                     par[2][6]:=LSW.KW;
                     par[1][18]-=LSW.KW;
                     ~~
                  }
               {OD}
         {FI}
         {ELIF: __RUB.sys_attr(par[8],1321,dk) | __RUB.sys_attr(par[8],1322,dk)}
            { 'nieobecność bezplatna'; par[2][6]:=0; ~~}
         {ELIF: __RUB.sys_attr(par[8],112,dk)}
            { 'urlop bezpłatny'; par[2][6]:=0; par[2][4]:=N.NK; ~~}
         {ELIF: __RUB.sys_attr(par[8],1242,dk)}
            { 'opieka bezpłatna'; par[2][6]:=0; ~~}
         {ELIF: __RUB.sys_attr(par[8],114,dk)}
            { 'urlop wychowawczy'; par[2][6]:=0; par[2][4]:=N.NK; ~~}
         {ELIF: __RUB.sys_attr(par[8],1323,dk)}
            { 'wojsko'; par[2][6]:=0; par[2][4]:=N.NK; ~~}
         {FI}
         {SUBSTITUTE:'cont'}
         {par[2][2]:=par[2][3]:='' ;~~}
      {FI}
   {OD}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'Choroby'}
   {par[2][2]:=par[2][3]:=''; ~~}
   {IF: par[1][1]>0}
      {
         'choroba wynagrodzenie';
         par[2][2]:=par[2][3]:='';
         par[2][1]:='wynagr. za czas niezdolności do pracy, nie wypadek'; 'kod ZUS: 331';
         par[2][4]:=0; par[2][5]:=' '; par[2][6]:=par[1][1];
         ~~
      }
      {SUBSTITUTE:'cont'}
   {FI}
   {IF: par[1][2]>0}
      {
         'choroba wypadek';
         par[2][2]:=par[2][3]:='';
         par[2][1]:='wynagr. za czas niezdolności do pracy, wypadek'; 'kod ZUS: 333';
         par[2][4]:=0; par[2][5]:=' '; par[2][6]:=par[1][2];
         ~~
      }
      {SUBSTITUTE:'cont'}
   {FI}
   {IF: par[1][3]>0}
      {
         'zasiłek chorobowy';
         par[2][2]:=par[2][3]:='';
         par[2][1]:='zasiłek chorobowy z ubezpieczenia chorobowego'; 'kod ZUS: 313';
         par[2][4]:=0; par[2][5]:=' '; par[2][6]:=par[1][3];
         ~~
      }
      {SUBSTITUTE:'cont'}
   {FI}
   {IF: par[1][4]>0}
      {
         'zasiłek chorobowy wypadek';
         par[2][2]:=par[2][3]:='';
         par[2][1]:='zasiłek chorobowy z ubezpieczenia wypadkowego'; 'kod ZUS: 314';
         par[2][4]:=0; par[2][5]:=' '; par[2][6]:=par[1][4];
         ~~
      }
      {SUBSTITUTE:'cont'}
   {FI}
   {IF: par[1][5]>0}
      {
         'zasiłek macierzyński';
         par[2][2]:=par[2][3]:='';
         par[2][1]:='zasiłek macierzyński'; 'kod ZUS: 311';
         par[2][4]:=0; par[2][5]:=' '; par[2][6]:=par[1][5];
         ~~
      }
      {SUBSTITUTE:'cont'}
   {FI}
   {IF: par[1][6]>0}
      {
         'zasiłek opiekuńczy';
         par[2][2]:=par[2][3]:='';
         par[2][1]:='zasiłek opiekuńczy z ubezpieczenia chorobowego'; 'kod ZUS: 312';
         par[2][4]:=0; par[2][5]:=' '; par[2][6]:=par[1][6];
         ~~
      }
      {SUBSTITUTE:'cont'}
   {FI}
   {IF: par[1][8]>0}
      {
         'zasiłek porodowy';
         par[2][2]:=par[2][3]:='';
         par[2][1]:='zasiłek porodowy'; 'kod ZUS: 211';
         LSS.prefix(P.ref(),541);
         {? LSS.first() || par[2][1]:=LSS.S().OPIS ?};
         par[2][4]:=1; par[2][5]:=' '; par[2][6]:=par[1][8];
         ~~
      }
      {SUBSTITUTE:'cont'}
   {FI}
   {IF: par[1][9]>0}
      {
         'zasiłek wyrównawczy';
         par[2][2]:=par[2][3]:='';
         par[2][1]:='zasiłek wyrównawczy'; 'kod ZUS: 212';
         par[2][4]:=1; par[2][5]:=' '; par[2][6]:=par[1][9];
         ~~
      }
      {SUBSTITUTE: 'cont'}
   {FI}
   {IF:
      par[1][13]>0 | par[1][14]>0 | par[1][15]>0 | par[1][16]>0 |
      par[1][17]>0 | par[1][18]>0 | par[1][19]>0 | par[1][20]>0
   }
      {IF: par[1][13]>0}
         { 'wyrównanie choroba';~~}
         {FOR: LSW}
         {INDEX: 'R'}
         {PREFIX: P.ref(),467,~O.LT}
         {DO}
            {
               par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
               par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
               par[2][4]:=' '; 'liczba dni';
               par[2][5]:=' ';
               par[2][6]:=LSW.KW;
               par[1][13]-=LSW.KW;
               ~~
            }
            {SUBSTITUTE: 'cont'}
         {OD}
      {FI}
      {IF: par[1][20]>0}
         { 'wyrównanie choroba wypadek';~~}
         {FOR: LSW}
         {INDEX: 'R'}
         {PREFIX: P.ref(),469,~O.LT}
         {DO}
            {
               par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
               par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
               par[2][4]:=' '; 'liczba dni';
               par[2][5]:=' ';
               par[2][6]:=LSW.KW;
               par[1][20]-=LSW.KW;
               ~~
            }
            {SUBSTITUTE: 'cont'}
         {OD}
      {FI}
      {IF: par[1][14]>0}
         { 'wyrównanie zasiłek chorobowy';~~}
         {FOR: LSW}
         {INDEX: 'R'}
         {PREFIX: P.ref(),511,~O.LT}
         {DO}
            {
               par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
               par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
               par[2][4]:=' '; 'liczba dni';
               par[2][5]:=' ';
               par[2][6]:=LSW.KW;
               par[1][14]-=LSW.KW;
               ~~
            }
            {SUBSTITUTE: 'cont'}
         {OD}
      {FI}
      {IF: par[1][15]>0}
         { 'wyrównanie zasiłek chorobowy wypadek';~~}
         {FOR: LSW}
         {INDEX: 'R'}
         {PREFIX: P.ref(),513,~O.LT}
         {DO}
            {
               par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
               par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
               par[2][4]:=' '; 'liczba dni';
               par[2][5]:=' ';
               par[2][6]:=LSW.KW;
               par[1][15]-=LSW.KW;
               ~~
            }
            {SUBSTITUTE: 'cont'}
         {OD}
      {FI}
      {IF: par[1][16]>0}
         { 'wyrównanie zasiłek macierzyński';~~}
         {FOR: LSW}
         {INDEX: 'R'}
         {PREFIX: P.ref(),524,~O.LT}
         {DO}
            {
               par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
               par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
               par[2][4]:=' '; 'liczba dni';
               par[2][5]:=' ';
               par[2][6]:=LSW.KW;
               par[1][16]-=LSW.KW;
               ~~
            }
            {SUBSTITUTE: 'cont'}
         {OD}
      {FI}
      {IF: par[1][17]>0}
         { 'wyrównanie zasiłek opiekuńczy';~~}
         {FOR: LSW}
         {INDEX: 'R'}
         {PREFIX: P.ref(),530,~O.LT}
         {DO}
            {
               par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
               par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
               par[2][4]:=' '; 'liczba dni';
               par[2][5]:=' ';
               par[2][6]:=LSW.KW;
               par[1][17]-=LSW.KW;
               ~~
            }
            {SUBSTITUTE: 'cont'}
         {OD}
      {FI}
      {IF: par[1][18]>0}
         { 'wyrównanie zasiłek rehabilitacyjny';~~}
         {FOR: LSW}
         {INDEX: 'R'}
         {PREFIX: P.ref(),537,~O.LT}
         {DO}
            {
               par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
               par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
               par[2][4]:=' '; 'liczba dni';
               par[2][5]:=' ';
               par[2][6]:=LSW.KW;
               par[1][18]-=LSW.KW;
               ~~
            }
            {SUBSTITUTE: 'cont'}
         {OD}
      {FI}
      {IF: par[1][19]>0}
         { 'wyrównanie choroba szpital';~~}
         {FOR: LSW}
         {INDEX: 'R'}
         {PREFIX: P.ref(),517,~O.LT}
         {DO}
            {
               par[2][2]:=LSW.OD; par[2][3]:=LSW.DO;
               par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',LSW.KDSW);
               par[2][4]:=' '; 'liczba dni';
               par[2][5]:=' ';
               par[2][6]:=LSW.KW;
               par[1][19]-=LSW.KW;
               ~~
            }
            {SUBSTITUTE: 'cont'}
         {OD}
      {FI}
   {FI}
{MACRO-}
{MACRO: 'Bl_sk'}
   {
      par[11]:=0;
      P_INFO.cntx_psh();
      P_INFO.index('OD');
      P_INFO.prefix(exec('ref_firma','ustawienia'),P.OSOBA);
      {? P_INFO.last() & (P.ZA='T' | P.DZ>=dp)
      || {!
         |? {? P_INFO.BLOKADA<>#0 & P_INFO.BLOKADA~1=dp~1 & P_INFO.BLOKADA<=dk & par[11]=0
            || par[11]:=1;
               par[2][2]:=P_INFO.BLOKADA;
               par[2][1]:='przekr. rocznej podst. skł. na ubezp. emer. rent.'; 'kod ZUS: 140';
               par[2][3]:=par[2][4]:=par[2][5]:=par[2][6]:=2*' '
            ?};
            P_INFO.prev() & ~par[11]
         !}
      ?};
      P_INFO.cntx_pop();
      ~~
   }
   {IF: par[11]}
      {SUBSTITUTE: 'cont'}
   {FI}
{MACRO-}
{MACRO: 'BezpWych'}
{COMMENT}
B E Z P Ł A T N Y, W Y C H O W A W C Z Y,  W O J S K O
ER/WRT/XP/23.25/2401/0040 - ER/WRT/XP/22.26/2401/0006 - Nieobecności z wpisem "TRANSFER" nie są uwzględnione w RMUA.
Podczas transferu (12.51 -> 22.26) nierozliczone nieobecności dostały w polu N.LT wartość "TRANSFER".
{COMMENT-}
   {FOR: N}
   {INDEX:'NIEOBECL'}
   {PREFIX:'N',P.ref(),'TRANSFER'}
   {DO}
      {IF: N.OD<=dk & N.DO>=dp}
         {IF: __RUB.sys_attr(N.NB,112,date(O.R,O.M,0))}
            {
               'urlop bezpłatny'; par[2][6]:=0;
                par[2][2]:={? N.OD<dp || dp || N.OD ?};
                par[2][3]:={? N.DO>dk || dk || N.DO ?};
                par[2][4]:=N.NK;
                par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',N.KDSW);
                par[2][6]:=0; par[2][5]:=2*' ';
                ~~
            }
            {SUBSTITUTE:'cont'}
         {ELIF: __RUB.sys_attr(N.NB,114,date(O.R,O.M,0))}
            {
               'urlop wychowawczy'; par[2][6]:=0;
               par[2][2]:={? N.OD<dp || dp || N.OD ?};
               par[2][3]:={? N.DO>dk || dk || N.DO ?};
               par[2][4]:=N.NK;
               par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',N.KDSW);
               par[2][6]:=0; par[2][5]:=2*' ';
               ~~
            }
            {SUBSTITUTE:'cont'}
         {ELIF: __RUB.sys_attr(N.NB,1323,date(O.R,O.M,0))}
            {
               'wojsko'; par[2][6]:=0;
                par[2][2]:={? N.OD<dp || dp || N.OD ?};
                par[2][3]:={? N.DO>dk || dk || N.DO ?};
                par[2][4]:=N.NK;
                par[2][1]:=exec('memo2print','#string',S_ZUS,'OPIS',N.KDSW);
                par[2][6]:=0; par[2][5]:=2*' ';
                ~~
            }
            {SUBSTITUTE:'cont'}
         {FI}
      {FI}
   {OD}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'inf_ubezp'}
{FONT: 'T2'}
{<1 charleft()*'─'}
{FONT: 'I1'}

   {
      hs6:=1;
      bezpwych:=0;
      'ER/WRT/XP/23.25/2401/0073 - ER/WRT/XP/22.26/2401/0012 - Generowanie RMUA - dwa etaty w trakcie miesiąca ';
      'brak wykazania łącznie nieobecności jako ubezpieczonego';
      ~~
   }
   {FOR: P}
   {INDEX: 'PRACOSOB'}
   {PREFIX: pFirma,'P',pOsoba}
   {DO}
   {FOR: O_P}
   {INDEX: 'P_RMU'}
   {PREFIX: 'T',P.ref(),dk~1,dk~2,P.F_ZATR}
   {DO}
      {IF:
         O_P.O();
         LS.use(O.LT);
         LS.index('PRACNRRU');
         LS.prefix(P.ref());
         LS.first()
      }
         {
            {! _i:=1..8 |! par[6][_i]:=0; par[10][_i]:=0 !};
            {! _v:=1..20 |! par[1][_v]:=0 !};
            bezpwych:=1;
            ~~
         }
         {SUBSTITUTE: 'Lista'}
         {SUBSTITUTE: 'Nieobec'}
         {SUBSTITUTE: 'Choroby'}
      {FI}
   {OD}
   {IF: bezpwych}
      {SUBSTITUTE: 'BezpWych'}
   {FI}
   {OD}
   {SUBSTITUTE: 'Bl_sk'}
   {IF: ~hs6}
└─────────────────────────────────────────────────────────────────────────────────────────┴────────────┴────────────┴────────────────────┴─────────────────────┘
   {FI}
{MACRO-}