:!UTF-8
{TITLE:C. Wydruk etykiet (70x16) do skanowania}
{PRINTER: 'kody',,,,,'Q','B',,,,,,1,2,2,2,2,0,1}
{BEGIN:
      temp1:=temp2:=temp3:=''; nr_lbl:=nr_ark:=0;
      STR.split(REF.FIRMA().OPIS);
      firma1:=STR.line(36);
      firma2:=STR.line(36)
}
{END: &temp1; &temp2; &temp3; &nr_lbl; &nr_ark; &firma1; &firma2}
{EXIT:
    _exit:=0;
    {? ~_exit
    || undefine();
       define('ARKUSZY',1,'Ile arkuszy etykiet:'@,,10,10,0);
       {? ~def_edit("exec('ae_druk_ety','obiegi',2)")
       || _exit:=1
       || _exit:=0
       ?}
    ?};
    _exit
}
{DEFINEFONT: 'courier=Courier New,,m,8'}
{FONT: 'courier'}
{COMMENT}
(c) 2014 Macrologic
==============================================================================
    system: O B I E G I
      plik: BAR_ARK.RPM
            +----------------------------------------------------------------+
  Zawartość | Drukowanie etykiet do skanowania                               |
            +----------------------------------------------------------------+
==============================================================================
{COMMENT-}
{SPACE: 'E'}
{SKIP: 0.1}
{MACRO:'etykieta'}
{ENTIRE}
{
temp1:=exec('obiegi_etyk','urzadzenia');
temp2:=exec('obiegi_etyk','urzadzenia');
temp3:=exec('obiegi_etyk','urzadzenia')
;~~}
{SPACE: 'A'}{<4}{BARCODE:temp1; 33; 1;PAR_WYDR.KODKRESK}{<49}{BARCODE:temp2; 33; 1;PAR_WYDR.KODKRESK}{<94}{BARCODE:temp3; 33; 1;PAR_WYDR.KODKRESK}
{FONT: 'courier'}{SPACE: 'C'}{<1>40 firma1}{<46>85 firma1}{<91>130 firma1}
{IF: firma2<>''}
{FONT: 'courier'}{<1>40 firma2}{<46>85 firma2}{<91>130 firma2}
{FI}
{SPACE: 'B'}
{IF: nr_lbl<16}
{LINE: {? firma2='' || 2 || 1 ?}}
{ELIF: nr_lbl=16}
{SPACE: 'E'}
{LINE: {? firma2='' || 2 || 1 ?}}
{FI}
{ENTIRE-}
{MACRO-}
{WHILE: (nr_ark+=1)<=DEFINE.ARKUSZY}
{DO}
   {WHILE: (nr_lbl+=1)<18 }
   {DO}
      {SUBSTITUTE: 'etykieta'}
   {OD}
   {IF: nr_ark<DEFINE.ARKUSZY}{PAGE}{nr_lbl:=0; ~~}{FI}
{OD}
{COMMENT}
==============================================================================
      koniec pliku
==============================================================================
{COMMENT-}
