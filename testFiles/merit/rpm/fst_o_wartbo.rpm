:!UTF-8
{TITLE:A. Wartości i umorzenie środków - bilans otwarcia}
{PRINTER: FINFO.SZ_PRN,,,,,'M','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
   PRN:=obj_new(@.CLASS.PRINT,12 + {? rep_export() || 12 ?}); PRN.s_frame();
   PRNF:=obj_new(@.CLASS.PRINT,12 +{? rep_export() || 12 ?}); PRNF.s_frame();
   PRNF2:=obj_new(@.CLASS.PRINT,12 +{? rep_export() || 12 ?}); PRNF2.s_frame();
   VAR_DEL.delete('TAB_SQL','TAB_SROD');
   SRSR.cntx_psh(); SRST.cntx_psh();
   exec('init','fst');
   SRD.maski('r');
   exec('odd_filtr','fst');
   i:=0;
   color:=prn1:=prn2:=prn3:='';
   lm:=ll:=vp:=lmt:=rsep:=0; zestaw:=''; zestaw2:='';zestaw3:='';
   rodzaj:=''; par1:=0; par2:=0; par3:=0; par4:=0; par5:=0;
   sum_warp:=0; sum_umop:=0; sum_netp:=0;
   sum_warf:=0; sum_umof:=0; sum_netf:=0;
   sum_ward:=0; sum_umod:=0; sum_netd:=0;
   g_warp:=0; g_umop:=0;g_warf:=0;g_umof:=0; g_netp:=0; g_netf:=0;g_ward:=0; g_umod:=0; g_netd:=0;
   w_numer:=''; w_grupa:=''; w_wyd:=''; w_konto:='';
   w_odd:=''; w_metoda:=''; w_stawka:=''; w_data:='';
   w_war:=0; w_umo:=0; w_net:=0;
   sum_grupa:=''; test_grupa:='';
   {? rep_export() ||
   b_w_metoda:='';b_w_stawka:='';b_w_konto:='';b_w_war:=0; b_w_umo:=0; b_w_net:=0;
   d_w_metoda:='';d_w_stawka:='';d_w_konto:='';d_w_war:=0; d_w_umo:=0; d_w_net:=0 ?};
   PAR_WYDR.PR_GR:=0;
   PAR_WYDR.efld_opt({? FINFO.TOR_D<>'T'|| 'BO' || 'BOD' ?},'editable='+{? PAR_WYDR.RODZAJ=1 || 'grayed' || '1' ?},,'PR_GR');
   PAR_WYDR.fld_fml('PR_GR','BEFORE_EDIT',"PAR_WYDR.RODZAJ=2 & PAR_WYDR.ZESTAW=2");
   PAR_WYDR.fld_fml('RODZAJ','AFTER_EDIT',"{? PAR_WYDR.RODZAJ=1 | PAR_WYDR.ZESTAW<>2
                                        || PAR_WYDR.PR_GR:=0;
                                           cur_tab.efld_opt(cur_win,'editable=grayed',,'PR_GR')
                                        || cur_tab.efld_opt(cur_win,'editable=1',,'PR_GR')
                                        ?}; win_disp;
                                        1 ");
   PAR_WYDR.fld_fml('ZESTAW','AFTER_EDIT',"{? PAR_WYDR.RODZAJ=1 | PAR_WYDR.ZESTAW<>2
                                        || PAR_WYDR.PR_GR:=0;
                                           cur_tab.efld_opt(cur_win,'editable=grayed',,'PR_GR')
                                        || cur_tab.efld_opt(cur_win,'editable=1',,'PR_GR')
                                        ?}; win_disp;
                                        1 ")
}
{END:
   obj_del(PRN);
   obj_del(PRNF);
   obj_del(PRNF2);
   SRSR.cntx_pop(); SRST.cntx_pop();
   &i; &color; &prn1; &prn2; &prn3;
   &lm; &ll; &vp; &lmt; &rsep; &zestaw; &zestaw2; &zestaw3;
   &rodzaj; &par1; &par2; &par3; &par4; &par5;
   &sum_warp; &sum_umop; &sum_netp;
   &sum_warf; &sum_umof; &sum_netf;
   &sum_ward; &sum_umod; &sum_netd;
   &g_warp; &g_umop; &g_warf; &g_umof; &g_netp; &g_netf;
   &g_ward; &g_umod; &g_netd;
   &w_war; &w_umo; &w_net;
   &w_numer; &w_grupa; &w_wyd; &w_konto;
   &w_odd; &w_metoda; &w_stawka; &w_data;
   &sum_grupa; &test_grupa;
   VAR_DEL.delete('TAB_SQL','TAB_SROD');
   PAR_WYDR.fld_fml('PR_GR','BEFORE_EDIT',"*"); PAR_WYDR.fld_fml('RODZAJ','AFTER_EDIT',"*");
   PAR_WYDR.fld_fml('ZESTAW','AFTER_EDIT',"*")
}
{EXIT:
   exec('clear_par','fst');
   exec('set_parw','param_wydr');
   {? OPERATOR.DEPT<>null
   || PAR_WYDR.ODD:=OPERATOR.DEPT
   || PAR_WYDR.ODD:=0
   ?};
   PAR_WYDR.DANE:=1;
   PAR_WYDR.RODZAJ:=1;
   PAR_WYDR.ZESTAW:=2;
    _exit:=0;
   {? SSTALE.AO().KON<>date(0,0,0)
   || FUN.emsg('Wydruk należy wywoływać w okresie Bilans otwarcia.'@);
      _exit:=1
   |? SSTALE.AO().OES=0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().POCZ_ROK
   |? SSTALE.AO().OES>0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().KON_ROK
   ?};
   SRD.PAR_WYDR:='T';
   PAR_WYDR.JORG:=null; EDIT_ES.JORG:='';
   exec('odd_filtr','fst');
   exec('set_gr_list','fst');
   {? FINFO.TOR_D<>'T'
   || PAR_WYDR.win_edit('BO')
   || PAR_WYDR.win_edit('BOD')
   ?};
   PAR_WYDR.hdr_edit(': A. Wartości i umorzenie środków - bilans otwarcia'@);
   {? ~_exit & PAR_WYDR.edit("exec('check_bo','fst')") || _exit:=0 || _exit:=1 ?};
   {? ~_exit
   || {? PAR_WYDR.RODZAJ=2 & PAR_WYDR.WAR_GR=1
      || {? +|PAR_WYDR.GRUPA>=3
         || {? FUN.ask('(Tak) - Uwzględnić środki tylko ze wskazanej maski grupy '
                      '%1 ?\n(Nie) - W przeciwnym przypadku program uwzględni\n wszystkie'
                      ' środki z grupy %2.'@[|PAR_WYDR.GRUPA,(1+|PAR_WYDR.GRUPA)])
            || __SYNTGR:=2; PAR_WYDR.PR_GR:=0
            || __SYNTGR:=1; PAR_WYDR.GRUPA:=1+|PAR_WYDR.GRUPA
            ?}
         || __SYNTGR:=1
         ?}
      ?};
      {?  PAR_WYDR.RODZAJ=1 || _wy:=exec('sql_bo_1', 'fst2')
      |?  PAR_WYDR.RODZAJ=2 || _wy:=exec('sql_bo_2', 'fst2')
      ?};
      {? _wy=0 || _exit:=1 ?}
   ?};
   _exit
}
{COMMENT}
==================================================
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
Nazwa pliku: o_wartbo.rpm
Utworzony  : 2004-09-10
Zawartość  : Wartości i umorzenie na BO
==================================================
zmienne pomocnicze do wydrukow graficznych:
i - licznik, color, prn1, lm, ll, vp, lmt, rsep
{COMMENT-}
{PAR_WYDR.cntx_psh(); ~~}
{INCLUDE: wsp_pw.rpi}
{PAR_WYDR.cntx_pop(); ~~}
{COMMENT}--Definicja wiersza wydruku--------------------{COMMENT-}
{  prn1:='PRN'; prn2:='PRNF'; prn3:='PRNF2'; ~~}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
      {? PAR_WYDR.RODZAJ = 1 || rodzaj:='Nazwa środka'@
      |? PAR_WYDR.RODZAJ = 2
      ||
         {? PAR_WYDR.ZESTAW = 1 || rodzaj:='Symbol jed. ks.'@
         |? PAR_WYDR.ZESTAW = 2 || rodzaj:='Symbol grupy'@
         ?}
      ?};

      {? PAR_WYDR.RODZAJ = 1
      || PRN.add("zestaw", 40, rodzaj);
         PRN.add("w_numer",15,'Numer iwentarz.'@);
         PRN.add("w_grupa",6,'Grupa'@);
         PRN.add("w_jorg",16,'Jed.org.'@);
         PRN.add("w_konto",20,'Zestaw kont'@);
         PRN.add("w_odd",8,'Jed. ks.'@);
         PRN.add("w_metoda",6,'Metoda amort.'@);
         PRN.add("w_stawka",6,'Stawka amort.'@,1);
         PRN.add("w_data",10,'Data eksploat.'@);
         PRN.add("form(w_war,,2,' ,')",15,'Wartość inwentarzowa'@,1);
         PRN.add("form(w_umo,,2,' ,')",15,'Umorzenie'@,1);
         PRN.add("form(w_net,,2,' ,')",15,'Netto'@,1);

         PRNF.add("zestaw2", 40, rodzaj);
         PRNF.add("''",15,'Numer iwentarz.'@);
         PRNF.add("''",6,'Grupa'@);
         PRNF.add("''",16,'Jed.org.'@);
         PRNF.add("''",20,'Zestaw kont'@);
         PRNF.add("''",8,'Jed. ks.'@);
         PRNF.add("''",6,'Metoda amort.'@);
         PRNF.add("''",6,'Stawka amort.'@,1);
         PRNF.add("''",10,'Data eksploat.'@);
         PRNF.add("form(w_war,,2,' ,')",15,'Wartość inwentarzowa'@,1);
         PRNF.add("form(w_umo,,2,' ,')",15,'Umorzenie'@,1);
         PRNF.add("form(w_net,,2,' ,')",15,'Netto'@,1);

         PRNF2.add("zestaw2", 40, rodzaj);
         PRNF2.add("''",15,'Numer iwentarz.'@);
         PRNF2.add("''",6,'Grupa'@);
         PRNF2.add("''",16,'Jed.org.'@);
         PRNF2.add("''",20,'Zestaw kont'@);
         PRNF2.add("''",8,'Jed. ks.'@);
         PRNF2.add("''",6,'Metoda amort.'@);
         PRNF2.add("''",6,'Stawka amort.'@,1);
         PRNF2.add("''",10,'Data eksploat.'@);
         PRNF2.add("form(w_war,,2,' ,')",15,'Wartość inwentarzowa'@,1);
         PRNF2.add("form(w_umo,,2,' ,')",15,'Umorzenie'@,1);
         PRNF2.add("form(w_net,,2,' ,')",15,'Netto'@,1)

      |? PAR_WYDR.RODZAJ = 2
      || PRN.add("zestaw", 30, rodzaj);
         PRN.add("form(w_war,,2,' ,')",15,'Wartość inwentarzowa'@,1);
         PRN.add("form(w_umo,,2,' ,')",15,'Umorzenie'@,1);
         PRN.add("form(w_net,,2,' ,')",15,'Wartość netto'@,1);

         PRNF.add("zestaw2", 30, rodzaj);
         PRNF.add("form(w_war,,2,' ,')",15,'Wartość inwentarzowa'@,1);
         PRNF.add("form(w_umo,,2,' ,')",15,'Umorzenie'@,1);
         PRNF.add("form(w_net,,2,' ,')",15,'Wartość netto'@,1);

         PRNF2.add("zestaw3", 30, rodzaj);
         PRNF2.add("form(w_war,,2,' ,')",15,'Wartość inwentarzowa'@,1);
         PRNF2.add("form(w_umo,,2,' ,')",15,'Umorzenie'@,1);
         PRNF2.add("form(w_net,,2,' ,')",15,'Wartość netto'@,1)
      ?};
      PAR_WYDR.TITLE:='Wartości i umorzenie środków - bilans otwarcia roku obrachunkowego %1'@[SSTALE.AR().NAZ]; ~~}
{FI}
{COMMENT}---------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
      {? PAR_WYDR.RODZAJ = 1 || rodzaj:='Nazwa środka'@
      |? PAR_WYDR.RODZAJ = 2
      ||
         {? PAR_WYDR.ZESTAW = 1 || rodzaj:='Symbol jed. ks.'@
         |? PAR_WYDR.ZESTAW = 2 || rodzaj:='Symbol grupy'@
         ?}
      ?};

      {? PAR_WYDR.RODZAJ = 1
      || PRN.add("zestaw", 40, rodzaj);
         PRN.add("w_numer",15,'Numer iwentarz.'@);
         PRN.add("w_grupa",6,'Grupa'@);
         PRN.add("w_jorg",16,'Jed.org.'@);
         PRN.add("w_odd",8,'Jed. ks.'@);
         PRN.add("w_data",10,'Data eksploat.'@);
         {? PAR_WYDR.DANE = 1
         || PRN.add("w_konto",20,'POD zestaw kont'@);
            PRN.add("w_metoda",6,'POD metoda amort.'@);
            PRN.add("w_stawka",6,'POD stawka amort.'@,1);
            PRN.add("form(w_war,,2,' ,')",15,'POD wartość inwentarzowa'@,1);
            PRN.add("form(w_umo,,2,' ,')",15,'POD umorzenie'@,1);
            PRN.add("form(w_net,,2,' ,')",15,'POD netto'@,1)
         |? PAR_WYDR.DANE = 2
         ||     PRN.add("b_w_konto",20,'BIL zestaw kont'@);
                PRN.add("b_w_metoda",6,'BIL metoda amort.'@);
                PRN.add("b_w_stawka",6,'BIL stawka amort.'@,1);
                PRN.add("form(b_w_war,,2,' ,')",15,'BIL wartość inwentarzowa'@,1);
                PRN.add("form(b_w_umo,,2,' ,')",15,'BIL umorzenie'@,1);
                PRN.add("form(b_w_net,,2,' ,')",15,'BIL netto'@,1)
         |? PAR_WYDR.DANE = 4
         ||     PRN.add("d_w_konto",20,'DOD zestaw kont'@);
                PRN.add("d_w_metoda",6,'DOD metoda amort.'@);
                PRN.add("d_w_stawka",6,'DOD stawka amort.'@,1);
                PRN.add("form(d_w_war,,2,' ,')",15,'DOD wartość inwentarzowa'@,1);
                PRN.add("form(d_w_umo,,2,' ,')",15,'DOD umorzenie'@,1);
                PRN.add("form(d_w_net,,2,' ,')",15,'DOD netto'@,1)
         |? PAR_WYDR.DANE = 3
         ||     PRN.add("w_konto",20,'POD zestaw kont'@);
                PRN.add("w_metoda",6,'POD metoda amort.'@);
                PRN.add("w_stawka",6,'POD stawka amort.'@,1);
                PRN.add("form(w_war,,2,' ,')",15,'POD wartość inwentarzowa'@,1);
                PRN.add("form(w_umo,,2,' ,')",15,'POD umorzenie'@,1);
                PRN.add("form(w_net,,2,' ,')",15,'POD netto'@,1);
                PRN.add("b_w_konto",20,'BIL zestaw kont'@);
                PRN.add("b_w_metoda",6,'BIL metoda amort.'@);
                PRN.add("b_w_stawka",6,'BIL stawka amort.'@,1);
                PRN.add("form(b_w_war,,2,' ,')",15,'BIL wartość inwentarzowa'@,1);
                PRN.add("form(b_w_umo,,2,' ,')",15,'BIL umorzenie'@,1);
                PRN.add("form(b_w_net,,2,' ,')",15,'BIL netto'@,1);
                PRN.add("d_w_konto",20,'DOD zestaw kont'@);
                PRN.add("d_w_metoda",6,'DOD metoda amort.'@);
                PRN.add("d_w_stawka",6,'DOD stawka amort.'@,1);
                PRN.add("form(d_w_war,,2,' ,')",15,'DOD wartość inwentarzowa'@,1);
                PRN.add("form(d_w_umo,,2,' ,')",15,'DOD umorzenie'@,1);
                PRN.add("form(d_w_net,,2,' ,')",15,'DOD netto'@,1)
         ?};
         PRNF.add("zestaw2", 40, rodzaj);
         PRNF.add("''",15,'Numer iwentarz.'@);
         PRNF.add("''",6,'Grupa'@);
         PRNF.add("''",16,'Jed.org.'@);
         PRNF.add("''",20,'Zestaw kont'@);
         PRNF.add("''",8,'Jed. ks.'@);
         PRNF.add("''",6,'Metoda amort.'@);
         PRNF.add("''",6,'Stawka amort.'@,1);
         PRNF.add("''",10,'Data eksploat.'@);
         PRNF.add("form(w_war,,2,' ,')",15,'Wartość inwentarzowa'@,1);
         PRNF.add("form(w_umo,,2,' ,')",15,'Umorzenie'@,1);
         PRNF.add("form(w_net,,2,' ,')",15,'Netto'@,1);

         PRNF2.add("zestaw2", 40, rodzaj);
         PRNF2.add("''",15,'Numer iwentarz.'@);
         PRNF2.add("''",6,'Grupa'@);
         PRNF2.add("''",16,'Jed.org.'@);
         PRNF2.add("''",20,'Zestaw kont'@);
         PRNF2.add("''",8,'Jed. ks.'@);
         PRNF2.add("''",6,'Metoda amort.'@);
         PRNF2.add("''",6,'Stawka amort.'@,1);
         PRNF2.add("''",10,'Data eksploat.'@);
         PRNF2.add("form(w_war,,2,' ,')",15,'Wartość inwentarzowa'@,1);
         PRNF2.add("form(w_umo,,2,' ,')",15,'Umorzenie'@,1);
         PRNF2.add("form(w_net,,2,' ,')",15,'Netto'@,1)

      |? PAR_WYDR.RODZAJ = 2
      || PRN.add("zestaw", 30, rodzaj);
         {? PAR_WYDR.DANE = 1
         || PRN.add("form(w_war,,2,' ,')",15,'POD wartość inwentarzowa'@,1);
            PRN.add("form(w_umo,,2,' ,')",15,'POD umorzenie'@,1);
            PRN.add("form(w_net,,2,' ,')",15,'POD wartość netto'@,1)
         ?};
         {? PAR_WYDR.DANE = 2
         || PRN.add("form(b_w_war,,2,' ,')",15,'BIL wartość inwentarzowa'@,1);
            PRN.add("form(b_w_umo,,2,' ,')",15,'BIL umorzenie'@,1);
            PRN.add("form(b_w_net,,2,' ,')",15,'BIL wartość netto'@,1)
         ?};
         {? PAR_WYDR.DANE = 4
         || PRN.add("form(d_w_war,,2,' ,')",15,'DOD wartość inwentarzowa'@,1);
            PRN.add("form(d_w_umo,,2,' ,')",15,'DOD umorzenie'@,1);
            PRN.add("form(d_w_net,,2,' ,')",15,'DOD wartość netto'@,1)
         ?};
         {? PAR_WYDR.DANE = 3
         || PRN.add("form(w_war,,2,' ,')",15,'POD wartość inwentarzowa'@,1);
            PRN.add("form(w_umo,,2,' ,')",15,'POD umorzenie'@,1);
            PRN.add("form(w_net,,2,' ,')",15,'POD wartość netto'@,1);
            PRN.add("form(b_w_war,,2,' ,')",15,'BIL wartość inwentarzowa'@,1);
            PRN.add("form(b_w_umo,,2,' ,')",15,'BIL umorzenie'@,1);
            PRN.add("form(b_w_net,,2,' ,')",15,'BIL wartość netto'@,1);
            {? FINFO.TOR_D='T'
            || PRN.add("form(d_w_war,,2,' ,')",15,'DOD wartość inwentarzowa'@,1);
               PRN.add("form(d_w_umo,,2,' ,')",15,'DOD umorzenie'@,1);
               PRN.add("form(d_w_net,,2,' ,')",15,'DOD wartość netto'@,1)
            ?}
         ?};
         PRNF.add("zestaw2", 30, rodzaj);
         PRNF.add("form(w_war,,2,' ,')",15,'Wartość inwentarzowa'@,1);
         PRNF.add("form(w_umo,,2,' ,')",15,'Umorzenie'@,1);
         PRNF.add("form(w_net,,2,' ,')",15,'Wartość netto'@,1);

         PRNF2.add("zestaw3", 30, rodzaj);
         PRNF2.add("form(w_war,,2,' ,')",15,'Wartość inwentarzowa'@,1);
         PRNF2.add("form(w_umo,,2,' ,')",15,'Umorzenie'@,1);
         PRNF2.add("form(w_net,,2,' ,')",15,'Wartość netto'@,1)
      ?};
      PAR_WYDR.TITLE:='Wartości i umorzenie środków - bilans otwarcia roku obrachunkowego %1'@[SSTALE.AR().NAZ]; ~~}
{FI}
{COMMENT}------------------------------DANE DO WYDRUKU--------------{COMMENT-}
{COMMENT} Dane pobierane są w sekcji Exit z wykorzystaniem formuł z pliku query.fml
RODZAJ : 1 = analityczne, 2 = syntetyczne,
ZESTAW : 1 = według jedn. ksiegowych, 2 = według grup
DANE   : 1 = podatkowe, 2 = bilansowe, 3 = obie
{COMMENT-}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{COMMENT}------------------------------Parametry wydruku------------{COMMENT-}
{FONT: 'W8'}{SPACE: 'C'}
{<1 'PARAMETRY WYDRUKU:'@}
{COMMENT} ---- Stan na, Grupa, Rodzaj zestawienia ---- {COMMENT-}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{ par1:=~(PAR_WYDR.STAN_NA$6)+ ' ROKU'@;
  {? PAR_WYDR.WAR_GR = 1
  || {? |PAR_WYDR.GRUPA <> ''
     || {? var_pres('__SYNTGR')>0 & __SYNTGR=2 & +|PAR_WYDR.GRUPA>1
        || par2:=1+|PAR_WYDR.GRUPA
        || par2:=|PAR_WYDR.GRUPA
        ?}
     || par2:='dowolna'@
     ?}
  |? PAR_WYDR.WAR_GR = 2
  || {? |PAR_WYDR.GRUPA_OD <> '' || _od:='od: '@ + |PAR_WYDR.GRUPA_OD || _od:=''?};
     {? |PAR_WYDR.GRUPA_DO <> '' || _do:='do: '@ + |PAR_WYDR.GRUPA_DO || _do:=''?};
     {? _od <> '' & _do <> '' || par2:=_od + ' ' + _do
     |? _od <> '' & _do = '' ||  par2:=_od
     |? _od = '' & _do <> '' || par2:=_do
    ?}
  ?};
  {? PAR_WYDR.RODZAJ = 1
  || par3:='ANALITYCZNE'@ || par3:='SYNTETYCZNE'@
  ?};
  {? PAR_WYDR.JORG<>null || par5:=PAR_WYDR.JORG().SYMBOL || par5:='dowolna'@ ?}
;~~}
{IF: PAR_WYDR.WAR_GR<>3}
{<1 'Stan na: '@+par1}{<40 'Grupa: '@+par2}{<80 'Rodzaj zestawienia: '@+par3}{<115 'Jedn. organizacyjna: '@+par5}
{ELIF: PAR_WYDR.WAR_GR=3}
{<1 'Stan na: '@+par1}{<40 'Rodzaj zestawienia: '@+par3}{<80 'Jedn. organizacyjna: '@+par5}
{FI}
{COMMENT} ---- Dane, Jedn. ks., Zestawienie według ---- {COMMENT-}
{
  {? PAR_WYDR.DANE = 1
  || par1:='Podatkowe'@
  |? PAR_WYDR.DANE = 2
  || par1:='Bilansowe'@
  |? PAR_WYDR.DANE = 3
  || par1:='Wszystkie'@
  |? PAR_WYDR.DANE = 4
  || par1:='Dodatkowe'@
  ?};
  {? PAR_WYDR.ODD <> null || par2:=PAR_WYDR.ODD().OD || par2:='wszystkie'@ ?};
  {? PAR_WYDR.ZESTAW = 1
  || par3:='Jedn. księgowych'@
  |? PAR_WYDR.ZESTAW = 2
  || par3:='Grup'@
  ?};
  {? PAR_WYDR.ZAKRESDR = 0
  || par4:='Wszystkie'@
  |? PAR_WYDR.ZAKRESDR = 1
  || par4:='Trwałe'@
  |? PAR_WYDR.ZAKRESDR = 2
  || par4:='Niskocenne'@
  ?}
;~~}
{<1 'Dane: '@ + par1}{<40 'Jedn. księg.: '@ + par2}{<80 'Zakres środków: '@ + par4}{<115 'Zestawienie według: '@ + par3}
{IF: PAR_WYDR.WAR_GR=3}
{<1 'Wybór grup: '@+exec('create_list_gr','fst')}
{FI}
{ {? PAR_WYDR.CECHA<>null
  || par1:=PAR_WYDR.CECHA().AKRONIM;
     {? PAR_WYDR.WAR_CECH<>'' || par2:=PAR_WYDR.WAR_CECH ?}
  || par1:=par2:=''
  ?}
;~~}
{IF: par1<>''}
{<1 'Tylko środki posiadające cechę dodatkową: '@+par1+{? par2<>'' || ' o wartości: '@+par2 || '' ?}}
{FI}
{FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{ par1:=~(PAR_WYDR.STAN_NA$6)+ ' ROKU'@ }
{ {? PAR_WYDR.WAR_GR = 1
  || {? |PAR_WYDR.GRUPA <> ''
     || {? var_pres('__SYNTGR')>0 & __SYNTGR=2 & +|PAR_WYDR.GRUPA>1
        || par2:=1+|PAR_WYDR.GRUPA
        || par2:=|PAR_WYDR.GRUPA
        ?}
     || par2:='dowolna'@
     ?}
  |? PAR_WYDR.WAR_GR = 2
  || {? |PAR_WYDR.GRUPA_OD <> '' || _od:='od: '@ + |PAR_WYDR.GRUPA_OD || _od:=''?};
     {? |PAR_WYDR.GRUPA_DO <> '' || _do:='do: '@ + |PAR_WYDR.GRUPA_DO || _do:=''?};
     {? _od <> '' & _do <> '' || par2:=_od + ' ' + _do
     |? _od <> '' & _do = '' ||  par2:=_od
     |? _od = '' & _do <> '' || par2:=_do
    ?}
  ?};
  {? PAR_WYDR.RODZAJ = 1
  || par3:='ANALITYCZNE'@ || par3:='SYNTETYCZNE'@
  ?};
  {? PAR_WYDR.JORG<>null || par5:=PAR_WYDR.JORG().SYMBOL || par5:='dowolna'@ ?}
;~~}
{IF: PAR_WYDR.WAR_GR<>3}
{'Stan na: '@+par1}
{'Grupa: '@+par2}
{'Rodzaj zestawienia: '@+par3}
{'Jedn. organizacyjna: '@+par5}
{ELIF: PAR_WYDR.WAR_GR=3}
{ 'Stan na: '@+par1}
{ 'Rodzaj zestawienia: '@+par3}
{ 'Jedn. organizacyjna: '@+par5}
{FI}
{COMMENT} ---- Dane, Jedn. ks., Zestawienie według ---- {COMMENT-}
{
  {? PAR_WYDR.DANE = 1
  || par1:='Podatkowe'@
  |? PAR_WYDR.DANE = 2
  || par1:='Bilansowe'@
  |? PAR_WYDR.DANE = 3
  || par1:='Wszystkie'@
  |? PAR_WYDR.DANE = 4
  || par1:='Dodatkowe'@
  ?};
  {? PAR_WYDR.ODD <> null || par2:=PAR_WYDR.ODD().OD || par2:='wszystkie'@ ?};
  {? PAR_WYDR.ZESTAW = 1
  || par3:='Jedn. księgowych'@
  |? PAR_WYDR.ZESTAW = 2
  || par3:='Grup'@
  ?};
  {? PAR_WYDR.ZAKRESDR = 0
  || par4:='Wszystkie'@
  |? PAR_WYDR.ZAKRESDR = 1
  || par4:='Trwałe'@
  |? PAR_WYDR.ZAKRESDR = 2
  || par4:='Niskocenne'@
  ?}; ~~}
{ 'Dane: '@ + par1}
{ 'Jedn. księg.: '@ + par2}
{ 'Zakres środków: '@ + par4}
{ 'Zestawienie według: '@ + par3}
{IF: PAR_WYDR.WAR_GR=3}
{<1 'Wybór grup: '@+exec('create_list_gr','fst')}
{FI}
{ {? PAR_WYDR.CECHA<>null
  || par1:=PAR_WYDR.CECHA().AKRONIM;
     {? PAR_WYDR.WAR_CECH<>'' || par2:=PAR_WYDR.WAR_CECH ?}
  || par1:=par2:=''
  ?}
;~~}
{IF: par1<>''}
{<1 'Tylko środki posiadające cechę dodatkową: '@+par1+{? par2<>'' || ' o wartości: '@+par2 || '' ?}}
{FI}
{FI}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: ~rep_export()}
{SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{COMMENT}{FONT: 'T8'}{SPACE: 'B'}{COMMENT-}
{FONT: 'T8GB'}{SPACE: 'C'}
{ rsep:=PAR_WYDR.RSEP; ~~}
{FOR: TAB_SQL}
 {DO}
{COMMENT} ---- Podsumowanie cząstkowe według grup lub Jedn. ks. ---- {COMMENT-}
{COMMENT} ---- Podsumowania nie występują dla excel ---- {COMMENT-}
{IF: ~rep_export()}
  { {? PAR_WYDR.RODZAJ = 1
   ||
      {? PAR_WYDR.ZESTAW = 1
      || test_grupa:=TAB_SQL.ODDZIAL
      || test_grupa:=TAB_SQL.GR
      ?};
      {? sum_grupa = '' || test_grupa:=''?}
   ?}
  ;~~}
  {IF: PAR_WYDR.RODZAJ = 1 & sum_grupa <> test_grupa}
  {
   {? PAR_WYDR.ZESTAW = 1
   || zestaw:='Jedn. ks. '@ + sum_grupa + ' razem:'@
   || zestaw:='Grupa '@ + sum_grupa + ' razem:'@
   ?};
   w_numer:=''; w_grupa:=''; w_jorg:=''; w_konto:='';
   w_odd:=''; w_metoda:=''; w_stawka:=''; w_data:='';
   {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
   || w_war:=g_warp; w_umo:=g_umop; w_net:=g_netp
   || w_war:=g_warf; w_umo:=g_umof; w_net:=g_netf
   ?}
  ;~~}
  {COMMENT}{FONT: 'T8B'}{COMMENT-}
  {FONT: 'T8GB'}{SPACE: 'C'}{IF: PAR_WYDR.DANE = 3 & lineleft()<>0 & lineleft()<3}{PAGE}{FI}{SUBSTITUTE: 'LINIA0'}
{COMMENT} ---- Druga linia w podsumowaniu cząstkowym ---- {COMMENT-}
  {IF: PAR_WYDR.DANE = 3}
  {
   zestaw:='';  w_numer:=''; w_grupa:=''; w_jorg:='';
   w_konto:=''; w_odd:=''; w_metoda:=''; w_stawka:='';
   w_data:='';
   w_war:=g_warf; w_umo:=g_umof; w_net:=g_netf;
   rsep:=0;~~}
  {FONT: 'T8GB'}{SPACE: 'C'}{SUBSTITUTE: 'LINIA0'}
{COMMENT} ---- Trzecia linia w podsumowaniu cząstkowym ---- {COMMENT-}
  {IF: FINFO.TOR_D='T'}
  {
   zestaw:='';  w_numer:=''; w_grupa:=''; w_jorg:='';
   w_konto:=''; w_odd:=''; w_metoda:=''; w_stawka:='';
   w_data:='';
   w_war:=g_ward; w_umo:=g_umod; w_net:=g_netd;
   rsep:=0;~~}
  {FONT: 'T8GB'}{SPACE: 'C'}{SUBSTITUTE: 'LINIA0'}
  {FI}
  {rsep:=PAR_WYDR.RSEP;~~}
  {FI}
  {FONT: 'T8G'}{SPACE: 'C'}
{COMMENT} ---- wyzerowanie podsumowań cząstkowych---- {COMMENT-}
  {
     {? PAR_WYDR.RODZAJ = 1
     || g_warp:=0; g_umop:=0; g_warf:=0; g_umof:=0; g_netp:=0; g_netf:=0; g_ward:=0; g_umod:=0; g_netd:=0
     ?}
  ;~~}
  {FI}
 {FI}
{COMMENT} ---- zwykłe wiersze ---- {COMMENT-}
 {COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
 {
   {? PAR_WYDR.RODZAJ = 1
   ||
      w_numer:=TAB_SQL.NRI;
      w_grupa:=TAB_SQL.GRUPA;
      w_jorg:=TAB_SQL.JORG;
      {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
         || w_konto:=TAB_SQL.KONTOP
         |? PAR_WYDR.DANE=2
         || w_konto:=TAB_SQL.KONTOF
         |? PAR_WYDR.DANE=4
         || w_konto:=TAB_SQL.KONTOD
      ?};
      w_odd:=TAB_SQL.ODDZIAL;
      {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
         || w_metoda:=TAB_SQL.MAP
         |? PAR_WYDR.DANE=2
         || w_metoda:=TAB_SQL.MAF
         |? PAR_WYDR.DANE=4
         || w_metoda:=TAB_SQL.MAD
      ?};
      {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
         || w_stawka:=form(TAB_SQL.STAWKA,,2,' ,')
         |? PAR_WYDR.DANE=2
         || w_stawka:=form(TAB_SQL.STAFIN,,2,' ,')
         |? PAR_WYDR.DANE=4
         || w_stawka:=form(TAB_SQL.STADOD,,2,' ,')
      ?};
      w_data:=form(TAB_SQL.DE,,1);
      {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
      || w_war:=TAB_SQL.WARP;
         w_umo:=TAB_SQL.UMOP;
         w_net:=TAB_SQL.NETP
      |? PAR_WYDR.DANE=2
      || w_war:=TAB_SQL.WARF;
         w_umo:=TAB_SQL.UMOF;
         w_net:=TAB_SQL.NETF
      |? PAR_WYDR.DANE=4
      || w_war:=TAB_SQL.WARD;
         w_umo:=TAB_SQL.UMOD;
         w_net:=TAB_SQL.NETD
      ?};

      sum_warp+=TAB_SQL.WARP;
      sum_umop+=TAB_SQL.UMOP;
      sum_warf+=TAB_SQL.WARF;
      sum_umof+=TAB_SQL.UMOF;
      sum_netp+=TAB_SQL.NETP;
      sum_netf+=TAB_SQL.NETF;

      g_warp+=TAB_SQL.WARP; g_umop+=TAB_SQL.UMOP;
      g_warf+=TAB_SQL.WARF; g_umof+=TAB_SQL.UMOF;
      g_netp+=TAB_SQL.NETP; g_netf+=TAB_SQL.NETF;

      {? FINFO.TOR_D='T'
      || sum_ward+=TAB_SQL.WARD;
         sum_umod+=TAB_SQL.UMOD;
         sum_netd+=TAB_SQL.NETD;
         g_umod+=TAB_SQL.UMOD;
         g_ward+=TAB_SQL.WARD;
         g_netd+=TAB_SQL.NETD
      ?}
   ||
      sum_warp+=TAB_SQL.SUM_WARP;
      sum_umop+=TAB_SQL.SUM_UMOP;
      sum_netp+=TAB_SQL.SUM_NETP;
      sum_warf+=TAB_SQL.SUM_WARF;
      sum_umof+=TAB_SQL.SUM_UMOF;
      sum_netf+=TAB_SQL.SUM_NETF;

      {? FINFO.TOR_D='T'
      || sum_ward+=TAB_SQL.SUM_WARD;
         sum_umod+=TAB_SQL.SUM_UMOD;
         sum_netd+=TAB_SQL.SUM_NETD
      ?};

      {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
         || w_war:=TAB_SQL.SUM_WARP;
            w_umo:=TAB_SQL.SUM_UMOP;
            w_net:=TAB_SQL.SUM_NETP
      |? PAR_WYDR.DANE = 2
         || w_war:=TAB_SQL.SUM_WARF;
            w_umo:=TAB_SQL.SUM_UMOF;
            w_net:=TAB_SQL.SUM_NETF
      |? PAR_WYDR.DANE=4
         || w_war:=TAB_SQL.SUM_WARD;
            w_umo:=TAB_SQL.SUM_UMOD;
            w_net:=TAB_SQL.SUM_NETD
      ?}
   ?};

   {? PAR_WYDR.RODZAJ = 1
   ||
      zestaw:={? +TAB_SQL.NST<40 | PAR_WYDR.DANE<>3 || TAB_SQL.NST || 40+TAB_SQL.NST ?}
   ||
      {? PAR_WYDR.DANE = 3
      || {? PAR_WYDR.ZESTAW = 1
         || zestaw:='Jedn. ks. '@ + TAB_SQL.ODDZIAL + ' razem (P):'@
         || zestaw:='Grupa '@ + TAB_SQL.GRUPA + ' razem (P):'@
         ?}
      || {? PAR_WYDR.ZESTAW = 1
         || zestaw:='Jedn. ks. '@ + TAB_SQL.ODDZIAL + ' razem:'@
         || zestaw:='Grupa '@ + TAB_SQL.GRUPA + ' razem:'@
         ?}
      ?}
   ?}
 ;~~}
{FONT: 'T8G'}{SPACE: 'C'}
  {IF: PAR_WYDR.DANE = 3 & lineleft()<>0 & lineleft()<3}{PAGE}{FI}{SUBSTITUTE: 'LINIA0'}
{COMMENT} ---- Druga linia ---- {COMMENT-}
  {IF: PAR_WYDR.DANE = 3}
  {
   zestaw:='';
   {? PAR_WYDR.RODZAJ <> 1 & PAR_WYDR.DANE = 3
   || {? PAR_WYDR.ZESTAW = 1
      || zestaw:='Jedn. ks. '@ + TAB_SQL.ODDZIAL + ' razem (B):'@
      || zestaw:='Grupa '@ + TAB_SQL.GRUPA + ' razem (B):'@
      ?}
   ?};
   {? PAR_WYDR.RODZAJ = 1
   ||
      zestaw:={? +TAB_SQL.NST<40
              || ''
              || {? FINFO.TOR_D<>'T'
                 || 40-TAB_SQL.NST
                 || 40+(40-TAB_SQL.NST)
                 ?}
              ?};
      w_numer:=''; w_grupa:=''; w_jorg:='';
      w_odd:=''; w_data:='';
      w_konto:=TAB_SQL.KONTOF;
      w_metoda:=TAB_SQL.MAF;
      w_stawka:=form(TAB_SQL.STAFIN,,2,' ,');
      w_war:=TAB_SQL.WARF;
      w_umo:=TAB_SQL.UMOF;
      w_net:=TAB_SQL.NETF
   ||
      w_war:=TAB_SQL.SUM_WARF;
      w_umo:=TAB_SQL.SUM_UMOF;
      w_net:=TAB_SQL.SUM_NETF
   ?};
   rsep:=0;~~}
  {SUBSTITUTE: 'LINIA0'}
{COMMENT} ---- Trzecia linia ---- {COMMENT-}
  {IF: FINFO.TOR_D='T'}
  {
     zestaw:='';
   {? PAR_WYDR.RODZAJ <> 1 & PAR_WYDR.DANE = 3
   || {? PAR_WYDR.ZESTAW = 1
      || zestaw:='Jedn. ks. '@ + TAB_SQL.ODDZIAL + ' razem (D):'@
      || zestaw:='Grupa '@ + TAB_SQL.GRUPA + ' razem (D):'@
      ?}
   ?};
   {? PAR_WYDR.RODZAJ = 1
   ||
      zestaw:={? +TAB_SQL.NST<80 || '' || 80-TAB_SQL.NST ?};
      w_numer:=''; w_grupa:=''; w_jorg:='';
      w_odd:=''; w_data:='';
      w_konto:=TAB_SQL.KONTOD;
      w_metoda:=TAB_SQL.MAD;
      w_stawka:=form(TAB_SQL.STADOD,,2,' ,');
      w_war:=TAB_SQL.WARD;
      w_umo:=TAB_SQL.UMOD;
      w_net:=TAB_SQL.NETD
   ||
      w_war:=TAB_SQL.SUM_WARD;
      w_umo:=TAB_SQL.SUM_UMOD;
      w_net:=TAB_SQL.SUM_NETD
   ?};
   rsep:=0;~~}
  {SUBSTITUTE: 'LINIA0'}
  {FI}
  {rsep:=PAR_WYDR.RSEP;~~}
  {FI}
  {FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
   {? PAR_WYDR.RODZAJ=1
   || zestaw:=TAB_SQL.NST;
      w_numer:=TAB_SQL.NRI;
      w_grupa:=TAB_SQL.GRUPA;
      w_jorg:=TAB_SQL.JORG;
      w_odd:=TAB_SQL.ODDZIAL;
      w_data:=form(TAB_SQL.DE,,1);
      {? PAR_WYDR.DANE=1
      || w_konto:=TAB_SQL.KONTOP;
         w_metoda:=TAB_SQL.MAP;
         w_stawka:=form(TAB_SQL.STAWKA,,2,' ,');
         w_war:=TAB_SQL.WARP;
         w_umo:=TAB_SQL.UMOP;
         w_net:=TAB_SQL.NETP
      |? PAR_WYDR.DANE=2
      || b_w_konto:=TAB_SQL.KONTOF;
         b_w_metoda:=TAB_SQL.MAF;
         b_w_stawka:=form(TAB_SQL.STAFIN,,2,' ,');
         b_w_war:=TAB_SQL.WARF;
         b_w_umo:=TAB_SQL.UMOF;
         b_w_net:=TAB_SQL.NETF
      |? PAR_WYDR.DANE=4
      || d_w_konto:=TAB_SQL.KONTOD;
         d_w_metoda:=TAB_SQL.MAD;
         d_w_stawka:=form(TAB_SQL.STADOD,,2,' ,');
         d_w_war:=TAB_SQL.WARD;
         d_w_umo:=TAB_SQL.UMOD;
         d_w_net:=TAB_SQL.NETD
      |? PAR_WYDR.DANE=3
      || w_konto:=TAB_SQL.KONTOP;
         b_w_konto:=TAB_SQL.KONTOF;
         w_metoda:=TAB_SQL.MAP;
         b_w_metoda:=TAB_SQL.MAF;
         w_stawka:=form(TAB_SQL.STAWKA,,2,' ,');
         b_w_stawka:=form(TAB_SQL.STAFIN,,2,' ,');
         w_war:=TAB_SQL.WARP;
         w_umo:=TAB_SQL.UMOP;
         w_net:=TAB_SQL.NETP;
         b_w_war:=TAB_SQL.WARF;
         b_w_umo:=TAB_SQL.UMOF;
         b_w_net:=TAB_SQL.NETF;
         {? FINFO.TOR_D='T'
         || d_w_konto:=TAB_SQL.KONTOD;
            d_w_metoda:=TAB_SQL.MAD;
            d_w_stawka:=form(TAB_SQL.STADOD,,2,' ,');
            d_w_war:=TAB_SQL.WARD;
            d_w_umo:=TAB_SQL.UMOD;
            d_w_net:=TAB_SQL.NETD
         ?}
      ?};

      sum_warp+=TAB_SQL.WARP;
      sum_umop+=TAB_SQL.UMOP;
      sum_warf+=TAB_SQL.WARF;
      sum_umof+=TAB_SQL.UMOF;
      sum_netp+=TAB_SQL.NETP;
      sum_netf+=TAB_SQL.NETF;

      g_warp+=TAB_SQL.WARP; g_umop+=TAB_SQL.UMOP;
      g_warf+=TAB_SQL.WARF; g_umof+=TAB_SQL.UMOF;
      g_netp+=TAB_SQL.NETP; g_netf+=TAB_SQL.NETF;

      {? FINFO.TOR_D='T'
      || sum_ward+=TAB_SQL.WARD;
         sum_umod+=TAB_SQL.UMOD;
         sum_netd+=TAB_SQL.NETD;
         g_umod+=TAB_SQL.UMOD;
         g_ward+=TAB_SQL.WARD;
         g_netd+=TAB_SQL.NETD
      ?}
   || {? PAR_WYDR.ZESTAW=1
      || zestaw:='Jedn. ks. '@ + TAB_SQL.ODDZIAL + ' razem:'@
      || zestaw:='Grupa '@ + TAB_SQL.GRUPA + ' razem:'@
      ?};
      sum_warp+=TAB_SQL.SUM_WARP;
      sum_umop+=TAB_SQL.SUM_UMOP;
      sum_netp+=TAB_SQL.SUM_NETP;
      sum_warf+=TAB_SQL.SUM_WARF;
      sum_umof+=TAB_SQL.SUM_UMOF;
      sum_netf+=TAB_SQL.SUM_NETF;

      {? FINFO.TOR_D='T'
      || sum_ward+=TAB_SQL.SUM_WARD;
         sum_umod+=TAB_SQL.SUM_UMOD;
         sum_netd+=TAB_SQL.SUM_NETD
      ?};

      {? PAR_WYDR.DANE = 1
      || w_war:=TAB_SQL.SUM_WARP;
         w_umo:=TAB_SQL.SUM_UMOP;
         w_net:=TAB_SQL.SUM_NETP
      |? PAR_WYDR.DANE = 2
      || b_w_war:=TAB_SQL.SUM_WARF;
         b_w_umo:=TAB_SQL.SUM_UMOF;
         b_w_net:=TAB_SQL.SUM_NETF
      |? PAR_WYDR.DANE=4
      || d_w_war:=TAB_SQL.SUM_WARD;
         d_w_umo:=TAB_SQL.SUM_UMOD;
         d_w_net:=TAB_SQL.SUM_NETD
      |? PAR_WYDR.DANE=3
      || w_war:=TAB_SQL.SUM_WARP;
         w_umo:=TAB_SQL.SUM_UMOP;
         w_net:=TAB_SQL.SUM_NETP;
         b_w_war:=TAB_SQL.SUM_WARF;
         b_w_umo:=TAB_SQL.SUM_UMOF;
         b_w_net:=TAB_SQL.SUM_NETF;
         {? FINFO.TOR_D='T'
         || d_w_war:=TAB_SQL.SUM_WARD;
            d_w_umo:=TAB_SQL.SUM_UMOD;
            d_w_net:=TAB_SQL.SUM_NETD
         ?}
      ?}
   ?}
 ;~~}
 {IF: PAR_WYDR.DANE = 3}
   {rsep:=PAR_WYDR.RSEP;~~}
 {FI}
 {SUBSTITUTE: 'LINIA0'}
{FI}
 {
   {? PAR_WYDR.RODZAJ = 1
   || {? PAR_WYDR.ZESTAW = 1
      || sum_grupa:=TAB_SQL.ODDZIAL
      || sum_grupa:=TAB_SQL.GR
      ?}
   ?}
 ;~~}
 {OD}
{COMMENT} ---- podsumowanie czastkowe za ostatnim rekordem tabeli TAB_SQL ---- {COMMENT-}
{COMMENT} ---- Podsumowania nie występują dla excel ---- {COMMENT-}
{IF: ~rep_export()}
  {IF: PAR_WYDR.RODZAJ = 1}
  {
   {? PAR_WYDR.ZESTAW = 1
   || zestaw:='Jedn. ks. '@ + sum_grupa + ' razem:'@
   || zestaw:='Grupa '@ + sum_grupa + ' razem:'@
   ?};
   w_numer:=''; w_grupa:=''; w_jorg:=''; w_konto:='';
   w_odd:=''; w_metoda:=''; w_stawka:=''; w_data:='';
   {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
   || w_war:=g_warp; w_umo:=g_umop; w_net:=g_netp
   |? PAR_WYDR.DANE=2
   || w_war:=g_warf; w_umo:=g_umof; w_net:=g_netf
   |? PAR_WYDR.DANE=4
   || w_war:=g_ward; w_umo:=g_umod; w_net:=g_netd
   ?}
  ;~~}
  {FONT: 'T8GB'}{SPACE: 'C'}{IF: PAR_WYDR.DANE = 3 & lineleft()<>0 & lineleft()<3}{PAGE}{FI}{SUBSTITUTE: 'LINIA0'}
{COMMENT} ---- Druga linia w podsumowaniu cząstkowym ---- {COMMENT-}
  {IF: PAR_WYDR.DANE = 3}
  {
   zestaw:='';  w_numer:=''; w_grupa:=''; w_jorg:='';
   w_konto:=''; w_odd:=''; w_metoda:=''; w_stawka:='';
   w_data:='';
   w_war:=g_warf;
   w_umo:=g_umof;
   w_net:=g_netf;
   rsep:=0;~~}
  {SUBSTITUTE: 'LINIA0'}
  {IF: FINFO.TOR_D='T'}
  {
   zestaw:='';  w_numer:=''; w_grupa:=''; w_jorg:='';
   w_konto:=''; w_odd:=''; w_metoda:=''; w_stawka:='';
   w_data:='';
   w_war:=g_ward;
   w_umo:=g_umod;
   w_net:=g_netd;
   rsep:=0;~~}
  {SUBSTITUTE: 'LINIA0'}
  {FI}
  {rsep:=PAR_WYDR.RSEP;~~}
  {FI}
  {FONT: 'T8G'}{SPACE: 'C'}
 {FI}
{COMMENT}------------------------------FOOTER-LAST------------------{COMMENT-}
{IF: lineleft()<>0 & lineleft()<6}{PAGE}{FI}
{FOOTER}{FOOTER-}
{FONT: 'T8GB'}{SPACE: 'C'}
{
   {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
   || w_war:=sum_warp;
      w_umo:=sum_umop;
      w_net:=sum_netp
   |? PAR_WYDR.DANE = 2
   || w_war:=sum_warf;
      w_umo:=sum_umof;
      w_net:=sum_netf
   |? PAR_WYDR.DANE=4
   || w_war:=sum_ward;
      w_umo:=sum_umod;
      w_net:=sum_netd
   ?};

   {? PAR_WYDR.RODZAJ<>1
   || {? PAR_WYDR.DANE = 3
      || {? PAR_WYDR.ZESTAW = 1
         || zestaw2:='Wszystkie jedn. ks. razem (B):'@;
            zestaw3:='Wszystkie jedn. ks. razem (P):'@
         || zestaw2:='Wszystkie grupy razem (B):'@;
            zestaw3:='Wszystkie grupy razem (P):'@
         ?}
      || {? PAR_WYDR.ZESTAW = 1
         || zestaw2:=zestaw3:='Wszystkie jedn. ks. razem:'@
         || zestaw2:=zestaw3:='Wszystkie grupy razem:'@
         ?}
      ?}
   || {? PAR_WYDR.ZESTAW = 1
      || zestaw2:='Wszystkie jedn. ks. razem:'@
      || zestaw2:='Wszystkie grupy razem:'@
      ?}
   ?}
;~~}
{ prn1:='PRNF2';~~}
{IF: PAR_WYDR.DANE = 3 & lineleft()<>0 & lineleft()<3}{PAGE}{FI}{SUBSTITUTE: 'LINIA0'}
{IF: PAR_WYDR.DANE = 3}
{rsep:=0; {? PAR_WYDR.RODZAJ<>1 || zestaw3:=zestaw2 || zestaw2:='' ?}; ~~}
{ w_war:=sum_warf;
  w_umo:=sum_umof;
  w_net:=sum_netf
;~~}
{SUBSTITUTE: 'LINIA0'}
{IF: FINFO.TOR_D='T'}
{rsep:=0; {? PAR_WYDR.RODZAJ<>1 || zestaw3:='Wszystkie grupy razem (D):'@ || zestaw2:='' ?}; ~~}
{ w_war:=sum_ward;
  w_umo:=sum_umod;
  w_net:=sum_netd
;~~}
{SUBSTITUTE: 'LINIA0'}
{FI}
{FI}
{ vp:=0; ~~}
{FI}
{REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}