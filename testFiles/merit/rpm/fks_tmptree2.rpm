:!UTF-8
{TITLE: Rozrachunki wg kont}
{PRINTER: FINFO.SZ_PRN,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
          PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN: PRN:=obj_new(@.CLASS.PRINT,10); PRN.sl_frame(); w:=obj_new(10); licz:=0;
        color:=''; prn1:=prn2:='PRN'; lm:=ll:=lmt:=0;
        head:=PAR_WYDR.HEAD; vp:=1; rsep:=PAR_WYDR.RSEP;
        PAR_WYDR.TITLE:='ROZRACHUNKI WG KONT';
        tab_ana:={? var_pres('TAB_WID')>0 || TAB_WID || TAB_ROZ ?};
        tab_ana.cntx_psh(); {! _i:=1..10 |! w[_i]:='' !}; dalej:=0; s_sign:=''
}
{END: tab_ana.cntx_pop(); VAR_DEL.delete('PRN','w','tab_ana'); &licz; &dalej; &s_sign;
      &color; &prn1; &prn2; &lm; &ll; &vp; &lmt; &rsep; &head}
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzezone
==================================================
Nazwa pliku: fks_tmptree2.rpm
Utworzony:   2005-06-13 [AMK] Artur Makos
==================================================
Zawartosc: Rozrachunki wg kont (pulpit windykatora)
{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{ PRN.add("w[1]",60,'Opis pozycji'@);
  PRN.add("w[2]",16,'Obroty Winien'@,1);
  PRN.add("w[3]",16,'Obroty Ma'@,1);
  PRN.add("w[4]",16,'Saldo Winien'@,1);
  PRN.add("w[5]",16,'Saldo Ma'@,1);
  PRN.add("w[6]",10,'Data otw.'@);
  PRN.add("w[7]",10,'Termin pł.'@);
  PRN.add("w[8]",6,'Zwłoka'@,1);
  PRN.add("w[9]",6,'Typ'@);
  PRN.add("w[10]",19,'Jednostka księgowa'@);~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}{FONT: 'W8'}{SPACE: 'C'}
{IF: page=1}
{<3 {? var_pres('pulpit')>0 || 'Parametry analizy:'@ || 'Parametry wydruku:'@ ?}}
{<6 'Waluta: %1 - %2'@[SSTALE.WAL().KOD,SSTALE.WAL().TR]}{IF: var_pres('pulpit')>0}{<60
 {? WIND_N.ZAK_KON='M' || 'Maska kont: %1'@[WIND_N.KON_MAS] || 'Prefix kont: %1'@[WIND_N.KON_PRE]?}}{<115
{? WIND_N.Z='T' ||  'Generować pozycje rozr. po terminie: tak'@ ||  'Generować pozycje rozr. po terminie: nie'@ ?}}
{<6 {? WIND_N.ODD=0 ||  'Jednostka księgowa: wszystkie jednostki księgowe'@ ||  'Jednostka księgowa: %1'@[WIND_N.ODD().OD] ?}}{<60
{?WIND_N.ZAK_ROZ='T' || 'Rozrachunki przed terminem poniżej %1 dni'@[$WIND_N.PRZED_TP] ||   'Rozrachunki przed terminem powyżej %1 dni'@[$WIND_N.PO_TP] ?}}{<115
 'Opis: %1'@[WIND_N.OPIS]}
{<6 'Operator: %1'@[WIND_N.USER]}{<60'Ostatnie płatności %1 dni wstecz'@[$WIND_N.OST_PL]}{<115
{? WIND_N.OZNACZ='T' ||  'Tylko oznaczone do monitowania: tak'@ ||  'Tylko oznaczone do monitowania: nie'@ ?}}
{<6 {? -WIND_N.ZAK_KH='b' || 'Kontrahenci: wybrani'@ || 'Kontrahenci: wszyscy'@ ?}}{<60
 'Kontrahenci powyżej wartości: %1'@[form(WIND_N.OD_KW,,2,' ,')]}
{FI}{FI}
{FONT: 'T8B'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{ vp:=1;~~}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}{FONT: 'T8'}{SPACE: 'C'}
{SUBSTITUTE: 'LINIAF'}{ vp:=1;~~}
{FOOTER-}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8'}{SPACE: 'C'}{ dalej:=tab_ana.first();~~}
{WHILE: dalej}
{DO}
{IF: lineleft()=1 | lineleft()=2}{PAGE}{FI}
{ w[1]:=tab_ana.WART; w[2]:=form(tab_ana.WN,,2,' ,'); w[3]:=form(tab_ana.MA,,2,' ,');
  w[4]:=form(tab_ana.SWN,,2,' ,'); w[5]:=form(tab_ana.SMA,,2,' ,'); w[6]:=tab_ana.DO;
  w[7]:=tab_ana.TZ; w[8]:=tab_ana.ZWL; w[9]:=tab_ana.TYP; w[10]:=tab_ana.ODD;
~~}
{SUBSTITUTE: 'LINIA0'}
{IF: tab_ana.SYM_ZEW<>''}
{ {! _i:=1..10 |! w[_i]:='' !}; w[1]:=tab_ana.SYM_ZEW; rsep:=0; ~~}
{SUBSTITUTE: 'LINIA0'}
{ rsep:=1;~~}
{FI}
{ dalej:=tab_ana.next();~~}
{OD}