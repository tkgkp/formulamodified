:!UTF-8
{TITLE:Wydruk ewidencji VAT}
{PRINTER: FINFO.SZ_PRN,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
 _exp:={? rep_expo() || 7 || 0 ?}; PRN:=obj_new(@.CLASS.PRINT,30); PRN.sl_frame();
 PRN1:=obj_new(@.CLASS.PRINT,20); PRN1.sl_frame(); STR2:=obj_new(@.CLASS.STRING); STR3:=obj_new(@.CLASS.STRING);
 prosty:=0; w:=obj_new(52);  szer:=obj_new(17); ww:=obj_new(39); www:=obj_new(30); {!_a:=1 ..20 |! w[_a]:='' !};
 SLU.cntx_psh; SLU.index('NAZ'); SLU.prefix(); {! _a:=1..30 |! ww[_a]:=www[_a]:=0 !}; sizeslo:=0;
 w6:=w7:=w8:=w9:=w10:=w11:=w12:=0; stawka:=obj_new(7); text:=obj_new(18);
 sstr5:=sstr6:=sstr7:=sstr8:=sstr9:=sstr10:=sstr11:=sstr12:=sstr13:=0; linijka:=numer:=0;
 sstr14:=sstr15:=sstr16:=sstr17:=sstr18:=sstr19:=sstr20:=sstr21:=sstr22:=sstr23:=0;
 suma5:=suma6:=suma7:=suma8:=suma9:=suma10:=suma11:=suma12:=suma13:=suma14:=0;
 suma15:=suma16:=suma17:=suma18:=suma19:=suma20:=suma21:=suma22:=suma23:=0;
 w55:=w555:=rejestr:=tytul:=''; VAT7.PAR1:=VAT7.PAR3:=VAT7.PAR4:=0; VAT7.PAR2:=3;
 pom:=1; licznik:=inwest0:=inwest1:=inwest2:=inwest3:=inwest4:=inwestv1:=inwestv2:=0;
 pozost0:=pozost1:=pozost2:=pozost3:=pozost4:=pozostv1:=pozostv2:=zak:=0; zamk:=1;
 param1:=param2:=param3:=param4:=param5:=param6:=param7:=param8:=''; linecnt:=ile_l:=0;
 pom_1:=pom_2:=pom_3:=pom_4:=pom_5:=pom_6:=pom_7:='';
 dru_rej:=0; rej_1:=rej_2:=rej_3:=rej_4:=rej_5:=rej_6:=rej_7:=rej_8:=0;
 rej_9:=rej_10:=rej_11:=rej_12:=rej_13:=rej_14:=rej_15:=rej_16:=rej_17:=rej_18:=0;
 rej_naz:=''; pierwszy:=1; kor:=0; font_gr:=0;odd:=OPERATOR.DEPT=null;
 color:=''; prn1:=prn2:='PRN';
 lm:=ll:=lmt:=rsep:=0; vp:=1; rsep:=PAR_WYDR.RSEP; PAR_WYDR.RSEP:=1; fun:='';
 {? var_press('WAL',VAT7)>0 || VAT7.WAL:=exec('kod_pln','slo_slu') ?}; wal_op:='';
 VAT7.KRAJ:=exec('kod_pl','slo_slu'); kraj:='';
 VAT7.WY3:=1; VAT7.WYD_TECH:=0;  head:=PAR_WYDR.HEAD; logo:=PAR_WYDR.LOGO; UNPAR.P1:=1;
 OKRO_F.win_dict('SLO'); VAT7.WYSTROK:=VAT7.WYSTOKRO:=null; ROK_F.win_dict('WER')
}
{END:
 PAR_WYDR.HEAD:=head; &head; PAR_WYDR.LOGO:=logo; &logo; &ile_l;
 SLU.cntx_pop; {? var_pres('hdr_vat')>0 || &hdr_vat ?};
 &w6; &w7; &w8; &w9; &w10; &w11; &w12; obj_del(stawka); obj_del(ww); obj_del(www); obj_del(text);
 &sstr5; &sstr6; &sstr7; &sstr8; &sstr9; &sstr10; &sstr11; &sstr12; &sstr13; &sstr14; &sstr15; &sstr16;
 &sstr17; &sstr18; &sstr19; &sstr20; & sstr21; &sstr22; &sstr23; &zak; &linijka; &numer;
 &suma5; &suma6; &suma7; &suma8; &suma9; &suma10; &suma11; &suma12; &suma13; &suma14;
 &suma15; &suma16; &suma17; &suma18; &suma19; &suma20; &suma21; &suma22; &suma23;
 &w55; &w555;  &sizeslo; &licznik; &rejestr;  &pom;   &tytul; &prosty;
 &inwest0; &inwest1; &inwest2; &inwest3; &inwest4; &inwestv1; &inwestv2;
 &pozost0; &pozost1; &pozost2; &pozost3; &pozost4; &pozostv1; &pozostv2; &odd;
 {? var_pres('tvat')>0 || obj_del(tvat); obj_del(tn); obj_del(tv); obj_del(tb); obj_del(sn); obj_del(sv); obj_del(sb) ?};
 obj_del(w); &param1; &param2; &param3; &param4; &param5; &param6; &param7; &param8; SLO.hdr_sel; &zamk; &linecnt;
 _a:=SSTALE.AR().KOD+form(SSTALE.AO().NR,-2); obj_del(PRN); obj_del(PRN1); obj_del(szer);
 DOK.use('doku'+_a); POZ.use('pozy'+_a); POW.use('pow_'+_a);
 &rej_naz; &pierwszy; &pom_1; &pom_2; &pom_3; &pom_4; &pom_5; &pom_6; &pom_7;
 &dru_rej; &rej_1; &rej_2; &rej_3; &rej_4; &rej_5; &rej_6; &rej_7;&rej_8; &rej_9; &rej_10; &rej_11;
 &rej_12; &rej_13; &rej_14; &rej_15; &rej_16; &rej_17; &rej_18; &kor; font_gr:=1;
 &color; &prn1; &prn2;
 &lm; &ll; &vp; &lmt; PAR_WYDR.RSEP:=rsep; &rsep; &fun;
 &wal_op; &kraj; VAR_DEL.delete('dokvpoch','s2c','su','ssu','is_us','okrVat','okrVatNr','STR2','STR3')
}
{ SLU.prefix();
  {? SLU.find_key('~GRUPY PODATKOWE')
  || SLO.win_sel('ONE_SEL'); SLO.index('SL'); SLO.prefix(SLU.ref); SLO.hdr_sel; SLO.hdr_sel('GRUPY PODATKOWE');
     zamk:=SLO.select();
     rejestr:=SLO.KOD; tytul:='GRUPA PODATKOWA '+SLO.KOD
  ||  zamk:=0
  ?};~~}
{EXIT: ~zamk}
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzezone
==================================================
Nazwa pliku: vat_grup.rpm
Utworzony:   ???? - ??- ?? [?????] ???????????
Modyfikacje: 2001-03-20 [AMK] Artur Makos
==================================================
Zawartosc: Wydruk grup podatkowych VAT
{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: ~rep_expo()}{SUBSTITUTE: 'FOOT'}{FI}
{ VAT7.win_edit({? (1+rejestr)='Z' || 'REJZAK3' || 'REJSP1' ?});
  VAT7.hdr_edit();
  VAT7.hdr_edit({? var_pres('hdr_vat')<=0
                || 'GRUPY PODATKOWE VAT'
                || ~(-hdr_vat)
                ?});
  {? var_pres('hdr_vat')<0  || hdr_vat:=tytul || hdr_vat:=~(-hdr_vat) ?};
~~}
{EXIT: ~VAT7.edit()}
{ PAR_WYDR.TITLE:=hdr_vat+exec('naz_okr_vat','!fks_vat_zrej');
  okrVat:=exec('okr_vat_wydr','!fks_vat_zrej');
  dokvpoch:=exec('dokvpoch','!fks_vat_zrej');
  {? (1+rejestr)='Z'
  || param1:='Wydruk w podziale na: stawki';
     param2:='Uwzględniono: '+{? VAT7.PAR2=1 || 'korekty zakupów' |? VAT7.PAR2=2 || 'zakup' || 'zakup i korekty zakupów' ?};
     prosty:=1
  || param1:='Wydruk w wariancie: '+{? VAT7.PAR1=0 || 'uproszczonym' || 'rozszerzonym' ?};
     param2:='Uwzględniono: '+{? VAT7.PAR2=1 || 'korekty sprzedaży' |? VAT7.PAR2=2 || 'sprzedaż' || 'sprzedaż i korekty sprzedaży' ?};
     {? VAT7.PAR1 || zak:=2; prosty:=0 |? ~VAT7.PAR1 || prosty:=1 ?}
  ?};
  param3:='Wydruk dokumentów: '+exec('vat7par3','!fks_vat_zrej');
  {? SLU.find_key('~STAWKI VAT '+VAT7.KRAJ().KOD)
  || SLO.cntx_psh(); SLO.index('SL'); SLO.prefix(SLU.ref()); sizeslo:=SLO.size();
     tvat:=obj_new(sizeslo); tn:=obj_new(sizeslo);  tv:=obj_new(sizeslo); tb:=obj_new(sizeslo);
     sn:=obj_new(sizeslo); sv:=obj_new(sizeslo); sb:=obj_new(sizeslo); SLO.first;
     _ile:={? sizeslo<9 || 9 || sizeslo ?};
      su:=obj_new(_ile); ssu:=obj_new(8); {! _i:=1..8 |! ssu[_i]:=0 !}; is_us:=0;
     {! _a:=1 ..sizeslo
     |! tvat[_a]:=SLO.KOD; tn[_a]:=tv[_a]:=tb[_a]:=sn[_a]:=sv[_a]:=sb[_a]:=0; SLO.next()
     !}; SLO.cntx_pop();
     {! _a:=1.._ile
     |! su[_a]:=obj_new(4); su[_a][1]:=su[_a][2]:=su[_a][3]:=su[_a][4]:=0
     !}
  ?};
~~}
{IF: prosty}
{INCLUDE: fks_vatrej4.rpi}
{ELSE}
{INCLUDE: fks_vatrej5.rpi}
{FI}