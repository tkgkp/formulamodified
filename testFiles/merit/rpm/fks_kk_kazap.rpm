:!UTF-8
{TITLE:B.  Kartoteka zapisów księgowych we wskazanym przedziale okresów}
{PRINTER: FINFO.SZ_PRN,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
   sstrwn:=sstrma:=sumawn:=sumama:=sstrwn1:=sstrma1:=sumawn1:=sumama1:=0;
   color:=''; prn1:=prn2:='PRN'; lm:=ll:=lmt:=jbar:=0; vp:=1; rsep:=PAR_WYDR.RSEP;
   w:=obj_new(25); ww:=obj_new(10);  petla:=0; lp:=1; dane:=dane1:=mdc:='';font:='J';
   w9:=w10:=w91:=w92:=0; dl:=dl1:=0;  poziom:=poziom2:=0;
   {? PAR_SKID.get(39)='T' || czy_w:=1
   |? PAR_SKID.get(39)='N' || czy_w:=0
   || czy_w:=2
   ?};
   PRN:=obj_new(@.CLASS.PRINT,25); PRN.sl_frame();
   PRN1:=obj_new(@.CLASS.PRINT,15); PRN1.sl_frame();
   szer:=obj_new(15); wal:={? SSTALE.WAL=FINFO.NAROD || 0 || 1 ?};
   szer[1]:=20; szer[2]:=4; szer[3]:=50; szer[4]:=10; szer[5]:=11; szer[6]:=szer[7]:=szer[10]:=szer[11]:=15;
   szer[8]:=8; szer[9]:=20; szer[12]:=20; szer[13]:=10;
   wydrukod:=okresod:=okresdo:=pierwszy:=0; dataod:=datado:='';
   sokrown:=sokroma:=sokrown1:=sokroma1:=0;
   {? PARWYD.REDANTRE & var_pres('KONTO',TT_STKON)=27
   || an_sym:=TT_STKON.AN;
      KS.cntx_psh();
      KS.index('SYM'); KS.prefix();
      {? KS.find_key(SSTALE.AR,TT_STKON.KS)
      || ks_ref:=KS.ref; ks_naz:=KS.NAZ
      || ks_ref:=null; ks_naz:=KS.NAZ
      ?};
      KS.cntx_pop()
   || an_sym:=AN.SYM; ks_ref:=AN.KS; ks_naz:=AN.KS().NAZ
   ?};
   czy_odd:=OPERATOR.DEPT=null; szer[14]:=8*czy_odd
}
{END:
   &color; &prn1; &prn2; &ll; &vp; &lmt; &rsep; &jbar;
   &sstrwn; &sstrma; &petla; &sumawn; &sumama; obj_del(w); obj_del(PRN); obj_del(PRN1);
   obj_del(ww); &w9; &w10; &w91; &w92; obj_del(szer); &dl; &dl1; &lp; &dane; &dane1; &wal;
   &poziom; &poziom2; &wydrukod; &okresod; &okresdo; &pierwszy; &dataod; &datado;
   &sokrown; &sokroma; &sokrown1; &sokroma1; &czy_w; &czy_odd; &sstrma1; &sstrwn1; &sumama1; &sumawn1;
   okres:=SSTALE.AR().KOD+form(SSTALE.AO().NR,-2);&mdc;&lm;&font;
   &an_sym; &ks_ref; &ks_naz;
   DOK.use('doku'+okres); POZ.use('pozy'+okres); POW.use('pow_'+okres); &okres
}
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzezone
==================================================
Nazwa pliku: kk_kazap.rpm
Utworzony:   ????-??-??
Modyfikacje: 2001-06-26 [AMK] Artur Makos
==================================================
Zawartosc: Kartoteka zapisow dla konta we wskazanym przedziale okresow
{COMMENT-}
{INCLUDE: wsp_pw3.rpi}
{INCLUDE: wsp_pw.rpi}
{IF: ~rep_export()}{SUBSTITUTE: 'FOOT'}{SPACE: 'C'}{FI}
{ {? czy_w=2
  || WYDRUKI.win_edit('OKR_KZAP'); PAR_WYDR.WSK_WAL:='T'
  || WYDRUKI.win_edit('OKRESY')
  ?};
  WYDRUKI.OKRESOD:=0; WYDRUKI.OKRESDO:=SSTALE.AO().NR; ~~}
{EXIT: ~(WYDRUKI.edit("{? (WYDRUKI.OKRESDO<=SSTALE.AR().LOBR+1)&
                          (WYDRUKI.OKRESOD<=WYDRUKI.OKRESDO)&
                          (WYDRUKI.OKRESOD>=0)
                       || wydrukod:=WYDRUKI.OKRESOD; okresod:=WYDRUKI.OKRESOD; okresdo:=WYDRUKI.OKRESDO; 1
                       || FUN.info('Okresy muszą się mieścić w bieżącym roku bilansowym\n i pierwszy nie może być większy od drugiego.'@);
                          WYDRUKI.OKRESOD:=0; WYDRUKI.OKRESDO:=SSTALE.AO().NR; 0
                       ?}
                      "))}
{ {? czy_w=2 || {? PAR_WYDR.WSK_WAL='T' || czy_w:=1 || czy_w:=0 ?} ?};
  {? ~czy_w || szer[3]+=szer[8]+szer[9]+szer[10]+szer[11]+3 ?};
  {? czy_odd || szer[3]-=szer[14] ?};
  {? rep_export()
  || PRN.add("w[1]",szer[1],'Okres'@);
     PRN.add("w[2]",20,'Symbol dokumentu'@);
     PRN.add("w[15]",szer[3],'Opis operacji'@);
     PRN.add("w[3]",szer[4],'Data zapisu'@);
     PRN.add("w[16]",5,'Numer w dzienniku'@,1);
     {? czy_odd || PRN.add("w[14]",szer[14],'Jedn. księgowa'@) ?};
     PRN.add("w[4]",9,'Rejestr'@);
     PRN.add("w[16]",9,'Nr'@,1);
     PRN.add("w[17]",9,'Poz.'@,1);
     PRN.add("w[5]",szer[6],'Wn (%1)'@[(3+FINFO.NAROD().KOD)],1);
     PRN.add("w[6]",szer[7],'Ma (%1)'@[(3+FINFO.NAROD().KOD)],1);
     {? czy_w
     ||
        PRN.add("w[7]",szer[8],'Waluta'@);
        PRN.add("w[18]",szer[8],'Kurs'@,1);
        PRN.add("w[8]",szer[9],'Bank'@);
        PRN.add("w[19]",szer[9],'Tabela'@);
        PRN.add("w[9]",szer[10],{? ~wal ||'  Wn (waluta)'@||'  Wn (%1)'@[(3+SSTALE.WAL().KOD)]?},1);
        PRN.add("w[10]",szer[11],{? ~wal ||'  Ma (waluta)'@||'  Ma (%1)'@[(3+SSTALE.WAL().KOD)]?},1)
     ?};
     PRN.add("w[11]",szer[12],'Typ'@);
     PRN.add("w[20]",szer[12],'Symbol rozrachunku'@);
     PRN.add("w[12]",szer[13],'Data otw. rozrachunku'@);
     PRN.add("w[21]",szer[13],'Termin płatności'@)
  || PRN.add("w[1]",szer[1],'        Okres'@); PRN.add("w[13]",szer[2],'Lp.'@);
     _temp1:=(szer[3]%2-8)*' ';
     _temp2:=(szer[3]%2-6)*' ';
     PRN.add("w[2]",szer[3],'%1Symbol dokumentu/#%2opis operacji'@[_temp1,_temp2],,'#');
     PRN.add("w[3]",szer[4],'D. zap./ nr w dz.'@);
     {? czy_odd || PRN.add("w[14]",szer[14],'Jed. ks.'@) ?};
     PRN.add("w[4]",szer[5],'  Rejestr#nr   / poz.'@,,'#');
     PRN.add("w[5]",szer[6],'   Wn (%1)'@[(3+FINFO.NAROD().KOD)],1);
     PRN.add("w[6]",szer[7],'   Ma (%1)'@[(3+FINFO.NAROD().KOD)],1);
     {? czy_w
     || PRN.add("w[7]",szer[8],'Waluta/ kurs'); PRN.add("w[8]",szer[9],'Bank/ tabela');
        PRN.add("w[9]",szer[10],{? ~wal ||'  Wn (waluta)'@||'  Wn (%1)'@[(3+SSTALE.WAL().KOD)]?},1);
        PRN.add("w[10]",szer[11],{? ~wal ||'  Ma (waluta)'@||'  Ma (%1)'@[(3+SSTALE.WAL().KOD)]?},1)
     ?};
     PRN.add("w[11]",szer[12],'Typ/ symbol rozr.'@); PRN.add("w[12]",szer[13],'Data otw./ t. płatn.'@);
     PRN1.add("ww[1]",szer[1]+szer[2]+szer[3]+szer[4]+szer[5]+szer[14]+4+czy_odd,''); PRN1.add("ww[2]",szer[6],'',1);
     PRN1.add("ww[3]",szer[7],'',1);
     {? czy_w
     || PRN1.add("ww[4]",szer[8]+szer[9]+1,''); PRN1.add("ww[5]",szer[10],'',1);
        PRN1.add("ww[6]",szer[11],'',1);
        PRN1.add("ww[7]",szer[12]+szer[13]+1,'')
     ?}
  ?};
  ww[1]:=ww[2]:=ww[3]:=ww[4]:=ww[5]:=ww[6]:=ww[7]:='';
  OKRO_F.index('ROK'); OKRO_F.prefix(SSTALE.AR);
  {? OKRO_F.find_key(okresod) || dataod:=OKRO_F.NAZ ?};
  {? OKRO_F.find_key(okresdo) || datado:=OKRO_F.NAZ ?};
  OKRO_F.prefix();
  w[1]:=an_sym; poziom:=poziom2:=0; KS.prefix();
  {? KS.seek(ks_ref)
  || BUD.cntx_psh(); exec('rpm_clear','dok_fks');
     synt:=an_sym; KOM.index('KS');  KOM.prefix;
     {? KOM.find_key(KS.ref) || exec('rpm_display','dok_fks') ?};
     poziom:=poziom2:=BUD.size();
     BUD.cntx_pop()
  || FUN.info('Nie znaleziono konta syntetycznego dla konta %1.'@[an_sym])
  ?};    ~~
}
{COMMENT}------------------------------MACRO-LINIA------------------{COMMENT-}
{MACRO: 'LINIA'}
{PRN.ini_line()}
{WHILE: PRN.next()}
{DO}
{REP: PRN.fline()}
{OD}
{MACRO-}
{COMMENT}------------------------------MACRO-LINIA1------------------{COMMENT-}
{MACRO: 'LINIA1'}
{  ll:=lineleft(); ~~}
{IF:  PRN1.ini_line(); ll<(rsep+ PRN1.length()) & ll<>0}{PAGE}{FI}
{IF: vp}
 { PRN1.setcolor(color); PRN.setcolor(color);~~}
{IF: jbar}{REP: PRN.fjbar(PRN1)}{ELSE}{REP: PRN1.fbar(lmt)}{FI}
 { PRN1.setcolor('255:255:255'); PRN.setcolor('255:255:255'); vp:=0; ~~}
{ELIF: rsep}
{IF: jbar}{REP: PRN.fjbar(PRN1)}{ELSE}{REP: PRN1.fbar(lmt)}{FI}
{FI}
{WHILE: PRN1.next()}
{DO}
   {REP: PRN1.fline(lmt)}
{OD}
{MACRO-}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}{ prn1:=prn2:='PRN';~~}
{PAR_WYDR.TITLE:='KARTOTEKA ZAPISÓW KSIĘGOWYCH NA KONTACH O PREFIKSIE %1'@[an_sym];~~}
{SUBSTITUTE: 'HEAD'}{FONT: 'T8G'}{SPACE: 'C'}
{IF: page()=1}
{IF: rep_export()}
{'Parametry wydruku:'@}
{'Od okresu: %1 do okresu: %2'@[dataod,datado]}
{
   {? STALE.AO().ZAM='T'
   ||'Okres obrachunkowy: %1 %2 - zamknięty'@[SSTALE.AO().NAZ,SSTALE.AR().NAZ]
   ||'Okres obrachunkowy: %1 %2 - otwarty'@[SSTALE.AO().NAZ,SSTALE.AR().NAZ]
   ?}
}
{'Waluta: %1  %2'@[SSTALE.WAL().KOD,SSTALE.WAL().TR]}
{{? OPERATOR.DEPT || 'Jednostka księgowa: %1'@[OPERATOR.DEPT().OD] || 'Jednostka księgowa: wszystkie jednostki księgowe'@ ?}}
{SSTALE.AO().ROK().SYNT+KA.KS}{<{7+(+an_sym)} ks_naz}
{WHILE: poziom>0}
{DO}
  { dane:=($('  '+'KA.P'+$(poziom2-poziom+1)+'().TR'))();
    dane1:=$('KA.P'+$(poziom2-poziom+1)+'().KOD');
    dl1:=5+SSTALE.AO().ROK().SYNT+dl+(poziom2-poziom+1)*{? SSTALE.AO().ROK().SEP<>',' || 1 || 0 ?};
    dl+=(+dane1());~~}
{IF: dane<>''}{<{dl1} dane1()}{<{7+(+an_sym)} dane}{FI}
  { poziom-=1; ~~}
{OD}
{LINE: 1}
{ELSE}
{<3 'Parametry wydruku:'@}
{<5 'Od okresu: %1 do okresu: %2'@[dataod,datado]}
{<5
   {? STALE.AO().ZAM='T'
   ||'Okres obrachunkowy: %1 %2 - zamknięty'@[SSTALE.AO().NAZ,SSTALE.AR().NAZ]
   ||'Okres obrachunkowy: %1 %2 - otwarty'@[SSTALE.AO().NAZ,SSTALE.AR().NAZ]
   ?}
}
{<5 'Waluta: %1  %2'@[SSTALE.WAL().KOD,SSTALE.WAL().TR]}
{<5 {? OPERATOR.DEPT || 'Jednostka księgowa: %1'@[OPERATOR.DEPT().OD] || 'Jednostka księgowa: wszystkie jednostki księgowe'@ ?}}
{<5 SSTALE.AO().ROK().SYNT+KA.KS}{<{7+(+an_sym)} ks_naz}
{WHILE: poziom>0}
{DO}
  { dane:=($('  '+'KA.P'+$(poziom2-poziom+1)+'().TR'))();
    dane1:=$('KA.P'+$(poziom2-poziom+1)+'().KOD');
    dl1:=5+SSTALE.AO().ROK().SYNT+dl+(poziom2-poziom+1)*{? SSTALE.AO().ROK().SEP<>',' || 1 || 0 ?};
    dl+=(+dane1());~~}
{IF: dane<>''}{<{dl1} dane1()}{<{7+(+an_sym)} dane}{FI}
  { poziom-=1; ~~}
{OD}
{FI}
{FI}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{ vp:=1;~~}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER:0}{FONT: 'T8GB'}{SPACE: 'C'}{prn2:='PRN1';~~}
{ ww[1]:='   SUMA STRONY'; ww[2]:=form(sstrwn,,2,' ,'); ww[3]:=form(sstrma,,2,' ,');
                  {? wal || ww[5]:=form(sstrwn1,,2,' ,'); ww[6]:=form(sstrma1,,2,' ,') ?}; ~~}
{SUBSTITUTE: 'LINIA02'}
{IF: page>1}{ ww[1]:='   Z PRZENIESIENIA'; ww[2]:=form((sumawn-sstrwn),,2,' ,'); ww[3]:=form((sumama-sstrma),,2,' ,');
                          {? wal || ww[5]:=form((sumawn1-sstrwn1),,2,' ,'); ww[6]:=form((sumama1-sstrma1),,2,' ,') ?}; ~~}
{SUBSTITUTE: 'LINIA1'}{FI}
{ ww[1]:='   DO PRZENIESIENIA'; ww[2]:=form(sumawn,,2,' ,'); ww[3]:=form(sumama,,2,' ,');
  {? wal || ww[5]:=form(sumawn1,,2,' ,'); ww[6]:=form(sumama1,,2,' ,') ?}; ~~}
{SUBSTITUTE: 'LINIA1'}{prn1:='PRN1';~~}
{REP: PRN1.flbar()}
{SUBSTITUTE: 'CHARFOOT'}{ vp:=1; prn1:=prn2:='PRN';~~}{ sstrwn:=sstrma:=sstrwn1:=sstrma1:=0; ~~}
{FOOTER-}
{COMMENT}----------------------WYDRUK-------------------------------------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{WHILE: WYDRUKI.OKRESOD<=WYDRUKI.OKRESDO}
{DO}
{ okres:=SSTALE.AR().KOD+form(WYDRUKI.OKRESOD,-2); DOK.use('doku'+okres);
  POZ.use('pozy'+okres); POW.use('pow_'+okres);
 {? OPERATOR.DEPT
 || {? SSTALE.WAL<>FINFO.NAROD
    || POZ.index('OKWAL_O'); POZ.prefix('T','T',SSTALE.WAL,OPERATOR.DEPT,an_sym)
    || POZ.index('OKWAL_O1'); POZ.prefix('T','T',OPERATOR.DEPT,an_sym)
    ?}
 || {? SSTALE.WAL<>FINFO.NAROD
    || POZ.index('OKWAL'); POZ.prefix('T','T',SSTALE.WAL,an_sym)
    || POZ.index('OKWAL1'); POZ.prefix('T','T',an_sym)
    ?}
 ?}; petla:=POZ.first(); ~~
}
{IF: rep_export()}
{WHILE: petla}
{DO}
   {
     OKRO_F.cntx_psh;OKRO_F.prefix; OKRO_F.index('ROK');
     {? OKRO_F.find_key(SSTALE.AR,WYDRUKI.OKRESOD) || okres:=OKRO_F.NAZ ?};
     OKRO_F.cntx_pop;
     w[1]:=okres;
     w[2]:=POZ.DOK().NK;
     w[3]:=POZ.DOK().DTW$3;
     w[4]:=POZ.DOK().REJ().KOD;
     w[14]:=POZ.DOK().REJ().ODD().OD;
     {? -POZ.STR='wn'
     || w[5]:=form(POZ.SUM,,2,' ,'); w[6]:=form(0,,2,' ,')
     || w[6]:=form(POZ.SUM ,,2,' ,'); w[5]:=form(0,,2,' ,')
     ?};
     {? (~wal & POZ.WAL<>null ) | wal
     || {? -POZ.STR='wn'
        || w[9]:=form(POZ.SUMW,,2,' ,'); w[10]:=form(0,,2,' ,')
        || w[10]:=form(POZ.SUMW,,2,' ,'); w[9]:=form(0,,2,' ,')
        ?};
        w[7]:=(3+POZ.WAL().KOD); w[8]:=POZ.DOK().BANK().KOD
     || w[9]:=w[10]:=w[7]:=w[8]:=w[18]:=w[19]:=''
     ?};
     w[11]:=POZ.TID;
     {? POZ.ID<>'' || w[12]:=POZ.DO$3 || w[12]:=''?};
     {? (~wal & POZ.WAL<>null) | wal
     || w[18]:=form(POZ.KURS,8,4,' ,');
        {? POZ.DOK().BANK().KOD<>''
        || w[19]:=POZ.DOK().TKRS().SYM
        || w[19]:=''
        ?}
     ?};
     w[15]:=POZ.OP; w[16]:=$POZ.DOK().NRDZ;
     w[16]:=$POZ.DOK().NR+(6-(+$POZ.DOK().NR))*' ';
     w[17]:=form(POZ.POZ,5,,'99');
     w[20]:=POZ.ID;
     {? POZ.ID<>'' || w[21]:=POZ.TP$3 || w[21]:='' ?};~~}
     {SUBSTITUTE: 'LINIA'}
     {petla:=POZ.next(); ~~}
{OD}
{ WYDRUKI.OKRESOD+=1; ~~ }
{ELSE}
{WHILE: petla}
{DO}
   {IF: lineleft()<>0 & lineleft()<5}{PAGE}{FI}
   { w[1]:=''; w[2]:=POZ.DOK().NK;  w[3]:=POZ.DOK().DTW$3;
     w[4]:=POZ.DOK().REJ().KOD; w[13]:=$lp; lp+=1; pierwszy:=1;
     w[14]:=POZ.DOK().REJ().ODD().OD;
     {? (~wal & POZ.WAL<>null ) | wal
     || {? -POZ.STR='wn'
        || w[9]:=form(POZ.SUMW,,2,' ,'); w[10]:=form(0,,2,' ,')
        || w[10]:=form(POZ.SUMW,,2,' ,'); w[9]:=form(0,,2,' ,')
        ?};
        w[7]:=(3+POZ.WAL().KOD); w[8]:=POZ.DOK().BANK().KOD
     || w[7]:=w[8]:=w[9]:=w[10]:=''
     ?}; w[11]:=POZ.TID; {? POZ.ID<>'' || w[12]:=POZ.DO$3 || w[12]:=''?};
     {? -POZ.STR='wn'
     || w[5]:=form(POZ.SUM,,2,' ,'); w[6]:=form(0,,2,' ,')
     || w[6]:=form(POZ.SUM ,,2,' ,'); w[5]:=form(0,,2,' ,')
     ?};~~}
{SUBSTITUTE: 'LINIA0'}{ vp:=0; {? lineleft()=0 || vp:=1 ?};~~}
{ w[1]:=w[5]:=w[6]:=w[9]:=w[10]:=w[13]:=w[14]:=''; w[2]:=POZ.OP; w[3]:=$POZ.DOK().NRDZ;
  w[4]:=$POZ.DOK().NR+(6-(+$POZ.DOK().NR))*' '+form(POZ.POZ,5,,'99');
  {? (~wal & POZ.WAL<>null) | wal
  || w[7]:=form(POZ.KURS,8,4,' ,');
     {? POZ.DOK().BANK().KOD<>''
     || w[8]:=POZ.DOK().TKRS().SYM
     || w[8]:=''
     ?}
  ?};
  w[11]:=POZ.ID; {? POZ.ID<>'' || w[12]:=POZ.TP$3 || w[12]:='' ?};
~~}
{SUBSTITUTE: 'LINIA'}{ vp:=0; {? lineleft()=0 || vp:=1 ?};~~}
{ {? -POZ.STR='wn'
  || sstrwn+=POZ.SUM; sumawn+=POZ.SUM; sokrown+=POZ.SUM;
     {? wal || sstrwn1+=POZ.SUMW; sumawn1+=POZ.SUMW; sokrown1+=POZ.SUMW ?}
  || sstrma+=POZ.SUM;  sumama+=POZ.SUM; sokroma+=POZ.SUM;
     {? wal || sstrma1+=POZ.SUMW; sumama1+=POZ.SUMW; sokroma1+=POZ.SUMW ?}
  ?};
~~}
{petla:=POZ.next(); ~~}
{OD}
{IF: pierwszy>0}
{ OKRO_F.cntx_psh;OKRO_F.prefix; OKRO_F.index('ROK');
  {? OKRO_F.find_key(SSTALE.AR,WYDRUKI.OKRESOD) || okres:=OKRO_F.NAZ ?};
  OKRO_F.cntx_pop; w[1]:=okres; w[5]:=form(sokrown,,2,' ,');  w[6]:=form(sokroma,,2,' ,');
  w[2]:=w[3]:=w[4]:=w[7]:=w[8]:=w[9]:=w[10]:=w[11]:=w[12]:=w[13]:='';
  {? wal || w[9]:=form(sokrown1,,2,' ,'); w[10]:=form(sokroma1,,2,' ,') ?};~~}
{SUBSTITUTE: 'LINIA0'}{ vp:=0; {? lineleft()=0 || vp:=1 ?};~~}
{ sokrown:=sokroma:=sokrown1:=sokroma1:=pierwszy:=0;~~}
{FI}
{FI}
{ WYDRUKI.OKRESOD+=1; ~~ }
{OD}
{IF: ~rep_export()}
{IF: lineleft()<>0 & page>1 & lineleft()<5}{PAGE}{FI}
{FOOTER}{FOOTER-}
{ENTIRE}
{FONT: 'T8GB'}{SPACE: 'C'}
{ ww[1]:='   SUMA STRONY'@;ww[2]:=form(sstrwn,,2,' ,'); ww[3]:=form(sstrma,,2,' ,');
  {? wal || ww[5]:=form(sstrwn1,,2,' ,'); ww[6]:=form(sstrma1,,2,' ,') ?}; jbar:=1;~~}
{SUBSTITUTE: 'LINIA1'}
{IF: page>1}
{ ww[1]:='   Z PRZENIESIENIA'@; ww[2]:=form((sumawn-sstrwn),,2,' ,'); ww[3]:=form((sumama-sstrma),,2,' ,');
  {? wal || ww[5]:=form((sumawn1-sstrwn1),,2,' ,'); ww[6]:=form((sumama1-sstrma1),,2,' ,') ?}; jbar:=0;~~}
{SUBSTITUTE: 'LINIA1'}
{FI}
{ ww[1]:='   RAZEM'@; ww[2]:=form(sumawn,,2,' ,'); ww[3]:=form(sumama,,2,' ,');
  {? wal || ww[5]:=form(sumawn1,,2,' ,'); ww[6]:=form(sumama1,,2,' ,') ?}; jbar:=0;~~}
{SUBSTITUTE: 'LINIA1'}
{ ww[1]:='   SALDO'@; ww[2]:=form((F.SWn(sumawn,sumama)),,2,' ,'); ww[3]:=form((F.SMa(sumawn,sumama)),,2,' ,');
  {? wal || ww[5]:=form((F.SWn(sumawn1,sumama1)),,2,' ,'); ww[6]:=form((F.SMa(sumawn1,sumama1)),,2,' ,') ?}; jbar:=0;~~}
{SUBSTITUTE: 'LINIA1'}
{PRN1.lbar()}
{<1>{PRN.width()}'KONIEC WYDRUKU'@}
{ENTIRE-}
{FI}