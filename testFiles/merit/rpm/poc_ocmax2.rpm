:!UTF-8
{TITLE:Raport}
{PRINTER: exec('prt','param_wydr','v',KST),,,,,'Q','C',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   PAR_WYDR.TITLE:='Zestawienie ocen kompetencji'@;
   __RES:=cur_tab(1,1);
   count:=0;
   field:=0;
   szef:=0;
   lmt:=0;
   max:=0;
   ~~
}
{END:
   &__RES;
   &count;
   &field;
   &szef;
   &max;
   &lmt
}
{COMMENT}OLD: ocmax2.rpm{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{COMMENT}
==================================================================

   K O N F I G U R A C J A   -   N A G L O W E K,   S T O P K A

==================================================================
{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{SPACE: 'C'}
{FONT: 'W8'}
{LINE}
{<{lmt+1}'Parametry raportu'@}
{<{lmt+1}'Ocena:'@} {ZO_PROG.NAZWA}
{<{lmt+1}'Za okres:'@} {ZO_PROC.OKRES_OD} - {ZO_PROC.OKRES_DO}
{'Ä'*charleft()}
{HEADER-}
{FOOTER: 0}
{SPACE: 'C'}
{FONT: 'W8'}
{FOOTER-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}
=======================================

   Z A W A R T O S C   W Y D R U K U

=======================================
{COMMENT-}
{FOR: __RES}{DO}
   {IF: {? __RES.f_active() || __RES.f_test() || 1 ?}}
      {ENTIRE}
      {SPACE: 'C'}
      {FONT: 'W8B'}
      { max:=charleft(); ~~ }
      {>5 count+=1} {<7 __RES.NAZWISKO} {__RES.PIERWSZE} - {__RES.STN} w {__RES.UD_SKL}
      {FONT: 'W8'}
      { max:=charleft(); field:=7; ~~ }
      {WHILE: (field+=1)<=__RES.fld_num()}{DO}
         {<7 __RES.fld_name(field)} {>{max},2 __RES[field]}
      {OD}
      {  szef:=0;
         ZO_OSOBA.prefix();
         {? ZO_OSOBA.seek(__RES.TMP,)
         || P.index('ZZ_DOK');
            P.prefix();
            _ref:=ZO_OSOBA.ZZ_OSOBA().ZZ_LINK;
            {? P.find_key(ref_name(_ref),_ref)
            || _szef:=exec('prac_nad','stanprac',P.ref,0);
               {? _szef.first() & P.seek(_szef.P,)
               || szef:=1
               ?}
            ?}
         ?};
         ~~
      }
      {IF: szef}
         {<7 'Prze’o§ony: '} {P.OSOBA().NAZWISKO} {OSOBA.PIERWSZE} - {P.ST().ST} w {P.WYDZIAL().SYMBOL}
      {FI}
      {<7 'Ä'*(max-5)}
      {ENTIRE-}
   {FI}
{OD}