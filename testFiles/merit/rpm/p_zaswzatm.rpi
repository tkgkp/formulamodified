:!UTF-8
{INCLUDE: wsp_pw.rpi}
{HEADER}
{FONT: 'HEAD'}
{SPACE: 'B'}
{IF: PAR_WYDR.HEAD}
{ lmt:=charleft; ~~ }
{>{lmt}__CALL.MIEJSCE+', dn. '+__CALL.DATA}
{<1 HSTR.split(__CALL.F_NAZWA); HSTR.line(lmt)}
{WHILE: HSTR.next()}{DO}{<1 HSTR.line(lmt)}{OD}
{ PAR_WYDR.HEAD:=0; ~~ }
{SUBSTITUTE: 'HEAD'}
{ PAR_WYDR.HEAD:=1; ~~ }
{FONT: 'HEAD'}
{SPACE: 'B'}
{__CALL.F_ULICA}
{__CALL.F_POCZTA}
REGON {__CALL.F_REGON}
NIP {__CALL.F_NIP}
{ELSE}
{LINE: 6}
{FI}
{FONT: 'TITLE'}
{SPACE: 'A'}
{LINE: 3}
{<1>{charleft} 'ZAŚWIADCZENIE'}
{LINE: 5}
{HEADER-}
{FOR: __CALL}{DO}
{SPACE: 'A'}
{FONT: 'W12'}
{  {? __CALL.PLEC='K'
      || _a:='i'; _b:='a'; _d:='a'
      || _a:=''; _b:='y'; _d:=''
   ?};
   Text:=
      'Zaświadcza się, że Pan'+_a+' '+
      __CALL.NAZWISKO+' '+__CALL.IMIE+
      {? +__CALL.DRUGIEIM || ' '+__CALL.DRUGIEIM || '' ?}+
      ' zamieszkał'+_b+' '+__CALL.ADRES+
      {? +__CALL.IDENT || ', '+__CALL.IDENT+' ' || ' ' ?}+
      {? __CALL.ZATRUDN='T' || 'jest' || 'był'+_d ?}+
      ' zatrudnion'+_b+' w '+__CALL.F_NAZWA+
      ' od dnia '+__CALL.D_ZATR+' '+__CALL.UMOWA+
      {? __CALL.ZATRUDN='N'
      || ' i został'+_d+' zwolnion'+_b+' dnia '+__CALL.D_ZWOL+
         {? +__CALL.ZWOL || ' (przyczyna: '+__CALL.ZWOL+')' || '' ?}
      |? +__CALL.ZWOL & __CALL.RODZ_UM='C'
      || '. Umowa zostanie rozwiązana z dniem '+__CALL.D_ZWOL+' (przyczyna: '+__CALL.ZWOL+')'
      || ''
      ?}+'.';
   STR.split(gsub(Text,'..','.'));
   ~~
}
{JUSTIFY}
{WHILE: +(Text:=STR.line(charleft))}{DO}
{REP: {? +STR.spl_str
         || '{<1>{charleft}'
         || '{CENTER}{'
      ?}+'Text}'
}{OD}

{
   Textbr:='';
   {? __CALL.RODZAJ=''
   ||  ~~
   |? __CALL.SREDNIA='0,00'
   || STR.split('Brak danych o wynagrodzeniu '+__CALL.RODZAJ+
         ' za okres od dnia '+__CALL.MSC_DO+' do dnia '+__CALL.MSC_OD)
   |? __CALL.RODZAJ='netto i brutto'
   || STR.split('Średnie miesięczne wynagrodzenie netto wynosi '+__CALL.SREDNIA+' zł. '+
         '(słownie: '+__CALL.SLOW_SR+').');
      Textbr:='Średnie miesięczne wynagrodzenie brutto wynosi '+__CALL.SRED_BR+' zł. '+
         '(słownie: '+__CALL.SLOW_SRB+').'
   || STR.split('Średnie miesięczne wynagrodzenie '+__CALL.RODZAJ+' wynosi '+__CALL.SREDNIA+' zł. '+
         '(słownie: '+__CALL.SLOW_SR+').');~~
   ?};
   ~~
}
{WHILE: +(Text:=STR.line(charleft))}{DO}{REP: Text}{OD}
{IF: Textbr<>''}
{STR.split(Textbr);~~}
{WHILE: +(Text:=STR.line(charleft))}{DO}{REP: Text}{OD}
{FI}
{IF: __CALL.OBC_TYP<>'N'}
   {
      {? __CALL.OBC_KW='0,00'
      || STR.split('Wynagrodzenie powyższe nie jest obciążone z tytułu wyroków sądowych lub innych tytułów.')
      |? __CALL.OBC_TYP='I'
      || STR.split('Wynagrodzenie powyższe jest obciążone z tytułu wyroków sądowych i/lub innych tytułów.')
      || STR.split('Wynagrodzenie powyższe jest obciążone kwotą '+__CALL.OBC_KW+' zł. (słownie:'+__CALL.OBC_SL+').')
      ?};
      ~~
   }

{WHILE: +(Text:=STR.line(charleft))}{DO}{REP: Text}{OD}
{FI}
{IF:
   {? __CALL.RODZAJ='' | __CALL.SREDNIA='0,00'
   || 0
   || STR.split('Wynagrodzenie zostało wyliczone na podstawie zarobków '+__CALL.SLOW_UZ+
                'za okres od dnia '+__CALL.MSC_DO+' do dnia '+__CALL.MSC_OD);
      1
   ?}
}

{WHILE: +(Text:=STR.line(charleft))}{DO}{REP: Text}{OD}
{FI}

{IF:__CALL.STATUS<>''}
{ STR.split(__CALL.STATUS); ~~ }
{WHILE: +(Text:=STR.line(charleft))}{DO}{REP: Text}{OD}

{FI}
{ STR.split(__CALL.CEL); ~~ }
{WHILE: +(Text:=STR.line(charleft))}{DO}{REP: Text}{OD}
{SPACE: 'A'}
{LINE: 5}
{FONT: 'W8'}
{SPACE: 'C'}
{ lm:=charleft; ~~ }
{<1>{lm/2}(30*'─')}{<{lm/2}>{lm}(30*'─')}
{<1>{lm/2-18}}{'(pieczęć i podpis)'}{<{lm/2}>{lm-17}}{'(podpis odbiorcy)'}
{ &lm; ~~ }
{PAGE}
{OD}