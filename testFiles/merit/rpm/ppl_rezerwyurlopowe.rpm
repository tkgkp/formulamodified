:!UTF-8
{TITLE:Rezerwy urlopowe}
{PRINTER: exec('prt','param_wydr','h',KST),,,,,'Q','C',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
   PAR_WYDR.TITLE:='Rezerwy urlopowe'@;

   VAR_DEL.delete('PRN','prn1','vp','lmt','rsep','h_rat','tresc','PRT','prn2');
   VAR_DEL.delete('Lp');

   tresc:='rez_url';
   Lp:=0;

   PRN:=obj_new(@.CLASS.PRINT,11);
   {? ~rep_export()
   || PRN.add("Lp+=1",5,'Lp.'@,1,,,,,',,\'99\'')
   ?};
   PRN.add("RURL_P.OSOBA().NAZWISKO+' '+OSOBA.PIERWSZE",48,'Nazwisko i imię'@);
   PRN.add("RURL_P.LIM_ZAL",7,'Urlop zaległy'@,1,,,,,',2,\'9,\'');
   PRN.add("RURL_P.LIM_AKT",7,'Urlop bieżący'@,1,,,,,',2,\'9,\'');
   PRN.add("{? RURL_P.URL_DOD>0 || RURL_P.URL_DOD || '' ?}",13,'Urlop uzupełniający'@,1,,,,,',2,\'9,\'');
   PRN.add("RURL_P.URL_SUM",9,'Całkowity urlop'@,1,,,,,',2,\'9,\'');
   PRN.add("RURL_P.URL_WYK",12,'Wykorzystano'@,1,,,,,',2,\'9,\'');
   PRN.add("RURL_P.URL_POZ",15,'Urlop niewykorzystany'@,1,,,,,',2,\'9,\'');
   PRN.add("RURL_P.KWOTA",15,'Rezerwa urlopowa'@,1,,,,,',2,\'9,\'');
   {? RURL_N.CZY_LICZ='T'
   || PRN.add("RURL_P.NARZUTY",15,'Narzuty'@,1,,,,,',2,\'9,\'');
      PRN.add("RURL_P.KW_PRAC",15,'Koszt pracodawcy'@,1,,,,,',2,\'9,\'')
   ?};
   PRN.s_frame();

   prn1:='PRN';
   PRT:=obj_new(@.CLASS.PRINT,4);
   PRT.add("'             R A Z E M '@",137);
   PRT.add("form(RURL_N.KWOTA,,2,'9,')",15,'',1);
   {? RURL_N.CZY_LICZ='T'
   || PRT.add("form(RURL_N.NARZUTY,,2,'9,')",15,'',1);
      PRT.add("form(RURL_N.KW_PRAC,,2,'9,')",15,'',1)
   ?};
   PRT.s_frame();
   prn2:='PRT';

   lmt:=rsep:=0;
   vp:=h_rat:=1;
   ~~
}
{END:
   VAR_DEL.delete('PRN','prn1','vp','lmt','rsep','h_rat','tresc','PRT','prn2');
   VAR_DEL.delete('Lp');
   ~~
}
{COMMENT}OLD: wnieoroz.rpm{COMMENT-}
{COMMENT}OLD: skid_pw.rpi{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{COMMENT}
══════════════════════════════════════════════════════════════════════════════

   K O N F I G U R A C J A   -   N A G Ł Ó W E K,   S T O P K A

{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{IF: vp}
{FONT: 'T8'}{ h_rat:=charleft(); ~~ }
{FONT: 'T8G'}{ h_rat:={? rep_export() || charleft() || charleft()/h_rat ?}; ~~ }
   {SPACE: 'C'}
   {LINE}
   {<{ceil(lmt*h_rat)+1}'Parametry sprawozdania'@}
   {<{ceil(lmt*h_rat)+1}'Data kontroli:'@} {RURL_N.DATA$1}
   {<{ceil(lmt*h_rat)+1}'Metoda obliczania podstawy rezerwy:'@} {RURL_N.METODA().NAZWA}
{FI}
{FONT: 'T8B'}
{SPACE: 'B'}
{LINE}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{FOOTER: 0}
{FONT: 'T8'}
{SPACE: 'B'}
{SUBSTITUTE: 'LINIAF'}
{FOOTER-}
{IF: ~rep_export()}
   {SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}
══════════════════════════════════════════════════════════════════════════════

   M A K R O D E F I N I C J E

{COMMENT-}
{MACRO: tresc}
   {SUBSTITUTE: 'LINIA0'}
{MACRO-}
{MACRO: 'podsum'}
{ rsep:=1;~~ }
{SUBSTITUTE: 'LINIA02'}
{ prn1:=prn2;~~ }
{MACRO-}
{COMMENT}
══════════════════════════════════════════════════════════════════════════════

   Z A W A R T O Ś Ć   W Y D R U K U

{COMMENT-}
{FONT: 'T8'}
{SPACE: 'B'}
{ lmt:=int((charleft()-PRN.width())/2); ~~ }
{FOR: RURL_P}{INDEX: 'OSOBA'}{PREFIX: RURL_N.ref()}{DO}
   {SUBSTITUTE: tresc}
{OD}
{IF: ~rep_export()}
   {SUBSTITUTE: 'podsum'}
{FI}