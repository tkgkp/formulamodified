:!UTF-8
{MACRO: 'stronyf'}
{COMMENT}   ustalenie maksymalnych szerokosci strony dla fontow      {COMMENT-}
{
exec('czytaj','#stalesys',__STRDAT,XINFO,'KOD_P','KRAJ','MIA','NAZ','NIP','NR_D','NR_L','POCZ','TEL','UL');
KSTE.get;
strony:="
   VAR_DEL.delete('zero_na','szer','print5');
   VAR_DEL.delete('op_1','op_2','op_3','op_4');
   VAR_DEL.delete('oddzial');
   VAR_DEL.delete('__dane1','__dane2','__dane3','__dane4','__ul','__ur','__dl','__dr')
   ";
strony()
;~~}
{SPACE: exec('space','param_wydr')}
{FONT: exec('font','param_wydr','strony')}{max_T10B:=charleft;~~}
{
__dane1:=obj_new(20); {! _ii:=1..obj_len(__dane1)|! __dane1[_ii]:='' !};
__dane2:=obj_new(20); {! _ii:=1..obj_len(__dane2)|! __dane2[_ii]:='' !};
__dane3:=obj_new(20); {! _ii:=1..obj_len(__dane3)|! __dane3[_ii]:='' !};
__dane4:=obj_new(20); {! _ii:=1..obj_len(__dane4)|! __dane4[_ii]:='' !};

__ul:=__dane1;
__ur:=__dane3;
__dl:=__dane2;
__dr:=__dane4;

op_1:=op_2:=op_3:=op_4:='';

print5:="
   _grey:=\"
   {? var_press('blank')>0 & blank=1
   || color_bg
   |? var_press('blank')>0 & blank=2
   || color_gg
   |? var_press('blank')>0 & (blank=3 | blank=4)
   || color_ww
   || color_bw
   ?}\";
   _white:=\"
   {? var_press('blank')>0 & (blank=2 | blank=4)
   || color_gw
   || color_bw
   ?}\";
   prn1:='PRN5';
   op_1:=op_2:=op_3:=op_4:='';
   VAR_DEL.delete('PRN5');
   PRN5:=obj_new(@.CLASS.PRINT,5,'   ',' │' ,'  ', '───' ,'  ','──','─',' ');
   PRN5.add($('form('''',)'),_a,'',1,);
   PRN5.add($('form(op_1,)'),_b,'',,,_white);
   PRN5.add($('form(op_2,)'),_c,'',1,,_grey);
   PRN5.add($('form(op_3,)'),_d,'',,,_grey);
   PRN5.add($('form(op_4,)'),_e,'',1,,_grey)
";

szer:=obj_new(5);
szer[1]:=1;
szer[3]:=3;
szer[4]:=1;
szer[5]:=
   {? exec('get','#params',300250,2)<>''
      & (__STRTAB='ND' & ND.TYP().Z='T' | __STRTAB='FAKS' | __STRTAB='ZK_N' | __STRTAB='OFE')
   || 3
   || 1
   ?};
szer[2]:=(max_T10B-(szer[1]+szer[3]+szer[5]+16))/2$0;
print5(szer[1],szer[2],szer[3],szer[4],szer[5]);
szer[4]+=charleft-PRN5.width();
print5(szer[1],szer[2],szer[3],szer[4],szer[5]);
vp:=0;
lmt:=0;
date_head:='';
date_val:='';
{? var_press('zkn_date_head')=type_of('') & var_press('zkn_date_val')=type_of('')
||
   date_head+=zkn_date_head;
   date_val+=zkn_date_val
?};
{? var_press('nd_date_head')=type_of('') & var_press('nd_date_val')=type_of('')
||
   date_head+=nd_date_head;
   date_val+=nd_date_val
?};
{? var_press('ofe_date_head')=type_of('') & var_press('ofe_date_val')=type_of('')
||
   date_head+=ofe_date_head;
   date_val+=ofe_date_val
?};
~~}
{COMMENT}   DATA WYSTAIENIA, SPRZEDAZY, ZWROTU                       {COMMENT-}
{FONT: exec('font','param_wydr','daty')}
{IF: __STRTAB='FAKS' & FAKS.SZ='S'}
   {IF: FAKS.KZ=''}
      {date_head+=(exec('tr','tlumaczenia','1000110')+';');
       date_val+=(gsub(form(FAKS.DW,,3),'/','-')+';');
       ~~}
   {FI}
   {IF: FAKS.WHERE='K'}
      {LINE: 2}
   {FI}
   {IF: FAKS.WHERE<>'K'}
        {{? FAKS.T().HIS='T'
         || _date_head:=(exec('tr','tlumaczenia','1000112')+';')
         || _txt_ds:=
                     {? FAKS.WHERE='L'
                     || {? FAKS.DO_NA_DR<>date(0,0,0) || '1000111' || '' ?}
                     |? PAR_SKID.get(308)='T' & FAKS.DW>=date(2014,1,1)
                     || {? FAKS.DO_NA_DR<>date(0,0,0)
                        || exec('kod_aktualny','tlumaczenia','1000112')
                        |? FAKS.T().KOR='T' & exec('FindAndGet','#table',FAKS,FAKS.FKSQL,,"D",date(2014,1,1))<date(2014,1,1)
                        || '1000112'
                        || ''
                        ?}
                     || exec('kod_aktualny','tlumaczenia','1000112')
                     ?};
                     _date_head:=(exec('tr','tlumaczenia',_txt_ds)+';')
         ?};
         {? FAKS.WHERE<>'L'
               |
            FAKS.T().HIS<>'T' & PAR_SKID.get(308)='T' & FAKS.DW>=date(2014,1,1)
         || {? FAKS.DO_NA_DR<>date(0,0,0)
            || {? PARAM_W.MC='T'
               || {? PARAM_W.JEZYK=null || _date_val:=(form(FAKS.DO_NA_DR,,8) +';')|| _date_val:=((7+form(FAKS.DO_NA_DR,,1))+';') ?}
               || _date_val:=(gsub(form(FAKS.DO_NA_DR,,3),'/','-')+';')
               ?}
            |? FAKS.T().KOR='T' & exec('FindAndGet','#table',FAKS,FAKS.FKSQL,,"D",date(2014,1,1))<date(2014,1,1)
            || {? PARAM_W.MC='T'
               || {? PARAM_W.JEZYK=null || _date_val:=(form(FAKS.D,,8) +';') || _date_val:=((7+form(FAKS.D,,1))+';') ?}
               || _date_val:=(gsub(form(FAKS.D,,3),'/','-')+';')
               ?}
            || ''
            ?}
         || {? PARAM_W.MC='T'
            || {? PARAM_W.JEZYK=null || _date_val:=(form(FAKS.D,,8) +';') || _date_val:=((7+form(FAKS.D,,1))+';') ?}
            || _date_val:=(gsub(form(FAKS.D,,3),'/','-')+';')
            ?}
         ?};
         {? (var_press('_date_head')=type_of('')) & (var_press('_date_val')=type_of(''))
         ||
            date_head+=_date_head;
            date_val+=_date_val
         ?};~~}
   {FI}
   {IF: FAKS.WHERE<>'K' & FAKS.WHERE<>'N' & FAKS.KZ=''}
      {{? FAKS.T().KOR='N' | FAKS.T().KOR='T' & FAKS.DZ=date(0,0,0) & exec('czy_zwrot','faktury_nag',FAKS.ref())='N'
       || ''
       || date_head+=(exec('tr','tlumaczenia','1000153')+';');
          date_val+=(gsub(form(FAKS.DZ,,3),'/','-')+';')
       ?};~~
       }
   {FI}
{ELIF: __STRTAB='ZK_N' & proforma=1}
   { date_head+=(exec('tr','tlumaczenia','1000110')+';');
     date_val+=(gsub(form(ZK_N.DP,,3),'/','-')+';');
   ~~}
{ELIF: __STRTAB='FAKS' & FAKS.SZ='Z'}
   { date_head+=(exec('tr','tlumaczenia','1000110')+';');
     date_val+=(gsub(form(FAKS.DW,,3),'/','-')+';');
     _txt_ds:={? FAKS.WHERE='L' || '1000111' || exec('kod_aktualny','tlumaczenia','1000112') ?};
     date_head+=(exec('tr','tlumaczenia',_txt_ds)+';');
     {? PARAM_W.MC='T'
     || {?  PARAM_W.JEZYK=null || date_val+=(form(FAKS.D,,8) +';') || date_val+=((7+form(FAKS.D,,1))+';') ?}
     || date_val+=(gsub(form(FAKS.D,,3),'/','-')+';')
     ?};
   ~~}
{FI}
{IF: var_press('dup_head')=type_of('')&var_press('dup_val')=type_of('')&dup_head<>''&dup_val<>''}
{date_head+=(dup_head+';');
date_val+=(dup_val+';');
dup_head:='';
dup_val:='';
~~}
{FI}
{FONT: exec('font','param_wydr','fp_tr')}
{<1}{
{? var_press('date_head_arr')>100 || obj_del(date_head_arr) ?}; date_head_arr:=spli_str(date_head-1, ';');int_date_head:=1;
{? var_press('date_val_arr')>100 || obj_del(date_val_arr) ?}; date_val_arr:=spli_str(date_val-1, ';');int_date_val:=1;

_int:=1;
_first_sign:=0;
{!|?
   {? ((+date_head_arr[_int])>(+date_val_arr[_int]))
   || _first_sign+=+date_head_arr[_int]
   || _first_sign+=+date_val_arr[_int]
   ?};
   _int+=1;
   obj_len(date_head_arr)>=_int & obj_len(date_val_arr)>=_int
!};
_first_sign+=(obj_len(date_head_arr)*6);
tab_marg:=(charleft()-(szer[1]+szer[2]+szer[3]+szer[4]+szer[5]))/2;
charleft_head:=0;
charleft_blank:=charleft();
blank_space:={? (szer[4]+szer[5]+tab_marg) > _first_sign || (szer[1]+szer[2]+tab_marg) || charleft()-_first_sign-szer[3] ?};
~~}
{COMMENT}   drukowanie loga wraz z podstawowymi informacjami {COMMENT-}
{ENTIRE}
{ logo_size:=40; {!|? exec('get_logo','img_blob') & img_size(exec('get_logo','img_blob'),logo_size)>4 & logo_size>0 |! logo_size-=1 !}; ~~}
{IF: PAR_WYDR.LOGO}{IF: exec('get_logo','img_blob')}{<1}{LINE:1}{<3}{IMAGE: exec('get_logo','img_blob');logo_size}{ELSE}{<1}{LINE:1}{<3}{BITMAP:'"logo.bmp",40'}{FI}{ELSE}{<3}{FI}{COLOR: color_ww}{(blank_space-2)*' '}{COLOR: color_gg}{szer[3]*' '+'   '}{<{(charleft_blank+1)}}{COLOR: color_ww}{LINE}
{<1}{COLOR: color_ww}{blank_space*' '}{COLOR: color_gg}{szer[3]*' '+'   '}{WHILE: int_date_head<=obj_len(date_head_arr)}{DO}{<+{charleft_head} _wyn:=date_head_arr[int_date_head];charleft_head:={? ((+date_head_arr[int_date_head])>(+date_val_arr[int_date_head]))||+date_head_arr[int_date_head]||+date_val_arr[int_date_head]?}+6;int_date_head+=1;_wyn}{OD}{<{(charleft_blank+1)}}{COLOR: color_ww}
{charleft_head:=0;~~}
{<1}{COLOR: color_ww}{blank_space*' '}{COLOR: color_bg}{szer[3]*' '+'   '}{FONT: exec('font','param_wydr','fp_war')}{WHILE: int_date_val<=obj_len(date_val_arr)}{DO}{<+{charleft_head} _wyn:=date_val_arr[int_date_val];charleft_head:={? ((+date_head_arr[int_date_val])>(+date_val_arr[int_date_val]))||+date_head_arr[int_date_val]||+date_val_arr[int_date_val]?}+6;int_date_val+=1;_wyn}{OD}{<{(charleft_blank+1)}}{COLOR: color_ww}
{<1}{COLOR: color_ww}{blank_space*' '}{COLOR: color_gg}{szer[3]*' '+'   '}{<{(charleft_blank+1)}}{COLOR: color_bw}{LINE}{LINE}
{ENTIRE-}
{VAR_DEL.delete('dup_head','dup_val','date_head','date_val','date_head_arr','date_val_arr','int_date_val','int_date_head','logo_size');~~}
{COMMENT}   koniec loga wraz z podstawowymi informacjami {COMMENT-}
{COMMENT}   LICENCJOBIORCA                                           {COMMENT-}
{
{? exec('get','#params',100227,2)='T' || _kpocz:=3; _ul:=4 || _kpocz:=4; _ul:=3 ?};
{? __STRTAB='ND'
|| {? ND.TYP().P='N' | ND.TYP().DN='K'
   || __dane3[1]:=exec('tr','tlumaczenia','1000107'); "--Sprzedawca--"
   || __dane3[1]:=exec('tr','tlumaczenia','1000118'); "--Nabywca--"
   ?}
||
   {? __STRTAB='ZD_NAG'
   || __dane3[1]:=exec('tr','tlumaczenia','6000107'); "--Zamawiający--"
   |? __STRTAB='OPAK_N'
   || {? OPAK_N.PLUS='T'
      || __dane3[1]:='Przyjmujący:'
      || __dane3[1]:='Wydający:'
      ?}
   || {? __STRTAB='FAKS' & FAKS.SZ='S' | __STRTAB='ZK_N'  | __STRTAB='OFE'
      || __dane3[1]:=exec('tr','tlumaczenia','1000107'); "--Sprzedawca--"
      || __dane3[1]:=exec('tr','tlumaczenia','1000118'); "--Nabywca--"
      ?}
   ?}
?};
_kh_grvat:=0;
_fkh_grvat:=0;
{? __STRTAB='FAKS'
|| KH.cntx_psh();
   KH.prefix();
   FAKSKH.cntx_psh();
   FAKSKH.index('UNIK');
   FAKSKH.prefix(FAKS.ref(),exec('rola_grupa_vat','edi_fo_ksef'));
   _fkh_grvat:=FAKSKH.first();
   {? ~_fkh_grvat
   || _kgv:=exec('kh_grvat_lic','kontrahent',FAKS.DW);
      {? _kgv<>null() & KH.seek(_kgv)
      || _kh_grvat:=1
      ?}
   ?}
?};
KSTE.index('KST'); KSTE.prefix();
{? ~_fkh_grvat & ~_kh_grvat & KSTE.first() & +KSTE.NAZ || oddzial:=1 || oddzial:=0 ?};
{? oddzial
|| __dane3[2]:=KSTE.NAZ;
   __dane3[_kpocz]:=exec('kpocz','faktury_wydruk',KSTE.KOD_P,KSTE.POCZ,KSTE.MIA,KSTE.UL);
   __dane3[_ul]:=exec('adr','faktury_wydruk',KSTE.UL,KSTE.NR_D,KSTE.NR_L,KSTE.MIA,KSTE.POCZ);
   __dane3[6]:={? +KSTE.TEL || exec('tr','tlumaczenia','1000106')+' '+KSTE.TEL || '' ?}; "--tel:--";
   __dane3[12]:=KSTE.KRAJ().TR
|? _fkh_grvat
|| __dane3[2]:=FAKSKH.NAZ;
   __dane3[_kpocz]:=exec('kpocz','faktury_wydruk',FAKSKH.KPOCZ,FAKSKH.POCZ,FAKSKH.MIASTO,FAKSKH.UL);
   __dane3[_ul]:=exec('adr','faktury_wydruk',FAKSKH.UL,FAKSKH.DOM,FAKSKH.LOKAL,FAKSKH.MIASTO,FAKSKH.POCZ);
   __dane3[6]:={? +FAKSKH.KH().TEL || exec('tr','tlumaczenia','1000106')+' '+FAKSKH.KH().TEL || '' ?}; "--tel:--";
   __dane3[12]:=FAKSKH.KRAJ
|? _kh_grvat
|| __dane3[2]:=KH.NAZ;
   __dane3[_kpocz]:=exec('kpocz','faktury_wydruk',KH.KPOCZ,KH.POCZ,KH.MIASTO,KH.UL);
   __dane3[_ul]:=exec('adr','faktury_wydruk',KH.UL,KH.DOM,KH.LOKAL,KH.MIASTO,KH.POCZ);
   __dane3[6]:={? +KH.TEL || exec('tr','tlumaczenia','1000106')+' '+KH.TEL || '' ?}; "--tel:--";
   __dane3[12]:=KH.KRAJ
|| __dane3[2]:=XINFO.NAZ;
   __dane3[_kpocz]:=exec('kpocz','faktury_wydruk',XINFO.KOD_P,XINFO.POCZ,XINFO.MIA,XINFO.UL);
   __dane3[_ul]:=exec('adr','faktury_wydruk',XINFO.UL,XINFO.NR_D,XINFO.NR_L,XINFO.MIA,XINFO.POCZ);
   __dane3[6]:={? +XINFO.TEL || exec('tr','tlumaczenia','1000106')+' '+XINFO.TEL || '' ?}; "--tel:--";
   __dane3[12]:=XINFO.KRAJ().NAZ
?};
_nip_ue:='';
{? exec('get','#params',100231)='T'
   | __STRTAB='FAKS' & {? exec('get','#params',100221,2)='T' || FAKS.T().UE='T' & FAKS.NIP_UE<>'' || FAKS.NIP_UE<>'' ?}
   | __STRTAB='ND' & {? exec('get','#params',100221,2)='T' || ND.TYP().UE='T' || ND.NIP_UE<>'' ?}
   | __STRTAB='ZK_N' & {? exec('get','#params',100221,2)='T' || 0 || ZK_N.NIP_UE<>'' ?}
|| {? _fkh_grvat
   || NIPY.index('SNIP');NIPY.prefix(FAKSKH.KH)
   |? _kh_grvat
   || NIPY.index('SNIP');NIPY.prefix(KH.ref())
   || NIPY.index('SNIP_F');NIPY.prefix(REF.S_FIRMA)
   ?};
   {? NIPY.find_key('PL') || _nip_ue:=form(NIPY.KRAJ().KOD+' '+NIPY.NIP) ?}
?};
__dane3[5]:=
   {? _nip_ue<>''
   || exec('tr','tlumaczenia','1000113')+' '+_nip_ue
   |? _fkh_grvat
   || exec('tr','tlumaczenia','1000108')+' '+form(FAKSKH.NIP)
   |? _kh_grvat
   || exec('tr','tlumaczenia','1000108')+' '+form(KH.NIP)
   || exec('tr','tlumaczenia','1000108')+' '+form(XINFO.NIP)
   ?}; "--NIP--";
{? __STRTAB='FAKS'
|| KH.cntx_pop();
   FAKSKH.cntx_pop()
?};
{? __STRTAB='FAKS' & FAKS.SZ='S'
||
   {? exec('rbkvat_drukuj','faktury_wydruk')
   ||
      __dane3[7]:='';
      __dane3[8]:='';
      __dane3[9]:='';
      __dane3[10]:='';
      __dane3[11]:='';
      __dane3[14]:='';
      __dane3[15]:=''
   ||
      __dane3[7]:={?  +FAKS.NB || exec('tr','tlumaczenia','1000109') ?};
      __dane3[8]:=FAKS.NB; "--Numer rachunku--";
      __dane3[9]:=exec('rb_prefix','faktury_wydruk')+RB.get_rbtx(3,FAKS.RBK,FAKS.SKID_RBK().KRAJ().KODISO);
      __dane3[10]:='';
      __dane3[11]:='';
      {? (FAKS.T().EXPORT='T' | FAKS.T().UE='T' )
      || __dane3[11]:=exec('tr','tlumaczenia','1000114')+' '+FAKS.SKID_RBK().BANK().SWIFT
      || __dane3[10]:=FAKS.SKID_RBK().BANK().SWIFT
      ?};
      {? exec('get','#params',100228,2)='T'
      ||
         __dane3[14]:=FAKS.SKID_RBK().BANK().UL;
         _kod:=FAKS.SKID_RBK().BANK().K;
         __dane3[15]:={? _kod='' || '' || _kod+' '?}+FAKS.SKID_RBK().BANK().M
      ?}
   ?}
?};
{? __STRTAB='ZK_N' & proforma=1
||
   __dane3[7]:={? +bank1 || exec('tr','tlumaczenia','1000109') || '' ?}; "--Numer rachunku--";
   __dane3[8]:=bank1;
   __dane3[9]:=bank2;
   __dane3[10]:=bank3;
   __dane3[14]:=bank4;
   __dane3[15]:=bank5
?};
__dane3[13]:=
   {? KST.BDO=''
   || ''
   || _tr:=exec('tr','tlumaczenia','1000216');
      {? _tr='' || '' || _tr+' '?}+KST.BDO
   ?};
~~}
{COMMENT}   KONTRAHENT, ODBIORCA                                     {COMMENT-}
{
{? exec('get','#params',100227,2)='T' || _kpocz:=3; _ul:=4 || _kpocz:=4; _ul:=3 ?};
{? exec('get','#params',100222,2)='T'
||
   {? __STRTAB='FAKS' & FAKS.KH_ODB().ROZ_NAL='T'
   || FAKS.KH_ODB().KH_LNK()
   || ($(__STRTAB+'.KH()'))()
   ?};

   _ak:=exec('tr','tlumaczenia','1000159');  "--Adres korespondencyjny--";
   _id:=KH.LOTUSUID;
   _adr:=exec('adrK','wzorce'); _plug:=0; _nf:=''; _fn:=''; _dom:=''; _lokal:='';
   {? __STRTAB='FAKS' & Plugin.run('ADRES_KORESP_001',FAKS.KH,FAKS.KH_ODB,_adr)
   || _nf:=_adr.NAZ_P; _kp:=_adr.KPOCZ; _po:=_adr.POCZ; _mi:=_adr.MIASTO; _um:=_adr.UL; _kr:=_adr.KRAJ; _plug:=1
   |? __STRTAB='FAKS' & +FAKS.NAZ  & FAKS.KH_ODB().ROZ_NAL='N'
   || _nf:=FAKS.NAZ; _kr:=FAKS.KH_KRAJ; _fn:=KH.NAZ
   || _fn:=KH.NAZ; _kr:=KH.KRAJ
   ?};
   {? ~_plug
   || OS_ADRES.cntx_psh();
      OS_ADRES.index('RODZAJ1'); OS_ADRES.prefix(KH.ref(),'H');
      SKID.AD_KOR:={? OS_ADRES.find_le(date()) & (OS_ADRES.DO=date(0,0,0) | OS_ADRES.DO>=date()) || OS_ADRES.ref() || null() ?};
      OS_ADRES.cntx_pop();
      {? SKID.AD_KOR().KOD<>'' & SKID.AD_KOR().MIASTO<>'' & SKID.AD_KOR().ULICA<>''
      || _kp:=SKID.AD_KOR().KOD; _po:=SKID.AD_KOR().POCZTA; _mi:=SKID.AD_KOR().MIASTO;
         _um:=SKID.AD_KOR().ULICA+' '+SKID.AD_KOR().DOM+{? SKID.AD_KOR().LOKAL='' || '' || '/'+SKID.AD_KOR().LOKAL ?};
         {? SKID.AD_KOR().NAZ_P<>'' || _nf:=SKID.AD_KOR().NAZ_P ?}; _kr:=SKID.AD_KOR().KRAJ().NAZ
      |? _nf<>''
      || _kp:=FAKS.KPOCZ; _po:=FAKS.POCZ; _mi:=FAKS.MIASTO; _um:=FAKS.UL; _dom:=FAKS.DOM; _lokal:=FAKS.LOKAL
      || _kp:=KH.KPOCZ; _po:=KH.POCZ; _mi:=KH.MIASTO; _um:=KH.UL; _dom:=KH.DOM; _lokal:=KH.LOKAL
      ?}
   ?};
   obj_del(_adr);
   __dane1[1]:=_ak;
   __dane1[2]:={? _nf<>'' || _nf || exec('kontrahent_naz_lotusuid','abstore_fun',_fn,_id) ?};
   __dane1[_kpocz]:=exec('kpocz','faktury_wydruk',_kp,_po,_mi,_um);
   __dane1[_ul]:=exec('adr','faktury_wydruk',_um,_dom,_lokal,_mi,_po);
   __dane1[12]:=_kr;

   {? __STRTAB='ND'
   || {? ND.TYP().P='N' | ND.TYP().DN='K'
      || __dane2[1]:=exec('tr','tlumaczenia','1000118'); "--Nabywca--"
      || __dane2[1]:=exec('tr','tlumaczenia','1000107'); "--Sprzedawca--"
      ?}
   || {? __STRTAB='ZD_NAG'
      || __dane2[1]:=exec('tr','tlumaczenia','6000106'); "--Dostawca--"
      |? __STRTAB='OPAK_N'
      || __dane2[1]:='Kontrahent:'
      || {? __STRTAB='FAKS' & FAKS.SZ='S' | __STRTAB='ZK_N'  | __STRTAB='OFE'
         || __dane2[1]:=exec('tr','tlumaczenia','1000118'); "--Nabywca--"
         || __dane2[1]:=exec('tr','tlumaczenia','1000107'); "--Sprzedawca--"
         ?}
      ?}
   ?};
   {? __STRTAB='FAKS' & +FAKS.NAZ
   ||
      __dane2[2]:=exec('kontrahent_naz_lotusuid','abstore_fun',FAKS.NAZ,KH.LOTUSUID);
      __dane2[_kpocz]:=exec('kpocz','faktury_wydruk',FAKS.KPOCZ,FAKS.POCZ,FAKS.MIASTO,FAKS.UL);
      __dane2[_ul]:=exec('adr','faktury_wydruk',FAKS.UL,FAKS.DOM,FAKS.LOKAL,FAKS.MIASTO,FAKS.POCZ);
      __dane2[12]:=FAKS.KH_KRAJ
   ||
      ($(__STRTAB+'.KH()'))();
      __dane2[2]:=exec('kontrahent_naz_lotusuid','abstore_fun',KH.NAZ_P,KH.LOTUSUID);
      __dane2[_kpocz]:=exec('kpocz','faktury_wydruk',KH.KPOCZ,KH.POCZ,KH.MIASTO,KH.UL);
      __dane2[_ul]:=exec('adr','faktury_wydruk',KH.UL,KH.DOM,KH.LOKAL,KH.MIASTO,KH.POCZ);
      __dane2[12]:=KH.KRAJ
   ?};
   FAKS.cntx_psh;
   {? __STRTAB='ND' & ND.FAKS || FAKS.use(ref_name(ND.FAKS)) ?};
   {? (KH.TYP='I' | KH.TYP='R') & KH.PESEL<>'' & WYDRUKIL.WYDRUK<>'zak_rr' & WYDRUKIL.WYDRUK<>'kor_rr'
   || __dane1[5]:=''
   |? __STRTAB='FAKS'
    & {? exec('get','#params',100221,2)='T'
      || (FAKS.T().UE='T' | FAKS.NDVAT='O') & FAKS.NIP_UE<>''
      || FAKS.NIP_UE<>''
      ?}
   || __dane2[5]:=exec('tr','tlumaczenia','1000113')+' '+FAKS.NIP_UE; "--NIP UE--"
   |? __STRTAB='ND'
    & {? exec('get','#params',100221,2)='T'
      || ND.TYP().UE='T'  | ND.FAKS_REF<>'' & ND.FAKS().NDVAT='O' & ND.NIP_UE<>''
      || ND.NIP_UE<>''
      ?}
   || __dane2[5]:=exec('tr','tlumaczenia','1000113')+' '+ND.NIP_UE; "--NIP UE--"
   |? __STRTAB='ZK_N' & ZK_N.NIP_UE<>''
   || __dane2[5]:=exec('tr','tlumaczenia','1000113')+' '+ZK_N.NIP_UE; "--NIP UE--"
   || _nipfld:={? __STRTAB='FAKS' || '.NIP' || '.KH().NIP' ?};
      {? +($(__STRTAB+_nipfld))()
      || __dane2[5]:=exec('tr','tlumaczenia','1000108')+' '+($(__STRTAB+_nipfld))(); "--NIP--"
      || ''
      ?}
   ?};
   FAKS.cntx_pop;
   {? __STRTAB='FAKS' & FAKS.SZ='Z'
   ||
      __dane2[7]:={? +FAKS.NB || exec('tr','tlumaczenia','1000109') || '' ?}; "--Numer rachunku--";
      __dane2[8]:=FAKS.NB;
      __dane2[9]:=exec('rb_prefix','faktury_wydruk')+RB.get_rbtx(3,FAKS.RBK,FAKS.SKID_RBK().KRAJ().KODISO)
   ?};
   {? __STRODB<>'' & ($__STRODB)()<>null
   ||
      ($(__STRODB+'()'))();
      __dane4[1]:=exec('tr','tlumaczenia','1000119'); "--Odbiorca--";
      {? __STRTAB='FAKS'
      ||
         __dane4[2]:=FAKS.O_NAZ;
         __dane4[_kpocz]:=exec('kpocz','faktury_wydruk',FAKS.O_KPOCZ,FAKS.O_POCZ,FAKS.O_MIASTO,FAKS.O_UL);
         __dane4[_ul]:=exec('adr','faktury_wydruk',FAKS.O_UL,FAKS.O_DOM,FAKS.O_LOKAL,FAKS.O_MIASTO,FAKS.O_POCZ);
         __dane4[5]:={? +FAKS.O_NIP || exec('tr','tlumaczenia','1000108')+' '+FAKS.O_NIP || '' ?}; "--NIP--";
         __dane4[12]:=FAKS.O_KRAJ
      ||
         __dane4[2]:=KH_ODB.NAZ;
         __dane4[_kpocz]:=exec('kpocz','faktury_wydruk',KH_ODB.KPOCZ,KH_ODB.POCZ,KH_ODB.MIASTO,KH_ODB.UL);
         __dane4[_ul]:=exec('adr','faktury_wydruk',KH_ODB.UL,KH_ODB.DOM,KH_ODB.LOKAL,KH_ODB.MIASTO,KH_ODB.POCZ);
         __dane4[5]:={? +KH_ODB.NIP || exec('tr','tlumaczenia','1000108')+' '+KH_ODB.NIP || '' ?}; "--NIP--";
         __dane4[12]:=KH_ODB.KRAJ
      ?}
   |? __STRTAB='FAKS' & (WYDRUKIL.WYDRUK='zak_rr' | WYDRUKIL.WYDRUK='kor_rr')
   ||
      __dane4[1]:=exec('tr','tlumaczenia','1000107')+' '+FAKS.KH().KOD; "--Sprzedawca--";
      __dane4[3]:='PESEL: '+KH.PESEL;
      __dane4[4]:='';
      __dane4[5]:='';
      __dane4[6]:='';
      __dane4[7]:=''
   ?}
?}
;~~
}
{
{? exec('get','#params',100227,2)='T' || _kpocz:=3; _ul:=4 || _kpocz:=4; _ul:=3 ?};
{? exec('get','#params',100222,2)='N'
||
   {? __STRTAB='ND'
   || {? ND.TYP().P='N' | ND.TYP().DN='K'
      || __dane1[1]:=exec('tr','tlumaczenia','1000118'); "--Nabywca--"
      || __dane1[1]:=exec('tr','tlumaczenia','1000107'); "--Sprzedawca--"
      ?}
   || {? __STRTAB='ZD_NAG'
      || __dane1[1]:=exec('tr','tlumaczenia','6000106'); "--Dostawca--"
      |? __STRTAB='OPAK_N'
      || __dane1[1]:='Kontrahent:'
      || {? __STRTAB='FAKS' & FAKS.SZ='S' | __STRTAB='ZK_N'  | __STRTAB='OFE'
         || __dane1[1]:=exec('tr','tlumaczenia','1000118'); "--Nabywca--"
         || __dane1[1]:=exec('tr','tlumaczenia','1000107'); "--Sprzedawca--"
         ?}
      ?}
   ?};
   {? __STRTAB='FAKS' & +FAKS.NAZ
   ||
      __dane1[2]:=exec('kontrahent_naz_lotusuid','abstore_fun',FAKS.NAZ,KH.LOTUSUID);
      __dane1[_kpocz]:=exec('kpocz','faktury_wydruk',FAKS.KPOCZ,FAKS.POCZ,FAKS.MIASTO,FAKS.UL);
      __dane1[_ul]:=exec('adr','faktury_wydruk',FAKS.UL,FAKS.DOM,FAKS.LOKAL,FAKS.MIASTO,FAKS.POCZ);
      __dane1[12]:=FAKS.KH_KRAJ
   ||
      ($(__STRTAB+'.KH()'))();
      __dane1[2]:=exec('kontrahent_naz_lotusuid','abstore_fun',KH.NAZ_P,KH.LOTUSUID);
      __dane1[_kpocz]:=exec('kpocz','faktury_wydruk',KH.KPOCZ,KH.POCZ,KH.MIASTO,KH.UL);
      __dane1[_ul]:=exec('adr','faktury_wydruk',KH.UL,KH.DOM,KH.LOKAL,KH.MIASTO,KH.POCZ);
      __dane1[12]:=KH.KRAJ
   ?};
   FAKS.cntx_psh;
   {? __STRTAB='ND' & ND.FAKS || FAKS.use(ref_name(ND.FAKS)) ?};
   {? __STRTAB='FAKS'
    & {? exec('get','#params',100221,2)='T'
      || (FAKS.T().UE='T' | FAKS.NDVAT='O') & FAKS.NIP_UE<>''
      || FAKS.NIP_UE<>''
      ?}
   || __dane1[5]:=exec('tr','tlumaczenia','1000113')+' '+FAKS.NIP_UE; "--NIP UE--"
   |? __STRTAB='ND'
    & {? exec('get','#params',100221,2)='T'
      || ND.TYP().UE='T'  | ND.FAKS_REF<>'' & ND.FAKS().NDVAT='O' & ND.NIP_UE<>''
      || ND.NIP_UE<>''
      ?}
   || __dane1[5]:=exec('tr','tlumaczenia','1000113')+' '+ND.NIP_UE; "--NIP UE--"
   |? __STRTAB='ZK_N' & ZK_N.NIP_UE<>''
   || __dane1[5]:=exec('tr','tlumaczenia','1000113')+' '+ZK_N.NIP_UE; "--NIP UE--"
   || _nipfld:={? __STRTAB='FAKS' || '.NIP' || '.KH().NIP' ?};
      {? +($(__STRTAB+_nipfld))()
      || __dane1[5]:=exec('tr','tlumaczenia','1000108')+' '+($(__STRTAB+_nipfld))(); "--NIP--"
      || ''
      ?}
   ?};
   FAKS.cntx_pop;
   {? __STRTAB='FAKS' & FAKS.SZ='Z'
   ||
      __dane1[7]:={? +FAKS.NB || exec('tr','tlumaczenia','1000109') || '' ?}; "--Numer rachunku--";
      __dane1[8]:=FAKS.NB;
      __dane1[9]:=
         {? {? exec('get','#params',100221,2)='T' || FAKS.T().UE='T' & FAKS.NIP_UE<>'' || FAKS.NIP_UE<>'' ?}
         || FAKS.SKID_RBK().BANK().KODISO().KODISO+' '
         || ''
         ?}+RB.get_rbtx(3,FAKS.RBK,FAKS.SKID_RBK().KRAJ().KODISO)
   ?};
   {? __STRODB<>'' & ($__STRODB)()<>null
   ||
      ($(__STRODB+'()'))();
      __dane2[1]:=exec('tr','tlumaczenia','1000119'); "--Odbiorca--";
      {? __STRTAB='FAKS'
      ||
         __dane2[2]:=FAKS.O_NAZ;
         __dane2[_kpocz]:=exec('kpocz','faktury_wydruk',FAKS.O_KPOCZ,FAKS.O_POCZ,FAKS.O_MIASTO,FAKS.O_UL);
         __dane2[_ul]:=exec('adr','faktury_wydruk',FAKS.O_UL,FAKS.O_DOM,FAKS.O_LOKAL,FAKS.O_MIASTO,FAKS.O_POCZ);
         __dane2[5]:={? +FAKS.O_NIP || exec('tr','tlumaczenia','1000108')+' '+FAKS.O_NIP || '' ?}; "--NIP--";
         __dane2[12]:=FAKS.O_KRAJ
      ||
         __dane2[2]:=KH_ODB.NAZ;
         __dane2[_kpocz]:=exec('kpocz','faktury_wydruk',KH_ODB.KPOCZ,KH_ODB.POCZ,KH_ODB.MIASTO,KH_ODB.UL);
         __dane2[_ul]:=exec('adr','faktury_wydruk',KH_ODB.UL,KH_ODB.DOM,KH_ODB.LOKAL,KH_ODB.MIASTO,KH_ODB.POCZ);
         __dane2[5]:={? +KH_ODB.NIP || exec('tr','tlumaczenia','1000108')+' '+KH_ODB.NIP || '' ?}; "--NIP--";
         __dane2[12]:=KH_ODB.KRAJ
      ?}
   |? __STRTAB='FAKS' & (WYDRUKIL.WYDRUK='zak_rr' | WYDRUKIL.WYDRUK='kor_rr')
   ||
      __dane2[5]:='PESEL: '+KH.PESEL;
      __dane2[6]:=''; "--Nazwa dowodu tożsamości:--";
      __dane2[7]:='';    "--Seria i numer DT:--";
      __dane2[8]:='';  "--Wydany przez:--";
      __dane2[9]:='';"--Data wydania:--"
   ?}
?}
;~~
}
{
op_1:=op3:='';
{? __STRTAB='FAKS' & FAKS.SZ='S' & __wydrfa.uproszcz
||
   __ul[2]:=__ul[3]:=__ul[4]:=''
?}
;~~}
{FONT: exec('font','param_wydr','strony')}
{IF: lineleft()-(62+18)>0}{LINE: lineleft()-(62+18)}{FI}
{FONT: exec('font','param_wydr','strony_s1_l01')}
{COMMENT}   LINIA 1: __ul,__ur;   100222='N'                      {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   Sprzedaż: Nabywca/Sprzedawca    {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   Zakup: Sprzedawca/Nabywca       {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   100222='T'                                  {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   Sprzedaż: Adres korespondencyjny/Sprzedawca {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   Zakup: Adres korespondencyjny/Nabywca       {COMMENT-}
{VAR_DEL.delete('seller_first');~~}
{seller_first:=
{? exec('get','#params',100229)='T'
&
((__ul[1]*exec('tr','tlumaczenia','1000118')& __ur[1]*exec('tr','tlumaczenia','1000107'))
|
(__ul[1]*exec('tr','tlumaczenia','1000159')& __ur[1]*exec('tr','tlumaczenia','1000107')))
|| 1
|| 0
?};
blank:=2;
~~}
{ _f:=prn1+'.framecol(''204:204:204'')'; ($(_f))(); ~~}
{IF: +__ul[1] | +__ur[1]}   {op_1:=''; op_3:='';~~}    {SUBSTITUTE: 'LINIA0'}{FI}
{IF: +__ul[1] | +__ur[1]}   {op_1:=' '; op_3:=' ';~~}    {SUBSTITUTE: 'LINIA0X'}{FI}
{IF: +__ul[1] | +__ur[1]} {{? seller_first || op_1:=__ur[1]; op_3:=__ul[1] || op_1:=__ul[1]; op_3:=__ur[1] ?};~~} {SUBSTITUTE: 'LINIA0'}{FI}
{blank:=1;~~}
{IF: +__ul[1] | +__ur[1]}   {op_1:=' '; op_3:=' ';~~}    {SUBSTITUTE: 'LINIA0X'}{FI}
{COMMENT}   LINIA 2: __ul,__ur;   Nazwa                            {COMMENT-}
{FONT: exec('font','param_wydr','strony_s1_l02')}
{IF: +__ul[2] | +__ur[2]} {{? seller_first || op_1:=__ur[2]; op_3:=__ul[2] || op_1:=__ul[2]; op_3:=__ur[2] ?};~~} {SUBSTITUTE: 'LINIA0'}{FI}
{COMMENT}   LINIA 3: __ul,__ur;   KOD, MIASTO                      {COMMENT-}
{FONT: exec('font','param_wydr','strony_s1_l03')}
{IF: +__ul[3] | +__ur[3]} {{? seller_first || op_1:=__ur[3]; op_3:=__ul[3] || op_1:=__ul[3]; op_3:=__ur[3] ?};~~} {SUBSTITUTE: 'LINIA0'}{FI}
{COMMENT}   LINIA 4: __ul,__ur;   UL .KDP                          {COMMENT-}
{FONT: exec('font','param_wydr','strony_s1_l04')}
{IF: +__ul[4] | +__ur[4]} {{? seller_first || op_1:=__ur[4]; op_3:=__ul[4] || op_1:=__ul[4]; op_3:=__ur[4] ?};~~} {SUBSTITUTE: 'LINIA0'}{FI}
{COMMENT}   LINIA 12: __ul,__ur;  KRAJ                             {COMMENT-}
{IF: exec('get','#params',100226,2)='T'}
{FONT: exec('font','param_wydr','strony_s1_l12')}
{IF: +__ul[12] | +__ur[12]} {{? seller_first || op_1:=__ur[12]; op_3:=__ul[12] || op_1:=__ul[12]; op_3:=__ur[12] ?};~~} {SUBSTITUTE: 'LINIA0'}{FI}
{FI}
{COMMENT}   LINIA 5: __ul,__ur;   TEL                              {COMMENT-}
{IF: +__ul[1] | +__ur[1]}   {op_1:=' '; op_3:=' ';~~}    {SUBSTITUTE: 'LINIA0X'}{FI}
{FONT: exec('font','param_wydr','strony_s1_l05')}
{IF: +__ul[5] | +__ur[5]} {{? seller_first || op_1:=__ur[5]; op_3:=__ul[5] || op_1:=__ul[5]; op_3:=__ur[5] ?};~~} {SUBSTITUTE: 'LINIA0'}{FI}
{COMMENT}   LINIA 6: __ul,__ur;   NIPY                             {COMMENT-}
{FONT: exec('font','param_wydr','strony_s1_l06')}
{IF: +__ul[6] | +__ur[6]} {{? seller_first || op_1:=__ur[6]; op_3:=__ul[6] || op_1:=__ul[6]; op_3:=__ur[6] ?};~~} {SUBSTITUTE: 'LINIA0'}{FI}
{COMMENT}   LINIA 13: __ul,__ur;   BDO                             {COMMENT-}
{FONT: exec('font','param_wydr','strony_s1_l13')}
{IF: +__ul[13] | +__ur[13]} {{? seller_first || op_1:=__ur[13]; op_3:=__ul[13] || op_1:=__ul[13]; op_3:=__ur[13] ?};~~} {SUBSTITUTE: 'LINIA0'}{FI}
{IF: (+__ul[1] | +__ur[1]) & (
   {? seller_first
   || op_1:=Plugin.run('WYDR_LL_001',__STRTAB,__ur[1],__ur[2],PARAM_W.JEZYK); op_3:=Plugin.run('WYDR_LL_001',__STRTAB,__ul[1],__ul[2],PARAM_W.JEZYK)
   || op_1:=Plugin.run('WYDR_LL_001',__STRTAB,__ul[1],__ul[2],PARAM_W.JEZYK); op_3:=Plugin.run('WYDR_LL_001',__STRTAB,__ur[1],__ur[2],PARAM_W.JEZYK)
   ?};
   op_1<>'' | op_3<>'')}{SUBSTITUTE: 'LINIA0'}{FI}
{COMMENT}   odkreslenie                                              {COMMENT-}
{IF: lineleft()-62>0}{LINE: lineleft()-62}{FI}
{IF: +__ul[1] | +__ur[1]}   {op_1:=' '; op_3:=' ';~~}    {SUBSTITUTE: 'LINIA0X'}{FI}
{ {? seller_first || blank:=0 || blank:=3 ?};~~}
{IF: +__dl[1] | +__dr[1]}{LINE}{FI}
{ {? seller_first | +__dr[1] || blank:=2 || blank:=4 ?};~~}
{ op1:=op3:='';~~}
{IF: +__dl[1] | +__dr[1]}   {op_1:=''; op_3:='';~~}    {SUBSTITUTE: 'LINIA0'}{FI}
{IF: +__dl[1] | +__dr[1]}   {op_1:=' '; op_3:=' ';~~}    {SUBSTITUTE: 'LINIA0X'}{FI}
{COMMENT}   LINIA 1: __ul,__ur;   100222='N'                      {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   Sprzedaż: Odbiorca/--           {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   Zakup RR: RR/--                 {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   100222='T'                      {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   Sprzedaż: Nabywca/Odbiorca      {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   Zakup: Sprzedawca/--            {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   Zakup RR: Sprzedawca/RR         {COMMENT-}
{FONT: exec('font','param_wydr','strony_s2_l01')}
{IF: +__dl[1] | +__dr[1]}   {{? seller_first || op_1:=__dr[1]; op_3:=__dl[1] || op_1:=__dl[1]; op_3:=__dr[1] ?};~~}    {SUBSTITUTE: 'LINIA0'}{FI}
{IF: +__dl[1] | +__dr[1]}   {op_1:=' '; op_3:=' ';~~}    {SUBSTITUTE: 'LINIA0X'}{FI}
{ {? seller_first | +__dr[1] || blank:=1 || blank:=3 ?};~~}
{COMMENT}   LINIA 2: __dl,__dr;   Nazwa                            {COMMENT-}
{FONT: exec('font','param_wydr','strony_s2_l02')}
{IF: +__dl[2] | +__dr[2]}   {{? seller_first || op_1:=__dr[2]; op_3:=__dl[2] || op_1:=__dl[2]; op_3:=__dr[2] ?};~~}     {SUBSTITUTE: 'LINIA0'}{FI}
{FONT: exec('font','param_wydr','T10')}
{COMMENT}   LINIA 3: __dl,__dr;   KOD, MIASTO                      {COMMENT-}
{FONT: exec('font','param_wydr','strony_s2_l03')}
{IF: +__dl[3] | +__dr[3]}   {{? seller_first || op_1:=__dr[3]; op_3:=__dl[3] || op_1:=__dl[3]; op_3:=__dr[3] ?};~~}     {SUBSTITUTE: 'LINIA0'}{FI}
{COMMENT}   LINIA 4: __dl,__dr;   UL                               {COMMENT-}
{FONT: exec('font','param_wydr','strony_s2_l04')}
{IF: +__dl[4] | +__dr[4]}   {{? seller_first || op_1:=__dr[4]; op_3:=__dl[4] || op_1:=__dl[4]; op_3:=__dr[4] ?};~~}     {SUBSTITUTE: 'LINIA0'}{FI}
{COMMENT}   LINIA 12: __dl,__dr;  KRAJ                             {COMMENT-}
{IF: exec('get','#params',100226,2)='T'}
{FONT: exec('font','param_wydr','strony_s2_l12')}
{IF: +__dl[12] | +__dr[12]} {{? seller_first || op_1:=__dr[12]; op_3:=__dl[12] || op_1:=__dl[12]; op_3:=__dr[12] ?};~~}   {SUBSTITUTE: 'LINIA0'}{FI}
{FI}
{IF: +__dl[1] | +__dr[1]}   {op_1:=' '; op_3:=' ';~~}    {SUBSTITUTE: 'LINIA0X'}{FI}
{COMMENT}   LINIA 5: __dl,__dr;   TEL                              {COMMENT-}
{FONT: exec('font','param_wydr','strony_s2_l05')}
{IF: +__dl[5] | +__dr[5]}   {{? seller_first || op_1:=__dr[5]; op_3:=__dl[5] || op_1:=__dl[5]; op_3:=__dr[5] ?};~~}     {SUBSTITUTE: 'LINIA0'}{FI}
{COMMENT}   LINIA 6: __dl,__dr;   NIPY                             {COMMENT-}
{FONT: exec('font','param_wydr','strony_s2_l06')}
{IF: +__dl[6] | +__dr[6]}   {{? seller_first || op_1:=__dr[6]; op_3:=__dl[6] || op_1:=__dl[6]; op_3:=__dr[6] ?};~~}     {SUBSTITUTE: 'LINIA0'}{FI}
{IF: (+__dl[1] | +__dr[1]) & (
   {? seller_first
   || op_1:=Plugin.run('WYDR_LL_001',__STRTAB,__dr[1],__dr[2],PARAM_W.JEZYK); op_3:=Plugin.run('WYDR_LL_001',__STRTAB,__dl[1],__dl[2],PARAM_W.JEZYK)
   || op_1:=Plugin.run('WYDR_LL_001',__STRTAB,__dl[1],__dl[2],PARAM_W.JEZYK); op_3:=Plugin.run('WYDR_LL_001',__STRTAB,__dr[1],__dr[2],PARAM_W.JEZYK)
   ?};
   op_1<>'' | op_3<>'')}{SUBSTITUTE: 'LINIA0'}{FI}
{IF: +__dl[1] | +__dr[1]}   {op_1:=' '; op_3:=' ';~~}    {SUBSTITUTE: 'LINIA0X'}{FI}
{VAR_DEL.delete('seller_first');~~}
{LINE: 1}
{FONT: exec('font','param_wydr','T8G')}{max_T8G:=charleft;~~}
{FONT: exec('font','param_wydr','T10B')}{max_T10B:=charleft;~~}
{
exec('czytaj','#stalesys',,XINFO,'KOD_P','KRAJ','MIA','NAZ','NIP','NR_D','NR_L','POCZ','TEL','UL');
KSTE.get; strony();
VAR_DEL.delete('strony');
~~}
{COLOR: color_bw}
{MACRO-}
{MACRO: 'inf_dod'}
{COMMENT}   informacje dodatkowe na wydrukach      {COMMENT-}
{  {? var_pres('oo')>0  || obj_del(oo) ?};{? var_pres('oo')=0  || &oo ?};
   {? var_pres('OPIK')>0 || obj_del(OPIK) ?};{? var_pres('OPIK')=0 || &OPIK ?};
   _rozm:=(charleft-7-(S_GD.LK-1)*3)/S_GD.LK $0; oo:=obj_new(S_GD.LK); {! _i..S_GD.LK |! oo[_i]:='' !};
   OPIK:=obj_new(@.CLASS.PRINT,S_GD.LK);
   {! _i..S_GD.LK |! OPIK.add($('oo['+$_i+']'),_rozm,'') !};
   wsk:=0; prn1:='OPIK'; OPIK.n_frame(); byl:=0; rsep:=0;~~}
{FOR: M_GD}
{PREFIX: S_GD.GD}
{DO}
   {IF: S_GD.LK=M_GD.LK}
      { wsk+=1; oo[wsk]:=M_GD.OP; byl+=1;~~}
      {IF: wsk=S_GD.LK}
         {SUBSTITUTE: 'LINIA0'}
         {{! _i:=1..wsk |! oo[_i]:='' !};
          wsk:=0; ~~}
      {FI}
   {FI}
{OD}
{IF: byl & wsk & wsk<S_GD.LK}
   {SUBSTITUTE: 'LINIA0'}
{FI}
{ obj_del(OPIK); obj_del(oo); ~~}
{MACRO-}
{COMMENT}   MACRO - prn_txt                                          {COMMENT-}
{COMMENT}   Makro uzywane do drukowania tekstow                      {COMMENT-}
{MACRO: 'prn_txt'}
{ STR.split(Text);~~}
{WHILE: +(Text:=STR.line(Text_dl))}
{DO}
   {<{lmt}Text}
{OD}
{MACRO-}
{COMMENT}   MACRO - razem                                            {COMMENT-}
{COMMENT}   Makro drukuje razem przed tabelka                        {COMMENT-}
{MACRO: 'razem'}
{ __next:=0; ll:=lineleft();~~}
{IF:  _f:=prn1+'.ini_line()'; _v:=($(_f))();
      _f:=prn1+'.length()'; _v:=($(_f))();
      ll<(rsep+_v) & ll<>0}{PAGE}{FI}
{ENTIRE}
{REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
{WHILE: _f:=prn1+'.next()'; ($(_f))()}
{DO}
   {FIRST}
   {<{lmt-(+exec('tr','tlumaczenia','1000115')+2)}}{exec('tr','tlumaczenia','1000115')}{REP: _f:=prn1+'.fline(lmt)'; ($(_f))()}
   {FIRST-}
   {IF: __next}
      {REP: _f:=prn1+'.fline(lmt)'; ($(_f))()}
   {ELSE}
      { __next:=1;~~}
   {FI}
{OD}
{ENTIRE-}
{ VAR_DEL.delete('__next','skipline');~~}
{MACRO-}
{MACRO: 'HEADF'}
{IF: PAR_WYDR.TITLE<>''}
   {head_font:=exec('font','param_wydr','head_ie'); head_font_b:=exec('font','param_wydr','head_if');~~}
   {SPACE: 'B'}{FONT: head_font_b}
   {<1}{lm:=charleft();~~}
      {
         {? Plugin.runnable('WYDR_TYPE_001') || PAR_WYDR.TYPE:=Plugin.run('WYDR_TYPE_001') ?};
         invoice_type:=' '+PAR_WYDR.TYPE+'        ';
         invoice_sym:=PAR_WYDR.SYM+'  ';
         invoice_type_size:=+invoice_type;
         invoice_sym_size:=+invoice_type+(+invoice_sym);
         blank_invoice_type:=(+invoice_type)*'.';
         blank_sign:=(lm-(+invoice_type))*'.';
         blank_sign_pt:=(lm-(2*(+invoice_type)))*'.';
         extra_sign:=0;
      ~~}
      {<1}{FONT: head_font}{IF: exec('get','#params',300250,2)<>'' & var_press('__STRTAB')=type_of('') & (__STRTAB='ND' | __STRTAB='FAKS' | __STRTAB='ZK_N' | __STRTAB='OFE')}{IMAGE: barcode('QRCode',exec('get','#params',300250,2));8}{FI}{COLOR: color_ww}{blank_invoice_type}{FONT: exec('font','param_wydr','header')}{blank_pt:=charleft();~~}{FONT: head_font}{blank_sign_pt}{COLOR: color_oo}{>{lm}blank_invoice_type}{FONT: exec('font','param_wydr','head')}{IF:charleft()}{extra_sign:=1;charleft()*' '}{FI}{COLOR: color_bw}{end_type:=charleft();~~}
      {<1}{FONT: head_font}{COLOR: color_bw}{>{(lm-invoice_sym_size)}PAR_WYDR.TITLE+'  '}{FONT: head_font_b}{>{(lm-invoice_type_size)}invoice_sym}{COLOR: color_wo}{invoice_type}{FONT: exec('font','param_wydr','head')}{IF:charleft()}{charleft()*' '}{FI}{COLOR: color_bw}
      {<1}{FONT: head_font}{IF: var_press('podtytul')=type_of('')&podtytul<>''}{FONT: exec('font','param_wydr','header')}{COLOR: color_bw}{>{blank_pt-2-extra_sign}podtytul}{COLOR: color_ww}{'..'}{FONT: head_font}{ELSE}{COLOR: color_ww}{blank_sign}{FI}{COLOR: color_oo}{>{lm}blank_invoice_type}{FONT: exec('font','param_wydr','head')}{IF:charleft()}{charleft()*' '}{FI}{COLOR: color_bw}
      {IF: -PARAM_W.DR_DUPL='t' & var_press('dup_sym')=type_of(1) & dup_sym}
         {SPACE: 'E'}{LINE}
         {SPACE: 'B'}{<1}{FONT: head_font}{COLOR: color_ww}{blank_sign}{COLOR: color_wg}{<{lm-invoice_type_size+2}}{FONT: exec('font','param_wydr','head')}{exec('tr','tlumaczenia','1000227')}{COLOR: color_dgg}{(charleft()-end_type)*'.'}{COLOR: color_bw}{FONT: exec('font','param_wydr','header')}{dup_sym:=0;~~}
         {SPACE: 'E'}{<1}{FONT: head_font}{COLOR: color_ww}{blank_sign}{COLOR: color_dgg}{>{lm}blank_invoice_type}{FONT: exec('font','param_wydr','head')}{IF:charleft()}{charleft()*' '}{FI}{COLOR: color_bw}
      {ELSE}
         {SPACE: 'B'}
         {IF: exec('get','#params',300250,2)<>'' & var_press('__STRTAB')=type_of('') & (__STRTAB='ND' | __STRTAB='FAKS' | __STRTAB='ZK_N' | __STRTAB='OFE')}{LINE}{FI}
      {FI}
      {SPACE: 'B'}
      {VAR_DEL.delete('invoice_type','invoice_sym','invoice_type_size','invoice_sym_size','blank_invoice_type','blank_sign','blank_sign_pt','extra_sign');~~}
{FI}
{MACRO-}
{MACRO: 'Text'}
{<{lmt+1}}{
max_T8:=charleft;
STR.split(Text);
~~}
{IF: Line & +Text}{LINE}{FI}
{WHILE: +(Text:=STR.line(max_T8-4-2))}
{DO}
   {IF: +Text>=(max_T8-4-8)}
      {<{lmt+1}}{JUSTIFY}{<{lmt+1}>{max_T8-5}Text}
   {ELSE}
      {<{lmt+1}}{Text}
   {FI}
{OD}
{MACRO-}
{MACRO: 'Text_podpis'}
{<{lmt+1}}{
max_T8:=charleft;
STR.split(Text);
~~}
{IF: Line & +Text}{LINE}{FI}
{WHILE: +(Text:=STR.line(max_T8))}
{DO}
      {<{lmt+1}}{Text}
{OD}
{MACRO-}
{MACRO: 'panel_platnosci'}
   {STR.split(slownie);STR.line(40);~~}
   {IF: lineleft()>0 & lineleft()<(9+
      {? swift_tr<>'' | STR.line(40)<>'' || 1 || 0 ?}+
      {? swift_war<>'' | STR.line(40)<>'' || 1 || 0 ?}+
      {? STR.line(40)<>'' || 1 || 0 ?}) }
      {PAGE}
   {FI}
   {ENTIRE}
   {<1}{FONT: exec('font','param_wydr','fp_tr')}{STR.split(bank_war);line_charleft:=charleft();end_line:=charleft()-3;~~}
   {<1}{COLOR: color_gg}{LINE}
   {<1}{COLOR: color_gg}{FONT: exec('font','param_wydr','fp_tr')}{<7}{fp_tr}{COLOR: color_glg}{<{grey_line} line_sign}{COLOR: color_gg}{<+5 bank_tr}{COLOR: color_bg}{>{end_line}wp_tr}
   {<1}{COLOR: color_bg}{FONT: exec('font','param_wydr','fp_war')}{<7}{fp_war}{FONT: exec('font','param_wydr','fp_tr')}{COLOR: color_glg}{<{grey_line} line_sign}{COLOR: color_bg}{FONT: exec('font','param_wydr','fp_war')}{<+5}{STR.line(40)}
   {<1}{COLOR: color_gg}{FONT: exec('font','param_wydr','fp_tr')}{COLOR: color_glg}{<{grey_line} line_sign}{COLOR: color_bg}{FONT: exec('font','param_wydr','fp_war')}{<+5}{STR.line(40)}{STR.split(slownie);charleft_1:=(line_charleft-charleft());~~}{FONT: exec('font','param_wydr','head_if')}{COLOR: color_bg}{>{charleft()+charleft_1-1}wp_war+wp_wal}
   {<1}{COLOR: color_gg}{FONT: exec('font','param_wydr','fp_tr')}{<7}{tp_tr}{COLOR: color_glg}{<{grey_line} line_sign}{COLOR: color_gg}{<+5 rach_tr}
   {<1}{COLOR: color_bg}{FONT: exec('font','param_wydr','fp_war')}{<7}{1-tp_war}{FONT: exec('font','param_wydr','fp_tr')}{COLOR: color_glg}{<{grey_line} line_sign}{COLOR: color_bg}{FONT: exec('font','param_wydr','fp_war')}{<+5}{rach_war}{>{end_line}STR.line(40)}{str_slow:=STR.line(40);~~}
   {IF: swift_tr<>'' | str_slow<>''}
   {<1}{COLOR: color_gg}{FONT: exec('font','param_wydr','fp_tr')}{COLOR: color_glg}{<{grey_line} line_sign}{COLOR: color_gg}{<+5}{swift_tr}{FONT: exec('font','param_wydr','fp_war')}{COLOR: color_bg}{>{end_line}str_slow}{str_slow:=STR.line(40);~~}
   {FI}
   {IF: swift_war<>'' | str_slow<>''}
   {<1}{COLOR: color_gg}{FONT: exec('font','param_wydr','fp_tr')}{COLOR: color_glg}{<{grey_line} line_sign}{COLOR: color_bg}{FONT: exec('font','param_wydr','fp_war')}{<+5}{swift_war}{FONT: exec('font','param_wydr','fp_war')}{COLOR: color_bg}{>{end_line}str_slow}{str_slow:=STR.line(line_charleft-grey_line);~~}
   {FI}
   {IF: str_slow<>''}
   {<1}{FONT: exec('font','param_wydr','fp_tr')}{COLOR: color_glg}{<{grey_line} line_sign}{FONT: exec('font','param_wydr','fp_war')}{COLOR: color_bg}{>{end_line}str_slow}
   {FI}
   {LINE}
   {COLOR: color_ww}{<1}{'.'}{COLOR: color_bw}
   {ENTIRE-}
   {VAR_DEL.delete('fp_war','fp_tr','tp_war','tp_tr','bank_war','bank_tr','rach_war','rach_tr','swift_war','swift_tr','grey_line','line_charleft','end_line','str_slow','line_sign','pl_size');~~}
{MACRO-}
{MACRO: 'panel_informacji'}
   {{? var_press('inf_head_arr')>100 || obj_del(inf_head_arr) ?}; inf_head_arr:=spli_str(inf_head-1, ';');int_inf_head:=1;
   {? var_press('inf_val_arr')>100 || obj_del(inf_val_arr) ?}; inf_val_arr:=spli_str(inf_val-1, ';');int_inf_val:=1;
   cl_prn7:=charleft();
   ~~}
   {IF: obj_len(inf_head_arr)>0 & obj_len(inf_val_arr)>0 & inf_head_arr[1]<>'' & inf_val_arr[1]<>''}
   {
      print7:="
         _white:=\"
            {? var_press('blank')>0 & grey_c
            || color_gw
            || color_bw
            ?}\";
         prn1:='PRN7';
         VAR_DEL.delete('PRN7');
         PRN7:=obj_new(@.CLASS.PRINT,_a);
         PRN7.s_frame();
         _int:=1;
         {!|?
            {? inf_head_arr[_int]=exec('tr','tlumaczenia','1000148')
            | inf_head_arr[_int]=exec('tr','tlumaczenia','1000149')
            | inf_head_arr[_int]=exec('tr','tlumaczenia','6000103')
            ||
              {? _a>=4
              ||
                PRN7.add($('form(inf_head_arr[%1],)'[$_int]),3*_b,'',,,_white)
              ||
                PRN7.add($('form(inf_head_arr[%1],)'[$_int]),2*_b,'',,,_white)
              ?}
            ||
               PRN7.add($('form(inf_head_arr[%1],)'[$_int]),_b,'',,,_white)
            ?};
            _int+=1;
            _int<=_a
         !}
      ";

      print7(obj_len(inf_head_arr),(((cl_prn7/obj_len(inf_head_arr))-obj_len(inf_head_arr))/2)#0);
      grey_c:=1;
      ~~}
      {COLOR: color_gw}{FONT: exec('font','param_wydr','dane')}
      { _f:=prn1+'.framecol('+'\''+color_frame_w+'\''+')'; ($(_f))(); ~~}
      {SUBSTITUTE: 'LINIA03I'}
      {  _int:=1;
         grey_c:=0;
         {!|?
            inf_head_arr[_int]:=inf_val_arr[_int];
            _int+=1;
            _int<=obj_len(inf_head_arr)
         !};
      ~~}
      {COLOR: color_bw}{FONT: exec('font','param_wydr','dane_bold')}
      {SUBSTITUTE: 'LINIA03I'}
   {FI}
   {VAR_DEL.delete('inf_head','inf_val','int_inf_head','int_inf_val','grey_c','PRN7','cl_prn7');~~}
{MACRO-}
{MACRO: 'footer_nd'}
{IF: exec('czy_grp_dr','faktury_wydruk') | PARAM_W.KOPIA }
   {strona_nd:=1;~~}
   {IF: czy_war=2 | czy_war=3}
      {FOOTER}
      {~~}
      {~~}
      {SUBSTITUTE: 'footpoz'}
      {<1}{charleft_foot:=charleft();~~}{>{charleft_foot-1}}{COLOR: color_oo}{'  '}{COLOR: color_bw}
      {<1}{IF: exec('get_footer','img_blob')}{IMAGE: exec('get_footer','img_blob');;1}{FI}{>{charleft_foot-3}$strona_nd}{' '}{COLOR: color_oo}{'  '}{COLOR: color_bw}{strona_nd+=1;~~}
      {>{charleft_foot-1}}{COLOR: color_oo}{'  '}{COLOR: color_bw}
      {FOOTER-}
   {ELSE}
      {FOOTER}
      {SUBSTITUTE: 'footpoz'}
      {<1}{charleft_foot:=charleft();~~}{>{charleft_foot-1}}{COLOR: color_oo}{'  '}{COLOR: color_bw}
      {<1}{IF: exec('get_footer','img_blob')}{IMAGE: exec('get_footer','img_blob');;1}{FI}{>{charleft_foot-3}$strona_nd}{' '}{COLOR: color_oo}{'  '}{COLOR: color_bw}{strona_nd+=1;~~}
      {>{charleft_foot-1}}{COLOR: color_oo}{'  '}{COLOR: color_bw}
      {FOOTER-}
   {FI}
{ELSE}
   {IF: czy_war=2 | czy_war=3}
      {FOOTER}
      {~~}
      {~~}
      {SUBSTITUTE: 'footpoz'}
      {<1}{charleft_foot:=charleft();~~}{>{charleft_foot-1}}{COLOR: color_oo}{'  '}{COLOR: color_bw}
      {<1}{IF: exec('get_footer','img_blob')}{IMAGE: exec('get_footer','img_blob');;1}{FI}{MAXPAGE: >{charleft_foot-3};$page+' / '; 3L;' '}{' '}{COLOR: color_oo}{'  '}{COLOR: color_bw}
      {>{charleft_foot-1}}{COLOR: color_oo}{'  '}{COLOR: color_bw}
      {FOOTER-}
   {ELSE}
      {FOOTER}
      {SUBSTITUTE: 'footpoz'}
      {<1}{charleft_foot:=charleft();~~}{>{charleft_foot-1}}{COLOR: color_oo}{'  '}{COLOR: color_bw}
      {<1}{IF: exec('get_footer','img_blob')}{IMAGE: exec('get_footer','img_blob');;1}{FI}{MAXPAGE: >{charleft_foot-3};$page+' / '; 3L;' '}{' '}{COLOR: color_oo}{'  '}{COLOR: color_bw}
      {>{charleft_foot-1}}{COLOR: color_oo}{'  '}{COLOR: color_bw}
      {FOOTER-}
   {FI}
{FI}
{MACRO-}
{MACRO: 'clean_footer'}
{IF: exec('czy_grp_dr','faktury_wydruk') | PARAM_W.KOPIA }
   {strona:=1;{? var_pres('strona_nd')=type_of(1) || strona:=strona_nd ?};~~}
   {FOOTER}
   {<1}{charleft_foot:=charleft();~~}{>{charleft_foot-1}}{COLOR: color_oo}{'  '}{COLOR: color_bw}
   {<1}{IF: exec('get_footer','img_blob')}{IMAGE: exec('get_footer','img_blob');;1}{FI}{>{charleft_foot-3}$strona}{' '}{COLOR: color_oo}{'  '}{COLOR: color_bw}{strona+=1;~~}
   {>{charleft_foot-1}}{COLOR: color_oo}{'  '}{COLOR: color_bw}
   {FOOTER-}
{ELSE}
   {FOOTER}
   {<1}{charleft_foot:=charleft();~~}{>{charleft_foot-1}}{COLOR: color_oo}{'  '}{COLOR: color_bw}
   {<1}{IF: exec('get_footer','img_blob')}{IMAGE: exec('get_footer','img_blob');;1}{FI}{MAXPAGE: >{charleft_foot-3};$page+' / '; 3L;' '}{' '}{COLOR: color_oo}{'  '}{COLOR: color_bw}
   {>{charleft_foot-1}}{COLOR: color_oo}{'  '}{COLOR: color_bw}
   {FOOTER-}
{FI}
{MACRO-}
{MACRO: 'podmioty'}
{
FAKSKH.cntx_psh();
FAKSKH.index('UNIK');
FAKSKH.prefix(FAKS.ref());
__loop:=0;
{? FAKSKH.first()
|| {!
   |? {? ~exec('rola_pomin_lsp','edi_fo_ksef2',FAKSKH.ROLA,2)
      || __loop:=1
      ?};
      ~__loop & FAKSKH.next()
   !}
?};
~~}
{WHILE: __loop}
{DO}
{
VAR_DEL.delete('__STRTAB','__dane1','__dane2','__ul','__ur','szer','op1','op2','op3','op4','print5');

__STRTAB:='FAKS';
__dane1:=obj_new(20); {! _ii:=1..obj_len(__dane1)|! __dane1[_ii]:='' !};
__dane2:=obj_new(20); {! _ii:=1..obj_len(__dane2)|! __dane2[_ii]:='' !};

__ul:=__dane1;
__ur:=__dane2;

op_1:=op_2:=op_3:=op_4:='';

print5:="
   _grey:=\"
   {? var_press('blank')>0 & blank=1
   || color_bg
   |? var_press('blank')>0 & blank=2
   || color_gg
   |? var_press('blank')>0 & (blank=3 | blank=4)
   || color_ww
   || color_bw
   ?}\";
   _white:=\"
   {? var_press('blank')>0 & (blank=2 | blank=4)
   || color_gw
   || color_bw
   ?}\";
   prn1:='PRN5';
   op_1:=op_2:=op_3:=op_4:='';
   VAR_DEL.delete('PRN5');
   PRN5:=obj_new(@.CLASS.PRINT,5,'   ',' │' ,'  ', '───' ,'  ','──','─',' ');
   PRN5.add($('form('''',)'),_a,'',1,);
   PRN5.add($('form(op_1,)'),_b,'',,,_white);
   PRN5.add($('form(op_2,)'),_c,'',1,,_white);
   PRN5.add($('form(op_3,)'),_d,'',,,_white);
   PRN5.add($('form(op_4,)'),_e,'',1,,_white)
";

szer:=obj_new(5);
szer[1]:=1;
szer[3]:=3;
szer[4]:=1;
szer[5]:=
   {? exec('get','#params',300250,2)<>''
      & (__STRTAB='ND' & ND.TYP().Z='T' | __STRTAB='FAKS' | __STRTAB='ZK_N' | __STRTAB='OFE')
   || 3
   || 1
   ?};
szer[2]:=(max_T10B-(szer[1]+szer[3]+szer[5]+16))/2$0;
print5(szer[1],szer[2],szer[3],szer[4],szer[5]);
szer[4]+=charleft-PRN5.width();
print5(szer[1],szer[2],szer[3],szer[4],szer[5]);
vp:=0;
lmt:=0;
rsep:=0;
{? exec('get','#params',100227,2)='T' || _kpocz:=3; _ul:=4 || _kpocz:=4; _ul:=3 ?};
':: dane podmiotu lewy panel';
__ul[1]:=FAKSKH.ROLA;
{? FAKSKH.KH
|| __ul[2]:=FAKSKH.KH().NAZ_P
|| __ul[2]:=FAKSKH.NAZ
?};
__ul[_kpocz]:=exec('kpocz','faktury_wydruk',FAKSKH.KPOCZ,FAKSKH.POCZ,FAKSKH.MIASTO,FAKSKH.UL);
__ul[_ul]:=exec('adr','faktury_wydruk',FAKSKH.UL,FAKSKH.DOM,FAKSKH.LOKAL,FAKSKH.MIASTO,FAKSKH.POCZ);
__ul[5]:=FAKSKH.KRAJ;
__ul[6]:=exec('tr','tlumaczenia','1000108')+' '+FAKSKH.NIP;
':: dane podmiotu prawy panel';
__loop:=0;
{? FAKSKH.next()
|| {!
   |? {? ~exec('rola_pomin_lsp','edi_fo_ksef2',FAKSKH.ROLA,2)
      || __loop:=1
      ?};
      ~__loop & FAKSKH.next()
   !}
?};
{? __loop
||
   __ur[1]:=FAKSKH.ROLA;
   {? FAKSKH.KH
   || __ur[2]:=FAKSKH.KH().NAZ_P
   || __ur[2]:=FAKSKH.NAZ
   ?};
   __ur[_kpocz]:=exec('kpocz','faktury_wydruk',FAKSKH.KPOCZ,FAKSKH.POCZ,FAKSKH.MIASTO,FAKSKH.UL);
   __ur[_ul]:=exec('adr','faktury_wydruk',FAKSKH.UL,FAKSKH.DOM,FAKSKH.LOKAL,FAKSKH.MIASTO,FAKSKH.POCZ);
   __ur[5]:=FAKSKH.KRAJ;
   __ur[6]:=exec('tr','tlumaczenia','1000108')+' '+FAKSKH.NIP
?};
~~}
{FONT: exec('font','param_wydr','strony')}
{FONT: exec('font','param_wydr','strony_s1_l01')}
{COMMENT}   LINIA 1: __ul,__ur;   100222='N'                      {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   Sprzedaż: Nabywca/Sprzedawca    {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   Zakup: Sprzedawca/Nabywca       {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   100222='T'                                  {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   Sprzedaż: Adres korespondencyjny/Sprzedawca {COMMENT-}
{COMMENT}   LINIA 1: __ul,__ur;   Zakup: Adres korespondencyjny/Nabywca       {COMMENT-}
{VAR_DEL.delete('seller_first');~~}
{
blank:=2;
~~}
{IF: lineleft()-18<0}                                             {PAGE}{FI}
{ _f:=prn1+'.framecol(''204:204:204'')'; ($(_f))(); ~~}
{IF: +__ul[1] | +__ur[1]}   {op_1:=' '; op_3:=' ';~~}             {SUBSTITUTE: 'LINIA0X'}{FI}
{IF: +__ul[1] | +__ur[1]}   {op_1:=__ul[1]; op_3:=__ur[1];~~}     {SUBSTITUTE: 'LINIA0'}{FI}
{blank:=1;~~}
{IF: +__ul[1] | +__ur[1]}   {op_1:=' '; op_3:=' ';~~}             {SUBSTITUTE: 'LINIA0X'}{FI}
{COMMENT}   LINIA 2: __ul,__ur;   Nazwa                           {COMMENT-}
{FONT: exec('font','param_wydr','strony_s1_l02')}
{IF: +__ul[2] | +__ur[2]}   {op_1:=__ul[2]; op_3:=__ur[2];~~}     {SUBSTITUTE: 'LINIA0'}{FI}
{COMMENT}   LINIA 3: __ul,__ur;   KOD, MIASTO                     {COMMENT-}
{FONT: exec('font','param_wydr','strony_s1_l03')}
{IF: +__ul[3] | +__ur[3]}   {op_1:=__ul[3]; op_3:=__ur[3];~~}     {SUBSTITUTE: 'LINIA0'}{FI}
{COMMENT}   LINIA 4: __ul,__ur;   UL .KDP                         {COMMENT-}
{FONT: exec('font','param_wydr','strony_s1_l04')}
{IF: +__ul[4] | +__ur[4]}   {op_1:=__ul[4]; op_3:=__ur[4];~~}     {SUBSTITUTE: 'LINIA0'}{FI}
{COMMENT}   LINIA 5: __ul,__ur;  KRAJ                             {COMMENT-}
{IF: exec('get','#params',100226,2)='T'}
{FONT: exec('font','param_wydr','strony_s1_l12')}
{IF: +__ul[5] | +__ur[5]} {op_1:=__ul[5]; op_3:=__ur[5];~~}       {SUBSTITUTE: 'LINIA0'}{FI}
{FI}
{COMMENT}   LINIA 6: __ul,__ur;   NIP                             {COMMENT-}
{IF: +__ul[1] | +__ur[1]}   {op_1:=' '; op_3:=' ';~~}             {SUBSTITUTE: 'LINIA0X'}{FI}
{FONT: exec('font','param_wydr','strony_s1_l05')}
{IF: +__ul[6] | +__ur[6]}   {op_1:=__ul[6]; op_3:=__ur[6];~~}     {SUBSTITUTE: 'LINIA0'}{FI}
{IF: +__ul[1] | +__ur[1]}   {op_1:=' '; op_3:=' ';~~}             {SUBSTITUTE: 'LINIA0X'}{FI}
{COMMENT}   odkreslenie                                           {COMMENT-}
{
__loop:=0;
{? FAKSKH.next()
|| {!
   |? {? ~exec('rola_pomin_lsp','edi_fo_ksef2',FAKSKH.ROLA,2)
      || __loop:=1
      ?};
      ~__loop & FAKSKH.next()
   !}
?};
~~}
{IF: __loop}                                                      {LINE}{FI}
{OD}
{
VAR_DEL.delete('__loop');
VAR_DEL.delete('__STRTAB','__dane1','__dane2','__ul','__ur','szer','op1','op2','op3','op4','print5');
FAKSKH.cntx_pop();
~~}
{COLOR: color_bw}
{MACRO-}