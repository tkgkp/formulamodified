:!UTF-8
{TITLE:L. Wartość dotacji oraz kwot amortyzacji od dotacji}
{PRINTER: FINFO.SZ_PRN,,,,,'M','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
   PRN:=obj_new(@.CLASS.PRINT,12+ {? rep_export() || 2 ?} ); PRN.s_frame();
   PRN2:=obj_new(@.CLASS.PRINT,12); PRN2.s_frame();
   c:=obj_new(11+ {? rep_export() || 2 ?});
   {! _i:=1..11 |! c[_i] := '' !};
   SRSR.cntx_psh(); SRST.cntx_psh(); SRSW.cntx_psh();
   exec('init','fst');
   SRD.maski('r');
   exec('odd_filtr','fst');
   i:=0;
   color:=prn1:=prn2:='';
   lm:=ll:=vp:=lmt:=rsep:=0;
   par1:=0; par2:=0; par3:=0; par4:=0;
   sum_wart:=0; status:='';
   sum_amop:=0; sum_amof:=0; sum_amod:=0;
   amof:=0; amop:=0; amod:=0
}
{END:
   obj_del(PRN);
   obj_del(PRN2);
   obj_del(c);
   SRSR.cntx_pop(); SRST.cntx_pop(); SRSW.cntx_pop();
   &i; &color; &prn1; &prn2;
   &lm; &ll; &vp; &lmt; &rsep;
   &par1; &par2; &par3;&par4;
   &sum_amop; &sum_amof; &sum_amod;
   &amof; &amop; &amod;
   &sum_wart; &status
}
{COMMENT}
==================================================
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
Nazwa pliku: fst_o_zezdot.rpm
Utworzony  : 2005-08-21
Zawartość  : Wartość dotacji oraz kwot amortyzacji od dotacji
==================================================
{COMMENT-}
{PAR_WYDR.cntx_psh();~~}
{INCLUDE: wsp_pw.rpi}
{PAR_WYDR.cntx_pop();~~}
{MACRO: 'MAIN'}
{COMMENT} ---- zwykłe wiersze ---- {COMMENT-}
{     c[1]:=SRZF.SRZD().NAZWA;
      c[2]:=SRZF.SRSR().NRI;
      c[3]:=SRZF.SRSR().NST;
      c[4]:=$SRZF.DATA;
      c[5]:=SRZF.OKRO_F().NAZ+' '+SRZF.OKRO_F().ROK().NAZ;
      {? ~rep_export() ||
      {? FINFO.TOR_D='T'
      || c[6]:=SRZF.KONPOD().KOD+'/'+SRZF.KONFIN().KOD+'/'+SRZF.KONDOD().KOD
      || c[6]:=SRZF.KONPOD().KOD+'/'+SRZF.KONFIN().KOD
      ?} ?};
      {? rep_export() ||
      {? FINFO.TOR_D='T'
      || c[6]:=SRZF.KONPOD().KOD;
         c[12]:=SRZF.KONFIN().KOD;
         c[13]:=SRZF.KONDOD().KOD
      || c[6]:=SRZF.KONPOD().KOD;
         c[12]:=SRZF.KONFIN().KOD
      ?} ?};
      c[7]:=SRZF.SRDO().SYMBOL;
      c[8]:=SRZF.WARP_P;
      SRSW.cntx_psh();
      SRSW.index('HISTORIA');
      SRSW.prefix(SRZF.ref(),SSTALE.AR,SSTALE.AO);
      {? SRSW.first()
      || amop:=SRSW.AMOP; amof:=SRSW.AMOF; amod:=SRSW.AMOD
      || amop:=0; amof:=0; amod:=0
      ?};
      SRSW.cntx_pop();
      c[9]:=amop;
      c[10]:=amof;
      {? FINFO.TOR_D='T' || c[11]:=amod ?};
      sum_wart+=SRZF.WARP_P;
      sum_amop+=amop;
      sum_amof+=amof;
      sum_amod+=amod
 ;~~}
  {IF: lineleft() <=4 & lineleft()<>0}{PAGE}{FI}
  {FONT: 'T8G'}{SPACE: 'C'}{SUBSTITUTE: 'LINIA02'}
  {prn1:='PRN'; prn2:='PRN';~~}
  {rsep:=PAR_WYDR.RSEP;~~}
{MACRO-}
{COMMENT}--Definicja wiersza wydruku--------------------{COMMENT-}
{     prn1:='PRN'; prn2:='PRN'; ~~}
{     PRN.add("c[1]",20,'Źródło finansowania'@,,);
      PRN.add("c[2]",18,'Środek dotowany'@,,);
      PRN.add("c[3]",25,'Nazwa środka'@,,);
      PRN.add("c[4]",10,'Data'@,,);
      PRN.add("c[5]",15,'Od okresu'@,,'#');
      {? ~rep_export() ||
      {? FINFO.TOR_D='T' || PRN.add("c[6]",20,'Zestaw kont#POD/BIL/DOD'@,1,'#') || PRN.add("c[6]",20,'Zestaw kont POD/BIL'@,,) ?} ?};
      {? rep_export() ||
      {? FINFO.TOR_D='T' ||
      PRN.add("c[6]",20,'Zestaw kont POD'@,1,'#');
      PRN.add("c[12]",20,'Zestaw kont BIL'@,1,'#');
      PRN.add("c[13]",20,'Zestaw kont DOD'@,1,'#')
   || PRN.add("c[6]",20,'Zestaw kont POD'@,,);
      PRN.add("c[12]",20,'Zestaw kont BIL'@,,)
        ?} ?};
        {? ~rep_export() ||
      PRN.add("c[7]",20,'Dokument wartościowy'@,,);
      PRN.add("form(c[8],,2,' ,')",12,'Kwota pełna dotacji'@,1,'#');
      PRN.add("form(c[9],,2,' ,')",12,'Amortyzacja#podatkowa'@,1,'#');
      PRN.add("form(c[10],,2,' ,')",12,'Amortyzacja#bilansowa'@,1,'#');
      {? FINFO.TOR_D='T' || PRN.add("form(c[11],,2,' ,')",12,'Amortyzacja#dodatkowa'@,1,'#') ?};
      PRN2.add("c[1]",146,'',,'#');
      PRN2.add("{? type_of(c[8]) = 1 || form(c[8],,2,' ,') || c[8] ?}",12,'Wartość dotacji'@,1,'#');
      PRN2.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}",12,'Amortyzacja#podatkowa '@,1,'#');
      PRN2.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}",12,'Amortyzacja#bilansowa '@,1,'#');
      {? FINFO.TOR_D='T' || PRN2.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}",12,'Amortyzacja#dodatkowa '@,1,'#')?} ?};

      {? rep_export() ||
       PRN.add("c[7]",20,'Dokument wartościowy'@,,);
      PRN.add("form(c[8],,2,' ,')",12,'Kwota pełna dotacji'@,1,'#');
      PRN.add("form(c[9],,2,' ,')",12,'Amortyzacja podatkowa'@,1,'#');
      PRN.add("form(c[10],,2,' ,')",12,'Amortyzacja bilansowa'@,1,'#');
      {? FINFO.TOR_D='T' || PRN.add("form(c[11],,2,' ,')",12,'Amortyzacja dodatkowa'@,1,'#') ?};
      PRN2.add("c[1]",146,'',,'#');
      PRN2.add("{? type_of(c[8]) = 1 || form(c[8],,2,' ,') || c[8] ?}",12,'Wartość dotacji'@,1,'#');
      PRN2.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}",12,'Amortyzacja podatkowa '@,1,'#');
      PRN2.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}",12,'Amortyzacja bilansowa '@,1,'#');
      {? FINFO.TOR_D='T' || PRN2.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}",12,'Amortyzacja dodatkowa '@,1,'#')?} ?};

      PAR_WYDR.TITLE:='Wartość dotacji oraz kwot amortyzacji od dotacji na dzień %1'@[$SSTALE.AO().KON];
~~}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{COMMENT}------------------------------Parametry wydruku------------{COMMENT-}
{LINE: 1}
{FONT: 'W8'}{SPACE: 'C'}
{<1 'PARAMETRY WYDRUKU:'@}
{FONT: 'W8B'}{<1 'Jednostka księgowa: '@}{FONT: 'W8'}{{? OPERATOR.DEPT=null || 'wszystkie'@ || OPERATOR.DEPT().OD ?}}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: ~rep_export()}
{SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{ rsep:=1; ~~}
{prn1:='PRN';prn2:='PRN';~~}
{ SRZF.index('SRODEK');~~}
{ SRZF.prefix();~~}
{FOR: 'SRZF'}{INDEX: 'SRODEK'}
 {DO}
   {IF: SRZF.TYP='D' & ((SSTALE.AO().KON<>date(0,0,0) & SRZF.DATA<=SSTALE.AO().KON) | (SSTALE.AO().KON=date(0,0,0) & SRZF.DATA<=SSTALE.AR().POCZ_ROK))}
     {IF: OPERATOR.DEPT=null | SRZF.SRSR().ODD=OPERATOR.DEPT}
        {SUBSTITUTE: 'MAIN'}
     {FI}
   {FI}
 {OD}
{COMMENT}------------------------------FOOTER-LAST------------------{COMMENT-}
{IF: lineleft()<>0 & lineleft()<6}{PAGE}{FI}
{FOOTER}{FOOTER-}
 {COMMENT} ---- podsumowanie nie występuje dla excela ---- {COMMENT-}
{IF: ~rep_export()}
{FONT: 'T8GB'}{SPACE: 'C'}
{
   c[1]:='Ogółem:'@;
   c[2]:='';
   c[3]:='';
   c[4]:='';
   c[5]:='';
   c[6]:='';
   c[7]:='';
   c[8]:=sum_wart;
   c[9]:=sum_amop;
   c[10]:=sum_amof;
   {? FINFO.TOR_D='T' || c[11]:=sum_amod ?}
;~~}
{prn1:='PRN'; prn2:='PRN2';rsep:=1;~~}
{SUBSTITUTE: 'LINIA02'}
{FI}
{prn1:='PRN2'; prn2:='PRN2';~~}
{REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}