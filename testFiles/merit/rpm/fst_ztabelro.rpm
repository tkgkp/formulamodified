:!UTF-8
{TITLE: C. Tabela roczna amortyzacji}
{PRINTER: FINFO.SZ_PRN,,,,,'M','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   PRN:=obj_new(@.CLASS.PRINT,14); PRN.s_frame();
   PRN2:=obj_new(@.CLASS.PRINT,14); PRN2.s_frame();
   c:=obj_new(14);
   {! _i:=1..14 |! c[_i] := '' !};
   d:=obj_new(14);
   {! _i:=1..14 |! d[_i] := '' !};
   i:=0;
   color:=prn1:=prn2:='';
   lm:=ll:=vp:=lmt:=rsep:=0;
   __std:=null; slicznik:=0;
   par0:=0; par1:=0; par2:=0; par3:=0; par4:=0; par5:=0;
   exec('czytaj','#stalesys',,FINFO,'TOR_D')
}
{END:
   obj_del(PRN); obj_del(PRN2);
   obj_del(c); obj_del(d);
   &i; &color; &prn1; &prn2;
   &lm; &ll; &vp; &lmt; &rsep;
   &par0; &par1; &par2; &par3;&par4;&par5
}
{EXIT:
   _exit:=0;
   _exit
}
{COMMENT}
==================================================
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
Nazwa pliku: fst_ztabelro.rpm
Utworzony  : 2016-12-02
Zawartość  : Tabela roczna amortyzacji wybranego środka.
==================================================
{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{COMMENT}--Definicja wiersza wydruku--------------------{COMMENT-}
{  prn1:='PRN'; prn2:='PRN'; ~~}
{
      PRN.add("c[1]",39,'Nazwa środka'@,0,' ');
      PRN.add("c[2]",10,'Grupa'@,0,' ');
      PRN.add("c[3]",10,'Data zakupu'@,1,' ');
      PRN.add("c[4]",15,'Rodzaj rozchodu'@,1,' ');
      PRN.add("c[5]",10,'Data skreślenia'@,1,' ');
      PRN.add("c[6]",15,'Tor amortyzacji'@,0,' ');
      PRN.add("c[7]",24,'Metoda amortyzacji'@,0,' ');
      PRN.add("form(c[8],,2,' ,')",11,'Stawka'@,1,'#');
      PRN.add("form(c[9],,2,' ,')",11,'Wartość początkowa'@,1,' ');
      PRN.add("form(c[10],,2,' ,')",11,'Umorzenie początkowe'@,1,' ');
      PRN.add("form(c[11],,2,' ,')",11,'Netto początkowe'@,1,' ');

      PRN2.add("d[1]",15,'Tor amortyzacji'@,0,'#');
      PRN2.add("{? type_of(d[2])=1 || form(d[2],,2,' ,') || d[2] ?}",11,'I',1,'#');
      PRN2.add("{? type_of(d[3])=1 || form(d[3],,2,' ,') || d[3] ?}",11,'II',1,'#');
      PRN2.add("{? type_of(d[4])=1 || form(d[4],,2,' ,') || d[4] ?}",11,'III',1,'#');
      PRN2.add("{? type_of(d[5])=1 || form(d[5],,2,' ,') || d[5] ?}",11,'IV',1,'#');
      PRN2.add("{? type_of(d[6])=1 || form(d[6],,2,' ,') || d[6] ?}",11,'V',1,'#');
      PRN2.add("{? type_of(d[7])=1 || form(d[7],,2,' ,') || d[7] ?}",11,'VI',1,'#');
      PRN2.add("{? type_of(d[8])=1 || form(d[8],,2,' ,') || d[8] ?}",11,'VII',1,'#');
      PRN2.add("{? type_of(d[9])=1 || form(d[9],,2,' ,') || d[9] ?}",11,'VIII',1,'#');
      PRN2.add("{? type_of(d[10])=1 || form(d[10],,2,' ,') || d[10] ?}",11,'IX',1,'#');
      PRN2.add("{? type_of(d[11])=1 || form(d[11],,2,' ,') || d[11] ?}",11,'X',1,'#');
      PRN2.add("{? type_of(d[12])=1 || form(d[12],,2,' ,') || d[12] ?}",11,'XI',1,'#');
      PRN2.add("{? type_of(d[13])=1 || form(d[13],,2,' ,') || d[13] ?}",11,'XII',1,'#');
      PRN2.add("{? type_of(d[14])=1 || form(d[14],,2,' ,') || d[14] ?}",11,'Razem',1,'#');

      PAR_WYDR.TITLE:='Tabela roczna amortyzacji środka: %1\n dla roku podatkowego %2'@[SRST.NRI,$SSTALE.AO().RES];
      ~~}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{COMMENT}------------------------------Parametry wydruku------------{COMMENT-}
{FONT: 'W8'}{SPACE: 'C'}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{ rsep:=1; ~~}
{prn1:='PRN';~~}
{COMMENT} ---- Podatkowo ---- {COMMENT-}
{
   _rok:=SSTALE.AO().RES;

   c[1]:=SRST.NST;
   c[2]:=SRST.GR().GR;
   c[3]:=$SRST.DZ;
   c[4]:=SRST.SRSR().ROZ().R;
   c[5]:=$SRST.DES;
   c[6]:='Podatkowy';
   c[7]:=SRST.MP().N;
   _stap:=_warp:=_umop:=_netp:=0;
   SRST.cntx_psh(); SRSR.cntx_psh();
   SRST.index('PODAT');
   SRSR.prefix();
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES);
   {? SRST.first()
   || {? SRST.OKRES=0
      || _stap:=SRST.STAP * SRST.WKP;
         _warp:=SRST.WARP;
         _umop:=SRST.UMOP;
         _netp:=SRST.NETP
      || _stap:=SRST.SRSR().STAP * SRST.WKP;
         _warp:=SRST.SRSR().WARP;
         _umop:=SRST.SRSR().UMOP;
         _netp:=SRST.SRSR().NETP
      ?}
   ?};
   SRST.cntx_pop(); SRSR.cntx_pop();
   c[8]:=_stap;
   c[9]:=_warp;
   c[10]:=_umop;
   c[11]:=_netp
;~~}
{SUBSTITUTE: 'LINIA0'}
{
   c[1]:='';
   c[2]:='';
   c[3]:='';
   c[4]:='';
   c[5]:='';
   c[6]:='Bilansowy';
   c[7]:=SRST.MF().N;
   _staf:=_warf:=_umof:=_netf:=0;
   SRST.cntx_psh(); SRSR.cntx_psh();
   SRST.index('PODAT');
   SRSR.prefix();
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES);
   {? SRST.first()
   || {? SRST.OKRES=0
      || _staf:=SRST.STAF * SRST.WKF;
         _warf:=SRST.WARF;
         _umof:=SRST.UMOF;
         _netf:=SRST.NETF
      || _staf:=SRST.SRSR().STAF * SRST.WKF;
         _warf:=SRST.SRSR().WARF;
         _umof:=SRST.SRSR().UMOF;
         _netf:=SRST.SRSR().NETF
      ?}
   ?};
   SRST.cntx_pop(); SRSR.cntx_pop();
   c[8]:=_staf;
   c[9]:=_warf;
   c[10]:=_umof;
   c[11]:=_netf
;~~}
{SUBSTITUTE: 'LINIA0'}
{IF: FINFO.TOR_D='T'}
{
   c[1]:='';
   c[2]:='';
   c[3]:='';
   c[4]:='';
   c[5]:='';
   c[6]:='Dodatkowy';
   c[7]:=SRST.MD().N;
   _stad:=_ward:=_umod:=_netd:=0;
   SRST.cntx_psh(); SRSR.cntx_psh();
   SRST.index('PODAT');
   SRSR.prefix();
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES);
   {? SRST.first()
   || {? SRST.OKRES=0
      || _stad:=SRST.STAD * SRST.WKD;
         _ward:=SRST.WARD;
         _umod:=SRST.UMOD;
         _netd:=SRST.NETD
      || _stad:=SRST.SRSR().STAD * SRST.WKD;
         _ward:=SRST.SRSR().WARD;
         _umod:=SRST.SRSR().UMOD;
         _netd:=SRST.SRSR().NETD
      ?}
   ?};
   SRST.cntx_pop(); SRSR.cntx_pop();
   c[8]:=_stad;
   c[9]:=_ward;
   c[10]:=_umod;
   c[11]:=_netd
;~~}
{SUBSTITUTE: 'LINIA0'}
{FI}
{rsep:=PAR_WYDR.RSEP;~~}
{SUBSTITUTE: 'LINIAF'}
{COMMENT}------------------------------PODATKOWO-----------------------{COMMENT-}
{LINE: 1}
{  prn1:='PRN2'; prn2:='PRN2'; ~~}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{FONT: 'T8G'}{SPACE: 'C'}
{
   d[1]:='Podatkowy';
   SRST.cntx_psh();
   SRST.index('PODAT');
   d[14]:=0;
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,1);
   {? SRST.first() || d[2]:=SRST.AMOP;d[14]+=SRST.AMOP || d[2]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,2);
   {? SRST.first() || d[3]:=SRST.AMOP;d[14]+=SRST.AMOP || d[3]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,3);
   {? SRST.first() || d[4]:=SRST.AMOP;d[14]+=SRST.AMOP || d[4]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,4);
   {? SRST.first() || d[5]:=SRST.AMOP;d[14]+=SRST.AMOP || d[5]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,5);
   {? SRST.first() || d[6]:=SRST.AMOP;d[14]+=SRST.AMOP || d[6]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,6);
   {? SRST.first() || d[7]:=SRST.AMOP;d[14]+=SRST.AMOP || d[7]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,7);
   {? SRST.first() || d[8]:=SRST.AMOP;d[14]+=SRST.AMOP || d[8]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,8);
   {? SRST.first() || d[9]:=SRST.AMOP;d[14]+=SRST.AMOP || d[9]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,9);
   {? SRST.first() || d[10]:=SRST.AMOP;d[14]+=SRST.AMOP || d[10]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,10);
   {? SRST.first() || d[11]:=SRST.AMOP;d[14]+=SRST.AMOP || d[11]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,11);
   {? SRST.first() || d[12]:=SRST.AMOP;d[14]+=SRST.AMOP || d[12]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,12);
   {? SRST.first() || d[13]:=SRST.AMOP;d[14]+=SRST.AMOP || d[13]:='---' ?};
   SRST.cntx_pop();
~~}
{SUBSTITUTE: 'LINIA0'}
{COMMENT}------------------------------BILANSOWO-----------------------{COMMENT-}
{
   d[1]:='Bilansowy';
   SRST.cntx_psh();
   SRST.index('PODAT');
   d[14]:=0;
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,1);
   {? SRST.first() || d[2]:=SRST.AMOF;d[14]+=SRST.AMOF || d[2]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,2);
   {? SRST.first() || d[3]:=SRST.AMOF;d[14]+=SRST.AMOF || d[3]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,3);
   {? SRST.first() || d[4]:=SRST.AMOF;d[14]+=SRST.AMOF || d[4]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,4);
   {? SRST.first() || d[5]:=SRST.AMOF;d[14]+=SRST.AMOF || d[5]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,5);
   {? SRST.first() || d[6]:=SRST.AMOF;d[14]+=SRST.AMOF || d[6]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,6);
   {? SRST.first() || d[7]:=SRST.AMOF;d[14]+=SRST.AMOF || d[7]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,7);
   {? SRST.first() || d[8]:=SRST.AMOF;d[14]+=SRST.AMOF || d[8]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,8);
   {? SRST.first() || d[9]:=SRST.AMOF;d[14]+=SRST.AMOF || d[9]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,9);
   {? SRST.first() || d[10]:=SRST.AMOF;d[14]+=SRST.AMOF || d[10]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,10);
   {? SRST.first() || d[11]:=SRST.AMOF;d[14]+=SRST.AMOF || d[11]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,11);
   {? SRST.first() || d[12]:=SRST.AMOF;d[14]+=SRST.AMOF || d[12]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,12);
   {? SRST.first() || d[13]:=SRST.AMOF;d[14]+=SRST.AMOF || d[13]:='---' ?};
   SRST.cntx_pop();
~~}
{SUBSTITUTE: 'LINIA0'}
{COMMENT}------------------------------DODATKOWO-----------------------{COMMENT-}
{IF: FINFO.TOR_D='T'}
{
   d[1]:='Dodatkowy';
   SRST.cntx_psh();
   SRST.index('PODAT');
   d[14]:=0;
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,1);
   {? SRST.first() || d[2]:=SRST.AMOD;d[14]+=SRST.AMOD || d[2]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,2);
   {? SRST.first() || d[3]:=SRST.AMOD;d[14]+=SRST.AMOD || d[3]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,3);
   {? SRST.first() || d[4]:=SRST.AMOD;d[14]+=SRST.AMOD || d[4]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,4);
   {? SRST.first() || d[5]:=SRST.AMOD;d[14]+=SRST.AMOD || d[5]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,5);
   {? SRST.first() || d[6]:=SRST.AMOD;d[14]+=SRST.AMOD || d[6]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,6);
   {? SRST.first() || d[7]:=SRST.AMOD;d[14]+=SRST.AMOD || d[7]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,7);
   {? SRST.first() || d[8]:=SRST.AMOD;d[14]+=SRST.AMOD || d[8]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,8);
   {? SRST.first() || d[9]:=SRST.AMOD;d[14]+=SRST.AMOD || d[9]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,9);
   {? SRST.first() || d[10]:=SRST.AMOD;d[14]+=SRST.AMOD || d[10]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,10);
   {? SRST.first() || d[11]:=SRST.AMOD;d[14]+=SRST.AMOD || d[11]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,11);
   {? SRST.first() || d[12]:=SRST.AMOD;d[14]+=SRST.AMOD || d[12]:='---' ?};
   SRST.prefix(SRST.SRSR,SSTALE.AO().RES,12);
   {? SRST.first() || d[13]:=SRST.AMOD;d[14]+=SRST.AMOD || d[13]:='---' ?};
   SRST.cntx_pop();
~~}
{SUBSTITUTE: 'LINIA0'}
{FI}
{rsep:=PAR_WYDR.RSEP;~~}
{COMMENT}------------------------------ZAKONCZENiE-----------------------{COMMENT-}