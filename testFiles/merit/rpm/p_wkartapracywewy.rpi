:!UTF-8
{BEGIN:
   VAR_DEL.delete('tresc','NGodz','NDni','Cnt','lmt','lmtt8','lmtt10b','lmtt8g','lmttw8','lmttw8b');
   VAR_DEL.delete('dzien','SKLokr','val','total','display','names','PRH','PRG','PRN');
   VAR_DEL.delete('mark','control','group','dayOfWeek');
   VAR_DEL.delete('empty','lp','prn1','prn2','vp','rsep','size');
   VAR_DEL.delete('ok','__param','wsad');

   tresc:='pkd_wkartapracywewy';
   wsad:=var_pres('batch')>=100 & var_pres('id',batch)=type_of('') & batch.id=tresc & var_pres('par',batch)>100;

   PAR_WYDR.TITLE:='';
   P.cntx_psh();
   R_PRACDN.cntx_psh();
   R_KWGODZ.cntx_psh();
   R_WZCZ.cntx_psh();
   KAL_ROK.cntx_psh();
   KAL_DEF.cntx_psh();
   N.cntx_psh();
   R_ODN.cntx_psh();
   R_ODP.cntx_psh();
   R_REJ_WW.cntx_psh();
   G.cntx_psh();

   dzien:=obj_new(32);
   {! _ii:=1..obj_len(dzien) |! dzien[_ii]:=obj_new(60) !};
   SKLokr:=obj_new(7);
   {! _n:=1..obj_len(SKLokr) |! SKLokr[_n]:=obj_new(2) !};

   _domain:={? +B_DOMAIN.SYMBOL || B_DOMAIN.SYMBOL || 3+AreaTitle.area ?};
   ok:={? wsad
       || ''
       |? _domain='PRC'
       || exec('uprawnieniawrap','pkd','wydrukach zestawień czasu pracy'@,'PRC_CZP_WYDR')
       || exec('uprawnieniawrap','pkd','nieobecnościach'@,'PKD_EZK_OPNN','PKD_EZK_ORNN')+
          exec('uprawnieniawrap','pkd','wzorcach czasu pracy'@,'PKD_EZK_OPKA','PKD_EZK_ORKA')
       ?};
   {? +ok
   || FUN.emsg('Brak wymaganych uprawnień do przeglądania informacji o: %1'@[ok])
   || __param:={? wsad || batch.par || exec('p_wkartapracywewy','pkd') ?};
      {? __param.size()
      || R_WZCZ.index('R_WZCZ');
         KAL_ROK.index('KAL_ROK');
         KAL_ROK.clear();
         KAL_DEF.index('KAL_DEF');
         N.index('NIEORM');
         R_ODP.index('PRAC');
         R_ODN.index('PRAC');

         NGodz:=time(0,0,0);
         NDni:=Cnt:=lmt:=lmtt8:=lmtt10b:=lmtt8g:=lmttw8:=lmttw8b:=0;
         {? ~wsad
         || params_set('P',exec('wybierz_parses','pracownik',_domain).P)
         ?};

         size:=42;
         val:=obj_new(size);
         {! _ii:=1..obj_len(val) |! val[_ii]:=obj_new(31) !};
         total:=obj_new(size);
         display:=obj_new(size);
         names:=obj_new(size);
         'Dzień:';
         display[1]:=1;    names[1]:='Dzień miesiąca';
         display[2]:=0;    names[2]:='Dzień tygodnia';
         'Plan pracy:';
         display[3]:=1;    names[3]:='Plan pracy (liczba godzin):';
         display[4]:=1;    names[4]:='oznaczenie dnia';
         'Dzień pracy:';
         display[5]:=1;    names[5]:='Dzień pracy (liczba dni):';
         display[6]:=1;    names[6]:='godzina rozpoczęcia';
         display[7]:=1;    names[7]:='godzina zakończenia';
         display[8]:=1;    names[8]:='data zakończenia';
         'Czas pracy:';
         display[9]:=1;    names[9]:='Czas pracy (liczba godzin):';
         display[10]:=1;   names[10]:='praca zgodna z wymiarem';
         display[11]:=1;   names[11]:='praca w dni wolne';
         display[12]:=1;   names[12]:='przekroczenia dobowe';
         display[13]:=1;   names[13]:='przekroczenia średniotygodniowe';
         display[14]:=1;   names[14]:='praca ponad wymiar';
         'Dyżury:';
         display[15]:=1;   names[15]:='Dyżury (liczba godzin):';
         display[16]:=1;   names[16]:='godzina rozpoczęcia';
         display[17]:=1;   names[17]:='godzina zakończenia';
         display[18]:=1;   names[18]:='miejsce pełnienia';
         'Młodociani:';
         display[19]:=1;   names[19]:='Młodociani (czas pracy):';
         display[20]:=1;   names[20]:='liczba godzin pracy wzbronionej';
         'Nieobecności:';
         display[21]:=1;   names[21]:='Nieobecności (liczba godzin):';
         display[22]:=0;   names[22]:='urlop wypoczynkowy';
         display[23]:=0;   names[23]:='urlop macierzyński';
         display[24]:=0;   names[24]:='urlop wychowawczy';
         display[25]:=0;   names[25]:='urlop bezpłatny';
         display[26]:=0;   names[26]:='urlop okolicznościowy';
         display[27]:=0;   names[27]:='zwolnienie niepłatne';
         display[28]:=0;   names[28]:='choroba pracownika';
         display[29]:=0;   names[29]:='opieka nad dzieckiem';
         display[30]:=0;   names[30]:='nieobecność usprawiedliwiona';
         display[31]:=0;   names[31]:='nieobecność nieusprawiedliwiona';
         display[32]:=0;   names[32]:='przestój';
         'Informacje dodatkowe:';
         display[33]:=1;   names[33]:='Informacje dodatkowe:';
         display[34]:=1;   names[34]:='praca w porze nocnej';
         display[35]:=0;   names[35]:='liczba godzin z dodatkiem 50%';
         display[36]:=0;   names[36]:='liczba godzin z dodatkiem 100%';
         display[37]:=0;   names[37]:='godziny odebrane';
         display[38]:=0;   names[38]:='odbiór godzin nadliczbowych';
         display[39]:=0;   names[39]:='wnioskowany czas wolny';
         display[40]:=0;   names[40]:='godziny do odpracowania';
         display[41]:=0;   names[41]:='godziny odpracowane';
         display[42]:=0;   names[42]:='praca poza siedzibą firmy';

         '{! _ind:=1..42 |! display[_ind]:=1 !};display[2]:=0;';

         dayOfWeek:="
            _dt:=date(_a,_b,_c)~4;
            {? _dt=1 || 'Po'@
            |? _dt=2 || 'Wt'@
            |? _dt=3 || 'Śr'@
            |? _dt=4 || 'Cz'@
            |? _dt=5 || 'Pt'@
            |? _dt=6 || 'So'@
            || 'Nd'@
            ?}";

         lp:=0;
         _days:=date(__param.ROK,__param.MC,0)~3;
         _cols:={? rep_export() || _days+4 || _days+2 ?};
         _wDni:=5;
         _wOG:=7;

         {? var_pres('PRH')>0 || obj_del(PRH) ?};
         PRH:=obj_new(@.CLASS.PRINT,_cols);
         {? rep_export()
         || PRH.add("''",12,'Numer teczki'@);
            PRH.add("''",40,'Współpracownik'@);
            PRH.add("''",40,'Jednostka organizacyjna'@)
         ?};
         PRH.add("",40,_a:=~-(date(__param.ROK,__param.MC,0)$8); form(_a,-((38/2)+(floor((+_a)/2))),1));
         {! _i:=1.._days |! PRH.add("''",5,form($_i,-4)) !};
         {? ~rep_export()
         || PRH.add("''",7,form('Razem'@,-6))
         ?};
         PRH.sl_frame();

         {? var_pres('PRG')>0 || obj_del(PRG) ?};
         PRG:=obj_new(@.CLASS.PRINT,_cols);
         {? rep_export()
         || PRG.add("'%1'[P.T]",12,'');
            PRG.add("'%1 %2'[P.OSOBA().NAZWISKO,OSOBA.PIERWSZE]",40,'');
            PRG.add("P.WYDZIAL().SYMBOL+' '+|UD_SKL.OPIS",40,'')
         ?};
         PRG.add("names[Cnt]",40,'');
         {! _i:=1.._days |! PRG.add(($('val[Cnt]['+$_i+']')),_wDni,'') !};
         {? ~rep_export()
         || PRG.add("total[Cnt]",_wOG,'',1,,,,,',2,\'9.\'')
         ?};
         PRG.sl_frame();

         {? var_pres('PRN')>0 || obj_del(PRN) ?};
         PRN:=obj_new(@.CLASS.PRINT,_cols);
         {? rep_export()
         || PRN.add("'%1'[P.T]",12,'');
            PRN.add("'%1 %2'[P.OSOBA().NAZWISKO,OSOBA.PIERWSZE]",40,'');
            PRN.add("P.WYDZIAL().SYMBOL+' '+|UD_SKL.OPIS",40,'')
         ?};
         PRN.add("{?~mark(Cnt)||{? ~rep_export()||'    '||'- '?}||''?}+names[Cnt]",40,'');
         {! _i:=1.._days |!
            _fml_col:='
               _type:=\',\'+(2+|val[2]['+$_i+'])+\',\';
               _color:=color;
               _result:=\'\';
               {? _color<>\'\'
               || {? \',nd,\'*(-_type) || _result:=\',\'+_color ?}
               ?};
               _result
               ';
            PRN.add(($('val[Cnt]['+$_i+']')),_wDni,form(dayOfWeek(__param.ROK,__param.MC,_i),-4),,,$_fml_col)
         !};
         {? ~rep_export()
         || PRN.add("total[Cnt]",_wOG,'',1,,,,,',2,\'9.\'')
         ?};
         PRN.sl_frame();

         prn1:='PRN';
         prn2:='PRH';
         lmt:=rsep:=0;
         vp:=1;

         group:="
            {? _a=3  || ',4'
            |? _a=5  || ',6,7,8'
            |? _a=9  || ',10,11,12,13,14'
            |? _a=15 || ',16,17,18'
            |? _a=19 || ',20'
            |? _a=21 || ',22,23,24,25,26,27,28,29,30,31,32'
            |? _a=33 || ',34,35,36,37,38,39,40,41,42'
            || ''
            ?}";

         mark:="
            {? ((',3,5,9,15,19,21,33,')*(','+$_a+','))>0 || 1 || 0 ?}";

         control:="
            _pos:=spli_str($Cnt+group(Cnt),',');
            {! _days:=1..date(__param.ROK,__param.MC,0)~3 |!
               {! _ind:=1 .. obj_len(_pos) |!
                  {? val[#_pos[_ind]][_days]<>form('',5)
                  || return(0)
                  ?}
               !}
            !};
            return(1)"

      || ok:='nie'
      ?}
   ?}
}
{END:
   P.cntx_pop();
   R_REJ_WW.cntx_pop();
   R_PRACDN.cntx_pop();
   R_KWGODZ.cntx_pop();
   R_WZCZ.cntx_pop();
   KAL_ROK.cntx_pop();
   KAL_DEF.cntx_pop();
   N.cntx_pop();
   G.cntx_pop();
   R_ODP.cntx_pop();
   R_ODN.cntx_pop();
   {! _n:=1..obj_len(dzien) |! obj_del(dzien[_n]) !};
   {? var_pres('val')>100 || {! _n:=1..obj_len(val) |! obj_del(val[_n]) !} ?};
   VAR_DEL.delete('tresc','NGodz','NDni','Cnt','lmt','lmtt8','lmtt10b','lmtt8g','lmttw8','lmttw8b');
   VAR_DEL.delete('dzien','SKLokr','val','total','display','names','PRH','PRG','PRN');
   VAR_DEL.delete('mark','control','group','dayOfWeek');
   VAR_DEL.delete('empty','lp','prn1','prn2','vp','rsep','size');
   VAR_DEL.delete('ok','__param','wsad')
}
{EXIT: +ok}
{EXIT: ~wsad & ~params_get().P.first()}
{INCLUDE: wsp_pw.rpi}
{COMMENT}
═══════════════════════════════════════════════════════════════════════════
   K O N F I G U R A C J A   -   N A G Ł Ó W E K,   S T O P K A
═══════════════════════════════════════════════════════════════════════════
{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT:'T10B'}{SPACE: 'B'}
{CENTER}{<1>{charleft()}'E W I D E N C J A   M I E S I Ę C Z N A   C Z A S U   P R A C Y'}
{FONT:'T8G'}{SPACE: 'C'}
{lmt:=0;~~}
{FONT:'T8'}{SPACE: 'B'}
{lmtt8:=charleft();~~}
{FONT:'T10B'}{SPACE: 'B'}
{lmtt10b:=charleft();~~}
{FONT:'TW8B'}{SPACE: 'C'}
{<1>{charleft()}(137)*'─'}

   {IF: ~rep_export()}
      {FONT:'T8G'}{SPACE: 'B'}{<{lmt}'Parametry sprawozdania'@}
      {FONT:'T8G'}{SPACE: 'B'}{<{lmt}'%1 %2'
                              ['Sposób prezentacji wejść oraz wyjść:',
                              {? __param.ASK || 'wg doby pracowniczej' || 'wg dnia pracy' ?}]}

      {FONT:'T10B'}{SPACE: 'B'}{<1>{lmtt10b} P.OSOBA().NAZWISKO+' '+OSOBA.PIERWSZE+
                                             '   (Nr teczki '+|P.T+'),   Jednostka org. '+P.WYDZIAL().SYMBOL}
      {COMMENT}
      {FONT:'T8'}{SPACE: 'B'}{>{lmtt8-8-(+(date(__param.ROK,__param.MC,0)$8))}date(__param.ROK,__param.MC,0)$8}{COMMENT-}
   {ELSE}
      {FONT:'T8G'}{SPACE: 'C'}{<{lmt}'Parametry sprawozdania'@}
      {FONT:'T8G'}{SPACE: 'C'}{<{lmt}'%1 %2'
                              ['Sposób prezentacji wejść oraz wyjść:',
                              {? __param.ASK || 'wg doby pracowniczej' || 'wg dnia pracy' ?}]}
      {FONT:'T8G'}{SPACE: 'C'}{<{lmt}'%1 %2'['Za okres:',date(__param.ROK,__param.MC,0)$8]}
      {LINE}
   {FI}
{FONT: 'T8GB'}
{SPACE: 'D'}
{rsep:=0; ~~}
{SUBSTITUTE: 'TABHEAD2'}
{rsep:=1; ~~}
{HEADER-}
{FOOTER: 0}
{FONT: 'T8G'}
{SUBSTITUTE: rsep:=0; vp:=0; prn1:='PRN'; 'LINIAF'}

    Legenda :
             R - roboczy, RN - roboczy w niedzielę, RS - roboczy w święto, WH - harmonogramowo wolny, W5 - wolny z tytułu pięciodniowego tyg. pracy, WN - wolny za niedzielę,
             WS - wolny za święto, SN - święto niedzielne, SW - święto w inny dzień niż niedziela, [W - wolny - dane historyczne], [S - święto - dane historyczne])
{FOOTER-}
{IF: ~rep_export()}
   {SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}
═══════════════════════════════════════════════════════════════════════════
   M A K R O D E F I N I C J E
═══════════════════════════════════════════════════════════════════════════
{COMMENT-}
{MACRO: 'TABHEAD2'}
{ _f:=prn2+'.setcolor(color)'; ($(_f))(); ~~}
{ _f:=prn2+'.ini_head()'; ($(_f))()}
{REP: _f:=prn2+'.fhbar(lmt)'; ($(_f))()}
{WHILE: _f:=prn2+'.h_next()'; ($(_f))()}
{DO}
{REP: _f:=prn2+'.h_fline(lmt)'; ($(_f))()}
{OD}
{ _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
{ _f:=prn1+'.ini_head()'; ($(_f))()}
{WHILE: _f:=prn1+'.h_next()'; ($(_f))()}
{DO}
{REP: _f:=prn1+'.h_fline(lmt)'; ($(_f))()}
{OD}
{MACRO-}
{MACRO: 'LINEX'}
{  ll:=lineleft(); ~~}
{IF:  params_set(params_get());
      _f:='params_set(params_get()); '+prn1+'.ini_line()'; _v:=($(_f))();
      _f:=prn1+'.length()'; _v:=($(_f))();
      ll<(rsep+_v) & ll<>0}{PAGE}{FI}
{ENTIRE}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}{ vp:=0; ~~}
{ELSE}
   {IF: PAR_WYDR.RSEP & rsep}
      {REP: _f:=prn1+'.fcbar(lmt)'; ($(_f))()}
   {ELIF: rsep}
      {REP: _f:=prn1+'.fcbar(lmt)'; ($(_f))()}
   {FI}
{FI}
{WHILE: _f:=prn1+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.fline(lmt)'; ($(_f))()}
{OD}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{ENTIRE-}
{MACRO-}
{ MASK.Use('R_PRACDN',__param.ROK,__param.MC);
  R_PRACDN.index('R_PRACDN');
  R_PRACDN.prefix();
  MASK.Use('R_KWGODZ',__param.ROK,__param.MC);
  R_KWGODZ.index('DATA_RUB');
  R_KWGODZ.prefix();
  MASK.Use('R_REJ_WW',__param.ROK,__param.MC);
  R_REJ_WW.index('R_REJ_WX');
  ~~
}
{FONT: 'T8G'}
{SPACE: 'C'}
{MACRO: tresc}
   {  echo('Pracownik: '@+P.OSOBA().NAZWISKO+' '+OSOBA.PIERWSZE);
      exec('oblicz_wewy','wkartp','msc'); ~~
   }
   {FONT: 'T8GB'}
   {SPACE: 'D'}
   {WHILE: dzien[Cnt+=1][1]}
   {DO}
      { val[1][Cnt]:=form(dzien[Cnt][1],5);
        val[2][Cnt]:=form(dzien[Cnt][2],5);
        val[3][Cnt]:=form(_a:=dzien[Cnt][17];{?_a<>time(0,0,0)||_a||''?},5);
        val[4][Cnt]:=form(dzien[Cnt][3],-3);

        val[5][Cnt]:=form({?dzien[Cnt][4]||{?(',nd,po,'*-dzien[Cnt][2])||'  1'||'   1'?}||' '?},5);
        val[6][Cnt]:=form(_a:=dzien[Cnt][26];{?_a<>time(0,0,0)||_a||''?},5);
        val[7][Cnt]:=form(_a:=dzien[Cnt][27];{?_a<>time(0,0,0)||_a||''?},5);
        val[8][Cnt]:=form(_a:=dzien[Cnt][28];{?_a<>date(0,0,0)||5+(_a$3)||''?},5);

        val[9][Cnt]:=form(_a:=dzien[Cnt][5];{?_a<>time(0,0,0)||_a||''?},5);
        val[10][Cnt]:=form(_a:=dzien[Cnt][6];{?_a<>time(0,0,0)||_a||''?},5);
        val[11][Cnt]:=form(_a:=dzien[Cnt][7];{?_a<>time(0,0,0)||_a||''?},5);
        val[12][Cnt]:=form(_a:=dzien[Cnt][9];{?_a<>time(0,0,0)||_a||''?},5);
        val[13][Cnt]:=form(_a:=dzien[Cnt][12];{?_a<>time(0,0,0)||_a||''?},5);
        val[14][Cnt]:=form(_a:=dzien[Cnt][13];{?_a<>time(0,0,0)||_a||''?},5);

        val[15][Cnt]:=form('',5);
        val[16][Cnt]:=form('',5);
        val[17][Cnt]:=form('',5);
        val[18][Cnt]:=form('',5);

        val[19][Cnt]:=form('',5);
        val[20][Cnt]:=form('',5);

        val[21][Cnt]:=form(_a:=dzien[Cnt][11]; {? type_of(_a)=5 & _a<>*0 || _a ||''?},5);
        val[22][Cnt]:=form(_a:=dzien[Cnt][50]; {? type_of(_a)=5 & _a<>*0 || _a ||''?},5);
        val[23][Cnt]:=form(_a:=dzien[Cnt][51]; {? type_of(_a)=5 & _a<>*0 || _a ||''?},5);
        val[24][Cnt]:=form(_a:=dzien[Cnt][52]; {? type_of(_a)=5 & _a<>*0 || _a ||''?},5);
        val[25][Cnt]:=form(_a:=dzien[Cnt][53]; {? type_of(_a)=5 & _a<>*0 || _a ||''?},5);
        val[26][Cnt]:=form(_a:=dzien[Cnt][54]; {? type_of(_a)=5 & _a<>*0 || _a ||''?},5);
        val[27][Cnt]:=form(_a:=dzien[Cnt][55]; {? type_of(_a)=5 & _a<>*0 || _a ||''?},5);
        val[28][Cnt]:=form(_a:=dzien[Cnt][56]; {? type_of(_a)=5 & _a<>*0 || _a ||''?},5);
        val[29][Cnt]:=form(_a:=dzien[Cnt][57]; {? type_of(_a)=5 & _a<>*0 || _a ||''?},5);
        val[30][Cnt]:=form(_a:=dzien[Cnt][58]; {? type_of(_a)=5 & _a<>*0 || _a ||''?},5);
        val[31][Cnt]:=form(_a:=dzien[Cnt][59]; {? type_of(_a)=5 & _a<>*0 || _a ||''?},5);
        val[32][Cnt]:=form(_a:=dzien[Cnt][60]; {? type_of(_a)=5 & _a<>*0 || _a ||''?},5);

        val[33][Cnt]:=form('',5);
        val[34][Cnt]:=form(_a:=dzien[Cnt][8];{?_a<>time(0,0,0)||_a||''?},5);
        val[35][Cnt]:=form(_a:=dzien[Cnt][20];{?_a<>time(0,0,0)||_a||''?},5);
        val[36][Cnt]:=form(_a:=dzien[Cnt][21];{?_a<>time(0,0,0)||_a||''?},5);
        val[37][Cnt]:=form(_a:=dzien[Cnt][22];{?_a<>time(0,0,0)||_a||''?},5);
        val[38][Cnt]:=form(_a:=dzien[Cnt][15];{?_a<>time(0,0,0)||_a||''?},5);
        val[39][Cnt]:=form(_a:=dzien[Cnt][16];{?_a<>time(0,0,0)||_a||''?},5);
        val[40][Cnt]:=form(_a:=dzien[Cnt][23];{?_a<>time(0,0,0)||_a||''?},5);
        val[41][Cnt]:=form(_a:=dzien[Cnt][25];{?_a<>time(0,0,0)||_a||''?},5);
        val[42][Cnt]:=form(_a:=dzien[Cnt][40];{?_a<>time(0,0,0)||_a||''?},5);
        ~~
      }
   {OD}
   { total[1]:=form('',6);
     total[2]:=form('',6);
     total[3]:=form(_a:=dzien[obj_len(dzien)][17];{?_a<>time(0,0,0)||_a||''?},6);
     total[4]:=form('',6);

     total[5]:=form(_a:=dzien[obj_len(dzien)][4];{?_a<>0          ||_a||''?},6);
     total[6]:=form('',6);
     total[7]:=form('',6);
     total[8]:=form('',6);

     total[9]:=form(_a:=dzien[obj_len(dzien)][5];{?_a<>time(0,0,0)||_a||''?},6);
     total[10]:=form(_a:=dzien[obj_len(dzien)][6]; {?_a<>time(0,0,0)||_a||''?},6);
     total[11]:=form(_a:=dzien[obj_len(dzien)][7]; {?_a<>time(0,0,0)||_a||''?},6);
     total[12]:=form(_a:=dzien[obj_len(dzien)][9]; {?_a<>time(0,0,0)||_a||''?},6);
     total[13]:=form(_a:=dzien[obj_len(dzien)][12];{?_a<>time(0,0,0)||_a||''?},6);
     total[14]:=form(_a:=dzien[obj_len(dzien)][13];{?_a<>time(0,0,0)||_a||''?},6);

     total[15]:=form('',6);
     total[16]:=form('',6);
     total[17]:=form('',6);
     total[18]:=form('',6);

     total[19]:=form('',6);
     total[20]:=form('',6);

     total[21]:=form(_a:=dzien[obj_len(dzien)][11]; {? type_of(_a)=5 || {? _a<>time(0,0,0) || _a || '' ?} || '' ?},6);
     total[22]:=form({? type_of(dzien[obj_len(dzien)][50])=5 || dzien[obj_len(dzien)][50] || '' ?},6);
     total[23]:=form({? type_of(dzien[obj_len(dzien)][51])=5 || dzien[obj_len(dzien)][51] || '' ?},6);
     total[24]:=form({? type_of(dzien[obj_len(dzien)][52])=5 || dzien[obj_len(dzien)][52] || '' ?},6);
     total[25]:=form({? type_of(dzien[obj_len(dzien)][53])=5 || dzien[obj_len(dzien)][53] || '' ?},6);
     total[26]:=form({? type_of(dzien[obj_len(dzien)][54])=5 || dzien[obj_len(dzien)][54] || '' ?},6);
     total[27]:=form({? type_of(dzien[obj_len(dzien)][55])=5 || dzien[obj_len(dzien)][55] || '' ?},6);
     total[28]:=form({? type_of(dzien[obj_len(dzien)][56])=5 || dzien[obj_len(dzien)][56] || '' ?},6);
     total[29]:=form({? type_of(dzien[obj_len(dzien)][57])=5 || dzien[obj_len(dzien)][57] || '' ?},6);
     total[30]:=form({? type_of(dzien[obj_len(dzien)][58])=5 || dzien[obj_len(dzien)][58] || '' ?},6);
     total[31]:=form({? type_of(dzien[obj_len(dzien)][59])=5 || dzien[obj_len(dzien)][59] || '' ?},6);
     total[32]:=form({? type_of(dzien[obj_len(dzien)][60])=5 || dzien[obj_len(dzien)][60] || '' ?},6);

     total[33]:=form('',6);
     total[34]:=form(_a:=dzien[obj_len(dzien)][8]; {?_a<>time(0,0,0)||_a||''?},6);
     total[35]:=form(_a:=dzien[obj_len(dzien)][20];{?_a<>time(0,0,0)||_a||''?},6);
     total[36]:=form(_a:=dzien[obj_len(dzien)][21];{?_a<>time(0,0,0)||_a||''?},6);
     total[37]:=form(_a:=dzien[obj_len(dzien)][22];{?_a<>time(0,0,0)||_a||''?},6);
     total[38]:=form(_a:=dzien[obj_len(dzien)][15];{?_a<>time(0,0,0)||_a||''?},6);
     total[39]:=form(_a:=dzien[obj_len(dzien)][16];{?_a<>time(0,0,0)||_a||''?},6);
     total[40]:=form(_a:=dzien[obj_len(dzien)][23];{?_a<>time(0,0,0)||_a||''?},6);
     total[41]:=form(_a:=dzien[obj_len(dzien)][25];{?_a<>time(0,0,0)||_a||''?},6);
     total[42]:=form(_a:=dzien[obj_len(dzien)][40];{?_a<>time(0,0,0)||_a||''?},6);
     Cnt:=2; ~~
   }
   {WHILE: (Cnt+=1)<=size}
   {DO}
      { empty:={? display[Cnt]=0 || control() || 1 ?}; ~~}
      {IF: (display[Cnt]=1 | empty=0)}
         { _f:=prn1+'.setcolor(''255:255:254'')'; ($(_f))(); ~~ }
         {IF: group(Cnt)<>''}
            {FONT: 'T8GB'}
            { lp:=0; rsep:=1; ~~}
            {SUBSTITUTE: 'LINEX'}
         {ELIF: mark(Cnt)}
            {FONT: 'T8GB'}
            { rsep:=0; ~~}
            {SUBSTITUTE: 'LINEX'}
         {ELSE}
            {FONT: 'T8G'}
            { lp+=1; rsep:=0; ~~}
            {IF: lp%*2<>0}
               { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~ }
            {FI}
            {SUBSTITUTE: 'LINEX'}
         {FI}
         { _f:=prn1+'.setcolor(''255:255:254'')'; ($(_f))(); ~~ }
      {FI}
   {OD}
{MACRO-}
{IF: wsad}
   {SUBSTITUTE: tresc}
{ELSE}
   {FOR:  params_get().P}
   {DO}
      {IF:
         _rok:=__param.ROK; _mc:=__param.MC;
         _data_p:=date(_rok,_mc,1); _data_k:=date(_rok,_mc,0);
         {? P.seek(params_get().P.SQL,,1)
         || {? _data_p<P.DZA || _data_p:=P.DZA ?};
            {? P.DZ<>#0 & P.DZ<_data_k || _data_k:=P.DZ ?};
            _data_k>=_data_p
         || 0
         ?}
      }
         {SUBSTITUTE: tresc}
         {PAGE}
      {FI}
   {OD}
{FI}