:!UTF-8
{TITLE: Wydruk konwersji grup rodzajowych między klasyfikacjami }
{PRINTER: FINFO.SZ_PRN,,,,, 'i', 'c',,,, 1,,1,5,5,5,5 }
{BEGIN:  __ramki:='graf';
         typ:=' '; grupa:=' '; opcja:='';
         TAM.cntx_psh();
         SRST.cntx_psh(); SRSR.cntx_psh();
         TAM.index('KST');
         exec('ster_zkst','fst_kst');

         lp:=0;
         total1:=total2:='';
         kolumny:=15; lastkol:=i:=k:=0;
         kol:=obj_new(kolumny);
         szer:=obj_new(kolumny);
         war:=obj_new(kolumny);
         sumuj:=obj_new(kolumny);
         czysumuj:=obj_new(kolumny);
         opi1:=obj_new(kolumny);
         opi2:=obj_new(kolumny);
         tytul:=obj_new(kolumny);
         macro:='puste' }
{END:    {? var_pres('__ramki') = type_of('string') || &A1; &B1; &C1; &D1; &E1; &F1; &G1; &H1; &I1; &J1; &K1; &A2; &B2; &C2; &D2; &E2; &F2; &G2; &H2; &I2; &J2; &K2; &A3; &B3; &C3; &D3; &E3; &F3; &G3; &H3; &I3; &J3; &K3; &A4; &B4; &C4; &D4; &E4; &F4; &G4; &H4; &I4; &J4; &K4 ?};
         TAM.cntx_pop();
         SRST.cntx_pop(); SRSR.cntx_pop();
         obj_del(kol);   obj_del(szer);     obj_del(war);
         obj_del(sumuj); obj_del(czysumuj);
         obj_del(opi1);  obj_del(opi2);     obj_del(tytul);
         &total1; &total2;
         &lastkol;
         &grupa;
         &macro;
         &kolumny;
         &typ; &opcja; &i; &k; &lp;
         undefine() }
{INCLUDE: fst_ramki.rpi}
{COMMENT}
(c) 1997 Macrologic
==============================================================================
    system: E S T R A
==============================================================================

 Data utworzenia pliku   : 2001-04-05 [bla] Bogdan Lawreszuk
 Ostatnie zmiany w pliku : 2001-04-05 [bla] Bogdan Lawreszuk
            +----------------------------------------------------------------+
  Zawartosc | Wydruk bilansu przeksztalcenia wartosci srodkow w wyniku       |
            | zmiany klasyfikacji srodkow trwalych.                          |
            +----------------------------------------------------------------+

==============================================================================
{COMMENT-}
{EXIT:
         lastkol:=8;
         szer[1]:=7;
         szer[2]:=15;
         szer[3]:=38;
         szer[4]:=10;
         szer[5]:=15;
         szer[6]:=38;
         szer[7]:=10;
         kol[1]:=1;
         {! i:=2..lastkol
          |! kol[i]:=kol[i-1]+szer[i-1]
         !};
         {! i:=1..lastkol |! sumuj[i]:=czysumuj[i]:=0 !};
         opi1[1]:='Lp.';
         opi1[2]:=opi1[5]:='Symbol grupy';
         opi1[3]:=opi1[6]:='Nazwa grupy';
         opi1[4]:=opi1[7]:='Stawka';
         opi2[1]:='';
         opi2[2]:='klas. '+STER.ZKST().KST;
         opi2[3]:='w klasyfikacji '+STER.ZKST().KST;
                   opi2[4]:='';
                   opi2[5]:='klas. '+STER.NKST().KST;
         opi2[6]:='w klasyfikacji '+STER.NKST().KST;
         opi2[4]:=opi2[7]:='amort.';
         tytul[1]:=~-'Tabela konwersji grup rodzajowych między klasyfikacjami';
         tytul[2]:=STER.ZKST().KST+' > '+STER.NKST().KST;
                   war[1]:=('lp+=1');
                   war[2]:=('TAB_KONW.SGR().GR');
                   war[3]:=('form(TAB_KONW.SGR().NGS,kol[4]-kol[3]-2)');
                   war[4]:=('form(TAB_KONW.SGR().S,8,2)');
                   war[5]:=('TAB_KONW.GR().GR');
                   war[6]:=('form(TAB_KONW.GR().NGS,kol[7]-kol[6]-2)');
                   war[7]:=('form(TAB_KONW.GR().S,8,2)');
                   war[8]:=('SRST.WARP');
                   war[9]:=('SRST.WARF');
                   czysumuj[7]:=czysumuj[8]:=czysumuj[9]:=1;
                   0
}
{HEADER}
{ A1 }{ (kol[lastkol]-2)*J1 }{ B1 }
{ K1 } { XINFO.NAZ+{?OPERATOR.DEPT<>0||' < jedn. ks. : '+OPERATOR.DEPT().OD+' >'||''?} } {>{kol[lastkol]-5} 'dn. '+form(date())+' Strona '+form(page()) } {<{kol[lastkol]} K1 }
{ H1 }{ (kol[lastkol]-2)*J1 }{ F1 }
{ K1 }{<{kol[1]}>{kol[lastkol]} tytul[1]}{<{kol[lastkol]} K1 }
{ K1 }{<{kol[1]}>{kol[lastkol]} tytul[2]}{>{kol[lastkol]} K1 }
{ k:=1; ~~}
{H1}{WHILE:k<lastkol}{DO}{(kol[k+1]-kol[k]-1)*J1}{<{kol[k+1]}}{IF:k=lastkol-1}{F1}{ELSE}{E1}{FI}{k+=1;~~}{OD}
{ k:=1; ~~}
{K1}{WHILE:k<lastkol}{DO}{<{kol[k]}>{kol[k+1]}opi1[k]}{<{kol[k+1]} K1 }{k+=1;~~}{OD}
{ k:=1; ~~}
{K1}{WHILE:k<lastkol}{DO}{<{kol[k]}>{kol[k+1]}opi2[k]}{<{kol[k+1]} K1 }{k+=1;~~}{OD}
{HEADER-}
{FOOTER:0}
{ i:=1; ~~}
{D1}{WHILE:i<lastkol}{DO}{(kol[i+1]-kol[i]-1)*J1}{<{kol[i+1]}}{IF:i=lastkol-1}{C1}{ELSE}{G1}{FI}{i+=1;~~}{OD}
{FOOTER-}
{MACRO: 'puste' }
{MACRO-}
{MACRO:'suma'}
{ENTIRE}
{ i:=1; ~~}
{H1}{WHILE:i<lastkol}{DO}{(kol[i+1]-kol[i]-1)*J1}{<{kol[i+1]}}{IF:i=lastkol-1}{F1}{ELSE}{I1}{FI}{i+=1;~~}{OD}
{ i:=1;~~}
{K1}{WHILE:i<lastkol}{DO}{IF:i=1}{<{kol[i]+2}total1}{ELIF:i=2}{<{kol[i]+2}total2}{FI}{IF:czysumuj[i]}{>{kol[i+1]-2},2 sumuj[i] }{FI}{<{kol[i+1]} K1}{i+=1;~~}{OD}
{ i:=1; ~~}
{COMMENT}
{H1}{WHILE:i<lastkol}{DO}{(kol[i+1]-kol[i]-1)*J1}{<{kol[i+1]}}{IF:i=lastkol-1}{F1}{ELSE}{IF:czysumuj[i]=0}{G1}{ELSE}{I1}{FI}{FI}{i+=1;~~}{OD}
{COMMENT-}
{ENTIRE-}
{MACRO-}
{FOR: 'TAB_KONW'} {INDEX: 'SGR'} {PREFIX: SSTALE.AO().RES}
{DO}
{ENTIRE}
{ i:=1; ~~}
{H1}{WHILE:i<lastkol}{DO}{(kol[i+1]-kol[i]-1)*J1}{<{kol[i+1]}}{IF:i=lastkol-1}{F1}{ELSE}{I1}{FI}{i+=1;~~}{OD}
{ i:=1;~~}
{K1}{WHILE:i<lastkol}{DO}{<{kol[i]+2} ($(war[i]))()}{<{kol[i+1]} K1}{i+=1;~~}{OD}
{ENTIRE-}
{OD}
{COMMENT}
==============================================================================
      koniec pliku: konw_pr2.rpm
==============================================================================
1997 Macrologic Ltd. All rights reserved.
{COMMENT-}
