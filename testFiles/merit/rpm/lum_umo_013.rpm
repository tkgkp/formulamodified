:!UTF-8
{TITLE:H. Aneksy z zakresu dat}
{PRINTER: exec('set_parw','param_wydr'); exec('prt','param_wydr','h'),,,,,'Q','C',,,,,,1,
   PAR_WYDR.MBOT,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,0,1,,'enable'}
{BEGIN:
   VAR_DEL.delete('PRN','PRNS','w','s','tryb');
   PRN:=obj_new(@.CLASS.PRINT,20); PRN.s_frame();
   PRNS:=obj_new(@.CLASS.PRINT,20); PRNS.s_frame();
   tryb:=rep_export();

   w:=obj_new(20);
   s:=obj_new(20);

   i:=0;
   color:=prn1:=prn2:='';
   lm:=ll:=vp:=lmt:=rsep:=0;
   ind:=UMAN.ndx_tmp('',,'D',,);

   'parametry z tabeli WYDRUKI';
   _wydr_naz:='umo_013';
   WYDRUKIL.win_edit('MAG_104');
   WYDRUKIL.index('WYDRUKI');
   WYDRUKIL.prefix(OPERATOR.USER().KOD,_wydr_naz,);
   {? ~WYDRUKIL.first()
   ||
      WYDRUKIL.blank();
      WYDRUKIL.USERS:=OPERATOR.USER().KOD;
      WYDRUKIL.WYDRUK:=_wydr_naz;
      WYDRUKIL.add()
   ?}
;~~}
{END:
   VAR_DEL.delete('PRN','PRNS','w','s','tryb');
   &i;&ind;
   &color; &prn1; &prn2;
   &lm; &ll; &vp; &lmt; &rsep
;~~}
{EXIT: ~WYDRUKIL.edit("{? WYDRUKIL.OD_DATY>WYDRUKIL.DO_DATY & WYDRUKIL.DO_DATY<>date(0,0,0)
                       || FUN.info('Niepoprawny zakres dat.'@);
                          'OD_DATY'
                       || ''
                       ?}")}
{  WYDRUKIL.put(1);
   {? tryb<>1 || PRN.add("w[1]",5,'Lp.'@,1) ?};
   PRN.add("w[2]",20,'Symbol umowy'@);
   PRN.add("w[3]",6,'Kod'@);
   PRN.add("w[4]",40,'Nazwa'@);
   PRN.add("w[5]",10,'Data obow.'@);
   PRN.add("w[6]",25,'Aneks'@);
   PRN.add("w[7]",40,'Opis'@)
;~~}
{COMMENT}
color, prn1, lm, ll, vp, lmt, rsep - zmienne pomocnicze do wydrukow graficzn.
{COMMENT-}
{  PAR_WYDR.TITLE:='Aneksy z zakresu dat'@;
   prn1:='PRN'; prn2:='PRNS'; ~~}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: tryb<>1}{SUBSTITUTE: 'FOOT'}{FI}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{<{lmt+1}'Parametry wydruku: od %1 do %2'@[$WYDRUKIL.OD_DATY,$WYDRUKIL.DO_DATY]}
{FONT: 'T8GB'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{ rsep:=PAR_WYDR.RSEP; w[1]:=0;  ~~}
{FOR: 'UMAN'}
{INDEX: ind}
{FROM: WYDRUKIL.OD_DATY}
{TO: WYDRUKIL.DO_DATY}
{DO}
   {IF: UMAN.BIE().ODDZ = ST.ODDZ}
      {w[1]+=1;
       w[2]:=UMAN.BIE().SYM;
       w[3]:=UMAN.BIE().KH().KOD;
       w[4]:=UMAN.BIE().KH().NAZ;
       w[5]:=$UMAN.D;
       w[6]:=UMAN.SYM;
       w[7]:=UMAN.NAZ
      ;~~}
      {SUBSTITUTE: 'LINIA0'}
   {FI}
{OD}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}