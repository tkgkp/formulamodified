:!UTF-8
{COMMENT} raport rodzajowy - jednowalutowy -  z pozycjami i bez {COMMENT-}
{FONT: 'R'}
{'Zmienne:';
 'l-znacznik ilości pozycji w dokumencie, jeżeli 1 pozycja l=0 jeżeli>1 l=1';
 'zn-znacznik wystąpienia ostatniej pozycji w dokumencie zn=1 wystąpiła ostatnia pozycja';zn:=0;
 'w-wydruk walutowy, jeżeli w=1 to wydruk w walucie';w:=0;
 'last-znacznik wystąpienia ostatniego dokumentu last=1 - dokument jest ostatni';
 last:=0;
 ~~
}
{ XINFO.NAZ}
{<160}{XINFO.MIA}, {date}

Stanowisko raportu: {STANKAS.KOD} - {STANKAS.NAZWA}     {IF: STANKAS.WALUTA<>exec('wal_nar','kasa_wspolne')} Waluta: {STANKAS.WALUTA().SYM}{w:=1;~~}{FI}

{FONT: 'F'}         Raport {{? USRCONST.STANKAS();
                                 KUSERUPR.STANKAS();
                                 STANKAS.F_NUMER();
                                 STANKAS.CZY_KASA='T'
                              || 'rodzajowy'
                              || 'bankowy'
                              ?}} {'- '+STANKAS.NAZWA+' -'} nr: {RAPORT.NUM_RAP} za {{? RAPORT.DATA_OD=RAPORT.DATA_DO
                                                             ||'dzień: '+$RAPORT.DATA_OD
                                                             ||'okres: '+$RAPORT.DATA_OD+'-'+$RAPORT.DATA_DO
                                                             ?}}{FONT: 'Q'}

Strona {pg:=page;pg}
╒════╤═══════════╤═════════════════╤═══════════════════════════════╤══════════════════════════════╤═══════════════╤═══════════════{IF: WYDRUKI.PAR3='T'}╤═════════════════════════════════════════{FI}{IF: WYDRUKI.PAR4='T'}╤══════════════════════════════╕{ELSE}╕{FI}
│    │           │                 │                               │                              │               │               {IF: WYDRUKI.PAR3='T'}│                K o n t o                {FI}{IF: WYDRUKI.PAR4='T'}│                              │{ELSE}│{FI}
│Poz.│ Data      │ Nr dokumentu    │ Od kogo/komu                  │ Treść                        │ Przychód      │ Rozchód       {IF: WYDRUKI.PAR3='T'}├────────────────────┬────────────────────{FI}{IF: WYDRUKI.PAR4='T'}┤  Identyfikator rozrachunku   │{ELSE}│{FI}
│    │           │                 │                               │                              │               │               {IF: WYDRUKI.PAR3='T'}│         Wn         │         Ma         {FI}{IF: WYDRUKI.PAR4='T'}│                              │{ELSE}│{FI}
╞════╪═══════════╪═════════════════╪═══════════════════════════════╪══════════════════════════════╪═══════════════╪═══════════════{IF: WYDRUKI.PAR3='T'}╪════════════════════╪════════════════════{FI}{IF: WYDRUKI.PAR4='T'}╪══════════════════════════════╡{ELSE}╡{FI}
{HEADER}
Strona {page}
╒════╤═══════════╤═════════════════╤═══════════════════════════════╤══════════════════════════════╤═══════════════╤═══════════════{IF: WYDRUKI.PAR3='T'}╤═════════════════════════════════════════{FI}{IF: WYDRUKI.PAR4='T'}╤══════════════════════════════╕{ELSE}╕{FI}
│    │           │                 │                               │                              │               │               {IF: WYDRUKI.PAR3='T'}│                K o n t o                {FI}{IF: WYDRUKI.PAR4='T'}│                              │{ELSE}│{FI}
│Poz.│ Data      │ Nr dokumentu    │ Od kogo/komu                  │ Treść                        │ Przychód      │ Rozchód       {IF: WYDRUKI.PAR3='T'}├────────────────────┬────────────────────{FI}{IF: WYDRUKI.PAR4='T'}┤  Identyfikator rozrachunku   │{ELSE}│{FI}
│    │           │                 │                               │                              │               │               {IF: WYDRUKI.PAR3='T'}│         Wn         │         Ma         {FI}{IF: WYDRUKI.PAR4='T'}│                              │{ELSE}│{FI}
╞════╧═══════════╧═════════════════╧═══════════════════════════════╧══════════════════════════════╪═══════════════╪═══════════════{IF: WYDRUKI.PAR3='T'}╪════════════════════╪════════════════════{FI}{IF: WYDRUKI.PAR4='T'}╪══════════════════════════════╡{ELSE}╡{FI}
│     Z   p r z e n i e s i e n i a                                                               │{>{l6-1}form(sm,,2,' ')}│ {>{l7-1}form(sw,,2,' ')+' '}│{IF: WYDRUKI.PAR3='T'}                    │                    │{FI}{IF: WYDRUKI.PAR4='T'}                              │{FI}
{IF: {? WYDRUKI.PAR1='N' || {?~last||1||pg=page?} || ~zn ?}}╞════╤═══════════╤═════════════════╤═══════════════════════════════╤══════════════════════════════╪═══════════════╪═══════════════{IF: WYDRUKI.PAR3='T'}╪════════════════════╪════════════════════{FI}{IF: WYDRUKI.PAR4='T'}╪══════════════════════════════╡{ELSE}╡{FI}
{ELSE}╞═════════════════════════════════════════════════════════════════════════════════════════════════╧═══════════════╧═══════════════{IF: WYDRUKI.PAR3='T'}╧════════════════════╧════════════════════{FI}{IF: WYDRUKI.PAR4='T'}╧══════════════════════════════╡{ELSE}╡{FI}{FI}
{HEADER-}
{FOOTER:0}
{IF: ~zn}╞════╧═══════════╧═════════════════╧═══════════════════════════════╧══════════════════════════════╪═══════════════╪═══════════════╪════════════════════{IF: WYDRUKI.PAR3='T'}╧{ELSE}═{FI}════════════════════{IF: WYDRUKI.PAR4='T'}╪══════════════════════════════╡{ELSE}╕{FI}
{ELSE}╞═════════════════════════════════════════════════════════════════════════════════════════════════╤═══════════════╤═══════════════╤═════════════════════════════════════════{IF: WYDRUKI.PAR4='T'}╤══════════════════════════════╡{ELSE}┤{FI}{FI}
│     D o   p r z e n i e s i e n i a                                                             │{>{l6-1}form(sm,,2,' ')}│ {>{l7-1}form(sw,,2,' ')+' '}│     Obroty   narastająco                │{IF: WYDRUKI.PAR4='T'}                              │{FI}
╘═════════════════════════════════════════════════════════════════════════════════════════════════╧═══════════════╧═══════════════╧═════════════════════════════════════════{IF: WYDRUKI.PAR4='T'}╧══════════════════════════════╛{ELSE}╛{FI}
{FOOTER-}
{
 sm:=sw:=sp:=0; sm0:=sw0:=zn0:=0;
 exec('bo_rap','kasa_wspolne',STANKAS.WALUTA().SYM);
 {? ~w
   || OBROTY.cntx_psh();
      OBROTY.clear();
      OBROTY.index('RAPORTR');
      {? OBROTY.find_key(RAPORT.ref())
      || sp:=BO.PLN
      ?};
      OBROTY.cntx_pop()
   || sp:=BO.WAL
 ?};~~
}
{poz:=1; k1:=t1:=''; ~~}
{ l0:=1;l1:=l0+5;l2:=l1+12;l3:=l2+18;l4:=l3+32;l5:=l4+31;l6:=l5+16;l7:=l6+16;l8:=l7+21;
  l9:=l8+21;l10:=l9+31;l11:=l10+4; ~~}
{FOR: 'DOKUMENT'} {INDEX: 'RAPORT'}{PREFIX: RAPORT.ref()}
{DO}
{{?DOKUMENT.next || DOKUMENT.prev || last:=1?};~~}
{
 {|POZDOK
  |!prefix;index('DOKUMENT');
    prefix(@.DOKUMENT.ref);{?size=1|| l:=0 || l:=1?}
 |};~~
}
{IF: DOKUMENT.TYP_DOK='KWT'}
{k0:={? STANKAS.CZY_ZDEP='N'
        || form(DOKUMENT.WPL_NDEP,30)
        || form(DOKUMENT.WPL().O,30)
     ?};
 k1:=form(DOKUMENT.ADR,30); ~~}
{t0:=form(DOKUMENT.OPIS,30);

 t1:={? STANKAS.CZY_ZDEP='N'
        || form(DOKUMENT.AKT_NDEP,30)
        || form(DOKUMENT.AKT().SYM,30)
     ?}; ~~}
{ELSE}
{STR.split(DOKUMENT.NAZWA);k0:=STR.line(30);k1:=STR.line(30);~~}
{t0:=DOKUMENT.OPIS;~~}
{FI}
{'linijka zawierająca opis dokumentu';~~}
{pg:=page;zn0:=1;~~}
{ENTIRE}
{ {? ~l||{|POZDOK|!prefix;index('DOKUMENT');prefix(@.DOKUMENT.ref);first|}?};~~}
{IF: ~l}{SUBSTITUTE: 'KONTO'}{FI}
{POZDOK.cntx_psh; POZDOK.index( 'DOKUMENT');POZDOK.prefix( DOKUMENT.ref);{? POZDOK.first & POZDOK.ZAKS='A' || anul:=1 || anul:=0 ?}; POZDOK.cntx_pop;~~}
{IF: anul=1}
{<{l0}'│'} {<{l1} '│'} {<{l2}'│'} {<{l3}'│'} {<{l4}'│'} {'----dokument anulowany!----'} {<{l5} '│'}{<{l6}'│'}{<{l7}'│'}{<{l8} {? WYDRUKI.PAR3='T' ||'│' || ' '?} }{<{l9} {? WYDRUKI.PAR3='T' ||'│' || ' '?} }{IF: WYDRUKI.PAR4='T'}{<{l9+2}}{<{l10}'│'}{FI}
{FI}
{<{l0}'│'}{>{l1-1},0 poz}{<{l1} '│'}{poz+=1; ~~}{<{l1+2} DOKUMENT.DATA}{<{l2}'│'
}{<{l2+2}DOKUMENT.TYP_DOK+' '+$DOKUMENT.DOK_NUM}{<{l3}'│'}{<{l3+1} k0
}{<{l4}'│'}{<{l4+1} t0}{<{l5} '│'}{>{l6-1}{?DOKUMENT.PLUS_MIN='+'
||form({?~w||DOKUMENT.KW_PLN$2||DOKUMENT.KW_WAL$2?},,2,' ')||'0,00'?}}{<{l6}'│'
}{>{l7-1}{?DOKUMENT.PLUS_MIN='-'||form({?~w||DOKUMENT.KW_PLN$2
||DOKUMENT.KW_WAL$2?},,2,' ')||'0,00'?}+{? DOKUMENT.DOK_NUM<>0 & DOKUMENT.KW_PLN=0 || '*'||' '?}
}{<{l7}'│'}{IF: ~l} { {?POZDOK.PLUS_MIN='-'|| rp_konto ||'   '?}
}{FI}{<{l8} {? WYDRUKI.PAR3='T' ||'│' || ' '?} }{IF: ~l} { {?POZDOK.PLUS_MIN='+'|| rp_konto ||'   '?}
}{FI}{<{l9} {? WYDRUKI.PAR3='T' ||'│' || ' '?} }{IF: WYDRUKI.PAR4='T'}{<{l9+2}{? ~l||{|POZDOK|!prefix;index('DOKUMENT');prefix(@.DOKUMENT.ref);first;form(MF_FIKS,29)|}||''?}
}{<{l10}'│'}{FI}{ zn0:=1;~~}
{IF: +k1<>0}
{<{l0}'│'}{<{l1} '│'}{<{l2}'│'}{<{l3}'│'}{<{l3+1} k1}{<{l4}'│'}{<{l4+1} t1}{k1:=t1:=''; ~~}{<{l5} '│'
}{<{l6}'│'}{<{l7}'│'}{<{l8} {? WYDRUKI.PAR3='T' ||'│' || ' '?} }{<{l9} {? WYDRUKI.PAR3='T' ||'│' || ' ' ?}
}{IF: WYDRUKI.PAR4='T'}{<{l10}'│'}{FI}
{FI}
{{? DOKUMENT.PLUS_MIN='+'
 || sm+={?~w||DOKUMENT.KW_PLN$2||DOKUMENT.KW_WAL$2?};
    sm0:={?~w||DOKUMENT.KW_PLN$2||DOKUMENT.KW_WAL$2?};sw0:=0
 || sw+={?~w||DOKUMENT.KW_PLN$2||DOKUMENT.KW_WAL$2?};
    sw0:={?~w||DOKUMENT.KW_PLN$2||DOKUMENT.KW_WAL$2?};sm0:=0
?};~~}
{ENTIRE-}
{'drukowanie pozycji';~~}
{IF: WYDRUKI.PAR1='T'}
 {IF: l}
{'linijka zawierająca tekst ''w tym'' ';~~}
{<{l0}'│'}{<{l1} '│'}{<{l2}'│'}{<{l3}'│'}{<{l4}'│'}{<{l4+3}'w tym'}{<{l5} '│'
}{<{l6}'│'}{<{l7}'│'}{<{l8} {? WYDRUKI.PAR3='T' ||'│' || ' '?} }{<{l9} {? WYDRUKI.PAR3='T' ||'│' || ' ' ?} }{IF: WYDRUKI.PAR4='T'}{<{l10}'│'}{FI}{ zn0:=0;~~}
{FOR: 'POZDOK'}{INDEX: 'DOKUMENT'}{PREFIX: DOKUMENT.ref}
{DO}
{'linijka zawierająca dane pozycji';~~}
{pg:=page;~~}
{SUBSTITUTE: 'KONTO'}
{<{l0}'│'}{<{l1} '│'}{<{l2}'│'}{<{l3}'│'}{<{l4}'│'}{<{l4+1}POZDOK.POZOPER().NAZWA}{<{l5} '│'
}{>{l6-1}{?POZDOK.PLUS_MIN='+'||form({?~w||POZDOK.KW_PLN$2||POZDOK.KW_WAL$2?},,2,' ')||'0,00'?}}{<{l6}'│'
}{>{l7-1}{?POZDOK.PLUS_MIN='-'||form({?~w||POZDOK.KW_PLN$2||POZDOK.KW_WAL$2?},,2,' ')||'0,00'?}+{? DOKUMENT.DOK_NUM<>0 & DOKUMENT.KW_PLN=0 || '*'||' '?}
}{<{l7}'│'} { {?POZDOK.PLUS_MIN='-'|| rp_konto ||'   '?}
}{<{l8} {? WYDRUKI.PAR3='T' ||'│' || ' '?} } { {?POZDOK.PLUS_MIN='+'|| rp_konto ||'   '?}
}{<{l9} {? WYDRUKI.PAR3='T' ||'│' || ' '?} }{IF: WYDRUKI.PAR4='T'}{<{l9+2}{?WYDRUKI.PAR4='T'||form(POZDOK.MF_FIKS,29)?}}{<{l10}'│'}{FI}
{{?DOKUMENT.next()||DOKUMENT.prev()||{?POZDOK.next() || zn:=0;POZDOK.prev() || zn:=1?}?};~~}
{OD}
 {FI}
{FI}
{IF: DOKUMENT.next()}{DOKUMENT.prev();~~}
{zn:=0;~~}
├────┼───────────┼─────────────────┼───────────────────────────────┼──────────────────────────────┼───────────────┼───────────────{IF: WYDRUKI.PAR3='T'}┼────────────────────┼────────────────────{FI}{IF: WYDRUKI.PAR4='T'}┼──────────────────────────────┤{ELSE}┤{FI}
{'kolejna linia będzie wydrukowana tylko wtedy gdy nie nastąpi zmiana strony';~~}
{ELIF: pg=page}
{zn:=1;~~}
├────┴───────────┴─────────────────┴───────────────────────────────┴──────────────────────────────┴───────────────┴───────────────{IF: WYDRUKI.PAR3='T'}┴────────────────────┴────────────────────{FI}{IF: WYDRUKI.PAR4='T'}┴──────────────────────────────┤{ELSE}┤{FI}
{FI}
{OD}
{ENTIRE}
{IF: WYDRUKI.PAR4='T'}
│                                                                                                                                                                                                          │
╞════════════════════════════════════════════════════════════════════════╤════════════════════════╤═══════════════╤═══════════════╤══════════════════════════════════╤═════════════════════════════════════╡
│                                                                        │         Obroty         │{>{l6-1}form(sm,,2,' ')}│ {>{l7-1}form(sw,,2,' ')+' '}│                                  │               Podpisy               │
│                                                                        │                        ├───────────────┼───────────────┤                                  ├──────────────────┬──────────────────┤
│     P o d s u m o w a n i e                                            │    Stan na początek    │{>{l6-1}form(sp,,2,' ')}│ ************* │                                  │Sporz.            │Spraw.            │
│                                                                        │                        ├───────────────┼───────────────┤                                  ├──────────────────┼──────────────────┤
│         r a p o r t u                                                  │     Stan na koniec     │ ************* │{>{l7-1}form(sp+sm-sw,,2,' ')+' '}│                                  │                  │                  │
│                                                                        │                        ├───────────────┼───────────────┤                                  │                  │                  │
│                                                                        │          Suma          │{>{l6-1}form(sp+sm,,2,' ')}│{>{l7-1}form(sp+sm,,2,' ')+' '}│                                  │                  │                  │
╘════════════════════════════════════════════════════════════════════════╧════════════════════════╧═══════════════╧═══════════════╧══════════════════════════════════╧══════════════════╧══════════════════╛
{ELIF: WYDRUKI.PAR3='T'}
│                                                                                                                                 │                                         │
╞════════════════════════════════════════════════════════════════════════════════╤════════════════╤═══════════════╤═══════════════╪══════════════════════════╤══════════════┤
│                                                                                │    Obroty      │{>{l6-1}form(sm,,2,' ')}│ {>{l7-1}form(sw,,2,' ')+' '}│                          │  Podpisy     │
│                                                                                │                ├───────────────┼───────────────┤                          ├───────┬──────┤
│     P o d s u m o w a n i e                                                    │Stan na początek│{>{l6-1}form(sp,,2,' ')}│ ************* │                          │Sporz. │Spraw.│
│                                                                                │                ├───────────────┼───────────────┤                          ├───────┼──────┤
│         r a p o r t u                                                          │ Stan na koniec │ ************* │{>{l7-1}form(sp+sm-sw,,2,' ')+' '}│                          │       │      │
│                                                                                │                ├───────────────┼───────────────┤                          │       │      │
│                                                                                │    Suma        │{>{l6-1}form(sp+sm,,2,' ')}│{>{l7-1}form(sp+sm,,2,' ')+' '}│                          │       │      │
╘════════════════════════════════════════════════════════════════════════════════╧════════════════╧═══════════════╧═══════════════╧══════════════════════════╧═══════╧══════╛
{ELSE}
│                                                                                                                                 │
╞════════════════════════════════════════════════════════════════════════════════╤════════════════╤═══════════════╤═══════════════╪══════════════╕
│                                                                                │    Obroty      │{>{l6-1}form(sm,,2,' ')}│ {>{l7-1}form(sw,,2,' ')+' '}│  Podpisy     │
│                                                                                │                ├───────────────┼───────────────┼───────┬──────┤
│     P o d s u m o w a n i e                                                    │Stan na początek│{>{l6-1}form(sp,,2,' ')}│ ************* │Sporz. │Spraw.│
│                                                                                │                ├───────────────┼───────────────┼───────┼──────┤
│         r a p o r t u                                                          │ Stan na koniec │ ************* │{>{l7-1}form(sp+sm-sw,,2,' ')+' '}│       │      │
│                                                                                │                ├───────────────┼───────────────┤       │      │
│                                                                                │    Suma        │{>{l6-1}form(sp+sm,,2,' ')}│{>{l7-1}form(sp+sm,,2,' ')+' '}│       │      │
╘════════════════════════════════════════════════════════════════════════════════╧════════════════╧═══════════════╧═══════════════╧═══════╧══════╛

{FI}
{ENTIRE-}
{HEADER}{HEADER-}
{FOOTER}{FOOTER-}
