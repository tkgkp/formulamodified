:!UTF-8
{TITLE:A. Lista zapotrzebowania wyposażenia}
{PRINTER: exec('set_parw','param_wydr'); exec('prt','param_wydr','h'),,,,,'E','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
      PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{INCLUDE: wyp_beginend.rpi}
{COMMENT}
 (c) Macrologic S.A. Wszelkie prawa zastrzezone
 Wersja: 11.22
 Systemy: WYPOSAZ
{COMMENT-}
{PODTYTUL:='Wykonana w dniu: %1, na dzień: %2'@[$ODZAM.DATA,$ODZAM.DATA_W];~~}
{ PAR_WYDR.TITLE:='LISTA ZAPOTRZEBOWANIA MATERIAŁOWEGO NR %1'@[ODZAM.SYM];~~}
{COMMENT}Przygotowanie danych w tabeli tymczasowej{COMMENT-}
{ ODZAMPT.index('LTNR');ODZAMPT.prefix(ODZAM.ref());
  z1:=tab_tmp(2,'NAZWISKO','STRING[20]','Nazwisko'@
               ,'IMIE','STRING[15]','Imię'@
               ,'KTM','STRING[20]','Materiał'@
               ,'MNAZ','STRING[50]','Nazwa materiału'@
               ,'KOD','STRING[20]','Kod'@
               ,'NZ','STRING[50]','Nazwa'@
               ,'ROZMIAR','STRING[50]','Rozmiar'@
               ,'NAZ','STRING[40]','Nazwa'@
               ,'IL_W','REAL','Ilość'@
               ,'DATAZAM','DATE','Zamówić do'@
      );
  {? ODZAMPT.first() ||
    {! |?
      z1.NAZWISKO:=ODZAMPT.P().OSOBA().NAZWISKO;
      z1.IMIE:=ODZAMPT.P().OSOBA().PIERWSZE;
      z1.KOD:=ODZAMPT.MGRP().KOD;
      z1.NAZ:=ODZAMPT.MGRP().NAZ;
      z1.KTM:=ODZAMPT.M().KTM;
      z1.MNAZ:=ODZAMPT.M().N;
      z1.ROZMIAR:=ODZAMPT.DK_C().WAR01;
      exec('oblpt','wyp_zaopatrz');
      z1.IL_W:=ZZAOP.IL_W;
      z1.DATAZAM:=ZZAOP.DATAZAM;
      z1.add();
      ODZAMPT.next()
    !}
  ?};
~~}
{COMMENT}Okreslenie warunkow wydruku{COMMENT-}
{ select:=0;~~}
{COMMENT}---Definicja wiersza wydruku .{COMMENT-}
{PRN.add("lp+=1;form(lp,,0)",3,'Lp.'@,1); ~~}
{PRN.add("z1.NAZWISKO",20,'Nazwisko'@); ~~}
{PRN.add("z1.IMIE",15,'Imię'@); ~~}
{PRN.add("z1.KOD",10,'Podgrupa'@); ~~}
{PRN.add("z1.NAZ",40,'Nazwa podgrupy'@); ~~}
{PRN.add("z1.KTM",20,'Materiał'@); ~~}
{PRN.add("z1.MNAZ",40,'Nazwa materiału'@); ~~}
{COMMENT}{PRN.add("z1.ROZMIAR",50,'Rozmiar'@); ~~}{COMMENT-}
{PRN.add("form(z1.IL_W,10,2)",10,'Ilość'@,1); ~~}
{ z2:=z1.index('?');PODTYTUL:='';~~}
{INCLUDE: wsp_pw.rpi}
{INCLUDE: wyp_idruk01.rpi}
{FOR: z1}
{INDEX: z2}
{DO}
 {SUBSTITUTE: 'LINIA0'}
{OD}
{ obj_del(z1);~~}