:!UTF-8
{TITLE: Lista błędów}
{PRINTER: exec('prt','param_wydr','h',KST),,,,,'I','C',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   VAR_DEL.delete('Raport');
   PAR_WYDR.TITLE:='';
   Raport:=FUN.choice('Raport o błędach'@,0,'Brak karty'@,'Brak &kalendarza'@,'Przekroczona norma'@)
}
{END:
   VAR_DEL.delete('Raport')
}
{EXIT: ~Raport}
{COMMENT}OLD: w_bledy.rpm{COMMENT-}
{COMMENT}OLD: skid_pw.rpi{COMMENT-}
{COMMENT}OLD: std_info.rpi{COMMENT-}
{COMMENT}OLD: xkartpr.rpi{COMMENT-}
{COMMENT}OLD: xkalend.rpi{COMMENT-}
{COMMENT}OLD: xnorma.rpi{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{IF:  VAR_EDIT.win_edit('PRDN_DAT');
      VAR_EDIT.ROK:=date()~1;
      VAR_EDIT.MSC:=date()~2;
      VAR_EDIT.efld_opt('PRDN_DAT','mark=1',,'ROK');
      VAR_EDIT.efld_opt('PRDN_DAT','mark=1',,'MSC');
      VAR_EDIT.edit(
         "  _result:=__CHK.record(VAR_EDIT,,'ROK','MSC');
            {? _result='' & (VAR_EDIT.MSC<1 | VAR_EDIT.MSC>12)
            || FUN.emsg('Proszę podać porawną wartość w polu \"Miesiąc\".'@);
               _result:='MSC'
            ?};
            _result
         "
      )
}
   {  _Mask:=MASK.MaskZbio(VAR_EDIT.ROK,VAR_EDIT.MSC);
      {? R_ERRKAR.name<>('r_xa'+_Mask) || R_ERRKAR.use('r_xa'+_Mask) ?};
      {? R_ERRKAL.name<>('r_xb'+_Mask) || R_ERRKAL.use('r_xb'+_Mask) ?};
      {? R_ERRMAX.name<>('r_xc'+_Mask) || R_ERRMAX.use('r_xc'+_Mask) ?}; ~~
   }
   {IF: Raport=1}{INCLUDE: prc_bladkartpracy.rpi}{FI}
   {IF: Raport=2}{INCLUDE: prc_bladkalendarza.rpi}{FI}
   {IF: Raport=3}{INCLUDE: prc_bladnormyczasupracy.rpi}{FI}
{FI}