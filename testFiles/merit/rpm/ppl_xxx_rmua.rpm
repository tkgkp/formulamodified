:!UTF-8
{TITLE:PDF. RMUA - wzór ZUS}
{PRINTER:  exec('prt','param_wydr','v',KST),,,,,'m','c',,,,,,1,5,5,5,5,1,1}
{BEGIN:
   VAR_DEL.delete('__rmua','par','dp','dk','max','maxline','Text','hs6','bezpwych','exitKU','pFirma','pOsoba');
   P.cntx_psh();
   O_P.cntx_psh();
   O.cntx_psh();
   LS.cntx_psh();
   LS.index('PRACNRRU');
   KU.cntx_psh();
   KU.index('KARTAUB');
   KU.prefix(P.FIRMA,P.OSOBA,O.RU,O.MU);
   P.OSOBA();

   pFirma:=P.FIRMA;
   pOsoba:=P.OSOBA;
   dp:=date(O.RU,O.MU,1);
   dk:=date(O.RU,O.MU,0);
   max:=maxline:=hs6:=bezpwych:=exitKU:=0;
   Text:='';
   __rmua:=obj_new(10);
   {! _ii:=1..obj_len(__rmua) |! __rmua[_ii]:='' !};
   par:=obj_new(13);
   par[1]:=obj_new(20);
   par[2]:=obj_new(6);
   par[6]:=obj_new(8);
   par[10]:=obj_new(8);
   par[13]:=obj_new(6);
'ER/WRT/XP/23.25/2401/0059 - ER/WRT/XP/22.26/2401/0009';
'RMUA - urlop bezpłatny lub służba wojskowa cały miesiąc nie jest tworzony załącznik';
   {? ~KU.first()
   || _rubData:=date(O.R,O.M,0);
      N.cntx_psh();
      N.index('NIEOBECL');
      N.prefix('N',P.ref(),'TRANSFER');
      {? N.first()
      || {!
         |? {? N.OD<=dk & N.DO>=dp
            || {? ~__RUB.sys_attr(N.NB,112,_rubData) &
                  ~__RUB.sys_attr(N.NB,114,_rubData) &
                  ~__RUB.sys_attr(N.NB,1323,_rubData)
               || exitKU:=1
               ?}
            ?};
            N.next() & exitKU<>1
         !}
      ?};
      {? exitKU<>1
      || N.prefix('N',P.ref(),~O.LT);
         {? N.first()
         || {!
            |? {? N.OD<=dk & N.DO>=dp
               || {? ~__RUB.sys_attr(N.NB,112,_rubData) &
                     ~__RUB.sys_attr(N.NB,114,_rubData) &
                     ~__RUB.sys_attr(N.NB,124,_rubData) &
                     ~__RUB.sys_attr(N.NB,1321,_rubData) &
                     ~__RUB.sys_attr(N.NB,1322,_rubData) &
                     ~__RUB.sys_attr(N.NB,1323,_rubData)
                  || exitKU:=1
                  ?}
               ?};
               N.next() & exitKU<>1
            !}
         ?}
      ?};
      N.cntx_pop()
   ?}
}
{END:
   P.cntx_pop();
   O_P.cntx_pop();
   O.cntx_pop();
   LS.cntx_pop();
   KU.cntx_pop();
   VAR_DEL.delete('__rmua','par','dp','dk','max','maxline','Text','hs6','bezpwych','exitKU','pFirma','pOsoba')
}
{COMMENT}OLD: xxx_rmua.rpm{COMMENT-}
{COMMENT}OLD: xxx_rmua.rpi{COMMENT-}
{EXIT: exitKU}
{DEFINEFONT: 'H1=Arial,100,J,8'}
{DEFINEFONT: 'H2=Arial,100,I,8'}
{DEFINEFONT: 'I1='+PAR_WYDR.FONTW+',100,Q,8'}
{DEFINEFONT: 'I2='+PAR_WYDR.FONTW+',100,R,8'}
{DEFINEFONT: 'T1='+PAR_WYDR.FONTTAB+',100,I,8'}
{DEFINEFONT: 'T2='+PAR_WYDR.FONTTAB+',100,Q,8'}
{DEFINEFONT: 'T2B='+PAR_WYDR.FONTTAB+',100,R,8'}
{INCLUDE: p_xxx_rmua.rpi}

{FONT: 'm'}
{ maxline:=lineleft();
  max:=charleft();
~~ }
{FOOTER}
{FONT: 'T2'}{SPACE:'e'}────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
{IF: exec('getFile','podpis')<>''}
{<80}{BITMAP: '"'+exec('getFile','podpis')+'",,9'}{<80}┌───────────────────────────────────────────────────────────────────────────────┐
{ELSE}
{<80}┌───────────────────────────────────────────────────────────────────────────────┐
{FI}
{FONT: 'I1'}Nazwisko:             {FONT: 'I2'}{<30 OSOBA.NAZWISKO}         {FONT: 'T2'}{<80}│Podpis płatnika lub osoby upoważnionej oraz pieczątka adresowa płatnika        │
{FONT: 'I1'}Imię:                 {FONT: 'I2'}{<30 OSOBA.PIERWSZE}         {FONT: 'T2'}{<80}│                                                                               │
{FONT: 'I1'}Typ identyfikatora:   {FONT: 'I2'}{<30 __rmua[1]}              {FONT: 'T2'}{<80}│                                                                               │
{FONT: 'I1'}Identyfikator         {FONT: 'I2'}{<30 __rmua[2]}              {FONT: 'T2'}{<80}│                                                                               │
{FONT: 'I1'}Okres rozliczeniowy   {FONT: 'I2'}{<30 form(O.MU,-2)+$O.RU}    {FONT: 'T2'}{<80}│                                                                               │
{FONT: 'I1'}Kod oddziału NFZ      {FONT: 'I2'}{<30 __rmua[3]}              {FONT: 'T2'}{<80}│                                                                               │
                                                                                       {<80}└───────────────────────────────────────────────────────────────────────────────┘
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
{FOOTER-}
{ENTIRE}
{FONT: 'T2'}{SPACE:'e'}
┌────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│      ZAKŁAD UBEZPIECZEŃ        │    {FONT:'H2'}{SPACE:'B'}ZUS RMUA    RAPORT MIESIĘCZNY DLA OSOBY UBEZPIECZONEJ {FONT: 'T2'}{SPACE:'e'}                               │
│        SPOŁECZNYCH             │                                                                                                                             │
└────────────────────────────────┴─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

{FONT:'H1'}{SPACE:'B'}
I. DANE ORGANIZACYJNE
{FONT: 'I1'}{SPACE:'C'}Identyfikator raportu: {FONT: 'I2'}01/{form(O.MU,-2)}/{O.RU}

{FONT:'H1'}{SPACE:'B'}
II. DANE IDENTYFIKACYJNE PŁATNIKA SKŁADEK
{FONT: 'I1'}{SPACE:'C'}NIP:  {FONT: 'I2'}{<40 KST.NIP}  {FONT: 'I1'}{<80}Nazwisko:
REGON:                       {FONT: 'I2'}{<40 KST.REG}  {FONT: 'I1'}{<80}Imię:
PESEL:                                                              {<80}Nazwa skrócona płatnika składek: {FONT: 'I2'}{<120 KST.SKROT}

{FONT:'H1'}{SPACE:'B'}
III. DANE IDENTYFIKACYJNE OSOBY UBEZPIECZONEJ
{ {? exec('zn_ttub','pracownik',P.OSOBA,dk)
  || P_INFO.TPID();
     __rmua[1]:=exec('memo2print','#string',S_ZUS,'OPIS');
     __rmua[2]:={? P_INFO.TPID().KOD = '1' || OSOBA.DOWOD
                |? P_INFO.TPID().KOD = '2' || OSOBA.PASZPORT
                |? P_INFO.TPID().KOD = 'P' || OSOBA.PESEL
                |? P_INFO.TPID().KOD = 'N' || OSOBA.NIP
                ?};
     __rmua[3]:=P_INFO.KC().SYMBOL;
     __rmua[4]:=P_INFO.TTUB().KOD+P_INFO.PREM().KOD+P_INFO.STNP().KOD+' - ';
     P_INFO.TTUB();
     __rmua[4]+=exec('memo2print','#string',S_ZUS,'OPIS');
     P_INFO.PREM();
     __rmua[4]+=exec('memo2print','#string',S_ZUS,'OPIS');
     P_INFO.STNP();
     __rmua[4]+=exec('memo2print','#string',S_ZUS,'OPIS');
     H.cntx_psh();
     H.index('_HISTKOD');
     H.prefix(P.ref(),'Z');
     {? H.find_le(dk) || __rmua[5]:=form(H.RWYL,-3,0)+'/'+form(H.RWYM,-3,0) ?};
     H.cntx_pop();
     P_INFO.cntx_psh();
     P_INFO.index('OD');
     P_INFO.prefix(P.OSOBA);
     _stop:=0;
     {? P_INFO.last() & (P.ZA='T' | P.DZ>=dp)
     || {!
        |? {? P_INFO.BLOKADA<>#0 & P_INFO.BLOKADA~1=O.RU & P_INFO.BLOKADA<=dk
           || _stop:=1;
              {? P_INFO.BLWN<>null()
              || P_INFO.BLWN();
                 __rmua[6]:=exec('memo2print','#string',S_ZUS,'OPIS')
              ?}
           ?};
           P_INFO.prev() & ~_stop
        !}
     ?};
     P_INFO.cntx_pop();
     1
  ?};
  ~~
}
{FONT: 'I1'}{SPACE:'C'}Nazwisko:  {FONT: 'I2'}{<40 OSOBA.NAZWISKO}        {FONT: 'I1'}{<80}Typ identyfikatora:   {FONT: 'I2'}{<120 __rmua[1]}
Imię:                             {FONT: 'I2'}{<40 OSOBA.PIERWSZE}        {FONT: 'I1'}{<80}Identyfikator:        {FONT: 'I2'}{<120 __rmua[2]}

{FONT:'H1'}{SPACE:'B'}
IV.A ZESTAWIENIE NALEŻNYCH SKŁADEK NA UBEZPIECZENIA SPOŁECZNE I ZDROWOTNE
{FONT: 'I1'}{SPACE:'C'}Tytuł ubezpieczenia:
{ lmt:=charleft();~~}
{<1 STR.split(__rmua[4]); STR.line(lmt)}
{WHILE: STR.next()}{DO}{<1 STR.line(lmt)}{OD}

Informacja o przekroczeniu podstawy wymiaru składek na ubezpieczenia emerytalne i rentowe:    {<95 STR.split(__rmua[6]); STR.line(160-95)}
{WHILE: STR.next()}{DO}{<95 STR.line(160-95)}{OD}
Wymiar czasu pracy: {__rmua[5]}

{FONT: 'T2'}{SPACE:'C'}
┌─────────────────────────────────────────┬──────────────────────────────────────┬──────────────────────────────────────┬──────────────────────────────────────┐
│Ubezpieczenie                            │ Emerytalne i rentowe                 │ Chorobowe i wypadkowe                │ Zdrowotne                            │
├─────────────────────────────────────────┼──────────────────────────────────────┼──────────────────────────────────────┼──────────────────────────────────────┤
│Podstawa wymiaru składki                 │{>80 form(KU.S1,,2,'9.')            } │{>119 form(KU.S10,,2,'9.')          } │{>158 form(KU.S13,,2,'9.')          } │
├─────────────────────────────────────────┴──────────────────────────────┬───────┴──────────────────────────────┬───────┴──────────────────────────────────────┤
│Ubezpieczenie                                                           │   Emerytalne                         │  Rentowe                                     │
├────────────────────────────────────────────────────────────────────────┼──────────────────────────────────────┼──────────────────────────────────────────────┤
│Kwota składki finansowana przez ubezpieczonego                          │{>111 form(KU.S2,,2,'9.')           } │{>158  form(KU.S3,,2,'9.')                  } │
│Kwota składki finansowana przez płatnika                                │{>111 form(KU.S4,,2,'9.')           } │{>158  form(KU.S5,,2,'9.')                  } │
├─────────────────────────────────────────┬──────────────────────────────┴───────┬──────────────────────────────┴───────┬──────────────────────────────────────┤
│Ubezpieczenie                            │ Chorobowe                            │ Wypadkowe                            │ Zdrowotne                            │
├─────────────────────────────────────────┼──────────────────────────────────────┼──────────────────────────────────────┼──────────────────────────────────────┤
│Kwota składki                            │{>80 form(KU.S11,,2,'9.')           } │{>119 form(KU.S12,,2,'9.')          } │{>158 form(KU.S14,,2,'9.')          } │
└─────────────────────────────────────────┴──────────────────────────────────────┴──────────────────────────────────────┴──────────────────────────────────────┘
{FONT: 'I1'}{SPACE:'C'}
Kwota obniżenia podstawy na ubezpieczenia społeczne z tytułu
opłacenia składki w ramach pracowniczego programu emerytalnego:

Kwota wpłaty w ramach pracowniczego planu kapitałowego
finansowana przez płatnika składek:         {>80 form((KU.S31+KU.S32),,2,'9.')}                  {>128}Łączna kwota składek: {>158 form(KU.S2+KU.S3+KU.S4+KU.S5+KU.S11+KU.S12+KU.S14,,2,'9.')          }

{SUBSTITUTE: 'inf_ubezp'}
{FONT:'H1'}{SPACE:'B'}
VII. OŚWIADCZENIE PŁATNIKA SKŁADEK
{FONT: 'I1'}{SPACE:'C'}Data wypełnienia: {gsub(date()$4,'.','-')}

{ENTIRE-}
{FONT: 'T2'}{SPACE:'e'}
{DIRECT}
{IF: exec('getFile','podpis')<>''}
{<85}{BITMAP: '"'+exec('getFile','podpis')+'",,9'}
{FI}
{line(1);~~}
┌──────────────────────────────────────────────────────────────────────────────┬───────────────────────────────────────────────────────────────────────────────┐
{DIRECT-}
│Oświadczam, że dane zawarte w formularzu są zgodne ze stanem prawnym i        │Podpis płatnika lub osoby upoważnionej oraz pieczątka adresowa płatnika        │
│faktycznym. Jestem świadomy (-ma) odpowiedzialności karnej za zeznanie        │                                                                               │
│nieprawdy lub zatajenie prawdy.                                               │                                                                               │
│                                                                              │                                                                               │
│                                                                              │                                                                               │
│                                                                              │                                                                               │
└──────────────────────────────────────────────────────────────────────────────┴───────────────────────────────────────────────────────────────────────────────┘



