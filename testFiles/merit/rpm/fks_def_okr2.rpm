:!UTF-8
{TITLE: Okresy raportowania}
{PRINTER: exec('prt','param_wydr','v'),,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,
          PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN: PRN1:=obj_new(@.CLASS.PRINT,6); PRN1.s_frame(); prn1:='PRN1';
        lm:=ll:=lmt:=0; vp:=1; rsep:=PAR_WYDR.RSEP;
        OKRO_F.cntx_psh(); OSPR.cntx_psh() }
{END: VAR_DEL.delete('PRN1','prn1','rsep','lm','ll','lmt','vp');
      OKRO_F.cntx_pop(); OSPR.cntx_pop() }
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzezone
================================================================================
Nazwa pliku: def_okr2.rpm
System: IF
================================================================================
Zawartosc: Zestawienie okresow raportowania
{COMMENT-}
{ PRN1.add("OSPR.ROK().NAZ",4,'Rok'@);
  PRN1.add("OSPR.NAZWA",40,'Nazwa okresu'@);
  PRN1.add("OSPR.SKROT",6,'Skrót'@);
  PRN1.add("{? OSPR.TYP='K' || 'Kwartał'@
            |? OSPR.TYP='M' || 'Miesiąc'@
            |? OSPR.TYP='P' || 'Półrocze'@
            |? OSPR.TYP='R' || 'Rok'@ || 'Inny'@ ?}",10,'Typ okresu'@);
  PRN1.add("OSPR.OKRES_OD().NAZ",20,'Od okresu'@);
  PRN1.add("OSPR.OKRES_DO().NAZ",20,'Do okresu'@);
  PAR_WYDR.TITLE:='Okresy raportowania'@;
  lmt:=int((charleft()-PRN1.width())/2);~~}
{INCLUDE: wsp_pw.rpi}
{COMMENT}--------------------------SIGNATURE--------------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}---------------------------HEADER----------------------------{COMMENT-}
{HEADER}
{LINE: 1}
{FONT: 'HEAD'}{SUBSTITUTE: 'HEAD'}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}---------------------------FOOTER----------------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{FOOTER-}
{COMMENT}---------------------------WYDRUK----------------------------{COMMENT-}
{FOR: 'OSPR'}
{INDEX: 'ROK_NAZ'}
{PREFIX: REF.FIRMA}
{DO}
{SUBSTITUTE: 'LINIA0'}
{OD}
{FOOTER:0}
{FOOTER-}
{REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}
{LINE: 1}
{<{lmt}>{PRN1.width()} 'Koniec wydruku'@}
