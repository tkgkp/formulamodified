:!UTF-8
{TITLE:Wykaz zamienników}
{PRINTER: INFO.W_PRN,,,,,'E','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
      PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
  __ZAMEL.cntx_psh();
  PRN:=obj_new(@.CLASS.PRINT, 5);
  PRN.s_frame();
  prn1:='PRN';
  waslbar:=0;
  dalej:=0;
  color:='';
  lm:=ll:=vp:=lmt:=rsep:=0
}
{END:
  __ZAMEL.cntx_pop();
  obj_del(PRN);
  &dalej;
  &prn1;
  &color;
  &lm; &ll; &vp; &lmt; &rsep
}
{COMMENT}
  Wydruk zamiennikow surowca
   [MK] - 2003/02/11 - [8.10]
   Wywolanie: Produkcja->anaLiza wykonania->Pozycje->surOwce->Zamien surowiec
{COMMENT-}
{COMMENT}--Definicja wiersza wykazu zamienników.--------------------{COMMENT-}
{
PRN.add("__ZAMEL.KOD",20,'Kod surowca'@);
PRN.add("__ZAMEL.NAZWA",30,'Nazwa surowca'@);
PRN.add("__ZAMEL.ZE",11,'Zamiennik'@+' / '+'El. grupy'@);
PAR_WYDR.TITLE:='WYKAZ ZAMIENNIKÓW'@;~~}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T10'}{SPACE: 'B'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{FONT: 'T10B'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T10'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T10B'}{SPACE: 'B'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T10'}{SPACE: 'B'}
{ rsep:=PAR_WYDR.RSEP; ~~}
{__ZAMEL.prefix(); ~~}
{IF: __ZAMEL.first()}{ dalej:=1; ~~}{FI}
{WHILE: dalej}
{DO}
    {SUBSTITUTE: 'LINIA0'}
   { dalej:=__ZAMEL.next(); ~~}
{OD}
