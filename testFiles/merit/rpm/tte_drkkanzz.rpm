:!UTF-8
{TITLE:Porównanie kalkulacji zlecenia}
{PRINTER: INFO.W_PRN,,,,,'E','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
      PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   ANZH.cntx_psh();
   ANZTTO.cntx_psh();
   ANZMAT.cntx_psh();
   __ANZP.cntx_psh();
   M.clear();
   dalej:=0;
   VAR_DEL.delete('PRN','PRNNAG','PRNCONS','PRNFORM','PRNMAT','__PRNMAT','PRNWRK','__PRNWRK','PRNUSL','__PRNUSL','PRNNAR','__PRNNAR','TABEDIT');
   PRN:=obj_new(@.CLASS.PRINT,4);
   PRN.s_frame();
   PRNCONS:=obj_new(@.CLASS.PRINT, 6); PRNCONS.s_frame();
   PRNFORM:=obj_new(@.CLASS.PRINT, 6); PRNFORM.s_frame();
   PRNNAG:=obj_new(@.CLASS.PRINT, 6); PRNNAG.s_frame();
   PRNMAT:=obj_new(@.CLASS.PRINT,8);
   PRNMAT.s_frame();
   __PRNMAT:=tab_tmp(2,
      'KOD','STRING[15]','Kod surowca',
      'NAZ','STRING[30]','Opis suowca',
      'CENA','REAL','Cena surowca',
      'CENA1','REAL','Cena surowca',
      'POCH','STRING[11]','Pochodzenie',
      'POCH1','STRING[11]','Poch1',
      'TKTLNRK','STRING[20]','tech1',
      'TKTL1NRK','STRING[20]','tech2',
      'TKTLWER','STRING[6]','wer1',
      'TKTL1WER','STRING[6]','wer2'
      );
   PRNWRK:=obj_new(@.CLASS.PRINT, 6); PRNWRK.sl_frame();
   __PRNWRK:=tab_tmp(2,
      'KOD','STRING[10]','Kod stanowiska',
      'NAZWA','STRING[60]','Nazwa stanowiska',
      'KH','REAL','Koszt godziny',
      'KH1','REAL','Koszt godziny');
   PRNUSL:=obj_new(@.CLASS.PRINT, 6); PRNUSL.sl_frame();
   __PRNUSL:=tab_tmp(2,
      'KOD','STRING[10]','Kod stanowiska',
      'NAZWA','STRING[60]','Nazwa stanowiska',
      'WAR','REAL','Koszt godziny',
      'WAR1','REAL','Koszt godziny');
   PRNNAR:=obj_new(@.CLASS.PRINT, 6); PRNNAR.sl_frame();
   __PRNNAR:=tab_tmp(2,
      'KOD','STRING[10]','Kod stanowiska',
      'NAZWA','STRING[60]','Nazwa stanowiska',
      'WAR','REAL','Koszt godziny',
      'WAR1','REAL','Koszt godziny');
   prn1:='PRN';
   color:='';
   pkalmat:=pcons:=pform:=pkalus:=pkalna:=pkalst:=0;
   lm:=ll:=vp:=lmt:=rsep:=0;
   ndx_tmp:=ANZP.ndx_tmp(,1,'NRA',,0,'RUBR','NR',0)
}
{END:
   ANZH.cntx_pop();
   ANZTTO.cntx_pop();
   ANZMAT.cntx_pop();
   __ANZP.cntx_pop();
   VAR_DEL.delete('PRN','PRNNAG','PRNCONS','PRNFORM','PRNMAT','__PRNMAT','PRNWRK','__PRNWRK','PRNUSL','__PRNUSL','PRNNAR','__PRNNAR','TABEDIT');
   &dalej;
   &pkalmat;
   &pcons;
   &pform;
   &pkalus;
   &pkalna;
   &pkalst;
   &prn1;
   &color;
   &lm; &ll; &vp; &lmt; &rsep;
   ANZP.ndx_drop(ndx_tmp)
}
  {TABEDIT:=tab_tmp(
     ,'KCONS','STRING[1]','Stałe kalkulacji'@
     ,'KFORM','STRING[1]','Formuły użyte w kalkulacji'@
     ,'KALMAT','STRING[1]','Cennik pobranych surowców'@
     ,'KALUS','STRING[1]','Lista stawek usług'@
     ,'KALST','STRING[1]','Lista kosztów stanowisk'@
     ,'KALNA','STRING[1]','Lista kosztów NPU'@
   );
   _wydr_naz:='drkkanzz';
   WYDRUKIL.index('WYDRUKI');
   WYDRUKIL.prefix(OPERATOR.USER().KOD,_wydr_naz);
   {? ~WYDRUKIL.first()
   || WYDRUKIL.blank();
      WYDRUKIL.USERS:=OPERATOR.USER().KOD;
      WYDRUKIL.WYDRUK:=_wydr_naz;
      WYDRUKIL.add();
      TABEDIT.KFORM:=TABEDIT.KCONS:=TABEDIT.KALST:=TABEDIT.KALUS:=TABEDIT.KALNA:=TABEDIT.KALMAT:='T'
   || TABEDIT.KFORM:=WYDRUKIL.OD_STR;
      TABEDIT.KCONS:=WYDRUKIL.DO_STR;
      TABEDIT.KALST:=WYDRUKIL.FAKUM;
      TABEDIT.KALUS:=WYDRUKIL.SR;
      TABEDIT.KALNA:=WYDRUKIL.STANZAM;
      TABEDIT.KALMAT:=WYDRUKIL.FAK
   ?};
   _red:=TABEDIT.mk_edit('Wydruk kartotek stowarzyszonych'@,0,'tabedit1');
   TABEDIT.win_efld(_red,,'KCONS',,,,,,,,,'check-box',,"'T'","'N'");
   TABEDIT.win_efld(_red,,'KFORM',,,,,,,,,'check-box',,"'T'","'N'");
   TABEDIT.win_efld(_red,,'KALMAT',,,,,,,,,'check-box',,"'T'","'N'");
   TABEDIT.win_efld(_red,,'KALUS',,,,,,,,,'check-box',,"'T'","'N'");
   TABEDIT.win_efld(_red,,'KALST',,,,,,,,,'check-box',,"'T'","'N'");
   TABEDIT.win_efld(_red,,'KALNA',,,,,,,,,'check-box',,"'T'","'N'");
   TABEDIT.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=end'['&Zapisz'@],"'key:F2'");
   TABEDIT.win_ebtn(_red,'text=%1,btn_label_align=center,panel=bottom,align=end'['&Anuluj'@],"'key:Esc'");
   TABEDIT.win_edit(_red);
   ~~}
   {IF: TABEDIT.edit()}
    { WYDRUKIL.OD_STR:=TABEDIT.KFORM;
      WYDRUKIL.DO_STR:=TABEDIT.KCONS;
      WYDRUKIL.FAKUM:=TABEDIT.KALST;
      WYDRUKIL.SR:=TABEDIT.KALUS;
      WYDRUKIL.STANZAM:=TABEDIT.KALNA;
      WYDRUKIL.FAK:=TABEDIT.KALMAT;
      WYDRUKIL.put(1);
      pcons:=(-TABEDIT.KCONS='t');
      pform:=(-TABEDIT.KFORM='t');
      pkalmat:=(-TABEDIT.KALMAT='t');
      pkalus:=(-TABEDIT.KALUS='t');
      pkalst:=(-TABEDIT.KALST='t');
      pkalna:=(-TABEDIT.KALNA='t');
      ~~}
   {ELSE}
      {EXIT}
   {FI}
{COMMENT}
  Wydruk porownania kalkulacji zlecenia.
  [MKO] - 2003/02/28 - [8.10]
  Wywolanie: Produkcja -> Zlecenia -> kalkulacje -> TEN
             -> Porownanie->TEN  -> drukuJ
{COMMENT-}
{COMMENT}---Definicja wiersza wydruku pozycji porownania kalkulacji.{COMMENT-}
{  PRNNAG.add("nr",5,'Nr kalk.'@,1);
   PRNNAG.add("dk",10,'Data kalkulacji'@,1);
   PRNNAG.add("akt",7,'Aktywna'@,1);
   PRNNAG.add("war",13,'Wariant kalkulacji'@,1);
   PRN.add("form(__ANZP.NR,,0,'9')",8,'Nr rubr.'@,1);
   PRN.add("__ANZP.OPIS",30,'Opis rubryki'@);
   PRN.add("form(__ANZP.WART1,,2)",15,'Wart. stara'@,1);
   PRN.add("form(__ANZP.WART,,2)",15,'Wartość nowa'@,1);
   PRNMAT.add("__PRNMAT.KOD",10,'Kod surowca'@);
   PRNMAT.add("__PRNMAT.NAZ",15,'Nazwa surowca'@);
   PRNMAT.add("form(__PRNMAT.CENA,,2)",6,'Cena stara'@,1);
   PRNMAT.add("form(__PRNMAT.CENA1,,2)",6,'Cena nowa'@,1);
   PRNMAT.add("__PRNMAT.POCH",5,'Poch. stara'@);
   PRNMAT.add("__PRNMAT.POCH1",5,'Poch. nowa'@);
   PRNMAT.add("__PRNMAT.TKTLNRK+' '+__PRNMAT.TKTLWER",15,'Technologia'@);
   PRNMAT.add("__PRNMAT.TKTL1NRK+' '+__PRNMAT.TKTL1WER",15,'Techn. por.'@);
   PRNCONS.add("form(__ANKON.NR,,0,'9')",5,'Rubr.'@,1);
   PRNCONS.add("__ANKON.OPIS",30,'Opis'@);
   PRNCONS.add("form(ANKON.WAR,,2)",12,'Wartość stara'@,1);
   PRNCONS.add("form(__ANKON.WAR,,2)",12,'Wartość nowa'@,1);
   PRNFORM.add("form(__AFORM.NR,,0,'9')",5,'Rubr.'@,1);
   PRNFORM.add("AFORM.FRM",30,'Formuła stara'@);
   PRNFORM.add("__AFORM.FORM",30,'Formuła nowa'@);
   PRNWRK.add("__PRNWRK.KOD",10,'Kod operacji'@);
   PRNWRK.add("__PRNWRK.NAZWA",60,'Nazwa operacji'@);
   PRNWRK.add("form(__PRNWRK.KH,,2)",15,'Koszt godziny stary'@,1);
   PRNWRK.add("form(__PRNWRK.KH1,,2)",15,'Koszt godziny nowy'@,1);
   PRNUSL.add("__PRNUSL.KOD",10,'Kod operacji'@);
   PRNUSL.add("__PRNUSL.NAZWA",60,'Nazwa operacji'@);
   PRNUSL.add("form(__PRNUSL.WAR,,2)",15,'Stawka stara'@,1);
   PRNUSL.add("form(__PRNUSL.WAR1,,2)",15,'Stawka nowa'@,1);
   PRNNAR.add("__PRNNAR.KOD",10,'Kod operacji'@);
   PRNNAR.add("__PRNNAR.NAZWA",60,'Nazwa operacji'@);
   PRNNAR.add("form(__PRNNAR.WAR,,2)",15,'Koszt stary'@,1);
   PRNNAR.add("form(__PRNNAR.WAR1,,2)",15,'Koszt nowy'@,1);
   PAR_WYDR.TITLE:='PORÓWNANIE KALKULACJI ZLECENIA'@; ~~}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8'}{SPACE: 'B'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{<{lmt+1} 'PARAMETRY WYDRUKU:'@}
{<{lmt+1} 'Nr kalkulacji:'@} {<{lmt+15} form(ANZH.NRA)}
{<{lmt+1} 'Zlecenie:'@}   {<{lmt+15} ANZH.ZLEC().SYM}
{<{lmt+1} 'Wariant:'@}    {<{lmt+15} ANZH.OPC().NA}
{FONT: 'T8B'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------MACRO-----------------------{COMMENT-}
{MACRO: 'prnmat'}
{  ANZMAT.index('ASN');
   ANZMAT.prefix(VAR.A_ANZH);
   {? ANZMAT.first()
   || {!
      |? __PRNMAT.KOD:=ANZMAT.T().KTM;
         __PRNMAT.NAZ:=ANZMAT.T().N;
         __PRNMAT.CENA:=ANZMAT.PRICE;
         __PRNMAT.CENA1:=0;
         __PRNMAT.POCH:=ANZMAT.POCH;
         __PRNMAT.POCH1:='';
         __PRNMAT.TKTLNRK:={? ANZMAT.TKTL<>null() || ANZMAT.TKTL().NRK || '' ?};
         __PRNMAT.TKTL1NRK:='';
         __PRNMAT.TKTLWER:={? ANZMAT.TKTL<>null() || ANZMAT.TKTL().WER || '' ?};
         __PRNMAT.TKTL1WER:='';
         __PRNMAT.add();
         ANZMAT.next()
      !}
   ?};
  {? type_of(ANZ.anm.M)<>1
  ||
     _il:=obj_len(ANZ.anm.M);
     {! _i:=1.._il
     |! {? M.seek(ANZ.anm.M[_i])
        || {? ANZ.anm.T[_i]<>null
           || TKTL.prefix();
              {? TKTL.seek(ANZ.anm.T[_i])
              || _nrk:=TKTL.NRK; _wer:=TKTL.WER
              || _nrk:=_wer:=''
              ?}
           || _nrk:=_wer:=''
           ?};
           __PRNMAT.prefix(M.KTM);
           {? __PRNMAT.first
           || __PRNMAT.CENA1:=ANZ.anm.P[_i];
              __PRNMAT.POCH1:=ANZ.anm.S[_i];
              __PRNMAT.TKTL1NRK:=_nrk;
              __PRNMAT.TKTL1WER:=_wer;
              __PRNMAT.put
           || __PRNMAT.KOD:=M.KTM;
              __PRNMAT.NAZ:=M.N;
              __PRNMAT.CENA1:=ANZ.anm.P[_i];
              __PRNMAT.CENA:=0;
              __PRNMAT.POCH1:=ANZ.anm.S[_i];
              __PRNMAT.POCH:='';
              __PRNMAT.TKTL1NRK:=_nrk;
              __PRNMAT.TKTLNRK:='';
              __PRNMAT.TKTL1WER:=_wer;
              __PRNMAT.TKTLWER:='';
              __PRNMAT.add
           ?}
        ?}
     !}
  ?}
;~~}
{MACRO-}
{MACRO: 'prnwrk'}
{ ANZWRK.index('AP');
  ANZWRK.prefix(VAR.A_ANZH);
  {? ANZWRK.first
  || {! |?
      __PRNWRK.KOD:=ANZWRK.PLACE().KOD;
      __PRNWRK.NAZWA:=ANZWRK.PLACE().NA;
      __PRNWRK.KH:=ANZWRK.KH;
      __PRNWRK.KH1:=0;
      __PRNWRK.add;
      ANZWRK.next
     !}
  ?};
  {? type_of(ANZ.anw.M)<>1
  ||
     TWRKPLC.clear();
     _il:=obj_len(ANZ.anw.M);
     {! _i:=1.._il |!
        {? TWRKPLC.seek(ANZ.anw.M[_i])
        || __PRNWRK.prefix(TWRKPLC.KOD,TWRKPLC.NA);
           {? __PRNWRK.first
           || __PRNWRK.KH1:=ANZ.anw.P[_i];
              __PRNWRK.put
           || __PRNWRK.KOD:=TWRKPLC.KOD;
              __PRNWRK.NAZWA:=TWRKPLC.NA;
              __PRNWRK.KH1:=ANZ.anw.P[_i];
              __PRNWRK.KH:=0;
              __PRNWRK.add
           ?}
        ?}
     !}
  ?}
;~~}
{MACRO-}
{MACRO: 'prnusl'}
{ ANZTOU.index('AT');
  ANZTOU.prefix(VAR.A_ANZH);
  {? ANZTOU.first
  || {! |?
      __PRNUSL.KOD:=ANZTOU.TTOUT().KOD;
      __PRNUSL.NAZWA:=ANZTOU.TTOUT().NA;
      __PRNUSL.WAR:=ANZTOU.CENA;
      __PRNUSL.WAR1:=0;
      __PRNUSL.add;
      ANZTOU.next
     !}
  ?};
  {? type_of(ANZ.ano.M)<>1
  ||
     TTOUT.clear();
     _il:=obj_len(ANZ.ano.M);
     {!_i:=1.._il |!
        {? TTOUT.seek(ANZ.ano.M[_i])
        || __PRNUSL.prefix(TTOUT.KOD,TTOUT.NA);
           {? __PRNUSL.first
           || __PRNUSL.WAR1:=ANZ.ano.P[_i];
              __PRNUSL.put
           || __PRNUSL.KOD:=TTOUT.KOD;
              __PRNUSL.NAZWA:=TTOUT.NA;
              __PRNUSL.WAR1:=ANZ.ano.P[_i];
              __PRNUSL.WAR:=0;
              __PRNUSL.add
           ?}
        ?}
     !}
  ?}
;~~}
{MACRO-}
{MACRO: 'prnnar'}
{ ANZTLS.index('AT');
  ANZTLS.prefix(VAR.A_ANZH);
  {? ANZTLS.first
  || {! |?
      __PRNNAR.KOD:=ANZTLS.M().KTM;
      __PRNNAR.NAZWA:=ANZTLS.M().N;
      __PRNNAR.WAR:=ANZTLS.KOSZT;
      __PRNNAR.WAR1:=0;
      __PRNNAR.add;
      ANZTLS.next
     !}
  ?};
  {? type_of(ANZ.anu.M)<>1
  ||
     M.clear();
     _il:=obj_len(ANZ.anu.M);
     {! _i:=1.._il |!
        {? M.seek(ANZ.anu.M[_i])
        || __PRNNAR.prefix(M.KTM,M.N);
           {? __PRNNAR.first
           || __PRNNAR.WAR1:=ANZ.anu.P[_i];
              __PRNNAR.put
           || __PRNNAR.KOD:=M.KTM;
              __PRNNAR.NAZWA:=M.N;
              __PRNNAR.WAR1:=ANZ.anu.P[_i];
              __PRNNAR.WAR:=0;
              __PRNNAR.add
           ?}
        ?}
     !}
  ?}
;~~}
{MACRO-}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8'}{SPACE: 'B'}
{ rsep:=PAR_WYDR.RSEP; ~~}
{lmt:=int((charleft()-PRN.width())/2); ~~}
{ANZP.prefix(); ~~}
{IF: __ANZP.first()}{ dalej:=1; ~~}
{WHILE: dalej}
{DO}
     {IF: lineleft > 10} {SUBSTITUTE: 'LINIA0'}
   {ELSE}{SUBSTITUTE: 'LINIAF'}{PAGE}{FONT: 'T8B'}{SPACE:'B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}{SUBSTITUTE: 'LINIA0'}
   {FI}
   { dalej:=__ANZP.next(); ~~}
{OD}
 {SUBSTITUTE: 'LINIAF'}
{FI}
{IF: pkalmat}
{<1  lk:=charleft();prn1:='PRNMAT'; ~~}
{ lmt:=int((charleft()-PRNMAT.width())/2); ~~}
{IF: lineleft<14}{PAGE}{FI}

{<1>{lk}'LISTA CEN SUROWCÓW POBRANYCH DO KALKULACJI ZLECENIA'@}
{FONT: 'T8B'}{SPACE: 'B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}
{SUBSTITUTE: 'prnmat'}
{__PRNMAT.prefix();~~}
{IF: __PRNMAT.first()}{dalej:=1; ~~}
{WHILE: dalej}
{DO}
     {IF: lineleft > 10} {SUBSTITUTE: 'LINIA0'}
   {ELSE}{SUBSTITUTE: 'LINIAF'}{PAGE}{FONT: 'T8B'}{SPACE:'B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}{SUBSTITUTE: 'LINIA0'}
   {FI}
 { dalej:=__PRNMAT.next(); ~~}
{OD}
 {SUBSTITUTE: 'LINIAF'}
{FI}
{FI}
{IF: pform}
{<1  lk:=charleft();prn1:='PRNFORM';lmt:=int((charleft()-PRNFORM.width())/2); ~~}
{IF: lineleft<14}{PAGE}{FI}

{<1>{lk}'FORMUŁY KALKULACJI ZLECENIA'@}
  {FONT: 'T8B'}{SPACE: 'B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}
  {__AFORM.prefix(); ~~}
  {IF: __AFORM.first()}
{ dalej:=1;  ~~}{FI}
  {WHILE: dalej}
  {DO}
    {AFORM.clear();AFORM.seek(__AFORM.REF,'aformsrv');~~}
      {IF: lineleft > 10} {SUBSTITUTE: 'LINIA0'}
   {ELSE}{SUBSTITUTE: 'LINIAF'}{PAGE}{FONT: 'T8B'}{SPACE:'B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}{SUBSTITUTE: 'LINIA0'}
   {FI}
    { dalej:=__AFORM.next(); ~~}
  {OD}
   {SUBSTITUTE: 'LINIAF'}
{FI}
{IF: pcons}
{<1  lk:=charleft(); prn1:='PRNCONS';lmt:=int((charleft()-PRNCONS.width())/2); ~~}
{IF: lineleft<14}{PAGE}{FI}

{<1>{lk}'STAŁE KALKULACJI ZLECENIA'@}
 {FONT: 'T8B'}{SPACE: 'B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}
  {__ANKON.prefix(); ~~}
  {IF: __ANKON.first()}
{ dalej:=1; ~~}{FI}
  {WHILE: dalej}
  {DO}
    {ANKON.clear();ANKON.seek(__ANKON.REF,'ankonst');~~}
        {IF: lineleft > 10} {SUBSTITUTE: 'LINIA0'}
   {ELSE}{SUBSTITUTE: 'LINIAF'}{PAGE}{FONT: 'T8B'}{SPACE:'B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}{SUBSTITUTE: 'LINIA0'}
   {FI}
    { dalej:=__ANKON.next(); ~~}
  {OD}
   {SUBSTITUTE: 'LINIAF'}
{FI}
{IF: pkalst}
  {SUBSTITUTE: 'prnwrk'}
  {__PRNWRK.prefix(); ~~}
  {IF: __PRNWRK.first()}
{ dalej:=1; prn1:='PRNWRK'; lmt:=int((charleft()-PRNWRK.width())/2); ~~}{FI}
{FONT: 'W10'}{SPACE: 'A'}
{<1  lk:=charleft(); ~~}
{IF: lineleft<14}{PAGE}{FI}

{<1>{lk} 'LISTA KOSZTÓW STANOWISK POBRANYCH DO KALKULACJI ZLECENIA'@}
{FONT: 'T8B'}{SPACE: 'B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}
  {WHILE: dalej}
  {DO}
     {IF: lineleft > 10} {SUBSTITUTE: 'LINIA0'}
   {ELSE}{SUBSTITUTE: 'LINIAF'}{PAGE}{FONT: 'T8B'}{SPACE:'B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}{SUBSTITUTE: 'LINIA0'}
   {FI}
    { dalej:=__PRNWRK.next(); ~~}
  {OD}
  {SUBSTITUTE: 'LINIAF'}
{FI}
{IF: pkalus}
  {SUBSTITUTE: 'prnusl'}
  {__PRNUSL.prefix(); ~~}
  {IF: __PRNUSL.first()}
{ dalej:=1; prn1:='PRNUSL'; lmt:=int((charleft()-PRNUSL.width())/2); ~~}{FI}
{FONT: 'W10'}{SPACE: 'A'}
{<1  lk:=charleft(); ~~}
{IF: lineleft<14}{PAGE}{FI}


{<1>{lk} 'LISTA STAWEK USŁUG POBRANYCH DO KALKULACJI ZLECENIA'@}
{FONT: 'T8B'}{SPACE: 'B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}
  {WHILE: dalej}
  {DO}
     {IF: lineleft > 10} {SUBSTITUTE: 'LINIA0'}
   {ELSE}{SUBSTITUTE: 'LINIAF'}{PAGE}{FONT: 'T8B'}{SPACE:'B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}{SUBSTITUTE: 'LINIA0'}
   {FI}
    { dalej:=__PRNUSL.next(); ~~}
  {OD}
  {SUBSTITUTE: 'LINIAF'}
{FI}
{IF: pkalna}
  {SUBSTITUTE: 'prnnar'}
  {__PRNNAR.prefix(); ~~}
  {IF: __PRNNAR.first()}
{ dalej:=1; prn1:='PRNNAR'; lmt:=int((charleft()-PRNNAR.width())/2); ~~}{FI}
{FONT: 'W10'}{SPACE: 'A'}
{<1  lk:=charleft(); ~~}
{IF: lineleft<14}{PAGE}{FI}


{<1>{lk} 'LISTA KOSZTÓW NPU POBRANYCH DO KALKULACJI ZLECENIA'@}
{FONT: 'T8B'}{SPACE: 'B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}
  {WHILE: dalej}
  {DO}
     {IF: lineleft > 10} {SUBSTITUTE: 'LINIA0'}
   {ELSE}{SUBSTITUTE: 'LINIAF'}{PAGE}{FONT: 'T8B'}{SPACE:'B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}{SUBSTITUTE: 'LINIA0'}
   {FI}
    { dalej:=__PRNNAR.next(); ~~}
  {OD}
  {SUBSTITUTE: 'LINIAF'}
{FI}
