:!UTF-8
{TITLE: Polecenie wydania wyposażenia}
{PRINTER: INFO.W_PRN,,,,,'E','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
      PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
  PRN:=obj_new(@.CLASS.PRINT,9); PRN.s_frame();
  M.cntx_psh();
  M.clear();
  kreska:='─';
  prn1:='PRN';
  lp:=0;
  select:=0;
  dalej:=0;
  width:=80;
  color:='';
  lm:=ll:=vp:=lmt:=rsep:=0;
  VAR_DEL.delete('czas_w','toler_w');
  czas_w:=4;
  toler_w:=4;
  PWOPOZ.cntx_psh();
  PWOPOZ.index('PRODZO');
  PWOPOZ.prefix(POLWO.ref());
  {? PWOPOZ.first()
  || {!
     |?
        {? (+form(PWOPOZ.CZAS))>czas_w   || czas_w:=(+form(PWOPOZ.CZAS))  ?};
        {? (+form(PWOPOZ.TOLER))>toler_w || toler_w:=(+form(PWOPOZ.TOLER)) ?};
        PWOPOZ.next()
     !}
  ?};
  PWOPOZ.cntx_pop()
}
{END:
  obj_del(PRN);
  M.cntx_pop();
  &kreska;&width;
  &lp;
  &select;&dalej;
  &prn1;
  &color;
  &lm; &ll; &vp; &lmt; &rsep;
  VAR_DEL.delete('czas_w','toler_w')
}
{COMMENT}
 (c) Macrologic S.A. Wszelkie prawa zastrzezone
 Wersja: 12.10
 Autor: Waldemar Werbiński
 Systemy: WYPOSAZ
{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{"---Definicja wiersza wydruku ."; ~~}
{PRN.add("lp+=1;form(lp,,0)",3,'Lp.'@,1); ~~}
{PRN.add("PWOPOZ.MGRP().KOD",8,'Kod'@); ~~}
{PRN.add("PWOPOZ.MGRP().NAZ",30,'Nazwa'@); ~~}
{COMMENT}{PRN.add("M.J().KOD",5,'Jm'@); ~~}{COMMENT-}
{PRN.add("form(PWOPOZ.IL,10,2)",10,'Ilość'@,1); ~~}
{PRN.add("form(PWOPOZ.CZAS)",czas_w,'czas'@,1); ~~}
{PRN.add("form(PWOPOZ.TOLER)",toler_w,'±'@,1); ~~}
{PRN.add("PWOPOZ.ZWROT",5,'Zwrot'@,1); ~~}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{PAR_WYDR.TITLE:='POLECENIE WYDANIA WYPOSAŻENIA'@;~~}
{MACRO: 'TOP'}
{FONT: 'T8G'}{SPACE: 'B'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{ width:=charleft(); ~~}
{<{1} XINFO.NAZ}{>{width} OPERATOR.USER().DANE+' '+PAR_WYDR.MIEJSC+' dn. '+$date()}

{<{lmt+1} PAR_WYDR.TITLE}
{<{lmt+1} 'Dla:'}{<{lmt+6} exec('osoba_npd','wyp',POLWO.P().OSOBA)}
{<{lmt+6} 'Zatrudn.: %1'@[exec('set_p_info','wyp',POLWO.P)]}
{MACRO-}
{SUBSTITUTE: 'TOP'}

{FONT: 'T8G'}
{<1 'Symbol:'@}{<20 POLWO.SYM}{>{width} 'Data wystawienia:'@+' '+$POLWO.DATA}
{<1 'Wystawił:'@}{<20 POLWO.USER().DANE}{>{width} 'Data wydania:'@+' '+$POLWO.DATA_W}
{<1 'Stan:'@}{<20 {? POLWO.AKCEPT='T' || 'ZAAKCEPTOWANE'@ || 'NIEZAAKCEPTOWANE'@ ?}
}{>{width} 'Wygenerowane:'@+' '+{? POLWO.DATA_G<>date(0,0,0) || $POLWO.DATA_G || 'niewykorzystane'@ ?}}

{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'TOP'}
{FONT: 'T8GB'}{SPACE: 'B'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'B'}
{rsep:=PAR_WYDR.RSEP; ~~}
{FOR: 'PWOPOZ'}
{INDEX: 'PRODZOK'}
{PREFIX: POLWO.ref()}
{DO}
 {M.seek(PWOPOZ.RODZO().M,);~~}
 {SUBSTITUTE: 'LINIA0'}
{OD}