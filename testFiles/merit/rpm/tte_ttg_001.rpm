:!UTF-8
{TITLE:Grupy technologiczne}
{PRINTER: INFO.W_PRN,,,,,'E','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
      PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   TTG.cntx_psh;
   TTGP.cntx_psh;
   druk:=wybor:=wybor1:=lp:=0;
   PRN:=obj_new(@.CLASS.PRINT,5);
   PRN.s_frame();
   prn1:='PRN';
   color:='';tytul:='';
   lm:=ll:=vp:=lmt:=rsep:=0
}
{END:
   TTG.cntx_pop;
   TTGP.cntx_pop;
   &druk;
   &wybor;
   &lp;
   &wybor1;
   obj_del(PRN);
   &prn1;
   &color;&tytul;
   &lm; &ll; &vp; &lmt; &rsep
}
{wybor:=FUN.ask('Czy drukować pozycje grup technologicznych?'@);
{? wybor || wybor1:=FUN.ask('Czy drukować wszystkie grupy technologiczne?'@) ?};
~~}
{COMMENT}
  Wydruk tabeli grup technologicznych.
  [MKO] - 2002/03/26 - [7.53]
  Wywołanie: Grupy technologiczne (z poziomu rejestrowania surowców karty technologicznej) -> Drukuj
{COMMENT-}
{COMMENT}--Definicja wiersza wydruku grup technologicznych.--{COMMENT-}
{
{? wybor=0
||
    PRN.add("form(lp)",5,'Lp.'@,1);
    PRN.add("TTG.GR",10,'Grupa'@);
    PRN.add("TTG.OPIS",40,'Opis'@)
||
    PRN.add("form(lp)",5,'Lp.'@,1);
    PRN.add("TTGP.PT().KTM",20,'Kod'@);
    PRN.add("TTGP.PT().N",40,'Nazwa'@)
?};
  PAR_WYDR.TITLE:='GRUPY TECHNOLOGICZNE'@;
~~}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T10'}{SPACE: 'B'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{IF: wybor=0}
{FONT: 'T10B'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T10'}{ vp:=1; ~~}
{FI}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{IF: wybor=0}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T10B'}{SPACE: 'B'}
{SUBSTITUTE: 'TABHEAD'}
{FI}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{IF: wybor=0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FI}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{FONT: 'T10'}{SPACE: 'B'}
{ rsep:=PAR_WYDR.RSEP;druk:=0; ~~}
{IF: wybor=0}
  {FOR: TTG}
  {INDEX: 'GR'}
  {DO}
     {lp+=1;~~}
     {SUBSTITUTE: 'LINIA0'}
  {OD}
{ELIF: wybor1=0}
  {FOR: TTG}
  {INDEX: 'GR'}
  {SELECT}
  {DO}
     {FOR: TTGP}
     {INDEX: 'GRS'}
     {PREFIX: TTG.ref}
     {DO}
        {FIRST}
             {IF: lineleft < 7}{PAGE}{FI}
             {<{lmt+1} 'GRUPA:'@}{<{lmt+6} TTG.GR+' '+TTG.OPIS}
             {FONT:'T10B'}
             {SUBSTITUTE: 'TABHEAD'}{FONT: 'T10'}{ vp:=1;druk:=1;lp:=0; ~~}
       {FIRST-}
       {IF: lineleft > 7}
             {lp+=1;~~}
             {SUBSTITUTE: 'LINIA0'}
       {ELSE}
             {SUBSTITUTE: 'LINIAF'}
             {PAGE}
             {FONT: 'T10B'}
             {SUBSTITUTE: 'TABHEAD'}
             {FONT: 'T10'}{ vp:=1;lp+=1; ~~}
             {SUBSTITUTE: 'LINIA0'}
       {FI}
       {TOTAL}
           {IF: druk=1}
               {SUBSTITUTE: 'LINIAF'}
               {druk:=0;~~}
           {FI}
   {OD}
{OD}
{ELSE}
  {FOR: TTG}
  {INDEX: 'GR'}
  {DO}
     {FOR: TTGP}
     {INDEX: 'GRS'}
     {PREFIX: TTG.ref}
     {DO}
        {FIRST}
             {IF: lineleft < 7}{PAGE}{FI}
             {<{lmt+1} 'GRUPA:'@}{<{lmt+6} TTG.GR+' '+TTG.OPIS}
             {FONT:'T10B'}
             {SUBSTITUTE: 'TABHEAD'}{FONT: 'T10'}{ vp:=1;druk:=1;lp:=0; ~~}
       {FIRST-}
       {IF: lineleft > 7}
                 {lp+=1;~~}
             {SUBSTITUTE: 'LINIA0'}
       {ELSE}
             {SUBSTITUTE: 'LINIAF'}
             {PAGE}
             {FONT: 'T10B'}
             {SUBSTITUTE: 'TABHEAD'}
             {FONT: 'T10'}{ vp:=1;lp+=1; ~~}
             {SUBSTITUTE: 'LINIA0'}
       {FI}
       {TOTAL}
           {IF: druk=1}
               {SUBSTITUTE: 'LINIAF'}
               {druk:=0;~~}
           {FI}
   {OD}
{OD}
{FI}
