:!UTF-8
{TITLE:G. Tabela roczna zmian stanu środków}
{PRINTER: FINFO.SZ_PRN,,,,,'M','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
   PRN:=obj_new(@.CLASS.PRINT,15+{? rep_export() || 22 ?}); PRN.s_frame();
   PRNF:=obj_new(@.CLASS.PRINT,15); PRNF.s_frame();
   PRN2:=obj_new(@.CLASS.PRINT,15); PRN2.s_frame();
   PRN3:=obj_new(@.CLASS.PRINT,15); PRN3.s_frame();
   PRN4:=obj_new(@.CLASS.PRINT,15); PRN4.s_frame();
   c:=obj_new(15+{? rep_export() || 22 ?});
   d:=obj_new(15);
   gp:=obj_new(13);
   gf:=obj_new(13);
   gd:=obj_new(13);
   {! _i:=1..15+{? rep_export() || 22 ?} |! c[_i] := '' !};
   {! _i:=1..15 |! d[_i] := '' !};
   {! _i:=1..13 |! gp[_i] := 0 !};
   {! _i:=1..13 |! gf[_i] := 0 !};
   {! _i:=1..13 |! gd[_i] := 0 !};
   sum_pod:=obj_new(12);
   sum_fin:=obj_new(12);
   sum_dod:=obj_new(12);
   {! _i:=1..12 |! sum_pod[_i]:=0; sum_fin[_i]:=0; sum_dod[_i]:=0 !};
   sum_grupa:=''; test_grupa:='';
   podsum:=0;
   VAR_DEL.delete('TAB_SQL');
   SRST.cntx_psh(); SRSR.cntx_psh();
   i:=0;
   color:=prn1:=prn2:=prn3:='';
   t_prn1:='';t_prn2:='';
   lm:=ll:=vp:=lmt:=rsep:=0;
   par1:=0; par2:=0; par3:=0; par4:=0
}
{END:
   obj_del(PRN);
   obj_del(PRNF);
   obj_del(PRN2);
   obj_del(PRN3);
   obj_del(PRN4);
   obj_del(c); obj_del(d); obj_del(gp); obj_del(gf); obj_del(gd);
   obj_del(sum_pod); obj_del(sum_fin); obj_del(sum_dod);
   &sum_grupa; &test_grupa; &podsum;
   SRST.cntx_pop(); SRSR.cntx_pop();
   VAR_DEL.delete('TAB_SQL');
   &i; &color; &prn1; &prn2; &prn3;
   &t_prn1; &t_prn2;
   &lm; &ll; &vp; &lmt; &rsep;
   &par1; &par2; &par3; &par4
}
{EXIT:
   exec('clear_par','fst');
   exec('set_parw','param_wydr');
   {? OPERATOR.DEPT<>null
   || PAR_WYDR.ODD:=OPERATOR.DEPT
   || PAR_WYDR.ODD:=0
   ?};
   {? SRSR.name()<>'srsrr'+REF.FIRMA().SYMBOL
   || exec('init','fst');
      SRD.maski('r')
   ?};
   {? SSTALE.AO().KON<>date(0,0,0)
   || PAR_WYDR.STAN_NA:=SSTALE.AO().KON
   |? SSTALE.AO().OES=0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().POCZ_ROK
   |? SSTALE.AO().OES>0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().KON_ROK
   ?};
   PAR_WYDR.ZESTAW:=2;
   PAR_WYDR.WART_PN:=2;
   PAR_WYDR.RODZAJ2:=1;
   SRD.PAR_WYDR:='T';
   PAR_WYDR.JORG:=null; EDIT_ES.JORG:='';
   exec('odd_filtr','fst');
   exec('set_gr_list','fst');
   {? FINFO.TOR_D<>'T'
   || PAR_WYDR.win_edit('TABZMIA')
   || PAR_WYDR.win_edit('TABZMIAD')
   ?};
   PAR_WYDR.hdr_edit(': G. Tabela roczna zmian stanu środków'@);
   {? PAR_WYDR.edit("exec('check_tabzmia','fst')") || _exit:=0 || _exit:=1 ?};
   {? ~_exit
   || __ASKJRG:={? PAR_WYDR.ASKJRG='X' || 0
                |? PAR_WYDR.ASKJRG='N' || 0
                |? PAR_WYDR.ASKJRG='T' || 1
                ?};
      {? PAR_WYDR.ASKJRG='X'
      || PAR_WYDR.ZMIANY:='T'
      || PAR_WYDR.ZMIANY:='N'
      ?};
      VAR_DEL.delete('TAB_SQL');
      TAB_SQL:=exec('o_tabzm','fst2');
      {? exec('if_ok','fst','TAB_SQL') || _exit:=0 || _exit:=1 ?}
   ?};
   _exit
}
{COMMENT}
==================================================
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
Nazwa pliku: fst_o_tabzm.rpm
Utworzony  : 2016-12-10
Zawartość  : Tabela roczna zmian stanu środków
==================================================
----------------------- OPIS PÓL ZMIENNEJ PAR_WYDR ------------{COMMENT-}
{COMMENT}
ODD    : jedn. ksieg.
{COMMENT-}
{COMMENT}zmienne pomocnicze do wydrukow graficznych:
i - licznik, color, prn1, lm, ll, vp, lmt, rsep
{COMMENT-}
{PAR_WYDR.cntx_psh(); ~~}
{INCLUDE: wsp_pw.rpi}
{PAR_WYDR.cntx_pop(); ~~}
{MACRO: 'TABHEAD2'}
{ _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
{ _f:=prn1+'.ini_head()'; ($(_f))()}
{REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}
{WHILE: _f:=prn1+'.h_next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.h_fmline(lmt)'; ($(_f))()}
{OD}
{REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
{ _f:=prn2+'.ini_head()'; ($(_f))()}
{ _f:=prn2+'.setcolor(color)'; ($(_f))(); ~~}
{WHILE: _f:=prn2+'.h_next()'; ($(_f))()}
{DO}
   {REP: _f:=prn2+'.h_fmline(lmt)'; ($(_f))()}
{OD}
{MACRO-}
{COMMENT}{COMMENT-}
{MACRO: 'LINIA03'}
{  ll:=lineleft(); t_prn1:=prn1; t_prn2:=prn2;~~}
{IF:  _f:=prn2+'.ini_line()'; _v:=($(_f))();
      _f:=prn2+'.length()'; _v:=($(_f))();
      ll<(1+_v) & ll<>0}{PAGE}
      {prn1:=t_prn1; prn2:=t_prn2;~~}
{FI}
{ENTIRE}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}{ vp:=0; ~~}
{ELSE}
   {IF: PAR_WYDR.RSEP & rsep}
      {REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
   {ELIF: rsep}
      {REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
   {FI}
   { '';~~}
{FI}
{WHILE: _f:=prn2+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn2+'.fline(lmt)'; ($(_f))()}
{OD}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{ENTIRE-}
{MACRO-}
{COMMENT}--Definicja wiersza wydruku--------------------{COMMENT-}
{  prn1:='PRN2'; prn2:='PRN'; ~~}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
      PRN.add("{? type_of(c[2]) = 1 || form(c[2],,2,' ,') || c[2] ?}",14,'Bilans otwarc.'@,1,'#');
      PRN.add("{? type_of(c[4]) = 1 || form(c[4],,2,' ,') || c[4] ?}",14,'Ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[5]) = 1 || form(c[5],,2,' ,') || c[5] ?}",14,'Skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[6]) = 1 || form(c[6],,2,' ,') || c[6] ?}",14,'Koniec okresu'@,1,'#');
      PRN.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}",14,'Pocz. okresu'@,1,'#');
      PRN.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}",14,'W ciągu okresu'@,1,'#');
      PRN.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}",14,'Ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}",14,'Skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}",14,'Koniec okresu'@,1,'#');

      PRNF.add("{? type_of(c[2]) = 1 || form(c[2],,2,' ,') || c[2] ?}",14,'Bilans otwarc.'@,1,'#');
      PRNF.add("{? type_of(c[4]) = 1 || form(c[4],,2,' ,') || c[4] ?}",14,'Ze zwiększenia'@,1,'#');
      PRNF.add("{? type_of(c[5]) = 1 || form(c[5],,2,' ,') || c[5] ?}",14,'Skreśl.z ewid.'@,1,'#');
      PRNF.add("{? type_of(c[6]) = 1 || form(c[6],,2,' ,') || c[6] ?}",14,'Koniec okresu'@,1,'#');
      PRNF.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}",14,'Pocz. okresu'@,1,'#');
      PRNF.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}",14,'W ciągu okresu'@,1,'#');
      PRNF.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}",14,'Ze zwiększenia'@,1,'#');
      PRNF.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}",14,'Skreśl.z ewid.'@,1,'#');
      PRNF.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}",14,'Koniec okresu'@,1,'#');

      {? PAR_WYDR.RODZAJ = 1
      ||
         PRN2.add("d[13]", 14, 'Grupa'@);
         PRN2.add("d[14]", 31, 'Nr inwentarzowy'@);
         PRN2.add("d[12]", 48, 'Jedn. księgowa'@);
         PRN2.add("d[15]", 48, 'Nazwa środka'@);

         PRN4.add("d[13]", 150, '')

      |? PAR_WYDR.RODZAJ = 2
      ||
         PRN2.add("c[1]", 150, '');
         PRN4.add("c[1]", 150, '')
      ?};

      PRN3.add("", 65, 'Wartość'@);
      PRN3.add("", 82, 'Umorzenie'@);


      PAR_WYDR.TITLE:='Tabela roczna zmian stanu środków - stan na dzień %1 roku'@[PAR_WYDR.STAN_NA$6]
; ~~}
{FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
   {? PAR_WYDR.RODZAJ = 1
   || PRN.add("c[22]", 14, 'Grupa'@);
      PRN.add("c[23]", 31, 'Nr inwentarzowy'@);
      PRN.add("c[24]", 48, 'Jedn. księgowa'@);
      PRN.add("c[25]", 48, 'Nazwa środka'@)
   |? PAR_WYDR.RODZAJ = 2 & PAR_WYDR.ZESTAW = 1
   || PRN.add("c[22]", 48, 'JEDN. KS.'@) ?};
   {? PAR_WYDR.RODZAJ = 2 & PAR_WYDR.ZESTAW <> 1
   || PRN.add("c[22]", 48, 'Grupa'@) ?};

   {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
   || PRN.add("{? type_of(c[2]) = 1 || form(c[2],,2,' ,') || c[2] ?}",14,'Wartość POD Bilans otwarc.'@,1,'#');
      PRN.add("{? type_of(c[4]) = 1 || form(c[4],,2,' ,') || c[4] ?}",14,'Wartość POD Ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[5]) = 1 || form(c[5],,2,' ,') || c[5] ?}",14,'Wartość POD Skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[6]) = 1 || form(c[6],,2,' ,') || c[6] ?}",14,'Wartość POD Koniec okresu'@,1,'#');
      PRN.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}",14,'Umorzenie POD Pocz. okresu'@,1,'#');
      PRN.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}",14,'Umorzenie POD W ciągu okresu'@,1,'#');
      PRN.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}",14,'Umorzenie POD Ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}",14,'Umorzenie POD Skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}",14,'Umorzenie POD Koniec okresu'@,1,'#') ?};
   {? PAR_WYDR.DANE = 2 | PAR_WYDR.DANE = 3
   || PRN.add("{? type_of(c[13]) = 1 || form(c[13],,2,' ,') || c[13] ?}",14,'Wartość BIL Bilans otwarc.'@,1,'#');
      PRN.add("{? type_of(c[14]) = 1 || form(c[14],,2,' ,') || c[14] ?}",14,'Wartość BIL Ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[15]) = 1 || form(c[15],,2,' ,') || c[15] ?}",14,'Wartość BIL Skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[16]) = 1 || form(c[16],,2,' ,') || c[16] ?}",14,'Wartość BIL Koniec okresu'@,1,'#');
      PRN.add("{? type_of(c[17]) = 1 || form(c[17],,2,' ,') || c[17] ?}",14,'Umorzenie BIL Pocz. okresu'@,1,'#');
      PRN.add("{? type_of(c[18]) = 1 || form(c[18],,2,' ,') || c[18] ?}",14,'Umorzenie BIL W ciągu okresu'@,1,'#');
      PRN.add("{? type_of(c[19]) = 1 || form(c[19],,2,' ,') || c[19] ?}",14,'Umorzenie BIL Ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[20]) = 1 || form(c[20],,2,' ,') || c[20] ?}",14,'Umorzenie BIL Skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[21]) = 1 || form(c[21],,2,' ,') || c[21] ?}",14,'Umorzenie BIL Koniec okresu'@,1,'#') ?};
   {? PAR_WYDR.DANE = 4
   || PRN.add("{? type_of(c[26]) = 1 || form(c[26],,2,' ,') || c[26] ?}",14,'Wartość DOD Bilans otwarc.'@,1,'#');
      PRN.add("{? type_of(c[27]) = 1 || form(c[27],,2,' ,') || c[27] ?}",14,'Wartość DOD Ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[28]) = 1 || form(c[28],,2,' ,') || c[28] ?}",14,'Wartość DOD Skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[29]) = 1 || form(c[29],,2,' ,') || c[29] ?}",14,'Wartość DOD Koniec okresu'@,1,'#');
      PRN.add("{? type_of(c[30]) = 1 || form(c[30],,2,' ,') || c[30] ?}",14,'Umorzenie DOD Pocz. okresu'@,1,'#');
      PRN.add("{? type_of(c[31]) = 1 || form(c[31],,2,' ,') || c[31] ?}",14,'Umorzenie BIL W ciągu okresu'@,1,'#');
      PRN.add("{? type_of(c[32]) = 1 || form(c[32],,2,' ,') || c[32] ?}",14,'Umorzenie DOD Ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[33]) = 1 || form(c[33],,2,' ,') || c[33] ?}",14,'Umorzenie DOD Skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[34]) = 1 || form(c[34],,2,' ,') || c[34] ?}",14,'Umorzenie DOD Koniec okresu'@,1,'#') ?};

      PRNF.add("{? type_of(c[2]) = 1 || form(c[2],,2,' ,') || c[2] ?}",14,'Bilans otwarc.'@,1,'#');
      PRNF.add("{? type_of(c[4]) = 1 || form(c[4],,2,' ,') || c[4] ?}",14,'Ze zwiększenia'@,1,'#');
      PRNF.add("{? type_of(c[5]) = 1 || form(c[5],,2,' ,') || c[5] ?}",14,'Skreśl.z ewid.'@,1,'#');
      PRNF.add("{? type_of(c[6]) = 1 || form(c[6],,2,' ,') || c[6] ?}",14,'Koniec okresu'@,1,'#');
      PRNF.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}",14,'Pocz. okresu'@,1,'#');
      PRNF.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}",14,'W ciągu okresu'@,1,'#');
      PRNF.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}",14,'Ze zwiększenia'@,1,'#');
      PRNF.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}",14,'Skreśl.z ewid.'@,1,'#');
      PRNF.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}",14,'Koniec okresu'@,1,'#');

      {? PAR_WYDR.RODZAJ = 1
      ||
         PRN2.add("d[13]", 14, 'Grupa'@);
         PRN2.add("d[14]", 31, 'Nr inwentarzowy'@);
         PRN2.add("d[12]", 48, 'Jedn. księgowa'@);
         PRN2.add("d[15]", 48, 'Nazwa środka'@);

         PRN4.add("d[13]", 150, '')

      |? PAR_WYDR.RODZAJ = 2
      ||
         PRN2.add("c[1]", 150, '');
         PRN4.add("c[1]", 150, '')
      ?};



      PAR_WYDR.TITLE:='Tabela roczna zmian stanu środków - stan na dzień %1 roku'@[PAR_WYDR.STAN_NA$6]
; ~~}
{FI}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{COMMENT}------------------------------Parametry wydruku------------{COMMENT-}
{FONT: 'W8'}{SPACE: 'C'}
{<1 'PARAMETRY WYDRUKU:'}
{COMMENT} ---- Stan na, Grupa, Rodzaj zestawienia ---- {COMMENT-}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
  {? PAR_WYDR.WAR_GR=1
  || {? |PAR_WYDR.GRUPA<>'' || par1:=|PAR_WYDR.GRUPA || par1:='dowolna'@?}
  |? PAR_WYDR.WAR_GR=2
  || {? |PAR_WYDR.GRUPA_OD<>'' || _od:='od: '+|PAR_WYDR.GRUPA_OD || _od:=''?};
     {? |PAR_WYDR.GRUPA_DO<>'' || _do:='do: '+|PAR_WYDR.GRUPA_DO || _do:=''?};
     {? _od<>'' & _do<>'' || par1:=_od+' '+_do
     |? _od<>'' & _do='' ||  par1:=_od
     |? _od='' & _do<>'' || par1:=_do
    ?}
  |? PAR_WYDR.WAR_GR=4
  || par1:='wszystkie'
  ?};

  {? PAR_WYDR.RODZAJ=1
  || par2:='analityczne'@ || par2:='syntetyczne'@
  ?};
  {? PAR_WYDR.ZESTAW=1
  || par3:='jedn. księgowych'@
  |? PAR_WYDR.ZESTAW=2
  || par3:='grup'@
  ?};
  par4:={? PAR_WYDR.JORG<>null || PAR_WYDR.JORG().SYMBOL || 'dowolna'@ ?}
;~~}
{IF: PAR_WYDR.WAR_GR<>3}
{FONT: 'W8B'}{<1 'Grupa: '@}{FONT: 'W8'}{<8 par1}{FONT: 'W8B'}{<40 'Rodzaj zestawienia: '@}{FONT: 'W8'}{<59 par2}{FONT: 'W8B'}{<80 'Zestawienie według: '@}{FONT: 'W8'}{<99 par3}{FONT: 'W8B'}{<120 'Jedn. organizacyjna: '@}{FONT: 'W8'}{<142 par4}
{ELIF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{<1 'Rodzaj zestawienia: '@}{FONT: 'W8'}{<20 par2}{FONT: 'W8B'}{<40 'Zestawienie według: '@}{FONT: 'W8'}{<59 par3}{FONT: 'W8B'}{<80 'Jedn. organizacyjna: '@}{FONT: 'W8'}{<102 par4}
{FI}
{COMMENT} ---- Dane, Jedn. ksiegowa, Zestawienie według ---- {COMMENT-}
{
  {? PAR_WYDR.DANE=1
  || par1:='podatkowe'@
  |? PAR_WYDR.DANE=2
  || par1:='bilansowe'@
  |? PAR_WYDR.DANE=3
  || par1:='wszystkie'@
  |? PAR_WYDR.DANE=4
  || par1:='dodatkowe'@
  ?};
  {? PAR_WYDR.ODD<>null || par2:=PAR_WYDR.ODD().OD || par2:='dowolna'@ ?};

  {? PAR_WYDR.ZAKRESDR=0
  || par3:='wszystkie'@
  |? PAR_WYDR.ZAKRESDR=1
  || par3:='trwałe'@
  |? PAR_WYDR.ZAKRESDR=2
  || par3:='niskocenne'@
  ?}
;~~}
{FONT: 'W8B'}{<1 'Dane: '@}{FONT: 'W8'}{<8 par1}{FONT: 'W8B'}{<40 'Jednostka księgowa: '@}{FONT: 'W8'}{<59 par2}{FONT: 'W8B'}{<80 'Zakres środków: '@}{FONT: 'W8'}{<99 par3}
{
  {? PAR_WYDR.MO_DO=1
  || par3:='miesiąca obowiązywania'@
  |? PAR_WYDR.MO_DO=2
  || par3:='daty operacji'@
  ?}
;~~}
{IF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{<1 'Wybór grup: '@}{FONT: 'W8'}{<20 exec('create_list_gr','fst')}
{FI}
{ {? PAR_WYDR.PRZYCHOD<>null || par1:=PAR_WYDR.PRZYCHOD().R || par1:='dowolny'@ ?};
  {? PAR_WYDR.ROZCHOD<>null || par2:=PAR_WYDR.ROZCHOD().R || par2:='dowolny'@ ?}
;~~}
{FONT: 'W8B'}{<1 'Rodzaj przychodu: '@}{FONT: 'W8'}{<20 par1}{FONT: 'W8B'}{<40 'Rodzaj rozchodu: '@}{FONT: 'W8'}{<51 par2}{FONT: 'W8B'}{<80 'Dokumenty wartościowe według: '@}{FONT: 'W8'}{<111 par3}
{IF: FINFO.TOR_D<>'T'}
{IF: PAR_WYDR.DANE=3}{FONT: 'W8B'}{<1 'Uwaga: '}{FONT: 'W8'}{'W wierszach tabeli najpierw prezentowane są dane podatkowe, w następnym wierszu - dane bilansowe'@}{FI}
{ELSE}
{IF: PAR_WYDR.DANE=3}{FONT: 'W8B'}{<1 'Uwaga: '}{FONT: 'W8'}{'W kolejnych wierszach tabeli prezentowane są dane podatkowe, bilansowe i dodatkowe'@}{FI}
{FI}
{COMMENT}
{  {? PAR_WYDR.ASKJRG='N'
   || par1:='w obecnej i poprzednich jednostkach księgowych. Wartości dla takich środków przedstawiono w nawiasach kwadratowych np. [100].'
   |? PAR_WYDR.ASKJRG='T'
   || par1:='w obecnej i poprzednich jednostkach księgowych (lub j. org.). Wartości dla takich środków przedstawiono w nawiasach\n kwadratowych np. [100].'
   |? PAR_WYDR.ASKJRG='X'
   || par1:='w obecnej jednostce księgowej (i j. org.).'
   ?}
;~~}
{FONT: 'W8B'}{<1 'Środki przeniesione w bieżącym roku uwzględniono: '}{FONT: 'W8'}{par1}
{IF: PAR_WYDR.ASKJRG<>'X'}
{'W przypadku uwzgl. przenoszenia środków wartości w kolumnach <Ze zwiększenia> i <Skreśl. z ewid.> mogą zawierać wartości zarówno wynikające ze skreśleń i zwiększeń'}
{'(dok. wartościowe) jak i z przeniesień środków między j. księgowymi i j. org. Wartości wynikające z przeniesień nie wchodzą w zakres podsumowań.'}
{FI}
 {COMMENT-}
{FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
  {? PAR_WYDR.WAR_GR=1
  || {? |PAR_WYDR.GRUPA<>'' || par1:=|PAR_WYDR.GRUPA || par1:='dowolna'@?}
  |? PAR_WYDR.WAR_GR=2
  || {? |PAR_WYDR.GRUPA_OD<>'' || _od:='od: '+|PAR_WYDR.GRUPA_OD || _od:=''?};
     {? |PAR_WYDR.GRUPA_DO<>'' || _do:='do: '+|PAR_WYDR.GRUPA_DO || _do:=''?};
     {? _od<>'' & _do<>'' || par1:=_od+' '+_do
     |? _od<>'' & _do='' ||  par1:=_od
     |? _od='' & _do<>'' || par1:=_do
    ?}
  |? PAR_WYDR.WAR_GR=4
  || par1:='wszystkie'
  ?};

  {? PAR_WYDR.RODZAJ=1
  || par2:='analityczne'@ || par2:='syntetyczne'@
  ?};
  {? PAR_WYDR.ZESTAW=1
  || par3:='jedn. księgowych'@
  |? PAR_WYDR.ZESTAW=2
  || par3:='grup'@
  ?};
  par4:={? PAR_WYDR.JORG<>null || PAR_WYDR.JORG().SYMBOL || 'dowolna'@ ?}
;~~}
{IF: PAR_WYDR.WAR_GR<>3}
{FONT: 'W8B'}{ 'Grupa: '@}{FONT: 'W8'}{ par1}
{FONT: 'W8B'}{ 'Rodzaj zestawienia: '@}{FONT: 'W8'}{ par2}
{FONT: 'W8B'}{ 'Zestawienie według: '@}{FONT: 'W8'}{ par3}
{FONT: 'W8B'}{ 'Jedn. organizacyjna: '@}{FONT: 'W8'}{ par4}
{ELIF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{ 'Rodzaj zestawienia: '@}{FONT: 'W8'}{ par2}
{FONT: 'W8B'}{ 'Zestawienie według: '@}{FONT: 'W8'}{ par3}
{FONT: 'W8B'}{ 'Jedn. organizacyjna: '@}{FONT: 'W8'}{ par4}
{FI}
{COMMENT} ---- Dane, Jedn. ksiegowa, Zestawienie według ---- {COMMENT-}
{
  {? PAR_WYDR.DANE=1
  || par1:='podatkowe'@
  |? PAR_WYDR.DANE=2
  || par1:='bilansowe'@
  |? PAR_WYDR.DANE=3
  || par1:='wszystkie'@
  |? PAR_WYDR.DANE=4
  || par1:='dodatkowe'@
  ?};
  {? PAR_WYDR.ODD<>null || par2:=PAR_WYDR.ODD().OD || par2:='dowolna'@ ?};

  {? PAR_WYDR.ZAKRESDR=0
  || par3:='wszystkie'@
  |? PAR_WYDR.ZAKRESDR=1
  || par3:='trwałe'@
  |? PAR_WYDR.ZAKRESDR=2
  || par3:='niskocenne'@
  ?}
;~~}
{FONT: 'W8B'}{'Dane: '@}{FONT: 'W8'}{ par1}
{FONT: 'W8B'}{'Jednostka księgowa: '@}{FONT: 'W8'}{ par2}
{FONT: 'W8B'}{'Zakres środków: '@}{FONT: 'W8'}{ par3}
{
  {? PAR_WYDR.MO_DO=1
  || par3:='miesiąca obowiązywania'@
  |? PAR_WYDR.MO_DO=2
  || par3:='daty operacji'@
  ?}
;~~}
{IF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{'Wybór grup: '@}{FONT: 'W8'}{exec('create_list_gr','fst')}
{FI}
{ {? PAR_WYDR.PRZYCHOD<>null || par1:=PAR_WYDR.PRZYCHOD().R || par1:='dowolny'@ ?};
  {? PAR_WYDR.ROZCHOD<>null || par2:=PAR_WYDR.ROZCHOD().R || par2:='dowolny'@ ?}
;~~}
{FONT: 'W8B'}{'Rodzaj przychodu: '@}{FONT: 'W8'}{par1}
{FONT: 'W8B'}{'Rodzaj rozchodu: '@}{FONT: 'W8'}{par2}
{FONT: 'W8B'}{'Dokumenty wartościowe według: '@}{FONT: 'W8'}{par3}
{IF: FINFO.TOR_D<>'T'}
{IF: PAR_WYDR.DANE=3}{FONT: 'W8B'}{<1 'Uwaga: '}{FONT: 'W8'}{'W wierszach tabeli najpierw prezentowane są dane podatkowe, w następnym wierszu - dane bilansowe'@}{FI}
{ELSE}
{IF: PAR_WYDR.DANE=3}{FONT: 'W8B'}{<1 'Uwaga: '}{FONT: 'W8'}{'W kolejnych wierszach tabeli prezentowane są dane podatkowe, bilansowe i dodatkowe'@}{FI}
{FI}
{COMMENT}
{  {? PAR_WYDR.ASKJRG='N'
   || par1:='w obecnej i poprzednich jednostkach księgowych. Wartości dla takich środków przedstawiono w nawiasach kwadratowych np. [100].'
   |? PAR_WYDR.ASKJRG='T'
   || par1:='w obecnej i poprzednich jednostkach księgowych (lub j. org.). Wartości dla takich środków przedstawiono w nawiasach\n kwadratowych np. [100].'
   |? PAR_WYDR.ASKJRG='X'
   || par1:='w obecnej jednostce księgowej (i j. org.).'
   ?}
;~~}
{FONT: 'W8B'}{<1 'Środki przeniesione w bieżącym roku uwzględniono: '}{FONT: 'W8'}{par1}
{IF: PAR_WYDR.ASKJRG<>'X'}
{'W przypadku uwzgl. przenoszenia środków wartości w kolumnach <Ze zwiększenia> i <Skreśl. z ewid.> mogą zawierać wartości zarówno wynikające ze skreśleń i zwiększeń'}
{'(dok. wartościowe) jak i z przeniesień środków między j. księgowymi i j. org. Wartości wynikające z przeniesień nie wchodzą w zakres podsumowań.'}
{FI}
 {COMMENT-}
{FI}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{prn1:='PRN3';prn2:='PRN';~~}
{SUBSTITUTE: 'TABHEAD2'}
{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8GB'}{SPACE: 'C'}
{prn1:='PRN3';prn2:='PRN';~~}
{SUBSTITUTE: 'TABHEAD2'}
{prn1:='PRN'; {? podsum=0 || prn2:='PRN2' || prn2:='PRN4'?};~~}{ vp:=1;~~}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: ~rep_export()}
{SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{ rsep:=PAR_WYDR.RSEP; ~~}
{FOR: TAB_SQL}
 {DO}
{COMMENT} ---- Podsumowanie cząstkowe według grup lub jedn. ksiegowych ---- {COMMENT-}
  {COMMENT} ---- Podsumowania nie występują dla excel ---- {COMMENT-}
{IF: ~rep_export()}
  { {? PAR_WYDR.RODZAJ=1
   ||
      {? PAR_WYDR.ZESTAW=1
      || test_grupa:=TAB_SQL.ODDZIAL
      |? PAR_WYDR.ZESTAW=2
      || test_grupa:=TAB_SQL.GR
      ?};
      {? sum_grupa='' || test_grupa:=''?}
   ?}
  ;~~}
{IF: PAR_WYDR.RODZAJ=1 & sum_grupa<>test_grupa}
{COMMENT}Pierwsza linia podsumowania czastkowego{COMMENT-}
   {
   podsum:=1;
   {? PAR_WYDR.ZESTAW=1
   || d[13]:='Razem: jedn. księg. '@+sum_grupa
   |? PAR_WYDR.ZESTAW=2
   || d[13]:='Razem: grupa '@+sum_grupa
   ?};
   {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
   || c[2]:=gp[2]; c[3]:=gp[3]; c[4]:=gp[4]; c[5]:=gp[5]; c[6]:=gp[6];
      c[7]:=gp[7]; c[8]:=gp[8]; c[9]:=gp[9]; c[10]:=gp[10]; c[11]:=gp[11]; c[12]:=gp[12]
   |? PAR_WYDR.DANE=2
   || c[2]:=gf[2]; c[3]:=gf[3]; c[4]:=gf[4]; c[5]:=gf[5]; c[6]:=gf[6];
      c[7]:=gf[7]; c[8]:=gf[8]; c[9]:=gf[9]; c[10]:=gf[10]; c[11]:=gf[11]; c[12]:=gf[12]
   |? PAR_WYDR.DANE=4
   || c[2]:=gd[2]; c[3]:=gd[3]; c[4]:=gd[4]; c[5]:=gd[5]; c[6]:=gd[6];
      c[7]:=gd[7]; c[8]:=gd[8]; c[9]:=gd[9]; c[10]:=gd[10]; c[11]:=gd[11]; c[12]:=gd[12]
   ?}
  ;~~}
  {FONT: 'T8GB'}{SPACE: 'C'}
  {IF: lineleft()<= (4+{? PAR_WYDR.DANE=3 || 2 || 0 ?} ) & lineleft()<>0}{PAGE}{FI}
  {prn1:='PRN'; prn2:='PRN4'; rsep:=1;~~}{SUBSTITUTE: 'LINIA02'}
  {prn1:='PRN4'; prn2:='PRN'; rsep:=1 ; ~~}
  {SUBSTITUTE: 'LINIA02'}
{COMMENT}Druga linia podsumowania czastkowego{COMMENT-}
  {IF: PAR_WYDR.DANE=3}
    {
     c[2]:=gf[2]; c[3]:=gf[3]; c[4]:=gf[4]; c[5]:=gf[5]; c[6]:= gf[6];
     c[7]:=gf[7]; c[8]:=gf[8]; c[9]:=gf[9]; c[10]:=gf[10]; c[11]:=gf[11]; c[12]:=gf[12]
    ;~~}
    {prn1:='PRN'; prn2:='PRN'; rsep:=PAR_WYDR.RSEP; ~~}
{COMMENT}Trzecia linia podsumowania czastkowego{COMMENT-}
  {IF: FINFO.TOR_D='T'}
    {SUBSTITUTE: 'LINIA02'}
    {
     c[2]:=gd[2]; c[3]:=gd[3]; c[4]:=gd[4]; c[5]:=gd[5]; c[6]:= gd[6];
     c[7]:=gd[7]; c[8]:=gd[8]; c[9]:=gd[9]; c[10]:=gd[10]; c[11]:=gd[11]; c[12]:=gd[12]
    ;~~}
    {prn1:='PRN'; prn2:='PRN'; rsep:=PAR_WYDR.RSEP; ~~}
  {FI}
  {SUBSTITUTE: 'LINIA0'}
  {FI}
  {rsep:=PAR_WYDR.RSEP;
  prn1:='PRN'; prn2:='PRN'; "vp:=0";
  podsum:=0
  ;~~}
{COMMENT} ---- wyzerowanie podsumowań cząstkowych---- {COMMENT-}
  {
     {? PAR_WYDR.RODZAJ = 1
        || {! _i:=1..12 |! gp[_i]:=gf[_i]:=gd[_i]:=0 !}
     ?}
  ;~~}
  {FONT: 'T8G'}{SPACE: 'C'}
  {FI}
{FI}
{COMMENT} ---- zwykłe wiersze ---- {COMMENT-}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
 {
   {? PAR_WYDR.RODZAJ=1
   || d[13]:=TAB_SQL.GRUPA;
      d[14]:=TAB_SQL.NRI;
      d[15] := TAB_SQL.NST;
      {? TAB_SQL.AKTYWNY='N'
      || _mie:=TAB_SQL.MIE_DO;
         _dzi:=0
      |? TAB_SQL.AKTYWNY='P'
      || _mie:=TAB_SQL.MIE_OD;
         _dzi:=1
      ?};
      {? TAB_SQL.AKTYWNY<>'T'
      || _rok:=SSTALE.AO().RES;
         _data:=$(date(_rok,_mie,_dzi))
      ?};
      {? TAB_SQL.AKTYWNY='T' || d[12]:=TAB_SQL.ODDZIAL+ {? PAR_WYDR.ASKJRG='T' || ' ('+TAB_SQL.JORG+')' || '' ?}
      |? TAB_SQL.AKTYWNY='P' || d[12]:=TAB_SQL.ODDZIAL+ {? PAR_WYDR.ASKJRG='T' || ' ('+TAB_SQL.JORG+')' || '' ?} +' [od: '+_data+']'
      |? TAB_SQL.AKTYWNY='N' || d[12]:=TAB_SQL.ODDZIAL+ {? PAR_WYDR.ASKJRG='T' || ' ('+TAB_SQL.JORG+')' || '' ?} +' [do: '+_data+']'
      ?}
   |? PAR_WYDR.RODZAJ = 2
   || c[1]:= {? PAR_WYDR.ZESTAW = 1 || 'JEDN. KS.: '@ + TAB_SQL.ODDZIAL || 'GRUPA: '@ + TAB_SQL.GR ?}
   ?};

   {? PAR_WYDR.RODZAJ=1 & (PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3)
   || {? TAB_SQL.AKTYWNY='T' || c[2]:=TAB_SQL.WARP
      |? TAB_SQL.AKTYWNY='P' || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[2]:='['+form(TAB_SQL.WARP,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[4]:=TAB_SQL.WARP_ZW+TAB_SQL.WARP_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[4]:='['+form(TAB_SQL.WARP_ZW+TAB_SQL.WARP_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[4]:='['+form(TAB_SQL.WARP_ZW+TAB_SQL.WARP_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[5]:=TAB_SQL.WARP_SKR
      |? TAB_SQL.AKTYWNY='P' || c[5]:='['+form(TAB_SQL.WARP_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[5]:='['+form(TAB_SQL.WARP_SKR+(-1*TAB_SQL.WARP_ZWD),,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[6]:=TAB_SQL.WARP_KON
      |? TAB_SQL.AKTYWNY='P' || c[6]:='['+form(TAB_SQL.WARP_KON,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[6]:='-'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[7]:=TAB_SQL.UMOP-TAB_SQL.AMOP
      |? TAB_SQL.AKTYWNY='P' || c[7]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || c[7]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[7]:='['+form(TAB_SQL.UMOP-TAB_SQL.AMOP,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[9]:=TAB_SQL.UMP_CO
      |? TAB_SQL.AKTYWNY='P' || c[9]:='['+form(TAB_SQL.UMP_CO,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[9]:='['+form(TAB_SQL.UMP_CO,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[10]:=TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[10]:='['+form(TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[10]:='['+form(TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[11]:=TAB_SQL.UMP_SKR
      |? TAB_SQL.AKTYWNY='P' || c[11]:='['+form(TAB_SQL.UMP_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[11]:='['+form(TAB_SQL.UMP_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[12]:=(TAB_SQL.UMP_KON-TAB_SQL.AMOP)
      |? TAB_SQL.AKTYWNY='P' || c[12]:='['+form((TAB_SQL.UMP_KON),,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[12]:='-'
      ?}
   |? PAR_WYDR.RODZAJ=1 & PAR_WYDR.DANE = 2
   || {? TAB_SQL.AKTYWNY='T' || c[2]:=TAB_SQL.WARF
      |? TAB_SQL.AKTYWNY='P' || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[2]:='['+form(TAB_SQL.WARF,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[4]:=TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[4]:='['+form(TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[4]:='['+form(TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[5]:=TAB_SQL.WARF_SKR
      |? TAB_SQL.AKTYWNY='P' || c[5]:='['+form(TAB_SQL.WARF_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[5]:='['+form(TAB_SQL.WARF_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[6]:=TAB_SQL.WARF_KON
      |? TAB_SQL.AKTYWNY='P' || c[6]:='['+form(TAB_SQL.WARF_KON,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[6]:='-'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[7]:=TAB_SQL.UMOF-TAB_SQL.AMOF
      |? TAB_SQL.AKTYWNY='P' || c[7]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || '-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[7]:='['+form(TAB_SQL.UMOF-TAB_SQL.AMOF,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[9]:=TAB_SQL.UMF_CO
      |? TAB_SQL.AKTYWNY='P' || c[9]:='['+form(TAB_SQL.UMF_CO,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[9]:='['+form(TAB_SQL.UMF_CO,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[10]:=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[10]:='['+form(TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[10]:='['+form(TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[11]:=TAB_SQL.UMF_SKR
      |? TAB_SQL.AKTYWNY='P' || c[11]:='['+form(TAB_SQL.UMF_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[11]:='['+form(TAB_SQL.UMF_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[12]:=(TAB_SQL.UMF_KON-TAB_SQL.AMOF)
      |? TAB_SQL.AKTYWNY='P' || c[12]:='['+form((TAB_SQL.UMF_KON),,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[12]:='-'
      ?}
   |? PAR_WYDR.RODZAJ=1 & PAR_WYDR.DANE = 4
   || {? TAB_SQL.AKTYWNY='T' || c[2]:=TAB_SQL.WARD
      |? TAB_SQL.AKTYWNY='P' || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[2]:='['+form(TAB_SQL.WARD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[4]:=TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[4]:='['+form(TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[4]:='['+form(TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[5]:=TAB_SQL.WARD_SKR
      |? TAB_SQL.AKTYWNY='P' || c[5]:='['+form(TAB_SQL.WARD_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[5]:='['+form(TAB_SQL.WARD_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[6]:=TAB_SQL.WARD_KON
      |? TAB_SQL.AKTYWNY='P' || c[6]:='['+form(TAB_SQL.WARD_KON,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[6]:='-'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[7]:=TAB_SQL.UMOD-TAB_SQL.AMOD
      |? TAB_SQL.AKTYWNY='P' || c[7]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || '-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[7]:='['+form(TAB_SQL.UMOD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[9]:=TAB_SQL.UMD_CO
      |? TAB_SQL.AKTYWNY='P' || c[9]:='['+form(TAB_SQL.UMD_CO,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[9]:='['+form(TAB_SQL.UMD_CO,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[10]:=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[10]:='['+form(TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[10]:='['+form(TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[11]:=TAB_SQL.UMD_SKR
      |? TAB_SQL.AKTYWNY='P' || c[11]:='['+form(TAB_SQL.UMD_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[11]:='['+form(TAB_SQL.UMD_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[12]:=(TAB_SQL.UMD_KON-TAB_SQL.AMOD)
      |? TAB_SQL.AKTYWNY='P' || c[12]:='['+form((TAB_SQL.UMD_KON),,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[12]:='-'
      ?}
   |? PAR_WYDR.RODZAJ=2
   || {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
      || c[2]:=TAB_SQL.WARP;
         c[4]:=TAB_SQL.WARP_ZW+TAB_SQL.WARP_ZWD;
         c[5]:=TAB_SQL.WARP_SKR;
         c[6]:=TAB_SQL.WARP_KON;
         c[7]:=TAB_SQL.UMOP-TAB_SQL.AMOP;
         c[9]:=TAB_SQL.UMP_CO;
         c[10]:=TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD;
         c[11]:=TAB_SQL.UMP_SKR;
         c[12]:=TAB_SQL.UMP_KON-TAB_SQL.AMOP
      |? PAR_WYDR.DANE=2
      || c[2]:=TAB_SQL.WARF;
         c[4]:=TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD;
         c[5]:=TAB_SQL.WARF_SKR;
         c[6]:=TAB_SQL.WARF_KON;
         c[7]:=TAB_SQL.UMOF-TAB_SQL.AMOF;
         c[9]:=TAB_SQL.UMF_CO;
         c[10]:=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD;
         c[11]:=TAB_SQL.UMF_SKR;
         c[12]:=TAB_SQL.UMF_KON-TAB_SQL.AMOF
      |? PAR_WYDR.DANE=4
      || c[2]:=TAB_SQL.WARD;
         c[4]:=TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD;
         c[5]:=TAB_SQL.WARD_SKR;
         c[6]:=TAB_SQL.WARD_KON;
         c[7]:=TAB_SQL.UMOD-TAB_SQL.AMOD;
         c[9]:=TAB_SQL.UMD_CO;
         c[10]:=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD;
         c[11]:=TAB_SQL.UMD_SKR;
         c[12]:=TAB_SQL.UMD_KON-TAB_SQL.AMOD
      ?}
   ?};
~~}
{
   {? PAR_WYDR.RODZAJ=1
   || {? TAB_SQL.AKTYWNY<>'P' & TAB_SQL.MIE_OD=1
      || gp[2]+=TAB_SQL.WARP
      ?};
      {? TAB_SQL.AKTYWNY<>'N'
      || gp[4]+={? TAB_SQL.AKTYWNY='T' || TAB_SQL.WARP_ZW || 0 ?}+TAB_SQL.WARP_ZWD;
         gp[5]+=TAB_SQL.WARP_SKR;
         gp[6]+=TAB_SQL.WARP_KON
      || gp[4]+=TAB_SQL.WARP_ZWD
      ?};
      gp[7]+=(TAB_SQL.UMOP-TAB_SQL.AMOP);
      gp[9]+=TAB_SQL.UMP_CO;
      {? TAB_SQL.AKTYWNY='T'
      || gp[10]+=TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD
      || gp[10]+=TAB_SQL.UMP_ZWD
      ?};
      {? TAB_SQL.AKTYWNY<>'N'
      || gp[11]+=TAB_SQL.UMP_SKR
      ?};
      gp[12]+=(TAB_SQL.UMP_KON-TAB_SQL.AMOP);

      {? TAB_SQL.AKTYWNY<>'P' & TAB_SQL.MIE_OD=1
      || gf[2]+=TAB_SQL.WARF
      ?};
      {? TAB_SQL.AKTYWNY<>'N'
      || gf[4]+={? TAB_SQL.AKTYWNY='T' || TAB_SQL.WARF_ZW || 0 ?}+TAB_SQL.WARF_ZWD;
         gf[5]+=TAB_SQL.WARF_SKR;
         gf[6]+=TAB_SQL.WARF_KON
      || gf[4]+=TAB_SQL.WARF_ZWD
      ?};
      gf[7]+=(TAB_SQL.UMOF-TAB_SQL.AMOF);
      gf[9]+=TAB_SQL.UMF_CO;
      {? TAB_SQL.AKTYWNY='T'
      || gf[10]+=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD
      || gf[10]+=TAB_SQL.UMF_ZWD
      ?};
      {? TAB_SQL.AKTYWNY<>'N'
      || gf[11]+=TAB_SQL.UMF_SKR
      ?};
      gf[12]+=(TAB_SQL.UMF_KON-TAB_SQL.AMOF);

      {? FINFO.TOR_D='T'
      || {? TAB_SQL.AKTYWNY<>'P' & TAB_SQL.MIE_OD=1
         || gd[2]+=TAB_SQL.WARD
         ?};
         {? TAB_SQL.AKTYWNY<>'N'
         || gd[4]+={? TAB_SQL.AKTYWNY='T' || TAB_SQL.WARD_ZW || 0 ?}+TAB_SQL.WARD_ZWD;
            gd[5]+=TAB_SQL.WARD_SKR;
            gd[6]+=TAB_SQL.WARD_KON
         || gd[4]+=TAB_SQL.WARD_ZWD
         ?};
         gd[7]+=(TAB_SQL.UMOD-TAB_SQL.AMOD);
         gd[9]+=TAB_SQL.UMD_CO;
         {? TAB_SQL.AKTYWNY='T'
         || gd[10]+=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD
         || gd[10]+=TAB_SQL.UMD_ZWD
         ?};
         {? TAB_SQL.AKTYWNY<>'N'
         || gd[11]+=TAB_SQL.UMD_SKR
         ?};
         gd[12]+=(TAB_SQL.UMD_KON-TAB_SQL.AMOD)
      ?}
   ?};

   {? PAR_WYDR.RODZAJ=1
   || {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
      || {? TAB_SQL.AKTYWNY<>'P' & TAB_SQL.MIE_OD=1
         || sum_pod[2]+=TAB_SQL.WARP;  "poczatek okresu"
         ?};
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_pod[4]+={? TAB_SQL.AKTYWNY='T' || TAB_SQL.WARP_ZW || 0 ?}+TAB_SQL.WARP_ZWD;  "ze zwiekszenia";
            sum_pod[5]+=TAB_SQL.WARP_SKR;  "skreslone z ewidencji";
            sum_pod[6]+=TAB_SQL.WARP_KON;  "koniec okresu"
         || sum_pod[4]+=TAB_SQL.WARP_ZWD
         ?};
         sum_pod[7]+=(TAB_SQL.UMOP-TAB_SQL.AMOP);  "poczatek okresu";
         sum_pod[9]+=TAB_SQL.UMP_CO;  "w ciagu okresu";
         sum_pod[10]+=TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD; "ze zwiekszenia";
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_pod[11]+=TAB_SQL.UMP_SKR; "skreslone z ewidencji"
         ?};
         sum_pod[12]+=(TAB_SQL.UMP_KON-TAB_SQL.AMOP); "koniec okresu"
      ?};

      {? PAR_WYDR.DANE=2 | PAR_WYDR.DANE=3
      || {? TAB_SQL.AKTYWNY<>'P' & TAB_SQL.MIE_OD=1
         || sum_fin[2]+=TAB_SQL.WARF;  "poczatek okresu"
         ?};
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_fin[4]+={? TAB_SQL.AKTYWNY='T' || TAB_SQL.WARF_ZW || 0 ?}+TAB_SQL.WARF_ZWD;  "ze zwiekszenia";
            sum_fin[5]+=TAB_SQL.WARF_SKR;  "skreslone z ewidencji";
            sum_fin[6]+=TAB_SQL.WARF_KON;  "koniec okresu"
         || sum_fin[4]+=TAB_SQL.WARF_ZWD
         ?};
         sum_fin[7]+=(TAB_SQL.UMOF-TAB_SQL.AMOF);  "poczatek okresu";
         sum_fin[9]+=TAB_SQL.UMF_CO;  "w ciagu okresu";
         sum_fin[10]+=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD;  "ze zwiekszenia";
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_fin[11]+=TAB_SQL.UMF_SKR;  "skreslone z ewidencji"
         ?};
         sum_fin[12]+=(TAB_SQL.UMF_KON-TAB_SQL.AMOF);  "koniec okresu"
      ?};

      {? (PAR_WYDR.DANE=4 | PAR_WYDR.DANE=3) & FINFO.TOR_D='T'
      || {? TAB_SQL.AKTYWNY<>'P' & TAB_SQL.MIE_OD=1
         || sum_dod[2]+=TAB_SQL.WARD;  "poczatek okresu"
         ?};
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_dod[4]+={? TAB_SQL.AKTYWNY='T' || TAB_SQL.WARD_ZW || 0 ?}+TAB_SQL.WARD_ZWD;  "ze zwiekszenia";
            sum_dod[5]+=TAB_SQL.WARD_SKR;  "skreslone z ewidencji";
            sum_dod[6]+=TAB_SQL.WARD_KON;  "koniec okresu"
         || sum_dod[4]+=TAB_SQL.WARD_ZWD
         ?};
         sum_dod[7]+=(TAB_SQL.UMOD-TAB_SQL.AMOD);  "poczatek okresu";
         sum_dod[9]+=TAB_SQL.UMD_CO;  "w ciagu okresu";
         sum_dod[10]+=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD;  "ze zwiekszenia";
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_dod[11]+=TAB_SQL.UMD_SKR;  "skreslone z ewidencji"
         ?};
         sum_dod[12]+=(TAB_SQL.UMD_KON-TAB_SQL.AMOD);  "koniec okresu"
      ?}
   |? PAR_WYDR.RODZAJ=2
   || sum_pod[2]+=TAB_SQL.WARP;  "poczatek okresu";
      sum_pod[4]+=TAB_SQL.WARP_ZW+TAB_SQL.WARP_ZWD;  "ze zwiekszenia";
      sum_pod[5]+=TAB_SQL.WARP_SKR;  "skreslone z ewidencji";
      sum_pod[6]+=TAB_SQL.WARP_KON;  "koniec okresu";
      sum_pod[7]+=(TAB_SQL.UMOP-TAB_SQL.AMOP);  "poczatek okresu";
      sum_pod[9]+=TAB_SQL.UMP_CO;  "w ciagu okresu";
      sum_pod[10]+=TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD; "ze zwiekszenia";
      sum_pod[11]+=TAB_SQL.UMP_SKR; "skreslone z ewidencji";
      sum_pod[12]+=(TAB_SQL.UMP_KON-TAB_SQL.AMOP); "koniec okresu";
      sum_fin[2]+=TAB_SQL.WARF;  "poczatek okresu";
      sum_fin[4]+=TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD;  "ze zwiekszenia";
      sum_fin[5]+=TAB_SQL.WARF_SKR;  "skreslone z ewidencji";
      sum_fin[6]+=TAB_SQL.WARF_KON;  "koniec okresu";
      sum_fin[7]+=(TAB_SQL.UMOF-TAB_SQL.AMOF);  "poczatek okresu";
      sum_fin[9]+=TAB_SQL.UMF_CO;  "w ciagu okresu";
      sum_fin[10]+=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD;  "ze zwiekszenia";
      sum_fin[11]+=TAB_SQL.UMF_SKR;  "skreslone z ewidencji";
      sum_fin[12]+=(TAB_SQL.UMF_KON-TAB_SQL.AMOF);  "koniec okresu";
      {? FINFO.TOR_D='T'
      || sum_dod[2]+=TAB_SQL.WARD;  "poczatek okresu";
         sum_dod[4]+=TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD;  "ze zwiekszenia";
         sum_dod[5]+=TAB_SQL.WARD_SKR;  "skreslone z ewidencji";
         sum_dod[6]+=TAB_SQL.WARD_KON;  "koniec okresu";
         sum_dod[7]+=(TAB_SQL.UMOD-TAB_SQL.AMOD);  "poczatek okresu";
         sum_dod[9]+=TAB_SQL.UMD_CO;  "w ciagu okresu";
         sum_dod[10]+=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD;  "ze zwiekszenia";
         sum_dod[11]+=TAB_SQL.UMD_SKR;  "skreslone z ewidencji";
         sum_dod[12]+=(TAB_SQL.UMD_KON-TAB_SQL.AMOD);  "koniec okresu"
      ?}
   ?}
 ;~~}
  {prn1:='PRN'; prn2:='PRN2';rsep:=1;~~}{IF: lineleft() <=6 & lineleft()<>0}{PAGE}{FI}{SUBSTITUTE: 'LINIA02'}
  {prn1:='PRN2'; prn2:='PRN';rsep:=1;~~}{SUBSTITUTE: 'LINIA02'}{prn1:='PRN'; prn2:='PRN';~~}
{COMMENT} ---- druga linia---- {COMMENT-}
{IF: PAR_WYDR.DANE = 3}
  {
   c[1]:='';
   c[13]:='';
   c[14]:='';
   c[15]:='';

   {? PAR_WYDR.RODZAJ=1
   ||
      {? TAB_SQL.AKTYWNY='T' || c[2]:=TAB_SQL.WARF
      |? TAB_SQL.AKTYWNY='P' || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[2]:='['+form(TAB_SQL.WARF,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[4]:=TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[4]:='['+form(TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[4]:='['+form(TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[5]:=TAB_SQL.WARF_SKR
      |? TAB_SQL.AKTYWNY='P' || c[5]:='['+form(TAB_SQL.WARF_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[5]:='['+form(TAB_SQL.WARF_SKR+(-1*TAB_SQL.WARF_ZWD),,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[6]:=TAB_SQL.WARF_KON
      |? TAB_SQL.AKTYWNY='P' || c[6]:='['+form(TAB_SQL.WARF_KON,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[6]:='-'
      ?};

      {? TAB_SQL.AKTYWNY='T' || c[7]:=TAB_SQL.UMOF-TAB_SQL.AMOF
      |? TAB_SQL.AKTYWNY='P' || c[7]:='-'
      |? TAB_SQL.AKTYWNY='N' || c[7]:='['+form(TAB_SQL.UMOF-TAB_SQL.AMOF,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[9]:=TAB_SQL.UMF_CO
      |? TAB_SQL.AKTYWNY='P' || c[9]:='['+form(TAB_SQL.UMF_CO,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[9]:='['+form(TAB_SQL.UMF_CO,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[10]:=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[10]:='['+form(TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[10]:='['+form(TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[11]:=TAB_SQL.UMF_SKR
      |? TAB_SQL.AKTYWNY='P' || c[11]:='['+form(TAB_SQL.UMF_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[11]:='['+form(TAB_SQL.UMF_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[12]:=(TAB_SQL.UMF_KON-TAB_SQL.AMOF)
      |? TAB_SQL.AKTYWNY='P' || c[12]:='['+form((TAB_SQL.UMF_KON-TAB_SQL.AMOF),,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || '-'
      ?}
   || c[2]:=TAB_SQL.WARF;
      c[4]:=TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD;
      c[5]:=TAB_SQL.WARF_SKR;
      c[6]:=TAB_SQL.WARF_KON;
      c[7]:=TAB_SQL.UMOF-TAB_SQL.AMOF;
      c[9]:=TAB_SQL.UMF_CO;
      c[10]:=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD;
      c[11]:=TAB_SQL.UMF_SKR;
      c[12]:=TAB_SQL.UMF_KON-TAB_SQL.AMOF
   ?};

   rsep:=PAR_WYDR.RSEP;
   prn1:='PRN'; prn2:='PRN'
  ;~~}
{COMMENT} ---- Trzecia linia---- {COMMENT-}
{IF: FINFO.TOR_D='T'}
  {SUBSTITUTE: 'LINIA02'}
  {
   c[1]:='';
   c[13]:='';
   c[14]:='';
   c[15]:='';

   {? PAR_WYDR.RODZAJ=1
   ||
      {? TAB_SQL.AKTYWNY='T' || c[2]:=TAB_SQL.WARD
      |? TAB_SQL.AKTYWNY='P' || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[2]:='['+form(TAB_SQL.WARD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[4]:=TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[4]:='['+form(TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[4]:='['+form(TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[5]:=TAB_SQL.WARD_SKR
      |? TAB_SQL.AKTYWNY='P' || c[5]:='['+form(TAB_SQL.WARD_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[5]:='['+form(TAB_SQL.WARD_SKR+(-1*TAB_SQL.WARD_ZWD),,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[6]:=TAB_SQL.WARD_KON
      |? TAB_SQL.AKTYWNY='P' || c[6]:='['+form(TAB_SQL.WARD_KON,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[6]:='-'
      ?};

      {? TAB_SQL.AKTYWNY='T' || c[7]:=TAB_SQL.UMOD-TAB_SQL.AMOD
      |? TAB_SQL.AKTYWNY='P' || c[7]:='-'
      |? TAB_SQL.AKTYWNY='N' || c[7]:='['+form(TAB_SQL.UMOD-TAB_SQL.AMOD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[9]:=TAB_SQL.UMD_CO
      |? TAB_SQL.AKTYWNY='P' || c[9]:='['+form(TAB_SQL.UMD_CO,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[9]:='['+form(TAB_SQL.UMD_CO,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[10]:=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[10]:='['+form(TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[10]:='['+form(TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[11]:=TAB_SQL.UMD_SKR
      |? TAB_SQL.AKTYWNY='P' || c[11]:='['+form(TAB_SQL.UMD_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[11]:='['+form(TAB_SQL.UMD_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[12]:=(TAB_SQL.UMD_KON-TAB_SQL.AMOD)
      |? TAB_SQL.AKTYWNY='P' || c[12]:='['+form((TAB_SQL.UMD_KON-TAB_SQL.AMOD),,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || '-'
      ?}
   || c[2]:=TAB_SQL.WARD;
      c[4]:=TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD;
      c[5]:=TAB_SQL.WARD_SKR;
      c[6]:=TAB_SQL.WARD_KON;
      c[7]:=TAB_SQL.UMOD-TAB_SQL.AMOD;
      c[9]:=TAB_SQL.UMD_CO;
      c[10]:=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD;
      c[11]:=TAB_SQL.UMD_SKR;
      c[12]:=TAB_SQL.UMD_KON-TAB_SQL.AMOD
   ?};

   rsep:=PAR_WYDR.RSEP;
   prn1:='PRN'; prn2:='PRN'
  ;~~}
{FI}
  {SUBSTITUTE: 'LINIA0'}
{FI}
  {rsep:=PAR_WYDR.RSEP;~~}
  {
   {? PAR_WYDR.RODZAJ = 1
   || {? PAR_WYDR.ZESTAW = 1
      || sum_grupa:=TAB_SQL.ODDZIAL
      |? PAR_WYDR.ZESTAW = 2
      || sum_grupa:=TAB_SQL.GR
      ?}
   ?}
 ;~~}
 {FI}
 {COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
   {? PAR_WYDR.RODZAJ=1
   || c[22]:=TAB_SQL.GRUPA;
      c[23]:=TAB_SQL.NRI;
      c[25] := TAB_SQL.NST;
      {? TAB_SQL.AKTYWNY='N'
      || _mie:=TAB_SQL.MIE_DO;
         _dzi:=0
      |? TAB_SQL.AKTYWNY='P'
      || _mie:=TAB_SQL.MIE_OD;
         _dzi:=1
      ?};
      {? TAB_SQL.AKTYWNY<>'T'
      || _rok:=SSTALE.AO().RES;
         _data:=$(date(_rok,_mie,_dzi))
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[24]:=TAB_SQL.ODDZIAL+ {? PAR_WYDR.ASKJRG='T' || ' ('+TAB_SQL.JORG+')' || '' ?}
      |? TAB_SQL.AKTYWNY='P' || c[24]:=TAB_SQL.ODDZIAL+ {? PAR_WYDR.ASKJRG='T' || ' ('+TAB_SQL.JORG+')' || '' ?} +' [od: '+_data+']'
      |? TAB_SQL.AKTYWNY='N' || c[24]:=TAB_SQL.ODDZIAL+ {? PAR_WYDR.ASKJRG='T' || ' ('+TAB_SQL.JORG+')' || '' ?} +' [do: '+_data+']'
      ?}
   |? PAR_WYDR.RODZAJ = 2
   || c[22]:= {? PAR_WYDR.ZESTAW = 1 || 'JEDN. KS.: '@ + TAB_SQL.ODDZIAL || 'GRUPA: '@ + TAB_SQL.GR ?}
   ?};

   {? PAR_WYDR.RODZAJ=1 & (PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3)
   || {? TAB_SQL.AKTYWNY='T' || c[2]:=TAB_SQL.WARP
      |? TAB_SQL.AKTYWNY='P' || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[2]:='['+form(TAB_SQL.WARP,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[4]:=TAB_SQL.WARP_ZW+TAB_SQL.WARP_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[4]:='['+form(TAB_SQL.WARP_ZW+TAB_SQL.WARP_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[4]:='['+form(TAB_SQL.WARP_ZW+TAB_SQL.WARP_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[5]:=TAB_SQL.WARP_SKR
      |? TAB_SQL.AKTYWNY='P' || c[5]:='['+form(TAB_SQL.WARP_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[5]:='['+form(TAB_SQL.WARP_SKR+(-1*TAB_SQL.WARP_ZWD),,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[6]:=TAB_SQL.WARP_KON
      |? TAB_SQL.AKTYWNY='P' || c[6]:='['+form(TAB_SQL.WARP_KON,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[6]:='-'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[7]:=TAB_SQL.UMOP-TAB_SQL.AMOP
      |? TAB_SQL.AKTYWNY='P' || c[7]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || c[7]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[7]:='['+form(TAB_SQL.UMOP-TAB_SQL.AMOP,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[9]:=TAB_SQL.UMP_CO
      |? TAB_SQL.AKTYWNY='P' || c[9]:='['+form(TAB_SQL.UMP_CO,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[9]:='['+form(TAB_SQL.UMP_CO,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[10]:=TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[10]:='['+form(TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[10]:='['+form(TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[11]:=TAB_SQL.UMP_SKR
      |? TAB_SQL.AKTYWNY='P' || c[11]:='['+form(TAB_SQL.UMP_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[11]:='['+form(TAB_SQL.UMP_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[12]:=(TAB_SQL.UMP_KON-TAB_SQL.AMOP)
      |? TAB_SQL.AKTYWNY='P' || c[12]:='['+form((TAB_SQL.UMP_KON),,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[12]:='-'
      ?}
   |? PAR_WYDR.RODZAJ=1 & PAR_WYDR.DANE = 2
   || {? TAB_SQL.AKTYWNY='T' || c[13]:=TAB_SQL.WARF
      |? TAB_SQL.AKTYWNY='P' || c[13]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || c[13]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[13]:='['+form(TAB_SQL.WARF,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[14]:=TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[14]:='['+form(TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[14]:='['+form(TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[15]:=TAB_SQL.WARF_SKR
      |? TAB_SQL.AKTYWNY='P' || c[15]:='['+form(TAB_SQL.WARF_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[15]:='['+form(TAB_SQL.WARF_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[16]:=TAB_SQL.WARF_KON
      |? TAB_SQL.AKTYWNY='P' || c[16]:='['+form(TAB_SQL.WARF_KON,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[16]:='-'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[17]:=TAB_SQL.UMOF-TAB_SQL.AMOF
      |? TAB_SQL.AKTYWNY='P' || c[17]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || '-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[17]:='['+form(TAB_SQL.UMOF-TAB_SQL.AMOF,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[18]:=TAB_SQL.UMF_CO
      |? TAB_SQL.AKTYWNY='P' || c[18]:='['+form(TAB_SQL.UMF_CO,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[18]:='['+form(TAB_SQL.UMF_CO,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[19]:=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[19]:='['+form(TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[19]:='['+form(TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[20]:=TAB_SQL.UMF_SKR
      |? TAB_SQL.AKTYWNY='P' || c[20]:='['+form(TAB_SQL.UMF_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[20]:='['+form(TAB_SQL.UMF_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[21]:=(TAB_SQL.UMF_KON-TAB_SQL.AMOF)
      |? TAB_SQL.AKTYWNY='P' || c[21]:='['+form((TAB_SQL.UMF_KON),,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[21]:='-'
      ?}
   |? PAR_WYDR.RODZAJ=1 & PAR_WYDR.DANE = 4
   || {? TAB_SQL.AKTYWNY='T' || c[26]:=TAB_SQL.WARD
      |? TAB_SQL.AKTYWNY='P' || c[26]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || c[26]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[26]:='['+form(TAB_SQL.WARD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[27]:=TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[27]:='['+form(TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[27]:='['+form(TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[28]:=TAB_SQL.WARD_SKR
      |? TAB_SQL.AKTYWNY='P' || c[28]:='['+form(TAB_SQL.WARD_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[28]:='['+form(TAB_SQL.WARD_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[29]:=TAB_SQL.WARD_KON
      |? TAB_SQL.AKTYWNY='P' || c[29]:='['+form(TAB_SQL.WARD_KON,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[29]:='-'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[30]:=TAB_SQL.UMOD-TAB_SQL.AMOD
      |? TAB_SQL.AKTYWNY='P' || c[30]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || '-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[30]:='['+form(TAB_SQL.UMOD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[31]:=TAB_SQL.UMD_CO
      |? TAB_SQL.AKTYWNY='P' || c[31]:='['+form(TAB_SQL.UMD_CO,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[31]:='['+form(TAB_SQL.UMD_CO,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[32]:=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[32]:='['+form(TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[32]:='['+form(TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[33]:=TAB_SQL.UMD_SKR
      |? TAB_SQL.AKTYWNY='P' || c[33]:='['+form(TAB_SQL.UMD_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[33]:='['+form(TAB_SQL.UMD_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[34]:=(TAB_SQL.UMD_KON-TAB_SQL.AMOD)
      |? TAB_SQL.AKTYWNY='P' || c[34]:='['+form((TAB_SQL.UMD_KON),,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[34]:='-'
      ?}
   |? PAR_WYDR.RODZAJ=2
   || {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
      || c[2]:=TAB_SQL.WARP;
         c[4]:=TAB_SQL.WARP_ZW+TAB_SQL.WARP_ZWD;
         c[5]:=TAB_SQL.WARP_SKR;
         c[6]:=TAB_SQL.WARP_KON;
         c[7]:=TAB_SQL.UMOP-TAB_SQL.AMOP;
         c[9]:=TAB_SQL.UMP_CO;
         c[10]:=TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD;
         c[11]:=TAB_SQL.UMP_SKR;
         c[12]:=TAB_SQL.UMP_KON-TAB_SQL.AMOP
      |? PAR_WYDR.DANE=2
      || c[13]:=TAB_SQL.WARF;
         c[14]:=TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD;
         c[15]:=TAB_SQL.WARF_SKR;
         c[16]:=TAB_SQL.WARF_KON;
         c[17]:=TAB_SQL.UMOF-TAB_SQL.AMOF;
         c[18]:=TAB_SQL.UMF_CO;
         c[19]:=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD;
         c[20]:=TAB_SQL.UMF_SKR;
         c[21]:=TAB_SQL.UMF_KON-TAB_SQL.AMOF
      |? PAR_WYDR.DANE=4
      || c[26]:=TAB_SQL.WARD;
         c[27]:=TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD;
         c[28]:=TAB_SQL.WARD_SKR;
         c[29]:=TAB_SQL.WARD_KON;
         c[30]:=TAB_SQL.UMOD-TAB_SQL.AMOD;
         c[31]:=TAB_SQL.UMD_CO;
         c[32]:=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD;
         c[33]:=TAB_SQL.UMD_SKR;
         c[34]:=TAB_SQL.UMD_KON-TAB_SQL.AMOD
      ?}
   ?};
~~}
{
   {? PAR_WYDR.RODZAJ=1
   || {? TAB_SQL.AKTYWNY<>'P' & TAB_SQL.MIE_OD=1
      || gp[2]+=TAB_SQL.WARP
      ?};
      {? TAB_SQL.AKTYWNY<>'N'
      || gp[4]+={? TAB_SQL.AKTYWNY='T' || TAB_SQL.WARP_ZW || 0 ?}+TAB_SQL.WARP_ZWD;
         gp[5]+=TAB_SQL.WARP_SKR;
         gp[6]+=TAB_SQL.WARP_KON
      || gp[4]+=TAB_SQL.WARP_ZWD
      ?};
      gp[7]+=(TAB_SQL.UMOP-TAB_SQL.AMOP);
      gp[9]+=TAB_SQL.UMP_CO;
      {? TAB_SQL.AKTYWNY='T'
      || gp[10]+=TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD
      || gp[10]+=TAB_SQL.UMP_ZWD
      ?};
      {? TAB_SQL.AKTYWNY<>'N'
      || gp[11]+=TAB_SQL.UMP_SKR
      ?};
      gp[12]+=(TAB_SQL.UMP_KON-TAB_SQL.AMOP);

      {? TAB_SQL.AKTYWNY<>'P' & TAB_SQL.MIE_OD=1
      || gf[2]+=TAB_SQL.WARF
      ?};
      {? TAB_SQL.AKTYWNY<>'N'
      || gf[4]+={? TAB_SQL.AKTYWNY='T' || TAB_SQL.WARF_ZW || 0 ?}+TAB_SQL.WARF_ZWD;
         gf[5]+=TAB_SQL.WARF_SKR;
         gf[6]+=TAB_SQL.WARF_KON
      || gf[4]+=TAB_SQL.WARF_ZWD
      ?};
      gf[7]+=(TAB_SQL.UMOF-TAB_SQL.AMOF);
      gf[9]+=TAB_SQL.UMF_CO;
      {? TAB_SQL.AKTYWNY='T'
      || gf[10]+=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD
      || gf[10]+=TAB_SQL.UMF_ZWD
      ?};
      {? TAB_SQL.AKTYWNY<>'N'
      || gf[11]+=TAB_SQL.UMF_SKR
      ?};
      gf[12]+=(TAB_SQL.UMF_KON-TAB_SQL.AMOF);

      {? FINFO.TOR_D='T'
      || {? TAB_SQL.AKTYWNY<>'P' & TAB_SQL.MIE_OD=1
         || gd[2]+=TAB_SQL.WARD
         ?};
         {? TAB_SQL.AKTYWNY<>'N'
         || gd[4]+={? TAB_SQL.AKTYWNY='T' || TAB_SQL.WARD_ZW || 0 ?}+TAB_SQL.WARD_ZWD;
            gd[5]+=TAB_SQL.WARD_SKR;
            gd[6]+=TAB_SQL.WARD_KON
         || gd[4]+=TAB_SQL.WARD_ZWD
         ?};
         gd[7]+=(TAB_SQL.UMOD-TAB_SQL.AMOD);
         gd[9]+=TAB_SQL.UMD_CO;
         {? TAB_SQL.AKTYWNY='T'
         || gd[10]+=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD
         || gd[10]+=TAB_SQL.UMD_ZWD
         ?};
         {? TAB_SQL.AKTYWNY<>'N'
         || gd[11]+=TAB_SQL.UMD_SKR
         ?};
         gd[12]+=(TAB_SQL.UMD_KON-TAB_SQL.AMOD)
      ?}
   ?};

   {? PAR_WYDR.RODZAJ=1
   || {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
      || {? TAB_SQL.AKTYWNY<>'P' & TAB_SQL.MIE_OD=1
         || sum_pod[2]+=TAB_SQL.WARP;  "poczatek okresu"
         ?};
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_pod[4]+={? TAB_SQL.AKTYWNY='T' || TAB_SQL.WARP_ZW || 0 ?}+TAB_SQL.WARP_ZWD;  "ze zwiekszenia";
            sum_pod[5]+=TAB_SQL.WARP_SKR;  "skreslone z ewidencji";
            sum_pod[6]+=TAB_SQL.WARP_KON;  "koniec okresu"
         || sum_pod[4]+=TAB_SQL.WARP_ZWD
         ?};
         sum_pod[7]+=(TAB_SQL.UMOP-TAB_SQL.AMOP);  "poczatek okresu";
         sum_pod[9]+=TAB_SQL.UMP_CO;  "w ciagu okresu";
         sum_pod[10]+=TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD; "ze zwiekszenia";
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_pod[11]+=TAB_SQL.UMP_SKR; "skreslone z ewidencji"
         ?};
         sum_pod[12]+=(TAB_SQL.UMP_KON-TAB_SQL.AMOP); "koniec okresu"
      ?};

      {? PAR_WYDR.DANE=2 | PAR_WYDR.DANE=3
      || {? TAB_SQL.AKTYWNY<>'P' & TAB_SQL.MIE_OD=1
         || sum_fin[2]+=TAB_SQL.WARF;  "poczatek okresu"
         ?};
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_fin[4]+={? TAB_SQL.AKTYWNY='T' || TAB_SQL.WARF_ZW || 0 ?}+TAB_SQL.WARF_ZWD;  "ze zwiekszenia";
            sum_fin[5]+=TAB_SQL.WARF_SKR;  "skreslone z ewidencji";
            sum_fin[6]+=TAB_SQL.WARF_KON;  "koniec okresu"
         || sum_fin[4]+=TAB_SQL.WARF_ZWD
         ?};
         sum_fin[7]+=(TAB_SQL.UMOF-TAB_SQL.AMOF);  "poczatek okresu";
         sum_fin[9]+=TAB_SQL.UMF_CO;  "w ciagu okresu";
         sum_fin[10]+=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD;  "ze zwiekszenia";
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_fin[11]+=TAB_SQL.UMF_SKR;  "skreslone z ewidencji"
         ?};
         sum_fin[12]+=(TAB_SQL.UMF_KON-TAB_SQL.AMOF);  "koniec okresu"
      ?};

      {? (PAR_WYDR.DANE=4 | PAR_WYDR.DANE=3) & FINFO.TOR_D='T'
      || {? TAB_SQL.AKTYWNY<>'P' & TAB_SQL.MIE_OD=1
         || sum_dod[2]+=TAB_SQL.WARD;  "poczatek okresu"
         ?};
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_dod[4]+={? TAB_SQL.AKTYWNY='T' || TAB_SQL.WARD_ZW || 0 ?}+TAB_SQL.WARD_ZWD;  "ze zwiekszenia";
            sum_dod[5]+=TAB_SQL.WARD_SKR;  "skreslone z ewidencji";
            sum_dod[6]+=TAB_SQL.WARD_KON;  "koniec okresu"
         || sum_dod[4]+=TAB_SQL.WARD_ZWD
         ?};
         sum_dod[7]+=(TAB_SQL.UMOD-TAB_SQL.AMOD);  "poczatek okresu";
         sum_dod[9]+=TAB_SQL.UMD_CO;  "w ciagu okresu";
         sum_dod[10]+=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD;  "ze zwiekszenia";
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_dod[11]+=TAB_SQL.UMD_SKR;  "skreslone z ewidencji"
         ?};
         sum_dod[12]+=(TAB_SQL.UMD_KON-TAB_SQL.AMOD);  "koniec okresu"
      ?}
   |? PAR_WYDR.RODZAJ=2
   || sum_pod[2]+=TAB_SQL.WARP;  "poczatek okresu";
      sum_pod[4]+=TAB_SQL.WARP_ZW+TAB_SQL.WARP_ZWD;  "ze zwiekszenia";
      sum_pod[5]+=TAB_SQL.WARP_SKR;  "skreslone z ewidencji";
      sum_pod[6]+=TAB_SQL.WARP_KON;  "koniec okresu";
      sum_pod[7]+=(TAB_SQL.UMOP-TAB_SQL.AMOP);  "poczatek okresu";
      sum_pod[9]+=TAB_SQL.UMP_CO;  "w ciagu okresu";
      sum_pod[10]+=TAB_SQL.UMP_ZW+TAB_SQL.UMP_ZWD; "ze zwiekszenia";
      sum_pod[11]+=TAB_SQL.UMP_SKR; "skreslone z ewidencji";
      sum_pod[12]+=(TAB_SQL.UMP_KON-TAB_SQL.AMOP); "koniec okresu";
      sum_fin[2]+=TAB_SQL.WARF;  "poczatek okresu";
      sum_fin[4]+=TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD;  "ze zwiekszenia";
      sum_fin[5]+=TAB_SQL.WARF_SKR;  "skreslone z ewidencji";
      sum_fin[6]+=TAB_SQL.WARF_KON;  "koniec okresu";
      sum_fin[7]+=(TAB_SQL.UMOF-TAB_SQL.AMOF);  "poczatek okresu";
      sum_fin[9]+=TAB_SQL.UMF_CO;  "w ciagu okresu";
      sum_fin[10]+=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD;  "ze zwiekszenia";
      sum_fin[11]+=TAB_SQL.UMF_SKR;  "skreslone z ewidencji";
      sum_fin[12]+=(TAB_SQL.UMF_KON-TAB_SQL.AMOF);  "koniec okresu";
      {? FINFO.TOR_D='T'
      || sum_dod[2]+=TAB_SQL.WARD;  "poczatek okresu";
         sum_dod[4]+=TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD;  "ze zwiekszenia";
         sum_dod[5]+=TAB_SQL.WARD_SKR;  "skreslone z ewidencji";
         sum_dod[6]+=TAB_SQL.WARD_KON;  "koniec okresu";
         sum_dod[7]+=(TAB_SQL.UMOD-TAB_SQL.AMOD);  "poczatek okresu";
         sum_dod[9]+=TAB_SQL.UMD_CO;  "w ciagu okresu";
         sum_dod[10]+=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD;  "ze zwiekszenia";
         sum_dod[11]+=TAB_SQL.UMD_SKR;  "skreslone z ewidencji";
         sum_dod[12]+=(TAB_SQL.UMD_KON-TAB_SQL.AMOD);  "koniec okresu"
      ?}
   ?}
 ;~~}
{COMMENT} ---- druga linia---- {COMMENT-}
{IF: PAR_WYDR.DANE = 3}
  {
   {? PAR_WYDR.RODZAJ=1
   ||
      {? TAB_SQL.AKTYWNY='T' || c[13]:=TAB_SQL.WARF
      |? TAB_SQL.AKTYWNY='P' || c[13]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || c[13]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[13]:='['+form(TAB_SQL.WARF,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[14]:=TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[14]:='['+form(TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[14]:='['+form(TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[15]:=TAB_SQL.WARF_SKR
      |? TAB_SQL.AKTYWNY='P' || c[15]:='['+form(TAB_SQL.WARF_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[15]:='['+form(TAB_SQL.WARF_SKR+(-1*TAB_SQL.WARF_ZWD),,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[16]:=TAB_SQL.WARF_KON
      |? TAB_SQL.AKTYWNY='P' || c[16]:='['+form(TAB_SQL.WARF_KON,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[16]:='-'
      ?};

      {? TAB_SQL.AKTYWNY='T' || c[17]:=TAB_SQL.UMOF-TAB_SQL.AMOF
      |? TAB_SQL.AKTYWNY='P' || c[17]:='-'
      |? TAB_SQL.AKTYWNY='N' || c[17]:='['+form(TAB_SQL.UMOF-TAB_SQL.AMOF,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[18]:=TAB_SQL.UMF_CO
      |? TAB_SQL.AKTYWNY='P' || c[18]:='['+form(TAB_SQL.UMF_CO,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[18]:='['+form(TAB_SQL.UMF_CO,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[19]:=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[19]:='['+form(TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[19]:='['+form(TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[20]:=TAB_SQL.UMF_SKR
      |? TAB_SQL.AKTYWNY='P' || c[20]:='['+form(TAB_SQL.UMF_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[20]:='['+form(TAB_SQL.UMF_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[21]:=(TAB_SQL.UMF_KON-TAB_SQL.AMOF)
      |? TAB_SQL.AKTYWNY='P' || c[21]:='['+form((TAB_SQL.UMF_KON-TAB_SQL.AMOF),,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || '-'
      ?}
   || c[13]:=TAB_SQL.WARF;
      c[14]:=TAB_SQL.WARF_ZW+TAB_SQL.WARF_ZWD;
      c[15]:=TAB_SQL.WARF_SKR;
      c[16]:=TAB_SQL.WARF_KON;
      c[17]:=TAB_SQL.UMOF-TAB_SQL.AMOF;
      c[18]:=TAB_SQL.UMF_CO;
      c[19]:=TAB_SQL.UMF_ZW+TAB_SQL.UMF_ZWD;
      c[20]:=TAB_SQL.UMF_SKR;
      c[21]:=TAB_SQL.UMF_KON-TAB_SQL.AMOF
   ?};

   rsep:=PAR_WYDR.RSEP;
   prn1:='PRN'; prn2:='PRN'
  ;~~}
{COMMENT} ---- Trzecia linia---- {COMMENT-}
{IF: FINFO.TOR_D='T'}
  {
   {? PAR_WYDR.RODZAJ=1
   ||
      {? TAB_SQL.AKTYWNY='T' || c[2]:=TAB_SQL.WARD
      |? TAB_SQL.AKTYWNY='P' || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD>1 || c[2]:='-'
      |? TAB_SQL.AKTYWNY='N' & TAB_SQL.MIE_OD=1 || c[2]:='['+form(TAB_SQL.WARD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[4]:=TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[4]:='['+form(TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[4]:='['+form(TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[5]:=TAB_SQL.WARD_SKR
      |? TAB_SQL.AKTYWNY='P' || c[5]:='['+form(TAB_SQL.WARD_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[5]:='['+form(TAB_SQL.WARD_SKR+(-1*TAB_SQL.WARD_ZWD),,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[6]:=TAB_SQL.WARD_KON
      |? TAB_SQL.AKTYWNY='P' || c[6]:='['+form(TAB_SQL.WARD_KON,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[6]:='-'
      ?};

      {? TAB_SQL.AKTYWNY='T' || c[7]:=TAB_SQL.UMOD-TAB_SQL.AMOD
      |? TAB_SQL.AKTYWNY='P' || c[7]:='-'
      |? TAB_SQL.AKTYWNY='N' || c[7]:='['+form(TAB_SQL.UMOD-TAB_SQL.AMOD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[9]:=TAB_SQL.UMD_CO
      |? TAB_SQL.AKTYWNY='P' || c[9]:='['+form(TAB_SQL.UMD_CO,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[9]:='['+form(TAB_SQL.UMD_CO,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[10]:=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD
      |? TAB_SQL.AKTYWNY='P' || c[10]:='['+form(TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[10]:='['+form(TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[11]:=TAB_SQL.UMD_SKR
      |? TAB_SQL.AKTYWNY='P' || c[11]:='['+form(TAB_SQL.UMD_SKR,,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || c[11]:='['+form(TAB_SQL.UMD_SKR,,2,' ,')+']'
      ?};
      {? TAB_SQL.AKTYWNY='T' || c[12]:=(TAB_SQL.UMD_KON-TAB_SQL.AMOD)
      |? TAB_SQL.AKTYWNY='P' || c[12]:='['+form((TAB_SQL.UMD_KON-TAB_SQL.AMOD),,2,' ,')+']'
      |? TAB_SQL.AKTYWNY='N' || '-'
      ?}
   || c[2]:=TAB_SQL.WARD;
      c[4]:=TAB_SQL.WARD_ZW+TAB_SQL.WARD_ZWD;
      c[5]:=TAB_SQL.WARD_SKR;
      c[6]:=TAB_SQL.WARD_KON;
      c[7]:=TAB_SQL.UMOD-TAB_SQL.AMOD;
      c[9]:=TAB_SQL.UMD_CO;
      c[10]:=TAB_SQL.UMD_ZW+TAB_SQL.UMD_ZWD;
      c[11]:=TAB_SQL.UMD_SKR;
      c[12]:=TAB_SQL.UMD_KON-TAB_SQL.AMOD
   ?};

   rsep:=PAR_WYDR.RSEP;
   prn1:='PRN'; prn2:='PRN'
  ;~~}
{FI}
{FI}
 {rsep:=PAR_WYDR.RSEP;~~}
  {
   {? PAR_WYDR.RODZAJ = 1
   || {? PAR_WYDR.ZESTAW = 1
      || sum_grupa:=TAB_SQL.ODDZIAL
      |? PAR_WYDR.ZESTAW = 2
      || sum_grupa:=TAB_SQL.GR
      ?}
   ?}
 ;~~}
  {prn1:='PRN'; prn2:='PRN2';rsep:=1;~~}{IF: lineleft() <=6 & lineleft()<>0}{PAGE}{FI}{SUBSTITUTE: 'LINIA02'}
  {prn1:='PRN2'; prn2:='PRN';rsep:=1;~~}{SUBSTITUTE: 'LINIA02'}{prn1:='PRN'; prn2:='PRN';~~}
{FI}
{OD}
{COMMENT} ---- podsumowanie czastkowe za ostatnim rekordem tabeli TAB_SQL ---- {COMMENT-}
 {COMMENT} ---- Podsumowania nie występują dla excel ---- {COMMENT-}
{IF: ~rep_export()}
{ {? PAR_WYDR.RODZAJ=1
   ||
      {? PAR_WYDR.ZESTAW=1
      || test_grupa:=TAB_SQL.ODDZIAL
      |? PAR_WYDR.ZESTAW=2
      || test_grupa:=TAB_SQL.GR
      ?};
      {? sum_grupa='' || test_grupa:=''?}
   ?}
;~~}
{IF: PAR_WYDR.RODZAJ=1}
{COMMENT}Pierwsza linia podsumowania czastkowego{COMMENT-}
{
   podsum:=1;
   {? PAR_WYDR.ZESTAW=1
   || d[13]:='Razem: jedn. księg. '@+sum_grupa
   |? PAR_WYDR.ZESTAW=2
   || d[13]:='Razem: grupa '@+sum_grupa
   ?};
   {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
   || c[2]:=gp[2]; c[3]:=gp[3]; c[4]:=gp[4]; c[5]:=gp[5]; c[6]:=gp[6];
      c[7]:=gp[7]; c[8]:=gp[8]; c[9]:=gp[9]; c[10]:=gp[10]; c[11]:=gp[11]; c[12]:=gp[12]
   |? PAR_WYDR.DANE = 2
   || c[2]:=gf[2]; c[3]:=gf[3]; c[4]:=gf[4]; c[5]:=gf[5]; c[6]:=gf[6];
      c[7]:=gf[7]; c[8]:=gf[8]; c[9]:=gf[9]; c[10]:=gf[10]; c[11]:=gf[11]; c[12]:=gf[12]
   |? PAR_WYDR.DANE = 4
   || c[2]:=gd[2]; c[3]:=gd[3]; c[4]:=gd[4]; c[5]:=gd[5]; c[6]:=gd[6];
      c[7]:=gd[7]; c[8]:=gd[8]; c[9]:=gd[9]; c[10]:=gd[10]; c[11]:=gd[11]; c[12]:=gd[12]
   ?}
  ;~~}
  {FONT: 'T8GB'}{SPACE: 'C'}
  {prn1:='PRN'; prn2:='PRN4';rsep:=1;~~}
  {IF: lineleft()<= (4+{? PAR_WYDR.DANE=3 || 2 || 0 ?} ) & lineleft()<>0}{PAGE}{FI}
  {SUBSTITUTE: 'LINIA02'}
  {prn1:='PRN4'; prn2:='PRN';rsep:=1;~~}
  {SUBSTITUTE: 'LINIA02'}
{COMMENT}Druga linia podsumowania czastkowego{COMMENT-}
  {IF: PAR_WYDR.DANE=3}
  {
   c[2]:=gf[2]; c[3]:=gf[3]; c[4]:=gf[4]; c[5]:=gf[5]; c[6]:=gf[6];
   c[7]:=gf[7]; c[8]:=gf[8]; c[9]:=gf[9]; c[10]:=gf[10]; c[11]:=gf[11]; c[12]:=gf[12];
   rsep:=PAR_WYDR.RSEP; "vp:=0"
   ;~~}
  {prn1:='PRN'; prn2:='PRN';~~}
{COMMENT}Trzecia linia podsumowania czastkowego{COMMENT-}
  {IF: FINFO.TOR_D='T'}
  {SUBSTITUTE: 'LINIA02'}
  {
   c[2]:=gd[2]; c[3]:=gd[3]; c[4]:=gd[4]; c[5]:=gd[5]; c[6]:=gd[6];
   c[7]:=gd[7]; c[8]:=gd[8]; c[9]:=gd[9]; c[10]:=gd[10]; c[11]:=gd[11]; c[12]:=gd[12];
   rsep:=PAR_WYDR.RSEP; "vp:=0"
   ;~~}
  {prn1:='PRN'; prn2:='PRN';~~}
  {FI}
  {SUBSTITUTE: 'LINIA0'}
  {FI}
  {rsep:=PAR_WYDR.RSEP;
  prn1:='PRN'; prn2:='PRN';
  podsum:=0
  ;~~}
{FI}
{FI}
{COMMENT}------------------------------FOOTER-LAST------------------{COMMENT-}
{IF: lineleft()<>0 & lineleft()<6}{PAGE}{FI}
{FOOTER}{FOOTER-}
 {COMMENT} ---- Podsumowania nie występują dla excel ---- {COMMENT-}
{IF: ~rep_export()}
{FONT: 'T8GB'}{SPACE: 'C'}
{  podsum:=1;
   {? PAR_WYDR.RODZAJ=1
   || d[13]:='Ogółem:'@
   |? PAR_WYDR.RODZAJ=2
   || c[1]:='Ogółem:'@
   ?};
   {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
   || c[2]:=sum_pod[2];
      c[3]:=sum_pod[3];
      c[4]:=sum_pod[4];
      c[5]:=sum_pod[5];
      c[6]:=sum_pod[6];
      c[7]:=sum_pod[7];
      c[8]:=sum_pod[8];
      c[9]:=sum_pod[9];
      c[10]:=sum_pod[10];
      c[11]:=sum_pod[11];
      c[12]:=sum_pod[12]
   |? PAR_WYDR.DANE=2
   || c[2]:=sum_fin[2];
      c[3]:=sum_fin[3];
      c[4]:=sum_fin[4];
      c[5]:=sum_fin[5];
      c[6]:=sum_fin[6];
      c[7]:=sum_fin[7];
      c[8]:=sum_fin[8];
      c[9]:=sum_fin[9];
      c[10]:=sum_fin[10];
      c[11]:=sum_fin[11];
      c[12]:=sum_fin[12]
   |? PAR_WYDR.DANE=4
   || c[2]:=sum_dod[2];
      c[3]:=sum_dod[3];
      c[4]:=sum_dod[4];
      c[5]:=sum_dod[5];
      c[6]:=sum_dod[6];
      c[7]:=sum_dod[7];
      c[8]:=sum_dod[8];
      c[9]:=sum_dod[9];
      c[10]:=sum_dod[10];
      c[11]:=sum_dod[11];
      c[12]:=sum_dod[12]
   ?}
;~~}
{prn1:='PRN'; prn2:='PRN4';rsep:=1;~~}
{SUBSTITUTE: 'LINIA02'}
{prn1:='PRN4'; prn2:='PRNF';rsep:=1;~~}
{SUBSTITUTE: 'LINIA02'}
{IF: PAR_WYDR.DANE=3}
{
   c[1]:=''; c[13]:='';
   c[2]:=sum_fin[2];
   c[3]:=sum_fin[3];
   c[4]:=sum_fin[4];
   c[5]:=sum_fin[5];
   c[6]:=sum_fin[6];
   c[7]:=sum_fin[7];
   c[8]:=sum_fin[8];
   c[9]:=sum_fin[9];
   c[10]:=sum_fin[10];
   c[11]:=sum_fin[11];
   c[12]:=sum_fin[12];
   prn1:='PRNF'; prn2:='PRNF';
   rsep:=PAR_WYDR.RSEP
;~~}
{SUBSTITUTE: 'LINIA02'}
{IF: FINFO.TOR_D='T'}
{
   c[1]:=''; c[13]:='';
   c[2]:=sum_dod[2];
   c[3]:=sum_dod[3];
   c[4]:=sum_dod[4];
   c[5]:=sum_dod[5];
   c[6]:=sum_dod[6];
   c[7]:=sum_dod[7];
   c[8]:=sum_dod[8];
   c[9]:=sum_dod[9];
   c[10]:=sum_dod[10];
   c[11]:=sum_dod[11];
   c[12]:=sum_dod[12];
   prn1:='PRNF'; prn2:='PRNF';
   rsep:=PAR_WYDR.RSEP
;~~}
{SUBSTITUTE: 'LINIA02'}
{FI}
{FI}
{FI}
{ prn1:='PRN';prn2:='PRN'; vp:=0; ~~}
{REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}