:!UTF-8
{TITLE:Taryfikator operacji}
{PRINTER: INFO.W_PRN,,,,,'E','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
      PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
  TTOPER.cntx_psh();
  PRN:= obj_new(@.CLASS.PRINT, 6);
  PRN.sl_frame();
  prn1:='PRN';
  waslbar:=0;
  dalej:=0;
  color:='';
  lm:=ll:=vp:=lmt:=rsep:=0
}
{END:
  TTOPER.cntx_pop();
  obj_del(PRN);
  &dalej;
  &prn1;
  &color;
  &lm; &ll; &vp; &lmt; &rsep
}
{COMMENT}
  Wydruk tabeli taryfikatora operacji.
  [SS] - 2000/09/21 - [7.22]
  [MKO] - 2001/10/19 - [7.53] OWwSK003_Aneks1
  Wywołanie: Ustawienia i parametryzacja -> Produkcja -> Taryfikatory kosztów -> Taryfikator operacji -> Drukuj
{COMMENT-}
{"---Definicja wiersza wydruku taryfikatora operacji TTOPER.              "; ~~}
{ PRN.add("TTOPER.KOD",10,'Kod'@);
  PRN.add("TTOPER.NA",50,'Nazwa operacji'@);
  PRN.add("form(TTOPER.STAWKA,,2)",10,'Stawka /h'@,1);
  PRN.add("{? TTOPER.ZAWOD<>null() || TTOPER.ZAWOD().ZD || ''?}",20,'Zawód'@);
  PRN.add("{? TTOPER.TKAT<>null() || form(TTOPER.TKAT().KAT,,0,'9') || '' ?}",10,'Kat. zaszer.'@,1);
  PRN.add("' '''+TTOPER.PLATNE+''''",6,'Płatne stawką'@);
  PAR_WYDR.TITLE:='TARYFIKATOR OPERACJI'@; ~~}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8'}{SPACE: 'B'}
{lmt:=int((charleft()-PRN.width())/2); ~~}
{FONT: 'T8B'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8B'}{SPACE: 'B'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8'}{SPACE: 'C'}
{ rsep:=PAR_WYDR.RSEP; ~~}
{TTOPER.index('KOD'); TTOPER.prefix(); ~~}
{IF: TTOPER.first()}{ dalej:=1; ~~}{FI}
{WHILE: dalej}
{DO}
   {SUBSTITUTE: 'LINIA0'}
   {dalej:=TTOPER.next(); ~~}
{OD}
