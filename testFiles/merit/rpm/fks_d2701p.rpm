:!UTF-8
{TITLE: Krajowa informacja podsumowująca VAT-27}
{PRINTER: 'port_std',,,,,'Q','C',,,,,,1,0,0,0,0,1,1,'A4'}
{BEGIN:
   l:=-1; STR.split(XINFO.NAZ+', '+XINFO.REGON); {! |? l+=1; STR.line(71); STR.next() !};
   us:=-1; STR.split(XINFO.URZAD().NU+', '+XINFO.URZAD().UK+' '+XINFO.URZAD().MU+', '+XINFO.URZAD().UU);
   {! |? us+=1; STR.line(71); STR.next() !};
   i:=j:=sumac:=sumad:=0; ld:=1;
   naz:=nip:='';
   NIPY.index('SNIP_F'); NIPY.prefix(REF.S_FIRMA,'PL');
   nipuelic:={? NIPY.first() || 2-NIPY.SNIP || XINFO.NIP ?};
   exec('rpm_as_pdf_ini','rpm_pdf')
}
{END:
   exec('rpm_as_pdf_end','rpm_pdf');
   VAR_DEL.delete('sd','nd','kd','td','sn','nn','kn','tn','su','nu','ku','naz','nip');
   VAR_DEL.delete('nipuelic','i','j','ld','l','us')
}
{  VAT_POZ.index('VAT_POZ'); VAT_POZ.prefix(VAT_DEK.ref());
   {? VAT_POZ.first()
   || {!
      |?
         {? VAT_POZ.find_key(VAT_DEK.TYP+' '+$(ld+1))
         || ld+=1
         ?}
      !}
   ?};
   ~~
}
{WHILE: j<ld}
{DO}
{j+=1; ~~}
{REP: '{INCLUDE: fks_d2701p1.rpi}'}
{REP: '{INCLUDE: fks_d2701p2.rpi}'}
{OD}