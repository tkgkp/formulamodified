:!UTF-8
{TITLE:A.  Schemat windykacyjny}
{PRINTER: FINFO.SZ_PRN,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   w:=obj_new(16); {! _i:=1..16 |! w[_i]:='' !};
   PRN:=obj_new(@.CLASS.PRINT,4); PRN.sl_frame();
   PRN1:=obj_new(@.CLASS.PRINT,15); PRN1.sl_frame();
   PRN2:=obj_new(@.CLASS.PRINT,1); PRN2.sl_frame();
   ROZNE.win_edit('SER_SCH'); ROZNE.UT_DOK:=0; ROZNE.UT_ROZR:=1; pow_sch:=0;
   color:=''; prn1:=prn2:='PRN1';
   lm:=ll:=lmt:=rsep:=0; vp:=1; rsep:=PAR_WYDR.RSEP; PAR_WYDR.RSEP:=1; fun:='';
   SER_WART.index('SERWART2'); dalej:=0; dru_bar:=1
}
{END:
   VAR_DEL.delete('PRN','PRN1','PRN2','w','pow_sch','dalej','color','prn1','prn2','lm','ll','vp','lmt');
   PAR_WYDR.RSEP:=rsep;
   VAR_DEL.delete('rsep','fun','dru_bar')
}
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzezone
==================================================
Nazwa pliku: fks_ser_sch.rpm
Utworzony:    2002-01-10 [AMK]
==================================================
Zawartosc: Wydruk schematu windykacyjnego
{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{EXIT: ~ROZNE.edit()}
{ PRN.add("",59,'Schemat'@);
  PRN.add("",57,'Monitowanie'@);
  PRN.add("",38,'Blokowanie'@);
  PRN.add("",49,'Naliczanie odsetek'@);
  PRN1.add("w[1]",8,'Kod'@);
  PRN1.add("w[2]",50,'Opis'@);
  PRN1.add("w[3]",1,'?'@);
  PRN1.add("w[4]",8,'Kod'@);
  PRN1.add("w[5]",46,'Opis'@);
  PRN1.add("w[6]",1,'?'@);
  PRN1.add("w[7]",17,'WARUNKOWE przez'@);
  PRN1.add("w[8]",18,'BEZWARUNKOWE przez'@);
  PRN1.add("w[13]",1,'W'@);
  PRN1.add("w[9]",1,'N'@);
  PRN1.add("w[10]",8,'Typ tab. odsetek'@);
  PRN1.add("w[11]",4,'Wal.'@);
  PRN1.add("w[15]",13,'Od kwoty'@,1);
  PRN1.add("w[16]",7,'Przed po ter. płat.'@);
  PRN1.add("w[14]",9,'Od l. dni'@,1);
  PRN2.add("w[12]",206,'');
   ~~
}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}{FONT: 'HEAD'}{SPACE: 'B'}
{LINE: 1}
{PAR_WYDR.TITLE:={?ROZNE.UT_DOK||'Wydruk schematów windykacyjnych'@||'Wydruk schematu windykacyjnego'@?}; ~~}
{SUBSTITUTE: 'HEAD'}{FONT: 'W8'}{SPACE: 'C'}{IF: page=1}
{<3 'Parametry wydruku:'@}
{<6 {?ROZNE.UT_DOK||'Selekcja schematów: wszystkie'@||'Selekcja schematów: bieżący'@?}}
{<6 {?ROZNE.UT_ROZR||'Z powiązaniami: tak'@||'Z powiązaniami: nie'@?}}{FI}
{FONT: 'T8GB'}{SPACE: 'C'}
{LINE: 1}{ PRN1.setcolor(color); PRN.setcolor(color);~~}
{REP: PRN.fhbar(lmt)}
{PRN.ini_head()}
{WHILE: PRN.h_next()}{DO}
{REP: PRN.h_fmline(lmt)}{OD}
{REP: PRN.fjbar(PRN1)}
{PRN1.ini_head()}
{WHILE: PRN1.h_next()}{DO}
{REP: PRN1.h_fmline(lmt)}{OD}{ vp:=1;~~}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{IF: pow_sch}{PRN2.lbar()}{ELSE}{PRN1.lbar()}{FI}{ vp:=1;~~}


{FOOTER-}
{COMMENT}------------------------------MACRO-LINIA1------------------{COMMENT-}
{MACRO: 'LINIA1'}
{ENTIRE}
{IF: vp}{PRN1.setcolor(color);~~}{REP: PRN1.fbar()}{ELIF:pow_sch}{PRN2.jbar(PRN1)}{ELIF: dru_bar}{PRN1.setcolor('255:255:255');~~}{PRN1.bar()}{FI}
{FONT: 'T8G'}{ PRN1.setcolor('255:255:255');~~}
{PRN1.ini_line()}
{WHILE: PRN1.next()}
{DO}
{REP: PRN1.fline()}
{OD}{ vp:=0;  PRN1.setcolor(color);pow_sch:=0; ~~}
{ENTIRE-}
{MACRO-}
{COMMENT}------------------------------MACRO-LINIA2------------------{COMMENT-}
{MACRO: 'LINIA2'}
{ENTIRE}
{IF: lineleft()=0}{PRN1.setcolor(color);PRN2.setcolor(color);~~}{REP: PRN1.fjbar(PRN2)}{FI}
{FONT: 'T8G'}{ PRN2.setcolor('255:255:255');~~}
{PRN2.ini_line()}
{WHILE: PRN2.next()}
{DO}
{REP: PRN2.fline()}
{OD}{ vp:=0;  PRN2.setcolor(color); ~~}
{ENTIRE-}
{MACRO-}
{COMMENT}------------------------------MACRO-SRODEK------------------{COMMENT-}
{MACRO: 'SRODEK'}
{ w[1]:=SER_SCH.KOD; w[2]:=SER_SCH.OPIS;
  w[3]:=SER_SCH.CZY_MON; w[4]:=SER_SCH.SER_TM().KOD; w[5]:=SER_SCH.SER_TM().OPIS;
  w[6]:=SER_SCH.CZY_BL;
  {? -SER_SCH.CZY_BL='t'
  || w[7]:={? SER_SCH.BL_WAR='R'||'obsługę operatora'@|?SER_SCH.BL_WAR='M'||'tryb monitowania'@||'wykonanie formuły'@?};
     w[8]:={? SER_SCH.BL_BWR='R'||'obsługę operatora'@|?SER_SCH.BL_BWR='M'||'tryb monitowania'@||'wykonanie formuły'@?}
  || w[7]:=w[8]:=''
  ?};
  w[9]:=SER_SCH.CZY_ODS; w[13]:=SER_SCH.CZY_ODS1;
  w[10]:=SER_SCH.ODS().KOD; w[11]:=w[14]:=w[15]:=w[16]:='';
  {? -SER_SCH.CZY_ODS='t'
  || w[14]:=$SER_SCH.DNI_ODS;
     SER_WART.prefix(SER_SCH.ref());
     {? SER_WART.first()
     || w[11]:=SER_WART.WAL().KOD; w[15]:=form(SER_WART.KW_GR,,2,' ,');
        w[16]:={? SER_WART.TYP_TERM=0 || 'po' || 'przed' ?}
     ?}
  ?};
~~
}
{IF: lineleft()=1 | lineleft()=2}{ vp:=1;~~}{PAGE}{ELIF: lineleft<>0}{ vp:=0;~~}{FI}
{SUBSTITUTE: 'LINIA1'}
{IF: -SER_SCH.CZY_ODS='t' & (dalej:=SER_WART.next(); dalej)}
{ {! _i:=1..16 |! w[_i]:='' !};~~}
{WHILE: dalej}
{DO}
{  w[11]:=SER_WART.WAL().KOD; w[15]:=form(SER_WART.KW_GR,,2,' ,');
   w[16]:={? SER_WART.TYP_TERM=0 || 'po'@ || 'przed'@ ?}; dru_bar:=0;~~}
{SUBSTITUTE: 'LINIA1'}
{ dalej:=SER_WART.next();~~}
{OD}{ dru_bar:=1;~~}
{FI}
{IF: ROZNE.UT_ROZR}{SUBSTITUTE: 'POWIAZAN'}{FI}
{MACRO-}
{COMMENT}-------------------------MACRO-POWIAZANIA SCHEMATU----------{COMMENT-}
{MACRO: 'POWIAZAN'}
{IF: lineleft()=1}{PAGE}{FI}
{FOR: 'SER_WOW'}
{INDEX: 'SER_SCH'}
{PREFIX: SER_SCH.ref()}
{DO}
{FIRST}{ pow_sch:=1;~~}
{IF: vp}{PRN1.setcolor(color);PRN2.setcolor(color);~~}
{REP: PRN1.fjbar(PRN2)}
{ELSE}{PRN1.setcolor('255:255:255');PRN2.setcolor('255:255:255');~~}{PRN1.jbar(PRN2)}
{FI}{ w[12]:='Powiązania - ';~~}
{FIRST-}
{ exec('rp_pow','!zws_par_frsw');
  {? w[12]=''||w[12]:=19*' '?};
  w[12]+='od dnia: %1 do dnia: %2 powiązanie z: %3'@[SER_WOW.DATA_OD$1,SER_WOW.DATA_DO$1,SER_KOR.KTO];~~}
{SUBSTITUTE: 'LINIA2'}{w[12]:='';~~}
{OD}
{MACRO-}
{COMMENT}------------------------------CIALO WYDRUKU------------------{COMMENT-}
{IF: ROZNE.UT_DOK}
{FOR: 'SER_SCH'}
{INDEX: 'KOD'}
{DO}
{SUBSTITUTE: 'SRODEK'}
{OD}
{ELSE}
{SUBSTITUTE: 'SRODEK'}
{FI}
{COMMENT}------------------------------FOOTER-LAST----------------------{COMMENT-}
{FOOTER}{FOOTER-}
{ENTIRE}
{IF: vp}{IF: pow_sch}{REP: PRN2.flbar()}{ELSE}{REP: PRN1.flbar()}{FI}
{ELSE}{IF: pow_sch}{PRN2.lbar()}{ELSE}{PRN1.lbar()}{FI}{FI}
{<1>{PRN.width()} 'KONIEC WYDRUKU'@}
{ENTIRE-}