:!UTF-8
{TITLE:E. Wydruk dokumentów z aktualnego roku}
{PRINTER: FINFO.SZ_PRN,,,,,'M','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
   PRN:=obj_new(@.CLASS.PRINT,15+{? rep_export() || 10 ?}); PRN.s_frame();
   PRNF:=obj_new(@.CLASS.PRINT,15); PRNF.s_frame();
   c:=obj_new(15+{? rep_export() || 10 ?});
   d:=obj_new(15+{? rep_export() || 10 ?});
   {! _i:=1..15+{? rep_export() || 10 ?} |! c[_i] := '' !};
   {! _i:=1..15+{? rep_export() || 10 ?} |! d[_i] := '' !};
   SRDO.cntx_psh(); SRST.cntx_psh(); SRSR.cntx_psh();
   exec('init','fst');
   SRD.maski('r');
   SRDO.prefix(); SRST.prefix(); SRSR.prefix();
   exec('odd_filtr','fst');
   SRD.PAR_WYDR:='T';
   PAR_WYDR.JORG:=null; EDIT_ES.JORG:='';
   i:=0;
   color:=prn1:=prn2:=''; fun:='';
   lm:=ll:=vp:=lmt:=rsep:=0;
   par1:=''; par2:=''; par3:=''; par4:='';par5:='';par6:='';par7:='';par8:='';par9:='';
   g_warp:=0; g_umop:=0; g_ulga:=0;
   g_warf:=0; g_umof:=0;
   g_ward:=0; g_umod:=0;
   sum_warp:=0; sum_umop:=0; sum_ulga:=0;
   sum_warf:=0; sum_umof:=0; sum_umod:=0; sum_ward:=0;
   sum_grupa:=''; test_grupa:='';
   srdo_dr:=0
}
{END:
   obj_del(PRN);
   obj_del(PRNF);
   obj_del(c);
   obj_del(d);
   SRDO.cntx_pop(); SRST.cntx_pop(); SRSR.cntx_pop();
   SRD.PAR_WYDR:='N';
   &i; &color; &prn1; &prn2;
   &lm; &ll; &vp; &lmt; &rsep;
   &par1; &par2; &par3;&par4; &par5; &par6; &par7; &fun; &par8; &par9;
   &g_warp; &g_umop; &g_ulga;
   &g_warf; &g_umof; &g_ward; &g_umod;
   &sum_grupa; &test_grupa;
   &sum_warp; &sum_umop; &sum_ulga;
   &sum_warf; &sum_umof; &sum_ward; &sum_umod;
   &srdo_dr
}
{EXIT:
   exec('clear_par','fst');
   exec('set_parw','param_wydr');
   {? OPERATOR.DEPT<>null
   || PAR_WYDR.ODD:=OPERATOR.DEPT
   || PAR_WYDR.ODD:=null
   ?};
   {? SSTALE.AO().KON<>date(0,0,0)
   || PAR_WYDR.STAN_NA:=SSTALE.AO().KON
   |? SSTALE.AO().OES=0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().POCZ_ROK
   |? SSTALE.AO().OES>0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().KON_ROK
   ?};
   PAR_WYDR.DOKTYP:=EDIT_ES.RODZ:='P';
   PAR_WYDR.DATA_OD:=SSTALE.AR().POCZ_ROK;
   PAR_WYDR.DATA_DO:=SSTALE.AR().KON_ROK;
   PAR_WYDR.TYPDOKO:='W';
   PAR_WYDR.JORG:=null;
   EDIT_ES.JORG:='';
   exec('set_gr_list','fst');
   PAR_WYDR.win_edit('DOKUM');
   PAR_WYDR.hdr_edit(': Wydruk dokumentów z aktualnego roku'@);
   SRDT.win_sel('SELECT');
   {? PAR_WYDR.edit("exec('check_dokum','fst')")
   || _exit:=0;
      exec('zakres_gr','fst')
   || _exit:=1
   ?};
   _exit
}
{COMMENT}
==================================================
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
Nazwa pliku: o_dokum.rpm
Utworzony  : 2004-09-10
Zawartość  : Wydruk dokumentów z aktualnego roku
==================================================
--------------------- OPIS PÓL ZMIENNEJ PAR_WYDR ------------{COMMENT-}
{COMMENT}
Dane pobierane są w sekcji Exit z wykorzystaniem formuł z pliku equery.fml
       DOKTYP: typ dokumentów: P - przyjęcie
                               W - wartościowe
                               I - inne
                               L - zmiana właściwości
                               M - zmiana metody amortyzacji
                               D - zmiana właściwości dofi./ulgi
       DATA_OD: dokumenty od
       DATA_DO: dokumenty do daty
       ODD    : jednostka księgowa
{COMMENT-}
{COMMENT}zmienne pomocnicze do wydrukow graficznych:
i - licznik, color, prn1, lm, ll, vp, lmt, rsep
{COMMENT-}
{PAR_WYDR.cntx_psh(); ~~}
{INCLUDE: wsp_pw.rpi}
{PAR_WYDR.cntx_pop(); ~~}
{COMMENT}--Definicja wiersza wydruku--------------------{COMMENT-}
{  prn1:='PRN'; prn2:='PRN'; ~~}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
      {? PAR_WYDR.DOKTYP='P'
      || PRN.add("c[1]", 12, 'Symbol'@,,'#');
         PRN.add("c[2]", 18, 'Nr        #inwentarzowy'@,,'#');
         PRN.add("c[3]", 38, 'Nazwa środka'@,,'#');
         PRN.add("c[4]", 8, 'Jed. ks.'@,,'#');
         PRN.add("c[5]", 16, 'Jed. organ.'@,,'#');
         PRN.add("c[6]", 10, 'Data   #wystaw.'@,,'#');
         PRN.add("c[7]", 10, 'Data   #zakupu'@,,'#');
         PRN.add("c[8]", 10, 'Data   #eksploat.'@,,'#');
         PRN.add("c[13]",36, 'Powiązane faktury'@,,' ');
         PRN.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}", 6, 'Stawka#amort.'@,1,'#');
         PRN.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}", 12, 'Wartość#podatkowa'@,1,'#');
         PRN.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}", 12, 'Wartość#bilansowa'@,1,'#');
         {? FINFO.TOR_D='T'
         || PRN.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}",12, 'Wartość#dodatkowa'@,1,'#')
         ?};
         PRNF.add("d[1]", 191, 'Dokumenty'@,,'#');
         PRNF.add("{? type_of(d[10]) = 1 || form(d[10],,2,' ,') || d[10] ?}", 12, 'Wartość#podatkowa'@,1,'#');
         PRNF.add("{? type_of(d[11]) = 1 || form(d[11],,2,' ,') || d[11] ?}", 12, 'Wartość#bilansowa'@,1,'#');
         {? FINFO.TOR_D='T'
         || PRNF.add("{? type_of(d[12]) = 1 || form(d[12],,2,' ,') || d[12] ?}", 12, 'Wartość#dodatkowa'@,1,'#')
         ?}
      |? PAR_WYDR.DOKTYP='W'
      || PRN.add("c[1]", 3, 'Typ'@,,'#');
         PRN.add("c[7]", 17, 'Symbol'@,,'#');
         PRN.add("c[2]", 18, 'Nr        #inwentarzowy'@,,'#');
         PRN.add("c[3]", 22, 'Nazwa środka'@,,'#');
         PRN.add("c[4]", 25, 'Jed.ks - Jed. org.'@,,'#');
         PRN.add("c[5]", 4, 'Gr.'@,,'#');
         PRN.add("c[6]", 10, 'Data   #wystaw.'@,,'#');
         PRN.add("c[8]", 16, 'Okres       #obowiązywania'@,1,'#');
         PRN.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}", 13, 'Wartość#podatkowa'@,1,'#');
         PRN.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}", 13, 'Umorzenie#podatkowe'@,1,'#');
         PRN.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}", 13, 'Wartość#bilansowa'@,1,'#');
         PRN.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}", 13, 'Umorzenie#bilansowe'@,1,'#');
         {? FINFO.TOR_D='T'
         || PRN.add("{? type_of(c[13]) = 1 || form(c[13],,2,' ,') || c[13] ?}", 13, 'Wartość#dodatkowa'@,1,'#');
            PRN.add("{? type_of(c[14]) = 1 || form(c[14],,2,' ,') || c[14] ?}", 13, 'Umorzenie#dodatkowe'@,1,'#')
         ?};

         PRNF.add("d[1]", 136, 'Typ'@,,'#');
         PRNF.add("{? type_of(d[9]) = 1 || form(d[9],,2,' ,') || d[9] ?}", 13, 'Wartość#podatkowa'@,1,'#');
         PRNF.add("{? type_of(d[10]) = 1 || form(d[10],,2,' ,') || d[10] ?}", 13, 'Umorzenie#podatkowe'@,1,'#');
         PRNF.add("{? type_of(d[11]) = 1 || form(d[11],,2,' ,') || d[11] ?}", 13, 'Wartość#bilansowa'@,1,'#');
         PRNF.add("{? type_of(d[12]) = 1 || form(d[12],,2,' ,') || d[12] ?}", 13, 'Umorzenie#bilansowe'@,1,'#');
         {? FINFO.TOR_D='T'
         || PRNF.add("{? type_of(d[13]) = 1 || form(d[13],,2,' ,') || d[13] ?}", 13, 'Wartość#dodatkowa'@,1,'#');
            PRNF.add("{? type_of(d[14]) = 1 || form(d[14],,2,' ,') || d[14] ?}", 13, 'Umorzenie#dodatkowe'@,1,'#')
         ?}

      |? PAR_WYDR.DOKTYP='I'
      || PRN.add("c[1]", 20, 'Symbol dokumentu'@,,'#');
         PRN.add("c[2]", 40, 'Nr inwentarzowy              #  Nazwa środka'@,,'#');
         PRN.add("c[3]", 16, 'Jed. ks.   #  Jed. org.'@,,'#');
         PRN.add("c[4]", 10, 'Typ dok.#Data wyst.'@,,'#');
         PRN.add("c[5]", 5, 'Grupa'@,,'#');
         PRN.add("c[6]", 10, 'Data   #wystaw.'@,,'#');
         PRN.add("c[7]", 16, 'Obowiązuje od'@,1,'#');
         PRN.add("c[8]", 10, 'Sezonowy?'@,,'#');
         PRN.add("c[9]", 15, 'Schemat sezonów'@,,'#')

      |? PAR_WYDR.DOKTYP='L'
      || PRN.add("c[1]", 15, 'Symbol dokum.'@,,'#');
         PRN.add("c[2]", 10, 'Data wyst.#'@,,'#');
         PRN.add("c[3]", 16, 'Nr inwentarz.# Zmiana na'@,,'#');
         PRN.add("c[4]", 40, 'Nazwa środka'@);
         PRN.add("c[5]", 25, 'Jed. ks.-Jed. org. # Zmiana na'@,,'#');
         PRN.add("c[6]", 15, 'Pomieszczenie # Zmiana na'@,,'#');
         PRN.add("c[7]", 20, 'Użytkownik # Zmiana na'@,,'#');
         PRN.add("c[8]", 20, 'Zestaw kont podat. #Zmiana na'@,,'#');
         PRN.add("c[9]", 20, 'Zestaw kont bilan. #Zmiana na'@,,'#');
         {? FINFO.TOR_D='T'
         || PRN.add("c[10]", 20, 'Zestaw kont dodat. #Zmiana na'@,,'#')
         ?}

      |? PAR_WYDR.DOKTYP='M'
      || PRN.add("c[1]", 20, 'Symbol dokumentu'@,,'#');
         PRN.add("c[2]", 40, 'Numer inwentarzowy                    # Nazwa środka'@,,'#');
         PRN.add("c[3]", 16, 'Jed. ks.#Jed. org.'@,,'#');
         PRN.add("c[4]", 10, 'Data wyst.#Data oper.'@,,'#');
         PRN.add("{? type_of(c[5]) = 1 || form(c[5],,0,' ,') || c[5] ?}", 10, 'Miesiac #Rok obow.'@,1,'#');
         PRN.add("c[6]", 12, {? FINFO.TOR_D<>'T' || 'Metoda #POD/BIL'@ || 'Metoda #POD/BIL/DOD'@ ?},,'#');
         PRN.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}", 12,{? FINFO.TOR_D<>'T'|| 'Stawka #POD/BIL'@ || 'Stawka #POD/BIL/DOD'@?},1,'#');
         PRN.add("{? type_of(c[8]) = 1 || form(c[8],,2,' ,') || c[8] ?}", 12,{? FINFO.TOR_D<>'T'|| 'Wsp. korekty# POD/BIL'@ || 'Wsp. korekty# POD/BIL/DOD'@ ?} ,1,'#');
         PRN.add("c[9]", 12,{? FINFO.TOR_D<>'T' || 'Data prz.# POD/BIL'@ || 'Data prz.# POD/BIL/DOD'@ ?},,'#')

      |? PAR_WYDR.DOKTYP='D'
      || PRN.add("c[1]", 15, 'Symbol dokum.'@,,'#');
         PRN.add("c[2]", 10, 'Data wyst.#Data oper.'@,,'#');
         PRN.add("c[3]", 16, 'Nr inwentarz.'@,,'#');
         PRN.add("c[4]", 40, 'Nazwa środka'@);
         PRN.add("c[5]", 25, 'Dofinansowanie/Ulga'@,,'#');
         PRN.add("c[8]", 20, 'Zestaw kont podat. #Zmiana na'@,,'#');
         PRN.add("c[9]", 20, 'Zestaw kont bilan. #Zmiana na'@,,'#');
         {? FINFO.TOR_D='T'
         || PRN.add("c[10]", 20, 'Zestaw kont dodat. #Zmiana na'@,,'#')
         ?}
      ?};
PAR_WYDR.TITLE:='Wydruk dokumentów z aktualnego - %1 roku obrachunkowego'@[SSTALE.AR().NAZ]; ~~}
{FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
 {? PAR_WYDR.DOKTYP='P'
      || PRN.add("c[1]", 12, 'Symbol'@,,'#');
         PRN.add("c[2]", 18, 'Nr inwentarzowy'@,,'#');
         PRN.add("c[3]", 38, 'Nazwa środka'@,,'#');
         PRN.add("c[4]", 8, 'Jed. ks.'@,,'#');
         PRN.add("c[5]", 16, 'Jed. organ.'@,,'#');
         PRN.add("c[6]", 10, 'Data wystaw.'@,,'#');
         PRN.add("c[7]", 10, 'Data zakupu'@,,'#');
         PRN.add("c[8]", 10, 'Data eksploat.'@,,'#');
         PRN.add("c[13]",36, 'Powiązane faktury'@,,' ');
         PRN.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}", 6, 'Stawka amort.'@,1,'#');
         PRN.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}", 12, 'Wartość podatkowa'@,1,'#');
         PRN.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}", 12, 'Wartość bilansowa'@,1,'#');
         {? FINFO.TOR_D='T'
         || PRN.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}",12, 'Wartość dodatkowa'@,1,'#')
         ?};
         PRNF.add("d[1]", 191, 'Dokumenty'@,,'#');
         PRNF.add("{? type_of(d[10]) = 1 || form(d[10],,2,' ,') || d[10] ?}", 12, 'Wartość podatkowa'@,1,'#');
         PRNF.add("{? type_of(d[11]) = 1 || form(d[11],,2,' ,') || d[11] ?}", 12, 'Wartość bilansowa'@,1,'#');
         {? FINFO.TOR_D='T'
         || PRNF.add("{? type_of(d[12]) = 1 || form(d[12],,2,' ,') || d[12] ?}", 12, 'Wartość dodatkowa'@,1,'#')
         ?}
      |? PAR_WYDR.DOKTYP='W'
      || PRN.add("c[1]", 3, 'Typ'@,,'#');
         PRN.add("c[7]", 17, 'Symbol'@,,'#');
         PRN.add("c[2]", 18, 'Nr inwentarzowy'@,,'#');
         PRN.add("c[3]", 22, 'Nazwa środka'@,,'#');
         PRN.add("c[4]", 25, 'Jed.ks '@,,'#');
         PRN.add("c[15]", 25, 'Jed. org.'@,,'#');
         PRN.add("c[5]", 4, 'Gr.'@,,'#');
         PRN.add("c[6]", 10, 'Data  wystaw.'@,,'#');
         PRN.add("c[8]", 16, 'Okres  obowiązywania'@,1,'#');
         PRN.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}", 13, 'Wartość podatkowa'@,1,'#');
         PRN.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}", 13, 'Umorzenie podatkowe'@,1,'#');
         PRN.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}", 13, 'Wartość bilansowa'@,1,'#');
         PRN.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}", 13, 'Umorzenie bilansowe'@,1,'#');
         {? FINFO.TOR_D='T'
         || PRN.add("{? type_of(c[13]) = 1 || form(c[13],,2,' ,') || c[13] ?}", 13, 'Wartość dodatkowa'@,1,'#');
            PRN.add("{? type_of(c[14]) = 1 || form(c[14],,2,' ,') || c[14] ?}", 13, 'Umorzenie dodatkowe'@,1,'#')
         ?};

         PRNF.add("d[1]", 136, 'Typ'@,,'#');
         PRNF.add("{? type_of(d[9]) = 1 || form(d[9],,2,' ,') || d[9] ?}", 13, 'Wartość podatkowa'@,1,'#');
         PRNF.add("{? type_of(d[10]) = 1 || form(d[10],,2,' ,') || d[10] ?}", 13, 'Umorzenie podatkowe'@,1,'#');
         PRNF.add("{? type_of(d[11]) = 1 || form(d[11],,2,' ,') || d[11] ?}", 13, 'Wartość bilansowa'@,1,'#');
         PRNF.add("{? type_of(d[12]) = 1 || form(d[12],,2,' ,') || d[12] ?}", 13, 'Umorzenie bilansowe'@,1,'#');
         {? FINFO.TOR_D='T'
         || PRNF.add("{? type_of(d[13]) = 1 || form(d[13],,2,' ,') || d[13] ?}", 13, 'Wartość dodatkowa'@,1,'#');
            PRNF.add("{? type_of(d[14]) = 1 || form(d[14],,2,' ,') || d[14] ?}", 13, 'Umorzenie dodatkowe'@,1,'#')
         ?}

      |? PAR_WYDR.DOKTYP='I'
      || PRN.add("c[1]", 20, 'Symbol dokumentu'@,,'#');
         PRN.add("c[2]", 40, 'Nr inwentarzowy'@,,'#');
         PRN.add("c[15]", 40, 'Nazwa środka'@,,'#');
         PRN.add("c[3]", 16, 'Jed. ks.'@,,'#');
         PRN.add("c[16]", 16, 'Jed. org.'@,,'#');
         PRN.add("c[4]", 10, 'Typ dok.'@,,'#');
         PRN.add("c[17]", 10, 'Data wyst.'@,,'#');
         PRN.add("c[5]", 5, 'Grupa'@,,'#');
         PRN.add("c[6]", 10, 'Data wystaw.'@,,'#');
         PRN.add("c[7]", 16, 'Obowiązuje od'@,1,'#');
         PRN.add("c[8]", 10, 'Sezonowy?'@,,'#');
         PRN.add("c[9]", 15, 'Schemat sezonów'@,,'#')

      |? PAR_WYDR.DOKTYP='L'
      || PRN.add("c[1]", 15, 'Symbol dokum.'@,,'#');
         PRN.add("c[2]", 10, 'Data wyst.'@,,'#');
         PRN.add("c[3]", 16, 'Nr inwentarz.'@,,'#');
         PRN.add("c[15]", 16, 'Zmiana na'@,,'#');
         PRN.add("c[4]", 40, 'Nazwa środka'@);
         PRN.add("c[5]", 25, 'Jed. ks. Zmiana na'@,,'#');
         PRN.add("c[16]", 25, 'Jed. org. Zmiana na'@,,'#');
         PRN.add("c[6]", 15, 'Pomieszczenie Zmiana na'@,,'#');
         PRN.add("c[7]", 20, 'Użytkownik Zmiana na'@,,'#');
         PRN.add("c[8]", 20, 'Zestaw kont podat. Zmiana na'@,,'#');
         PRN.add("c[9]", 20, 'Zestaw kont bilan. Zmiana na'@,,'#');
         {? FINFO.TOR_D='T'
         || PRN.add("c[10]", 20, 'Zestaw kont dodat. Zmiana na'@,,'#')
         ?}

      |? PAR_WYDR.DOKTYP='M'
      || PRN.add("c[1]", 20, 'Symbol dokumentu'@,,'#');
         PRN.add("c[2]", 40, 'Numer inwentarzowy'@,,'#');
         PRN.add("c[12]", 40, 'Nazwa środka'@,,'#');
         PRN.add("c[3]", 16, 'Jed. ks.'@,,'#');
         PRN.add("c[13]", 16, 'Jed. org.'@,,'#');
         PRN.add("c[4]", 10, 'Data wyst.'@,,'#');
         PRN.add("c[14]", 10, 'Data oper.'@,,'#');
         PRN.add("{? type_of(c[5]) = 1 || form(c[5],,0,' ,') || c[5] ?}", 10, 'Miesiac obow.'@,1,'#');
         PRN.add("{? type_of(c[15]) = 1 || form(c[15],,0,' ,') || c[15] ?}", 10, 'Rok obow.'@,1,'#');
         {? FINFO.TOR_D<>'T'
         || PRN.add("c[6]", 12,'Metoda POD'@,,'#');
            PRN.add("c[16]", 12,'Metoda BIL'@,,'#')
         || PRN.add("c[6]", 12,'Metoda POD'@,,'#');
            PRN.add("c[17]", 12,'Metoda BIL'@,,'#');
            PRN.add("c[18]", 12,'Metoda DOD'@,,'#') ?};
         {? FINFO.TOR_D<>'T'
         || PRN.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}", 12,'Stawka POD'@,1,'#');
            PRN.add("{? type_of(c[19]) = 1 || form(c[19],,2,' ,') || c[19] ?}", 12,'Stawka BIL'@,1,'#')
         || PRN.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}", 12,'Stawka POD'@,1,'#');
            PRN.add("{? type_of(c[19]) = 1 || form(c[19],,2,' ,') || c[19] ?}", 12,'Stawka BIL'@,1,'#');
            PRN.add("{? type_of(c[20]) = 1 || form(c[20],,2,' ,') || c[20] ?}", 12,'Stawka DOD'@,1,'#') ?};
         {? FINFO.TOR_D<>'T'
         ||  PRN.add("{? type_of(c[8]) = 1 || form(c[8],,2,' ,') || c[8] ?}", 12,'Wsp. korekty POD'@,1,'#');
             PRN.add("{? type_of(c[21]) = 1 || form(c[21],,2,' ,') || c[21] ?}", 12,'Wsp. korekty BIL'@,1,'#')
         ||  PRN.add("{? type_of(c[8]) = 1 || form(c[8],,2,' ,') || c[8] ?}", 12,'Wsp. korekty POD'@,1,'#');
             PRN.add("{? type_of(c[21]) = 1 || form(c[21],,2,' ,') || c[21] ?}", 12,'Wsp. korekty BIL'@,1,'#');
             PRN.add("{? type_of(c[22]) = 1 || form(c[22],,2,' ,') || c[22] ?}", 12,'Wsp. korekty DOD'@,1,'#') ?};
         {? FINFO.TOR_D<>'T'
         ||  PRN.add("c[9]", 12,'Data prz. POD'@,,'#');
             PRN.add("c[23]", 12,'Data prz. BIL'@,,'#')
         ||  PRN.add("c[9]", 12,'Data prz. POD'@,,'#');
             PRN.add("c[23]", 12,'Data prz. BIL'@,,'#');
             PRN.add("c[24]", 12,'Data prz. DOD'@,,'#') ?}

      |? PAR_WYDR.DOKTYP='D'
      || PRN.add("c[1]", 15, 'Symbol dokum.'@,,'#');
         PRN.add("c[2]", 10, 'Data wyst.'@,,'#');
         PRN.add("c[11]", 10, 'Data oper.'@,,'#');
         PRN.add("c[3]", 16, 'Nr inwentarz.'@,,'#');
         PRN.add("c[4]", 40, 'Nazwa środka'@);
         PRN.add("c[5]", 25, 'Dofinansowanie'@,,'#');
         PRN.add("c[12]", 25, 'Ulga'@,,'#');
         PRN.add("c[8]", 20, 'Zestaw kont podat. Zmiana na'@,,'#');
         PRN.add("c[9]", 20, 'Zestaw kont bilan. Zmiana na'@,,'#');
         {? FINFO.TOR_D='T'
         || PRN.add("c[10]", 20, 'Zestaw kont dodat. Zmiana na'@,,'#')
         ?}
      ?};
PAR_WYDR.TITLE:='Wydruk dokumentów z aktualnego - %1 roku obrachunkowego'@[SSTALE.AR().NAZ]; ~~}
{FI}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{COMMENT}------------------------------Parametry wydruku------------{COMMENT-}
{FONT: 'W8'}{SPACE: 'C'}
{<1 'PARAMETRY WYDRUKU:'@}
{COMMENT} ---- Stan na, Grupa, Rodzaj zestawienia ---- {COMMENT-}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
  {? PAR_WYDR.SRDT<>null
  || par1:=PAR_WYDR.SRDT().TYP + '('+ PAR_WYDR.SRDT().NAZWA +')'
  || par1:='wszystkie'@
  ?};

  par2:={? PAR_WYDR.ODD<>null || PAR_WYDR.ODD().OD || 'wszystkie'@ ?};

  {? PAR_WYDR.DOKTYP='P' || par3:='przyjęcia'@
  |? PAR_WYDR.DOKTYP='W' || par3:='wartościowe'@
  |? PAR_WYDR.DOKTYP='I' || par3:='inne'@
  |? PAR_WYDR.DOKTYP='L' || par3:='zmiana właściwości'@
  |? PAR_WYDR.DOKTYP='M' || par3:='zmiana metody amortyzacji'@
  |? PAR_WYDR.DOKTYP='D' || par3:='zmiana właściwości dofinansowania/ulgi'@
  ?};

  par4:='';
  {? PAR_WYDR.DATA_OD<>date(0,0,0) || par4+='od '@+PAR_WYDR.DATA_OD$2 ?};
  {? PAR_WYDR.DATA_DO<>date(0,0,0) || par4+=' do '@+PAR_WYDR.DATA_DO$2 ?};
  {? par4='' || par4:='dowolna'@ ?};

  {? PAR_WYDR.ZAKRESDR=0 || par5:='wszystkie'@
  |? PAR_WYDR.ZAKRESDR=1 || par5:='trwałe'@
  |? PAR_WYDR.ZAKRESDR=2 || par5:='niskocenne'@
  ?};

  {? PAR_WYDR.JORG<>null || par6:=PAR_WYDR.JORG().SYMBOL || par6:='wszystkie'@ ?};

  {? PAR_WYDR.WAR_GR=1
  || {? |PAR_WYDR.GRUPA<>'' || par7:=|PAR_WYDR.GRUPA || par7:='dowolna'@ ?}
  |? PAR_WYDR.WAR_GR=2
  || {? |PAR_WYDR.GRUPA_OD<>'' || _od:='od: '@+|PAR_WYDR.GRUPA_OD || _od:='' ?};
     {? |PAR_WYDR.GRUPA_DO<>'' || _do:='do: '@+|PAR_WYDR.GRUPA_DO || _do:='' ?};
     {? _od<>'' & _do<>'' || par7:=_od+' '+_do
     |? _od<>'' & _do='' ||  par7:=_od
     |? _od='' & _do<>'' || par7:=_do
     |? _od='' & _do='' || par7:='wszystkie'
    ?}
  |? PAR_WYDR.WAR_GR=4
  || par7:='dowolna'@
  ?};

  {? PAR_WYDR.DOKTYP='W'
  || {? PAR_WYDR.PRZYCHOD<>null || par8:=PAR_WYDR.PRZYCHOD().R || par8:='dowolny'@ ?};
     {? PAR_WYDR.ROZCHOD<>null || par9:=PAR_WYDR.ROZCHOD().R || par9:='dowolny'@ ?}
  ?}

;~~}
{FONT: 'W8B'}{<1 'J. księgowa: '@}{FONT: 'W8'}{par2}{FONT: 'W8B'}{<35 'Data wystawienia: '@}{FONT: 'W8'}{par4}{FONT: 'W8B'}{<83 'Rodzaj dokumentów: '@}{FONT: 'W8'}{par3}{FONT: 'W8B'}{<137 'Typ dokumentów: '@}{FONT: 'W8'}{par1}
{IF: PAR_WYDR.WAR_GR<>3}
{FONT: 'W8B'}{<1 'J. organizacyjna: '@}{FONT: 'W8'}{par6}{FONT: 'W8B'}{<35 'Zakres środków: '@}{FONT: 'W8'}{par5}{FONT: 'W8B'}{<83 'Grupa środków: '@}{FONT: 'W8'}{par7}
{ELIF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{<1 'J. organizacjna: '@}{FONT: 'W8'}{par6}{FONT: 'W8B'}{<35 'Zakres środków: '@}{FONT: 'W8'}{par5}
{FONT: 'W8B'}{<1 'Wybór grup: '@}{FONT: 'W8'}{FONT: 'W8'}{exec('create_list_gr','fst')}
{FI}
{IF: PAR_WYDR.DOKTYP='W' & (PAR_WYDR.PRZYCHOD<>null | PAR_WYDR.ROZCHOD<>null)}
{FONT: 'W8B'}{<1 'Rodzaj przychodu: '@}{FONT: 'W8'}{par8}{FONT: 'W8B'}{<32 'Rodzaj rozchodu: '@}{FONT: 'W8'}{par9}
{FI}
{FI}
{COMMENT} ---- Dane, Jedn. ks., Zestawienie według ---- {COMMENT-}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
  {? PAR_WYDR.SRDT<>null
  || par1:=PAR_WYDR.SRDT().TYP + '('+ PAR_WYDR.SRDT().NAZWA +')'
  || par1:='wszystkie'@
  ?};

  par2:={? PAR_WYDR.ODD<>null || PAR_WYDR.ODD().OD || 'wszystkie'@ ?};

  {? PAR_WYDR.DOKTYP='P' || par3:='przyjęcia'@
  |? PAR_WYDR.DOKTYP='W' || par3:='wartościowe'@
  |? PAR_WYDR.DOKTYP='I' || par3:='inne'@
  |? PAR_WYDR.DOKTYP='L' || par3:='zmiana właściwości'@
  |? PAR_WYDR.DOKTYP='M' || par3:='zmiana metody amortyzacji'@
  |? PAR_WYDR.DOKTYP='D' || par3:='zmiana właściwości dofinansowania/ulgi'@
  ?};

  par4:='';
  {? PAR_WYDR.DATA_OD<>date(0,0,0) || par4+='od '@+PAR_WYDR.DATA_OD$2 ?};
  {? PAR_WYDR.DATA_DO<>date(0,0,0) || par4+=' do '@+PAR_WYDR.DATA_DO$2 ?};
  {? par4='' || par4:='dowolna'@ ?};

  {? PAR_WYDR.ZAKRESDR=0 || par5:='wszystkie'@
  |? PAR_WYDR.ZAKRESDR=1 || par5:='trwałe'@
  |? PAR_WYDR.ZAKRESDR=2 || par5:='niskocenne'@
  ?};

  {? PAR_WYDR.JORG<>null || par6:=PAR_WYDR.JORG().SYMBOL || par6:='wszystkie'@ ?};

  {? PAR_WYDR.WAR_GR=1
  || {? |PAR_WYDR.GRUPA<>'' || par7:=|PAR_WYDR.GRUPA || par7:='dowolna'@ ?}
  |? PAR_WYDR.WAR_GR=2
  || {? |PAR_WYDR.GRUPA_OD<>'' || _od:='od: '@+|PAR_WYDR.GRUPA_OD || _od:='' ?};
     {? |PAR_WYDR.GRUPA_DO<>'' || _do:='do: '@+|PAR_WYDR.GRUPA_DO || _do:='' ?};
     {? _od<>'' & _do<>'' || par7:=_od+' '+_do
     |? _od<>'' & _do='' ||  par7:=_od
     |? _od='' & _do<>'' || par7:=_do
     |? _od='' & _do='' || par7:='wszystkie'
    ?}
  |? PAR_WYDR.WAR_GR=4
  || par7:='dowolna'@
  ?};

  {? PAR_WYDR.DOKTYP='W'
  || {? PAR_WYDR.PRZYCHOD<>null || par8:=PAR_WYDR.PRZYCHOD().R || par8:='dowolny'@ ?};
     {? PAR_WYDR.ROZCHOD<>null || par9:=PAR_WYDR.ROZCHOD().R || par9:='dowolny'@ ?}
  ?}

;~~}
{FONT: 'W8B'}{'J. księgowa: '@}{FONT: 'W8'}{par2}
{FONT: 'W8B'}{'Data wystawienia: '@}{FONT: 'W8'}{par4}
{FONT: 'W8B'}{'Rodzaj dokumentów: '@}{FONT: 'W8'}{par3}
{FONT: 'W8B'}{'Typ dokumentów: '@}{FONT: 'W8'}{par1}
{IF: PAR_WYDR.WAR_GR<>3}
{FONT: 'W8B'}{'J. organizacyjna: '@}{FONT: 'W8'}{par6}
{FONT: 'W8B'}{'Zakres środków: '@}{FONT: 'W8'}{par5}
{FONT: 'W8B'}{'Grupa środków: '@}{FONT: 'W8'}{par7}
{ELIF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{'J. organizacjna: '@}{FONT: 'W8'}{par6}
{FONT: 'W8B'}{'Zakres środków: '@}{FONT: 'W8'}{par5}
{FONT: 'W8B'}{'Wybór grup: '@}{FONT: 'W8'}{FONT: 'W8'}{exec('create_list_gr','fst')}
{FI}
{IF: PAR_WYDR.DOKTYP='W' & (PAR_WYDR.PRZYCHOD<>null | PAR_WYDR.ROZCHOD<>null)}
{FONT: 'W8B'}{'Rodzaj przychodu: '@}{FONT: 'W8'}{par8}
{FONT: 'W8B'}{'Rodzaj rozchodu: '@}{FONT: 'W8'}{par9}
{FI}
{FI}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: ~rep_export()}
{SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{ rsep:=PAR_WYDR.RSEP; ~~}
{FOR: SRDO}{INDEX: 'RODZAJ'}{PREFIX: PAR_WYDR.DOKTYP}
 {DO}
 {COMMENT}Warunek sprawdzajacy czy drukowac SRDO{COMMENT-}
 {  {? PAR_WYDR.WAR_GR=4
    || _grupa_ok:=1
    || _grupa_ok:=exec('gr_fit','fst',exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'GR','GR'))
    ?};
    srdo_dr:=(PAR_WYDR.SRDT=null | PAR_WYDR.SRDT=SRDO.TYP) & SRDO.DW>=PAR_WYDR.DATA_OD
            & SRDO.DW<=PAR_WYDR.DATA_DO
            & (PAR_WYDR.JORG=null | PAR_WYDR.JORG=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'JORG'))
            & (PAR_WYDR.ODD=null | PAR_WYDR.ODD=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'ODD'))
            & (PAR_WYDR.ZAKRESDR=0
              | (PAR_WYDR.ZAKRESDR=1 & exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'R')='T')
              | (PAR_WYDR.ZAKRESDR=2 & exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'R')='N'))
            & (PAR_WYDR.DOKTYP<>'W'
              | (PAR_WYDR.PRZYCHOD=null | PAR_WYDR.PRZYCHOD=SRDO.PRZYCHOD))
            & (PAR_WYDR.DOKTYP<>'W'
              | (PAR_WYDR.ROZCHOD=null | PAR_WYDR.ROZCHOD=SRDO.ROZ))
            & _grupa_ok & SRDO.LINK_REF=''
 ;~~}
 {IF: srdo_dr}
{COMMENT} ---- zwykłe wiersze ---- {COMMENT-}
{COMMENT} ---- Podsumowanie cząstkowe według grup ---- {COMMENT-}
{
   test_grupa:=SRDO.TYP().TYP;
   {? sum_grupa='' || test_grupa:='' ?}
;~~}
{IF: PAR_WYDR.DOKTYP='W' & sum_grupa<>test_grupa}
  {
  d[1]:='Dokumenty '@ + sum_grupa + ' razem:'@;
  d[2]:=''; d[3]:=''; d[4]:=''; d[5]:='';  d[6]:=''; d[7]:=''; d[8]:='';
  d[9]:= g_warp; d[10]:= g_umop; d[11]:= g_warf; d[12]:= g_umof; {? FINFO.TOR_D='T'|| d[13]:=g_ward; d[14]:=g_umod ?};
  rsep:=1
  ;~~}
  {FONT: 'T8GB'}{SPACE: 'C'}
  { fun:="_test:=lineleft();{? (_test<=2 & prn1='PRN' & prn2='PRNF')|| prn1:='PRNF'; prn2:='PRN' ?}" ;~~}
  {prn1:='PRN'; prn2:='PRNF';~~}{SUBSTITUTE: 'LINIA02'}{ prn1:='PRNF'; prn2:='PRN'; ~~}
  {rsep:=1
  ;~~}
  {FONT: 'T8G'}{SPACE: 'C'}
{COMMENT} ---- wyzerowanie podsumowań cząstkowych---- {COMMENT-}
  {
     {? PAR_WYDR.DOKTYP='W'
     || g_warp:=0; g_umop:=0; g_ulga:=0; g_warf:=0; g_umof:=0; g_ward:=0; g_umod:=0
     ?}
  ;~~}
{FI}
{COMMENT} ---- zwykle wiersze ----{COMMENT-}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
 {
   {? PAR_WYDR.DOKTYP='P'
   ||
      c[1]:=SRDO.SYMBOL;
      c[2]:={? SRDO.SRSR_E=null || SRDO.SRSR().NRI || SRDO.SRSR_E().NRI ?};
      c[3]:={? SRDO.SRSR_E=null || SRDO.SRSR().NST || SRDO.SRSR_E().NST ?};
      c[4]:=SRDO.SRSR().ODD().OD;
      c[5]:=SRDO.SRSR().JORG().SYMBOL;
      c[6]:=form(SRDO.DW,,1);
      c[7]:=form(SRDO.SRSR().DZ,,1);
      c[8]:=form(SRDO.SRSR().DE,,1);
      c[9]:=SRDO.SRSR().STAP;
      c[13]:=SRDO.DOK_ZAK;
      {? SRDO.SRSR_E=null
      || c[10]:=SRDO.SRSR().WARP;
         c[11]:=SRDO.SRSR().WARF;
         {? FINFO.TOR_D='T' || c[12]:=SRDO.SRSR().WARD ?};
         sum_warp+=SRDO.SRSR().WARP;
         {? FINFO.TOR_D='T' || sum_ward+=SRDO.SRSR().WARD ?};
         sum_warf+=SRDO.SRSR().WARF
      || c[10]:=SRDO.SRSR_E().WARP;
         c[11]:=SRDO.SRSR_E().WARF;
         {? FINFO.TOR_D='T' || c[12]:=SRDO.SRSR_E().WARD ?};
         sum_warp+=SRDO.SRSR_E().WARP;
         {? FINFO.TOR_D='T' || sum_ward+=SRDO.SRSR_E().WARD ?};
         sum_warf+=SRDO.SRSR_E().WARF
      ?}

   |? PAR_WYDR.DOKTYP='W'
   || c[1]:=SRDO.TYP().TYP;
      c[7]:=SRDO.SYMBOL;
      _tmpsrsr:={? SRDO.SRSR_E=null || SRDO.SRSR || SRDO.SRSR_E ?};
      c[2]:=exec('from_srst','fst',_tmpsrsr,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NRI');
      c[3]:=32+exec('from_srst','fst',_tmpsrsr,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NST');
      c[4]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'ODD','OD')
            +'-'+exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'JORG','SYMBOL');
      c[5]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'GR','GR');
      c[6]:=form(SRDO.DW,,1);
      c[8]:=SRDO.OKRO_F().NAZ+' '+SRDO.OKRO_F().ROK().NAZ;
      c[9]:=SRDO.WARP;
      c[10]:=SRDO.UMOP;
      c[11]:=SRDO.WARF;
      c[12]:=SRDO.UMOF;
      {? FINFO.TOR_D='T' || c[13]:=SRDO.WARD; c[14]:=SRDO.UMOD ?};

      g_warp+=SRDO.WARP; g_umop+=SRDO.UMOP; g_ulga+=0;
      g_warf+=SRDO.WARF; g_umof+=SRDO.UMOF;
      {? FINFO.TOR_D='T' || g_ward+=SRDO.WARD; g_umod+=SRDO.UMOD; sum_ward+=SRDO.WARD; sum_umod+=SRDO.UMOD ?};
      sum_warp+=SRDO.WARP; sum_umop+=SRDO.UMOP; sum_ulga+=0;
      sum_warf+=SRDO.WARF; sum_umof+=SRDO.UMOF

   |? PAR_WYDR.DOKTYP='I'
   || c[1]:=SRDO.SYMBOL;
      c[2]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NRI')
            +'- '+(32+exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NST'));
      c[3]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'ODD','OD')
            +'-'+exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'JORG','SYMBOL');
      c[4]:=SRDO.TYP().TYP;
      c[5]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'GR','GR');
      c[6]:=form(SRDO.DW,,1);
      c[7]:=SRDO.OKRO_F().NAZ;
      c[8]:={? SRDO.TYP().SEZONOWY='T' & SRDO.SEZ='T' || 'TAK' || 'NIE' ?};
      c[9]:={? SRDO.TYP().SEZONOWY='T' & SRDO.SCH_SEZ || SRDO.SCH_SEZ().KOD || '' ?}

   |? PAR_WYDR.DOKTYP='L'
   || c[1]:=SRDO.SYMBOL;
      c[2]:=form(SRDO.DW,,1);
      c[3]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NRI');
      c[4]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NST');
      c[5]:=c[5]:={? SRDO.TYP().JORG='T' & (SRDO.ODD | SRDO.JORG)
                  || SRDO.ODD().OD+'-'+SRDO.JORG().SYMBOL
                  || ''
                  ?};
      c[6]:={? SRDO.TYP().POM='T' & SRDO.POM || SRDO.POM().S || '' ?};
      c[7]:={? SRDO.TYP().OSOBA='T' & SRDO.OSOBA || SRDO.OSOBA().PIERWSZE+' '+SRDO.OSOBA().NAZWISKO || ' ' ?};
      c[8]:={? SRDO.TYP().KONPOD='T' & SRDO.KONPOD || SRDO.KONPOD().KOD || '' ?};
      c[9]:={? SRDO.TYP().KONFIN='T' & SRDO.KONFIN || SRDO.KONFIN().KOD || '' ?};
      {? FINFO.TOR_D='T' || c[10]:={? SRDO.TYP().KONDOD='T' & SRDO.KONDOD || SRDO.KONDOD().KOD || '' ?} ?}

   |? PAR_WYDR.DOKTYP='M'
   || c[1]:=SRDO.SYMBOL;
      c[2]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NRI');
      c[3]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'ODD','OD');
      c[4]:=form(SRDO.DW,,1);
      c[5]:=SRDO.OKRO_F().NAZ;
      c[6]:={? SRDO.TYP().MP='T' & SRDO.MP || SRDO.MP().K || '' ?};
      c[7]:={? SRDO.TYP().STAP='T' || SRDO.STAP || '' ?};
      c[8]:={? SRDO.TYP().WKP='T' || SRDO.WKP || '' ?};
      c[9]:=form(SRDO.DPLP,,1)

   |? PAR_WYDR.DOKTYP='D'
   || c[1]:=SRDO.SYMBOL;
      c[2]:=form(SRDO.DW,,1)+'#'+form(SRDO.DO,,1);
      c[3]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NRI');
      c[4]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NST');
      c[5]:={? SRDO.SRZF || SRDO.SRZF().NAZWA || '' ?};
      c[8]:={? SRDO.TYP().KONPOD='T' & SRDO.KONPOD || SRDO.KONPOD().KOD || '' ?};
      c[9]:={? SRDO.TYP().KONFIN='T' & SRDO.KONFIN || SRDO.KONFIN().KOD || '' ?};
      {? FINFO.TOR_D='T' || c[10]:={? SRDO.TYP().KONDOD='T' & SRDO.KONDOD || SRDO.KONDOD().KOD || '' ?} ?}
   ?}
 ;~~}
  { {? vp || prn1:='PRN'; prn2:='PRN'?};~~}{SUBSTITUTE: 'LINIA02'}{prn1:='PRN'; prn2:='PRN'; rsep:=PAR_WYDR.RSEP;~~}
{COMMENT} ---- druga linia---- {COMMENT-}
  {
   {? PAR_WYDR.DOKTYP='M'
   || c[1]='';
      c[2]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NST');
      c[3]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'JORG','SYMBOL');
      c[4]:=form(SRDO.DO,,1);
      c[5]:=SRDO.OKRO_F().ROK().NAZ;
      c[6]:={? SRDO.TYP().MF='T' & SRDO.MF || SRDO.MF().K || '' ?};
      c[7]:={? SRDO.TYP().STAF='T' || SRDO.STAF || '' ?};
      c[8]:={? SRDO.TYP().WKF='T' || SRDO.WKF || '' ?};
      c[9]:=form(SRDO.DPLF,,1)
   ?};
   rsep:=0
   ;~~}
  {IF: PAR_WYDR.DOKTYP='M'}
  {prn1:='PRN'; prn2:='PRN';~~}{SUBSTITUTE: 'LINIA02'}
  {rsep:=PAR_WYDR.RSEP;~~}
  {FI}
{COMMENT} ---- Trzecia linia---- {COMMENT-}
  {IF: FINFO.TOR_D='T'}
     {
      {? PAR_WYDR.DOKTYP='M'
      || c[1]='';
         c[2]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NST');
         c[3]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'JORG','SYMBOL');
         c[4]:=form(SRDO.DO,,1);
         c[5]:=SRDO.OKRO_F().ROK().NAZ;
         c[6]:={? SRDO.TYP().MD='T' & SRDO.MD || SRDO.MD().K || '' ?};
         c[7]:={? SRDO.TYP().STAD='T' || SRDO.STAD || '' ?};
         c[8]:={? SRDO.TYP().WKD='T' || SRDO.WKD || '' ?};
         c[9]:=form(SRDO.DPLD,,1)
      ?};
      rsep:=0
      ;~~}
  {IF: PAR_WYDR.DOKTYP='M'}
  {prn1:='PRN'; prn2:='PRN';~~}{SUBSTITUTE: 'LINIA02'}
  {FI}
  {rsep:=PAR_WYDR.RSEP;~~}
  {FI}
  {
   {? PAR_WYDR.DOKTYP='W' || sum_grupa:=SRDO.TYP().TYP ?}
  ;~~}
  {COMMENT}Koniec warunku sprawdzajacego czy drukowac SRDO{COMMENT-}
  {FI}
  {COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
   {? PAR_WYDR.DOKTYP='P'
   ||
      c[1]:=SRDO.SYMBOL;
      c[2]:={? SRDO.SRSR_E=null || SRDO.SRSR().NRI || SRDO.SRSR_E().NRI ?};
      c[3]:={? SRDO.SRSR_E=null || SRDO.SRSR().NST || SRDO.SRSR_E().NST ?};
      c[4]:=SRDO.SRSR().ODD().OD;
      c[5]:=SRDO.SRSR().JORG().SYMBOL;
      c[6]:=form(SRDO.DW,,1);
      c[7]:=form(SRDO.SRSR().DZ,,1);
      c[8]:=form(SRDO.SRSR().DE,,1);
      c[9]:=SRDO.SRSR().STAP;
      c[13]:=SRDO.DOK_ZAK;
      {? SRDO.SRSR_E=null
      || c[10]:=SRDO.SRSR().WARP;
         c[11]:=SRDO.SRSR().WARF;
         {? FINFO.TOR_D='T' || c[12]:=SRDO.SRSR().WARD ?};
         sum_warp+=SRDO.SRSR().WARP;
         {? FINFO.TOR_D='T' || sum_ward+=SRDO.SRSR().WARD ?};
         sum_warf+=SRDO.SRSR().WARF
      || c[10]:=SRDO.SRSR_E().WARP;
         c[11]:=SRDO.SRSR_E().WARF;
         {? FINFO.TOR_D='T' || c[12]:=SRDO.SRSR_E().WARD ?};
         sum_warp+=SRDO.SRSR_E().WARP;
         {? FINFO.TOR_D='T' || sum_ward+=SRDO.SRSR_E().WARD ?};
         sum_warf+=SRDO.SRSR_E().WARF
      ?}

   |? PAR_WYDR.DOKTYP='W'
   || c[1]:=SRDO.TYP().TYP;
      c[7]:=SRDO.SYMBOL;
      _tmpsrsr:={? SRDO.SRSR_E=null || SRDO.SRSR || SRDO.SRSR_E ?};
      c[2]:=exec('from_srst','fst',_tmpsrsr,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NRI');
      c[3]:=32+exec('from_srst','fst',_tmpsrsr,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NST');
      c[4]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'ODD','OD');
      c[15]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'JORG','SYMBOL');
      c[5]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'GR','GR');
      c[6]:=form(SRDO.DW,,1);
      c[8]:=SRDO.OKRO_F().NAZ+' '+SRDO.OKRO_F().ROK().NAZ;
      c[9]:=SRDO.WARP;
      c[10]:=SRDO.UMOP;
      c[11]:=SRDO.WARF;
      c[12]:=SRDO.UMOF;
      {? FINFO.TOR_D='T' || c[13]:=SRDO.WARD; c[14]:=SRDO.UMOD ?};

      g_warp+=SRDO.WARP; g_umop+=SRDO.UMOP; g_ulga+=0;
      g_warf+=SRDO.WARF; g_umof+=SRDO.UMOF;
      {? FINFO.TOR_D='T' || g_ward+=SRDO.WARD; g_umod+=SRDO.UMOD; sum_ward+=SRDO.WARD; sum_umod+=SRDO.UMOD ?};
      sum_warp+=SRDO.WARP; sum_umop+=SRDO.UMOP; sum_ulga+=0;
      sum_warf+=SRDO.WARF; sum_umof+=SRDO.UMOF

   |? PAR_WYDR.DOKTYP='I'
   || c[1]:=SRDO.SYMBOL;
      c[2]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NRI');
      c[15]:=(32+exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NST'));
      c[3]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'ODD','OD');
      c[16]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'JORG','SYMBOL');
      c[4]:=SRDO.TYP().TYP;
      c[5]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'GR','GR');
      c[6]:=form(SRDO.DW,,1);
      c[7]:=SRDO.OKRO_F().NAZ;
      c[8]:={? SRDO.TYP().SEZONOWY='T' & SRDO.SEZ='T' || 'TAK' || 'NIE' ?};
      c[9]:={? SRDO.TYP().SEZONOWY='T' & SRDO.SCH_SEZ || SRDO.SCH_SEZ().KOD || '' ?}

   |? PAR_WYDR.DOKTYP='L'
   || c[1]:=SRDO.SYMBOL;
      c[2]:=form(SRDO.DW,,1);
      c[3]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NRI');
      c[4]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NST');
      {? SRDO.TYP().JORG='T' & (SRDO.ODD | SRDO.JORG)
                  || c[5]:=SRDO.ODD().OD;
                     c[16]:=SRDO.JORG().SYMBOL
                  || c[5]:=''; c[16]:=''
                  ?};
      c[6]:={? SRDO.TYP().POM='T' & SRDO.POM || SRDO.POM().S || '' ?};
      c[7]:={? SRDO.TYP().OSOBA='T' & SRDO.OSOBA || SRDO.OSOBA().PIERWSZE+' '+SRDO.OSOBA().NAZWISKO || ' ' ?};
      c[8]:={? SRDO.TYP().KONPOD='T' & SRDO.KONPOD || SRDO.KONPOD().KOD || '' ?};
      c[9]:={? SRDO.TYP().KONFIN='T' & SRDO.KONFIN || SRDO.KONFIN().KOD || '' ?};
      {? FINFO.TOR_D='T' || c[10]:={? SRDO.TYP().KONDOD='T' & SRDO.KONDOD || SRDO.KONDOD().KOD || '' ?} ?}

   |? PAR_WYDR.DOKTYP='M'
   || c[1]:=SRDO.SYMBOL;
      c[2]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NRI');
      c[3]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'ODD','OD');
      c[4]:=form(SRDO.DW,,1);
      c[5]:=SRDO.OKRO_F().NAZ;
      c[6]:={? SRDO.TYP().MP='T' & SRDO.MP || SRDO.MP().K || '' ?};
      c[7]:={? SRDO.TYP().STAP='T' || SRDO.STAP || '' ?};
      c[8]:={? SRDO.TYP().WKP='T' || SRDO.WKP || '' ?};
      c[9]:=form(SRDO.DPLP,,1)

   |? PAR_WYDR.DOKTYP='D'
   || c[1]:=SRDO.SYMBOL;
      c[2]:=form(SRDO.DW,,1);
      c[11]:=form(SRDO.DO,,1);
      c[3]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NRI');
      c[4]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NST');
      c[5]:={? SRDO.SRZF || SRDO.SRZF().NAZWA || '' ?};
      c[8]:={? SRDO.TYP().KONPOD='T' & SRDO.KONPOD || SRDO.KONPOD().KOD || '' ?};
      c[9]:={? SRDO.TYP().KONFIN='T' & SRDO.KONFIN || SRDO.KONFIN().KOD || '' ?};
      {? FINFO.TOR_D='T' || c[10]:={? SRDO.TYP().KONDOD='T' & SRDO.KONDOD || SRDO.KONDOD().KOD || '' ?} ?}
   ?}
 ;~~}
{COMMENT} ---- druga linia---- {COMMENT-}
  {
   {? PAR_WYDR.DOKTYP='M'
   || c[12]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NST');
      c[13]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'JORG','SYMBOL');
      c[14]:=form(SRDO.DO,,1);
      c[15]:=SRDO.OKRO_F().ROK().NAZ;
      c[16]:={? SRDO.TYP().MF='T' & SRDO.MF || SRDO.MF().K || '' ?};
      c[19]:={? SRDO.TYP().STAF='T' || SRDO.STAF || '' ?};
      c[21]:={? SRDO.TYP().WKF='T' || SRDO.WKF || '' ?};
      c[23]:=form(SRDO.DPLF,,1)
   ?};
   rsep:=0
   ;~~}
{COMMENT} ---- Trzecia linia---- {COMMENT-}
  {IF: FINFO.TOR_D='T'}
     {
      {? PAR_WYDR.DOKTYP='M'
      || c[1]='';
         c[2]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'NST');
         c[3]:=exec('from_srst','fst',SRDO.SRSR,SRDO.OKRO_F().ROK,SRDO.OKRO_F,'JORG','SYMBOL');
         c[17]:=form(SRDO.DO,,1);
         c[5]:=SRDO.OKRO_F().ROK().NAZ;
         c[18]:={? SRDO.TYP().MD='T' & SRDO.MD || SRDO.MD().K || '' ?};
         c[20]:={? SRDO.TYP().STAD='T' || SRDO.STAD || '' ?};
         c[22]:={? SRDO.TYP().WKD='T' || SRDO.WKD || '' ?};
         c[24]:=form(SRDO.DPLD,,1)
      ?};
      rsep:=0
      ;~~}
  {IF: PAR_WYDR.DOKTYP='M'}
  {prn1:='PRN'; prn2:='PRN';~~}
  {FI}
  {rsep:=PAR_WYDR.RSEP;~~}
  {FI}
    { {? vp || prn1:='PRN'; prn2:='PRN'?};~~}{SUBSTITUTE: 'LINIA02'}{prn1:='PRN'; prn2:='PRN'; rsep:=PAR_WYDR.RSEP;~~}
{FI}
  {
   {? PAR_WYDR.DOKTYP='W' || sum_grupa:=SRDO.TYP().TYP ?};~~}
  {COMMENT}Koniec warunku sprawdzajacego czy drukowac SRDO{COMMENT-}
  {FI}
 {OD}
{COMMENT} ---- Podsumowanie cząstkowe za ostatnim rekordem ---- {COMMENT-}
{COMMENT} ---- Podsumowania nie występują dla excel ---- {COMMENT-}
{IF: ~rep_export()}
{IF: PAR_WYDR.DOKTYP='W'}
  {
  d[1]:='Dokumenty '@ + sum_grupa + ' razem:'@;
  d[2]:=''; d[3]:=''; d[4]:=''; d[5]:=''; d[6]:=''; d[7]:=''; d[8]:='';
  d[9]:= g_warp; d[10]:= g_umop; d[11]:= g_warf; d[12]:= g_umof; {? FINFO.TOR_D='T' || d[13]:= g_ward; d[14]:= g_umod ?};
  rsep:=1;vp:=0
  ;~~}
  {FONT: 'T8GB'}{SPACE: 'C'}
  {prn1:='PRN'; prn2:='PRNF';~~}{SUBSTITUTE: 'LINIA02'}{prn1:='PRNF'; prn2:='PRN';~~}
  {rsep:=1
  ;~~}
  {FONT: 'TG8'}{SPACE: 'C'}
{FI}
{COMMENT}------------------------------FOOTER-LAST------------------{COMMENT-}
{IF: PAR_WYDR.DOKTYP='P'}
{IF: lineleft()<>0 & lineleft()<6}{PAGE}{FI}
{FOOTER}{FOOTER-}
{COMMENT} ---- Podsumowania nie występują dla excel ---- {COMMENT-}
{COMMENT}{ vp:=0; ~~}{COMMENT-}
{FONT: 'T8GB'}{SPACE: 'C'}
{
   d[1] := 'Ogółem:'@;
   d[10] := sum_warp;
   d[11] := sum_warf;
   {? FINFO.TOR_D='T' || d[12] := sum_ward ?};
   prn1:='PRN';prn2:='PRNF';
   rsep:=1
;~~}
{SUBSTITUTE: 'LINIA02'}
{ prn1:='PRNF';vp:=0; ~~}
{REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}
{ELIF: PAR_WYDR.DOKTYP='W'}
{IF: lineleft()<>0 & lineleft()<6}{PAGE}{FI}
{FOOTER}{FOOTER-}
{COMMENT}{ vp:=0; ~~}{COMMENT-}
{FONT: 'T8GB'}{SPACE: 'C'}
{
   d[1] := 'Ogółem:'@;
   d[9] := sum_warp;
   d[10] := sum_umop;
   d[11] := sum_warf;
   d[12] := sum_umof;
   {? FINFO.TOR_D='T' || d[13] := sum_ward;  d[14] := sum_umod ?};
   prn1:='PRNF';prn2:='PRNF';
   rsep:=1
;~~}
{SUBSTITUTE: 'LINIA02'}
{ vp:=0; ~~}
{REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}
{FI}
{FI}