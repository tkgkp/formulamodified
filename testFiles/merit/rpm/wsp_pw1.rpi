:!UTF-8
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzezone
==============================================================================
Nazwa pliku: wsp_pw1.rpi
  Utworzony: 2003-08-26 [AMA]
==============================================================================
Zawartosc: Moduł pomocniczy do sporządzania wydruków
           zgodnych z OWwSK003_aneks1.
{COMMENT-}
{exec('set_parw','param_wydr');~~}
{DEFINEFONT: 'HEAD='+PAR_WYDR.FONTW+',100,M,8'}{COMMENT} Wymagane {SPACE: 'B'} {COMMENT-}
{DEFINEFONT: 'TITLE='+PAR_WYDR.FONTW+',100,F,8'}{COMMENT} Wymagane {SPACE: 'A'} {COMMENT-}
{DEFINEFONT: 'SIGN='+PAR_WYDR.FONTW+',100,M,8'}{COMMENT} Wymagane {SPACE: 'B'} {COMMENT-}
{DEFINEFONT: 'T8G='+PAR_WYDR.FONTTAB+',100,Q,8'}{COMMENT} Wymagane {SPACE: 'C'} {COMMENT-}
{DEFINEFONT: 'T8U='+PAR_WYDR.FONTTAB+',100,T,8'}{COMMENT} Wymagane {SPACE: 'C'} {COMMENT-}
{DEFINEFONT: 'T8='+PAR_WYDR.FONTTAB+',100,M,8'}{COMMENT} Wymagane {SPACE: 'B'} {COMMENT-}
{DEFINEFONT: 'T10='+PAR_WYDR.FONTTAB+',100,I,8'}{COMMENT} Wymagane {SPACE: 'B'} {COMMENT-}
{DEFINEFONT: 'T8GB='+PAR_WYDR.FONTTAB+',100,R,8'}{COMMENT} Wymagane {SPACE: 'C'} {COMMENT-}
{DEFINEFONT: 'T8B='+PAR_WYDR.FONTTAB+',100,N,8'}{COMMENT} Wymagane {SPACE: 'B'} {COMMENT-}
{DEFINEFONT: 'T10B='+PAR_WYDR.FONTTAB+',100,J,8'}{COMMENT} Wymagane {SPACE: 'B'} {COMMENT-}
{DEFINEFONT: 'W8='+PAR_WYDR.FONTW+',100,M,8'}{COMMENT} Wymagane {SPACE: 'C'} {COMMENT-}
{DEFINEFONT: 'W8B='+PAR_WYDR.FONTW+',100,N,8'}{COMMENT} Wymagane {SPACE: 'C'} {COMMENT-}
{DEFINEFONT: 'W10='+PAR_WYDR.FONTW+',100,M,8'}{COMMENT} Wymagane {SPACE: 'B'} {COMMENT-}
{DEFINEFONT: 'W10B='+PAR_WYDR.FONTW+',100,N,8'}{COMMENT} Wymagane {SPACE: 'B'} {COMMENT-}
{DEFINEFONT: 'W12='+PAR_WYDR.FONTW+',100,I,8'}{COMMENT} Wymagane {SPACE: 'A'} {COMMENT-}
{COMMENT}------------------------------MACRO-HEAD-------------------{COMMENT-}
{COMMENT}
Makro używane do drukowania nagłówka strony.
{COMMENT-}
{MACRO: 'HEAD'}
{SPACE: 'A'}{ lm:=charleft(); ~~}
{IF: PAR_WYDR.LOGO}
   {IF: exec('get_logo','img_blob')}
{<1}{IMAGE: exec('get_logo','img_blob');0;1}
   {ELSE}
{<1}{BITMAP:'"logo.bmp",,1'}
   {FI}
{FI}{FONT: 'HEAD'}{SPACE: 'B'}{ lm:=charleft(); ~~}
{IF: PAR_WYDR.HEAD}
   {IF: +PAR_WYDR.MIEJSC}
      {__MDC:=PAR_WYDR.MIEJSC+', '+date$1+{? PAR_WYDR.CZAS || ', '+$time() || '' ?};~~}
{COMMENT}
      {IF: __System='FIKS' | __System='IF' | __System='HOMEBANK' | __System='KASA' | __System='ESTRA' | __System='EMAG' | __System='PRODUKCJA' | __System='REMONTY' | __System='PROJEKTY' | __System='OBIEGI'}
{COMMENT-}
         {IF: lm}
         {IF: +XINFO.NAZ+4>lm-(+__MDC)}{>{lm} __MDC}{STR.split(XINFO.NAZ);~~}
         {<1 STR.line(lm)}
         {WHILE: STR.next()}{DO}{<1 STR.line(lm)}{OD}
         {ELSE}{<1 XINFO.NAZ}{>{lm} __MDC}{FI}
         {ELSE}
         {XINFO.NAZ+' '+__MDC}
         {FI}
{COMMENT}
      {ELIF: __System='KALI' | __System='RCP'}
        {>{lm} PAR_WYDR.MIEJSC+', '+date$1+{? PAR_WYDR.CZAS || ', '+$time() || '' ?}}
        {<1 HSTR.split(KST.NAZWA);HSTR.line(lm)}
        {WHILE: HSTR.next()}{DO}{<1 HSTR.line(lm)}{OD}
      {ELIF: __System='PRODUKCJA'}
         {<1 PINFO.NAZ}{>{lm} PAR_WYDR.MIEJSC+', '+date$1
         +{? PAR_WYDR.CZAS || ', '+$time() || '' ?}}
      {FI}
{COMMENT-}
   {ELSE}
      {__MDC:=date$1+{? PAR_WYDR.CZAS || ', '+$time() || '' ?};~~}
{COMMENT}
      {IF: __System='FIKS' | __System='IF' | __System='HOMEBANK' | __System='KASA' | __System='ESTRA' | __System='EMAG' | __System='PRODUKCJA' | __System='REMONTY' | __System='PROJEKTY' | __System='OBIEGI'}
{COMMENT-}
         {IF: lm}
         {IF: +XINFO.NAZ+4>lm-(+__MDC)}{>{lm} __MDC}{STR.split(XINFO.NAZ);~~}
         {<1 STR.line(lm)}
         {WHILE: STR.next()}{DO}{<1 STR.line(lm)}{OD}
         {ELSE}{<1 XINFO.NAZ}{>{lm} __MDC}{FI}
         {ELSE}
         {XINFO.NAZ+' '+__MDC}
         {FI}
{COMMENT}
      {ELIF: __System='KALI' | __System='RCP'}
         {>{lm} date$1+{? PAR_WYDR.CZAS || ', '+$time() || '' ?}}
         {<1 HSTR.split(KST.NAZWA);HSTR.line(lm)}
         {WHILE: HSTR.next()}{DO}{<1 HSTR.line(lm)}{OD}
      {ELIF: __System='PRODUKCJA'}
         {<1 PINFO.NAZ}{>{lm} date$1
         +{? PAR_WYDR.CZAS || ', '+$time() || '' ?}}
      {FI}
{COMMENT-}
   {FI}{COMMENT} {IF: +PAR_WYDR.MIEJSC} {COMMENT-}
   {COMMENT}
   Fragment zablokowany do czasu zwiększenia długości sygnatury.
   {IF: PAR_WYDR.SEP}{<1 lm*'─'}{FI}
   {COMMENT-}
   {VAR_DEL.delete('__MDC');~~}
{FI}
{SPACE: 'A'}
{IF: PAR_WYDR.TITLE<>''}
{SPACE: 'A'}{FONT: 'TITLE'}{lm:=charleft();~~}
   {<1>{lm} _poz:=PAR_WYDR.TITLE*'\n';
            {? _poz
               || (_poz-1)+PAR_WYDR.TITLE
               || PAR_WYDR.TITLE
            ?}}
   {IF: PAR_WYDR.TITLE*'\n'}
      {<1>{lm} _poz:=PAR_WYDR.TITLE*'\n';
            PAR_WYDR.TITLE+(+PAR_WYDR.TITLE-_poz)}
   {FI}
{FI}
{MACRO-}
{COMMENT}------------------------------MACRO-FOOT-------------------{COMMENT-}
{COMMENT}
Makro używane do drukowania stopki (sygnatury) strony.
{COMMENT-}
{MACRO: 'FOOT'}
{SPACE: 'B'}
{SIGNATURE}
{FONT: 'SIGN'}{ {? var_pres('PAGELANG')>0 || __P_STR:=exec('tran_sik','lang',17); __P_Z:=exec('tran_sik','lang',18) || __P_STR:='Strona'; __P_Z:='z' ?};{? PAR_WYDR.SIGN || s_sign:=exec('nazwa','#system')+' v.ST '+exec('wersja','#system') || s_sign:='' ?}; s_sign}{IF: PAR_WYDR.NUM
      }{IF: var_pres('NOMAXP')<=0 | NOMAXP<>1
      }{MAXPAGE: >{charleft()++s_sign};__P_STR+' '+$page()+' '+__P_Z+' ';5L;''}{ELSE}{>{charleft()++s_sign
      } __P_STR+' '+$page()}{FI}{FI}{&__P_STR;&__P_Z;~~}
{SIGNATURE-}
{MACRO-}
{MACRO: 'FOOTML'}
{COMMENT}
{SPACE: 'B'}
{SIGNATURE}
{FONT: 'SIGN'}{ {? PAR_WYDR.SIGN || s_sign:='Macrologic'+' '+'Proces'+' v'+__Wersja
      +'/MacLEX'+' '+menu_pth() || s_sign:='' ?}; s_sign}{IF: PAR_WYDR.NUM
      }{MAXPAGE: >{charleft()++s_sign};'Strona '+$page()+' z ';5L;''}{FI}
{SIGNATURE-}
{COMMENT-}
{MACRO-}
{MACRO: 'FOOTCMS'}
{COMMENT}
{SPACE: 'B'}
{SIGNATURE}
{FONT: 'SIGN'}{ {? var_pres('PAGELANG')>0 || __P_STR:=exec('tran_sik','lang',17); __P_Z:=exec('tran_sik','lang',18) || __P_STR:='Strona'; __P_Z:='z' ?};{? PAR_WYDR.SIGN || s_sign:=FL.WYTWORCA+' '+FL.NSYSTEM+' '+__Wersja
      +' '+{? cli_ver='mbasic' || '' || {? var_pres('PATH')>100 || PATH.menu_pth() || menu_pth() ?} ?}+' v.ST' || s_sign:='' ?}; s_sign}{IF: PAR_WYDR.NUM
      }{IF: var_pres('NOMAXP')<=0 | NOMAXP<>1
      }{MAXPAGE: >{charleft()++s_sign};__P_STR+' '+$page()+' '+__P_Z+' ';5L;''}{ELSE}{>{charleft()++s_sign
      } 'Strona '+$page()}{FI}{FI}{&__P_STR;&__P_Z;~~}
{SIGNATURE-}
{COMMENT-}
{MACRO-}