:!UTF-8
{TITLE:  Zestawienie zawieszonego VAT naliczonego}
{PRINTER: FINFO.SZ_PRN,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT}
{BEGIN:
 sstr5:=sstr6:=sstr7:=sstr8:=sstr9:=sstr10:=sstr11:=sstr12:=sstr13:=0;
 sstr14:=sstr15:=sstr16:=sstr17:=sstr18:=0; sklej:=mdc:='';
 suma5:=suma6:=suma7:=suma8:=suma9:=suma10:=suma11:=suma12:=suma13:=lm:=0;
 suma14:=suma15:=suma16:=suma17:=suma18:=0;
 pom:=1;  rejestr:='Z'; tytul:=''; w55:=w555:=''; w44:=''; dru_line:=1;
 inwest0:=inwest1:=inwest2:=inwest3:=inwest4:=inwestv1:=inwestv2:=0;
 pozost0:=pozost1:=pozost2:=pozost3:=pozost4:=pozostv1:=pozostv2:=0; ok:=rek:=0;

 sinwes0:=sinwes1:=sinwes2:=sinwes3:=sinwes4:=sinwesv1:=sinwesv2:=0;
 spozos0:=spozos1:=spozos2:=spozos3:=spozos4:=spozosv1:=spozosv2:=0;

 PRN:=obj_new(@.CLASS.PRINT,23); PRN.sl_frame();
 PRN1:=obj_new(@.CLASS.PRINT,20); PRN1.sl_frame();
 linijka:=1;numer:=0; d_sum1:=d_sum2:=d_sum3:=0; linecnt:=0; w:=obj_new(20); szer:=obj_new(15);
 {!_a:=1 ..20 |! w[_a]:='' !};  w6:=w7:=w8:=w9:=w10:=w11:=w12:=w13:=w14:=0;
 PRN2:=obj_new(@.CLASS.PRINT,7); PRN2.sl_frame();
 w2:=''; w15:=sstr20:=suma20:=inwest5:=pozost5:=inwestv5:=pozostv5:=w16:=sstr21:=suma21:=0;
 dru_rej:=rej_1:=rej_2:=rej_3:=rej_4:=rej_5:=rej_6:=rej_7:=rej_8:=rej_9:=0;
 VAT7.ZDOPER:=VAT7.ZDWYST:='T'; nast:=0;
 VAT7.DOPEROD:=VAT7.DOPERDO:=VAT7.DWYSTOD:=VAT7.DWYSTDO:=date(0,0,0);
 VAT7.win_edit('RVL');
 ROZLICZ.PAR1:=1;
 VAR_DEL.delete('vatcz')
}
{END:
  obj_del(PRN); obj_del(PRN1); obj_del(szer); obj_del(w);
  &w6; &w7; &w8; &w9; &w10; &w11; &w12; &w13; &w14;
  &sstr5; &sstr6; &sstr7; &sstr8; &sstr9; &sstr10; &sstr11; &sstr12;
  &sstr13; &sstr14; &sstr15; &sstr16; &sstr17; &sstr18;&linijka; &numer;
  &suma5; &suma6; &suma7; &suma8; &suma9; &suma10; &suma11; &suma12;
  &suma13; &suma14; &suma15; &suma16; &suma17; &suma18; &linecnt;
  &w55; &w555; &w44; &ok; &rek;&sklej; &d_sum1; &d_sum2; &d_sum3; &nast;
  &rejestr;  &pom;  &tytul;  &inwest0; &inwest1; &inwest2; &inwest3; &inwest4; &inwestv1; &inwestv2;
  &pozost0; &pozost1; &pozost2; &pozost3; &pozost4; &pozostv1; &pozostv2;
  &sinwes0; &sinwes1; &sinwes2; &sinwes3; &sinwes4; &sinwesv1; &sinwesv2;
  &spozos0; &spozos1; &spozos2; &spozos3; &spozos4; &spozosv1; &spozosv2;
  _a:=SSTALE.AR().KOD+form(SSTALE.AO().NR,-2); DOK.use('doku'+_a); POZ.use('pozy'+_a);
  POW.use('pow_'+_a);
  obj_del(PRN2);&w2; &w15; &sstr20; &suma20; &inwest5; &pozost5;
  &inwestv5; &pozostv5; &w16; &sstr21; &suma21; &mdc; &lm;
  &dru_rej; &rej_1; &rej_2; &rej_3; &rej_4; &rej_5; &rej_6; &rej_7; &rej_8; &rej_9; &dru_line;
  VAR_DEL.delete('vatcz')
}
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzezone
==================================================
Nazwa pliku: rvl_zak.rpm
Utworzony:   2002-08-01 [RL]
==================================================
{COMMENT-}
{EXIT: ~VAT7.edit(" {? VAT7.DOPEROD>VAT7.DOPERDO & VAT7.DOPERDO<>date(0,0,0)
                    || FUN.info('Nieprawidłowy zakres dat.'@); 'DOPEROD'
                    |? VAT7.DWYSTOD>VAT7.DWYSTDO & VAT7.DWYSTDO<>date(0,0,0)
                    || FUN.info('Nieprawidłowy zakres dat.'@); 'DWYSTDO'
                    || 1 ?} ") }
  {'       WYDRUK  wg. GRUP  PODATKOWYCH       '@;~~}
{ szer[1]:=8; szer[2]:=20; szer[3]:=10; szer[4]:=13; szer[5]:=54; szer[6]:=16; szer[7]:=16; szer[8]:=16; szer[9]:=16;
   szer[10]:=16; szer[11]:=17; szer[12]:=16; szer[13]:=3; szer[15]:=4;
   PRN.add("w[18]",szer[15],' Lp.'@,1); w[18]:='';
   PRN.add("w[1]",szer[1],'Rej. VAT'@); PRN.add("w[2]",szer[2],'  Symbol dokumentu xRej. księg.  Pozycja'@,,'x');
   PRN.add("w[3]",szer[3],'D. zapisu  wystawien. otrzymania'@);
   PRN.add("w[5]",szer[5],'Kontrahent - nazwa, siedziba, numer identyfikacyjny'@);
   PRN.add("w[7]",szer[7],'     NETTO'@,1);
   PRN.add("w[8]",szer[8],'      VAT'@,1);
   PRN.add("w[9]",szer[9],'     NETTO'@,1);
   PRN.add("w[10]",szer[10],'      VAT'@,1);
   PRN.add("w[11]",szer[11],'     Kwota'@,1);
   PRN.add("w[12]",szer[12],'     Kwota'@,1);
   PRN.add("w[13]",szer[13],'i/p');
   PRN1.add("w[1]",szer[1]+szer[2]+szer[3]+szer[5]+szer[15]+4,'');
   PRN1.add("w[3]",szer[7],'',1);
   PRN1.add("w[4]",szer[8],'',1);
   PRN1.add("w[5]",szer[9],'',1);
   PRN1.add("w[6]",szer[10],'',1);
   PRN1.add("w[7]",szer[11],'',1);
   PRN1.add("w[8]",szer[12],'',1);
   PRN1.add("w[9]",szer[13],'',1);
   PRN2.add("",szer[1]+szer[2]+szer[3]+szer[5]+szer[15]+4,'');
   PRN2.add("",szer[7]+szer[8]+1,'   Zakupy opodatkowane służące#     sprzedaży opodatkowanej'@,1,'#');
   PRN2.add("",szer[9]+szer[10]+1,'   Zakupy opodatkowane służące# sprzedaży opodatkowanej i zwol.'@,1,'#');
   PRN2.add("",szer[11],'Zakupy za kt. nie#przysług. odlicz.#podatku+nieopod.#objęte stawką 0%%'@,1,'#');
   PRN2.add("",szer[12],'  Podatek VAT'@,1);
   PRN2.add("",szer[13],'Inw poz');
   ~~
  }
{INCLUDE: wsp_pw3.rpi}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{PAR_WYDR.TITLE:='DOKUMENTY Z ZAWIESZONYM ROZLICZENIEM VAT'@;~~}
{SUBSTITUTE: 'CHARHEAD'}{FONT: 'Q'}{SPACE: 'B'}
{LINE: 1}{IF: page=1}
{<3 'Parametry wydruku:'@}
{<6 'Rodzaj ewidencji: %1'@[VAT7.EWI().TR]}{<70 {? VAT7.RVAT=null || 'Rejestr VAT: Wszystkie'@ || 'Rejestr VAT: %1'@[VAT7.RVAT().SYM] ?}}
{<6 {? OPERATOR.DEPT || 'Jednostka księgowa: %1'@[OPERATOR.DEPT().OD] || 'Jednostka księgowa: wszystkie jednostki księgowe'@ ?}}{<60 'Kraj opodatkowania: %1 (%2)'@[VAT7.KRAJ().TR,VAT7.KRAJ().KOD]}
{IF: VAT7.DOPEROD<>date(0,0,0) | VAT7.DOPERDO<>date(0,0,0)}
{<6 'Dokumenty, których data zapisu zawiera się w zakresie dat: %1 - %2'@[VAT7.DOPEROD$1,VAT7.DOPERDO$1]}
{FI}
{IF: VAT7.DWYSTOD<>date(0,0,0) | VAT7.DWYSTDO<>date(0,0,0)}
{<6 'Dokumenty, których data wystawienia zawiera się w zakresie dat: %1 - %2'@[VAT7.DWYSTOD$1,VAT7.DWYSTDO$1]}
{FI}
{<6 {? ROZLICZ.PAR1 || 'Kwoty pozostałe do rozliczenia: Tak'@ || 'Kwoty pozostałe do rozliczenia: Nie'@ ?}}
{FI}
{FONT: 'R'}{SPACE: 'C'}
{PRN2.hbar()}
{PRN2.ini_head()}
{WHILE: PRN2.h_next()}
{DO}
{PRN2.h_line()}
{OD}
{PRN2.jbar(PRN)}
{PRN.ini_head()}
{WHILE: PRN.h_next()}
{DO}
{PRN.h_line()}
{OD}
{PRN.bar()}
{FONT: 'Q'}{SPACE: 'C'}
{HEADER-}
{COMMENT}------------------------------MACRO-LINIA------------------{COMMENT-}
{MACRO: 'LINIA'}
{PRN.ini_line()}
{WHILE: PRN.next()}
{DO}
{<1 PRN.line()}
{OD}
{MACRO-}
{COMMENT}------------------------------MACRO-LINIA1------------------{COMMENT-}
{MACRO: 'LINIA1'}
{PRN1.ini_line()}
{WHILE: PRN1.next()}
{DO}
{<1 PRN1.line()}
{OD}
{MACRO-}
{COMMENT}------------------------------FOOTER--------------------------{COMMENT-}
{FOOTER: 0}
{IF:dru_line & linijka & lineleft<5 }{PRN.lbar()}{FI}
{PRN1.hbar()}
{ w[1]:='   SUMA STRONY'@;  w[3]:= form(sstr7,,2,' ,'); w[4]:= form(sstr8,,2,' ,');  w[5]:= form(sstr9,,2,' ,');
  w[6]:= form(sstr10,,2,' ,'); w[7]:= form(sstr11,,2,' ,'); w[8]:= form(sstr12,,2,' ,');  w[9]:='';
  ~~}
{SUBSTITUTE: 'LINIA1'}
{PRN1.bar()}
{IF: page>1}
{ w[1]:='   Z PRZENIESIENIA'@; w[3]:= form((suma7-sstr7),,2,' ,'); w[4]:= form((suma8-sstr8),,2,' ,');  w[5]:= form((suma9-sstr9),,2,' ,');
  w[6]:= form((suma10-sstr10),,2,' ,'); w[7]:= form((suma11-sstr11),,2,' ,'); w[8]:= form((suma12-sstr12),,2,' ,');  w[9]:='';
  ~~}
{SUBSTITUTE: 'LINIA1'}
{PRN1.bar()}{FI}
{ w[1]:='   DO PRZENIESIENIA'@; w[3]:= form(suma7,,2,' ,'); w[4]:= form(suma8,,2,' ,');  w[5]:= form(suma9,,2,' ,');
  w[6]:= form(suma10,,2,' ,'); w[7]:= form(suma11,,2,' ,'); w[8]:= form(suma12,,2,' ,');  w[9]:='';
   ~~}
{SUBSTITUTE: 'LINIA1'}
{PRN1.lbar()}
{SUBSTITUTE: 'CHARFOOT'}{ sstr7:=sstr8:=sstr9:=sstr10:=sstr11:=sstr12:=sstr20:=0; ~~}
{FOOTER-}
{COMMENT}-----------------------------------------------MACRO-SRODEK-----------------------------------{COMMENT-}
{MACRO: 'SRODEK'}
{  exec('mask','dok_fks_ks',ROZLVAT.OKRO().ROK().KOD,ROZLVAT.OKRO().NR); DOK.prefix(); ROZLVAT.DOK(); ~~}
{IF: DOK.KRAJ=VAT7.KRAJ &
     (VAT7.DOPEROD<>date(0,0,0) & DOK.DTW>=VAT7.DOPEROD | VAT7.DOPEROD=date(0,0,0)) &
     (VAT7.DOPERDO<>date(0,0,0) & DOK.DTW<=VAT7.DOPERDO | VAT7.DOPERDO=date(0,0,0)) &
     (VAT7.DWYSTOD<>date(0,0,0) & DOK.DTO>=VAT7.DWYSTOD | VAT7.DWYSTOD=date(0,0,0)) &
     (VAT7.DWYSTDO<>date(0,0,0) & DOK.DTO<=VAT7.DWYSTDO | VAT7.DWYSTDO=date(0,0,0))
}
       {  w[1]:=ROZLVAT.RVAT().SYM; dru_line:=1;
          w[2]:=DOK.NK; w[3]:=$DOK.DTW; w[14]:=$DOK.DTO; w[15]:=$DOK.D4;
          w2:=DOK.REJ().KOD+(8-(+DOK.REJ().KOD))*' '+form(DOK.NR,szer[2]-8,,'99');
          _nip:=ROZLVAT.DOK().NIP;
          w55:=ROZLVAT.DOK().KH_FULL+{? +DOK.MIASTO || ', '+DOK.MIASTO || '' ?}+{? +_nip || ', '+_nip || '' ?};
          STR.split(w55); w[5]:=STR.line(55);
     ~~
       }
       {FOR: 'VPOZ'}
       {INDEX: 'VDRV'}
       {PREFIX: DOK.ref,ROZLVAT.RVAT}
       {DO}
        {IF: ~VPOZ.OKRVAT}
         {vatcz:=exec('rvl','fks_vat',VPOZ.ref(),ROZLICZ.PAR1);~~}
         {IF: (VPOZ.GRVAT().KOD='ZInwePod')|VPOZ.GRVAT().KOD='ZInwPods'|(VPOZ.GRVAT().KOD='ZakupPod')|
              VPOZ.GRVAT().KOD='ZakuPods'|(VPOZ.GRVAT().KOD='ZakuPRop') }
           { {? VPOZ.GRVAT().KOD='ZInwPods' | VPOZ.GRVAT().KOD='ZakuPods'
             || _net:=(VPOZ.NETTO/2)$2; _vat:=(VPOZ.VAT/2)$2; _vatcz2:=(vatcz[2]/2)$2; _vatcz1:=(vatcz[1]/2)$2
             || _net:=VPOZ.NETTO; _vat:=VPOZ.VAT; _vatcz2:=vatcz[2]; _vatcz1:=vatcz[1]
             ?};
             w7+=_net-_vatcz1;
             w8+=_vat-_vatcz2;
             w12+=VPOZ.VAT-vatcz[2];
             {? (VPOZ.GRVAT().KOD)='ZInwePod' | VPOZ.GRVAT().KOD='ZInwPods'
             || inwest1+=_net-_vatcz1;  inwest4+=VPOZ.VAT-vatcz[2]; inwestv1+=_vat-_vatcz2; w[13]:='i'
             || pozost1+=_net-_vatcz1;  pozost4+=VPOZ.VAT-vatcz[2]; pozostv1+=_vat-_vatcz2;
                w[13]:={? VPOZ.GRVAT().KOD='ZakupPod' | VPOZ.GRVAT().KOD='ZInwPods' || 'p' || 'r'?}
             ?};
             ~~
           }
         {ELIF:(VPOZ.GRVAT().KOD='ZInwPodZ')|VPOZ.GRVAT().KOD='ZInwPodS'|(VPOZ.GRVAT().KOD='ZakuPodZ')|
               VPOZ.GRVAT().KOD='ZakuPodS'|(VPOZ.GRVAT().KOD='ZakPRopZ')}
           { {? VPOZ.GRVAT().KOD='ZInwPodS' | VPOZ.GRVAT().KOD='ZakuPodS'
             || _net:=(VPOZ.NETTO/2)$2; _vat:=(VPOZ.VAT/2)$2; _vatcz2:=(vatcz[2]/2)$2; _vatcz1:=(vatcz[1]/2)$2
             || _net:=VPOZ.NETTO; _vat:=VPOZ.VAT; _vatcz2:=vatcz[2]; _vatcz1:=vatcz[1]
             ?};
             w9+=_net-_vatcz1;
             w10+=_vat-_vatcz2;
             w12+=VPOZ.VAT-vatcz[2];
             {? VPOZ.GRVAT().KOD='ZInwPodZ' | VPOZ.GRVAT().KOD='ZInwPodS'
             || inwest2+=_net-_vatcz1; inwest4+=VPOZ.VAT-vatcz[2];  inwestv2+=_vat;w[13]:='i'
             || pozost2+=_net-_vatcz1; pozost4+=VPOZ.VAT-vatcz[2]; pozostv2+=_vat;
                w[13]:={? VPOZ.GRVAT().KOD='ZakuPodZ' | VPOZ.GRVAT().KOD='ZakuPodS' || 'p'|| 'r' ?}
             ?};~~
           }
         {ELIF:(VPOZ.GRVAT().KOD='ZInwPodN')|(VPOZ.GRVAT().KOD='ZakPRopN')|
               (VPOZ.GRVAT().KOD='ZakuPodN')}
          { w15+=VPOZ.NETTO-vatcz[1];  w12+=VPOZ.VAT-vatcz[2];
             {? (VPOZ.GRVAT().KOD)='ZInwPodN'
             || inwest5+=VPOZ.NETTO-vatcz[1]; inwestv5+=VPOZ.VAT-vatcz[2]; inwest4+=VPOZ.VAT-vatcz[2]; w[13]:='i'
             || pozost5+=VPOZ.NETTO-vatcz[1]; pozostv5+=VPOZ.VAT-vatcz[2];  pozost4+=VPOZ.VAT-vatcz[2];
                w[13]:={? VPOZ.GRVAT().KOD='ZakuPodN'||'p'||'r'?}
             ?}; ~~
           }
         {ELIF:(5+VPOZ.GRVAT().KOD='ZInwN')|(5+VPOZ.GRVAT().KOD='ZPozN')|
                (VPOZ.GRVAT().KOD='ZakupNpr') }
           { w11+=VPOZ.BRUTTO-vatcz[3];
             {? (5+VPOZ.GRVAT().KOD)='ZInwN'
             || inwest3+=VPOZ.BRUTTO-vatcz[3]; w[13]:='i'
             || pozost3+=VPOZ.BRUTTO-vatcz[3];w[13]:={? 5+VPOZ.GRVAT().KOD='ZPozN'||'p'||'r'?}
             ?}; ~~
           }
         {FI}
        {VAR_DEL.delete('vatcz');~~}
        {FI}
       {OD}
{COMMENT}----------------------------WYDRUK-------------------------------------------------{COMMENT-}
{IF:((page>1 & linecnt<17) | (page=1 & linecnt<13)) & linecnt<>0}
{PAGE}
{linijka:=1; ~~}
{FI}
{ENTIRE}
{ w[7]:=form(w7,,2,' ,'); w[8]:=form(w8,,2,' ,'); w[9]:=form(w9,,2,' ,');
  w[10]:=form(w10,,2,' ,'); w[11]:=form(w11,,2,' ,'); w[12]:=form(w12,,2,' ,');~~
}
{IF: linijka=0 & dru_line=1 | nast=1 }
{PRN.hbar()}
{FI}{ numer+=1; w[18]:=$numer; ~~}
{SUBSTITUTE: 'LINIA'}{ dru_rej:=1; w[18]:='';~~}
{  {!_a:=1 ..13 |! w[_a]:='' !}; w[2]:=w2; w[3]:=w[14]; w[5]:=STR.line(55); w[1]:='';~~}
{SUBSTITUTE: 'LINIA'}
{  {!_a:=1 ..13 |! w[_a]:='' !}; w[3]:=w[15]; w[5]:=STR.line(55); ~~}
{SUBSTITUTE: 'LINIA'}
    { sstr7+=w7; sstr8+=w8; sstr9+=w9; sstr10+=w10; sstr11+=w11; sstr12+=w12; suma20+=w15;
       suma7+=w7; suma8+=w8; suma9+=w9; suma10+=w10; suma11+=w11; suma12+=w12; sstr20+=w15;
       rej_1+=w6; rej_2+=w7; rej_3+=w8; rej_4+=w9; rej_5+=w10; rej_6+=w11;  rej_7+=w12;  rej_8+=w15;
       w7:=w8:=w9:=w10:=w11:=w12:=w15:=0; linijka:=1; nast:=0; ~~
}
{ENTIRE-}
{FI}
{MACRO-}
{COMMENT}----------------------PRZYGOTOWANIE WYDRUKU-----------------------{COMMENT-}
{FONT: 'Q'}{SPACE: 'C'}{ RS.index('RS'); RS.prefix(); ~~}
{FOR: 'RVAT'}
{INDEX:'RVAT_SYM'}
{PREFIX: REF.FIRMA,VAT7.EWI,VAT7.RVAT().SYM}
{DO}
 {IF: OPERATOR.DEPT}
  {FOR: 'ROZLVAT'}
  {INDEX: 'REJ_VO'}
  {PREFIX: OPERATOR.DEPT,RVAT.ref()}
  {DO}
  {SUBSTITUTE: 'SRODEK'}
  {OD}
 {ELSE}
  {FOR: 'ROZLVAT'}
  {INDEX: 'REJ_V'}
  {PREFIX: RVAT.ref()}
  {DO}
  {SUBSTITUTE: 'SRODEK'}
  {OD}
 {FI}
{nast:=0;~~}
{IF: ((page>1 & linecnt<19) | (page=1 & linecnt<15)) & linecnt<>0}
{PAGE}
{FI}
{IF: lineleft()<6 & lineleft()<>0}{PAGE}{ dru_line:=1;~~}{FI}
{ENTIRE}
{IF: dru_line}{PRN.lbar()}{ dru_line:=0;~~}{FI}
{PRN1.hbar()}
{w[1]:='Razem w rejestrze %1 %2'@[RVAT.SYM,RVAT.NAZ];
   w[3]:= form(inwest1-sinwes1+pozost1-spozos1,,2,' ,');
   w[4]:= form(inwestv1-sinwesv1+pozostv1-spozosv1,,2,' ,');
   w[5]:= form(inwest2-sinwes2+pozost2-spozos2,,2,' ,');  w[9]:='';
   w[6]:= form(inwestv2-sinwesv2+pozostv2-spozosv2,,2,' ,');
   w[7]:= form(inwest3-sinwes3+pozost3-spozos3,,2,' ,');
   w[8]:= form(inwest4-sinwes4+pozost4-spozos4,,2,' ,');
   ~~}
{SUBSTITUTE: 'LINIA1'}
{PRN1.bar()}
{ w[1]:='   w tym:  zakupy inwestycyjne'@; w[3]:= form(inwest1-sinwes1,,2,' ,'); w[4]:= form(inwestv1-sinwesv1,,2,' ,');  w[5]:= form(inwest2-sinwes2,,2,' ,');
  w[6]:= form(inwestv2-sinwesv2,,2,' ,');  w[7]:= form(inwest3-sinwes3,,2,' ,'); w[8]:= form(inwest4-sinwes4,,2,' ,'); w[9]:=''; ~~}
{SUBSTITUTE: 'LINIA1'}
{ w[1]:='           zakupy pozostałe'@; w[3]:= form(pozost1-spozos1,,2,' ,'); w[4]:= form(pozostv1-spozosv1,,2,' ,');  w[5]:= form(pozost2-spozos2,,2,' ,');
  w[6]:= form(pozostv2-spozosv2,,2,' ,'); w[7]:= form(pozost3-spozos3,,2,' ,'); w[8]:= form(pozost4-spozos4,,2,' ,');  w[9]:=''; ~~}
{SUBSTITUTE: 'LINIA1'}
{PRN1.lbar()}
{nast:=1; ~~}
{ENTIRE-}
{ sinwes0:=inwest0; sinwes1:=inwest1; sinwes2:=inwest2; sinwes3:=inwest3; sinwes4:=inwest4; sinwesv1:=inwestv1; sinwesv2:=inwestv2;
  spozos0:=pozost0; spozos1:=pozost1; spozos2:=pozost2; spozos3:=pozost3; spozos4:=pozost4; spozosv1:=pozostv1; spozosv2:=pozostv2;
  linijka:=0; dru_line:=0;~~}
{OD}
{COMMENT}----------------------------------------FOOTER-LAST----------------------------{COMMENT-}
{linecnt:=lineleft();~~}
{IF: ((page>1 & linecnt<13) | (page=1 & linecnt<9)) & linecnt<>0}
{IF: linijka=1}{PRN.lbar()}{FI}
{PAGE}
{ELIF: lineleft()=0}
{PRN.lbar()}
{FI}
{DIRECT}
{IF: linijka=0 & dru_line=0 & ((page>1 & linecnt<13) | (page=1 & linecnt<9)) & linecnt<>0}{PRN.lbar()}{FI}
{PRN1.hbar()}
{IF: page>1}
{ w[1]:='   SUMA STRONY'@; w[3]:= form(sstr7,,2,' ,'); w[4]:= form(sstr8,,2,' ,');  w[5]:= form(sstr9,,2,' ,');
  w[6]:= form(sstr10,,2,' ,'); w[7]:= form(sstr11,,2,' ,'); w[8]:= form(sstr12,,2,' ,');  w[9]:='';
  ~~}
{SUBSTITUTE: 'LINIA1'}
{PRN1.bar()}
{ w[1]:='   Z PRZENIESIENIA'@; w[3]:= form((suma7-sstr7),,2,' ,'); w[4]:= form((suma8-sstr8),,2,' ,');  w[5]:= form((suma9-sstr9),,2,' ,'); w[9]:='';
  w[6]:= form((suma10-sstr10),,2,' ,'); w[7]:= form((suma11-sstr11),,2,' ,'); w[8]:= form((suma12-sstr12),,2,' ,');
  ~~}
{SUBSTITUTE: 'LINIA1'}
{PRN1.bar()}
{FI}
{ w[1]:='   RAZEM'@; w[3]:= form(suma7,,2,' ,'); w[4]:= form(suma8,,2,' ,');  w[5]:= form(suma9,,2,' ,');  w[9]:='';
  w[6]:= form(suma10,,2,' ,'); w[7]:= form(suma11,,2,' ,'); w[8]:= form(suma12,,2,' ,');
  ~~}
{SUBSTITUTE: 'LINIA1'}
{PRN1.bar()}
{ w[1]:='   W TYM:  ZAKUPY INWESTYCYJNE'@; w[3]:= form(inwest1,,2,' ,'); w[4]:= form(inwestv1,,2,' ,');  w[5]:= form(inwest2,,2,' ,');
  w[6]:= form(inwestv2,,2,' ,');  w[7]:= form(inwest3,,2,' ,'); w[8]:= form(inwest4,,2,' ,'); w[9]:=''; ~~}
{SUBSTITUTE: 'LINIA1'}
{ w[1]:='           ZAKUPY POZOSTAŁE'@; w[3]:= form(pozost1,,2,' ,'); w[4]:= form(pozostv1,,2,' ,');  w[5]:= form(pozost2,,2,' ,');
  w[6]:= form(pozostv2,,2,' ,'); w[7]:= form(pozost3,,2,' ,'); w[8]:= form(pozost4,,2,' ,');  w[9]:=''; ~~}
{SUBSTITUTE: 'LINIA1'}
{PRN1.lbar()}
{<1>{PRN.width()} 'KONIEC WYDRUKU'@}
{DIRECT-}
{FOOTER}
{SUBSTITUTE: 'CHARFOOT'}
{~~}
{FOOTER-}
