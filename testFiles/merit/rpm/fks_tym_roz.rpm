:!UTF-8
{TITLE:  Dokumenty (pozycje) do automatycznego rozliczenia zawieszonego VAT}
{PRINTER: FINFO.SZ_PRN,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT}
{BEGIN:  PRN:=obj_new(@.CLASS.PRINT,10); PRN.s_frame(); mdc:=''; lm:=0;
         PRN1:=obj_new(@.CLASS.PRINT,10); PRN1.s_frame();
         exec('s_rozl1','!fks_vat_droz'); sizesrozl:=STYM_ROZ.size()
}
{END:  VAR_DEL.delete('PRN','STYM_ROZ','PRN1'); &mdc; &lm; &sizesrozl;
       exec('mask','dok_fks_ks',SSTALE.AR().KOD,SSTALE.AO().NR)
}
{PRN.add("ROZLVAT.RVAT().SYM",8,'Rejestr VAT'@);
 PRN.add("ROZLVAT.SYM",20,'Symbol dokumentu'@);
 PRN.add("$ROZLVAT.DATA",10,'Data zapisu'@);
 PRN.add("ROZLVAT.KH",10,'Kontrahent'@);
 PRN.add("form(TYM_ROZ.NETTO,18,2,' ,')",18,'Kwota netto'@);
 PRN.add("form(TYM_ROZ.VAT,18,2,' ,')",18,'Kwota VAT'@);
 PRN.add("TYM_ROZ.TRYB",45,'Tryb rozliczenia'@);
 PRN.add("TYM_ROZ.CO",40,'Opis'@);
 PRN.add("TYM_ROZ.OK",5,'Zazn.'@);
 PRN.add("TYM_ROZ.DOK_POZ",5,'Dok./Poz.'@);
 PRN1.add("STYM_ROZ.OPIS",57,'Podsumowanie'@);
 PRN1.add("form(STYM_ROZ.NETTO,18,2,' ,')",18,'Kwota netto'@);
 PRN1.add("form(STYM_ROZ.VAT,18,2,' ,')",18,'Kwota netto'@);
 ~~}
{INCLUDE: wsp_pw3.rpi}
{HEADER}
{PAR_WYDR.TITLE:='DOKUMENTY (POZYCJE) DO AUTOMATYCZNEGO ROZLICZENIA ZAWIESZONEGO VAT'@;~~}
{SUBSTITUTE: 'CHARHEAD'}{FONT: 'Q'}{SPACE: 'B'}
{LINE: 1}{IF: page=1}
{<3 'Parametry wydruku:'@}
{<6 'Okres: %1 %2'@[SSTALE.AO().NAZ,SSTALE.AO().ROK().NAZ]}
{<6 'Rodzaj ewidencji: %1'@[VAT7.EWI().TR]}
{<6 {? VAT7.RVAT=null() || 'Rejestr VAT: Wszystkie'@ || 'Rejestr VAT: %1'@[VAT7.RVAT().SYM] ?}}
{<6 {? OPERATOR.DEPT || 'Jednostka księgowa: %1'@[OPERATOR.DEPT().OD] || 'Jednostka księgowa: wszystkie jednostki księgowe'@ ?}}
{FI}
{LINE:1}
{FONT: 'Q'}{SPACE: 'C'}
{FONT: 'R'}
{PRN.hbar()}
{PRN.ini_head()}
{WHILE: PRN.h_next()}{DO}
{PRN.h_line()}
{OD}
{FONT: 'Q'}
{HEADER-}
{FOOTER}
{SUBSTITUTE: 'CHARFOOT'}
{~~}
{FOOTER-}
{MACRO: 'linia'}
{PRN.ini_line()}
{WHILE: PRN.next()}
{DO}
{<1 PRN.line()}
{OD}
{MACRO-}
{MACRO: 'linia1'}
{PRN1.ini_line()}
{WHILE: PRN1.next()}
{DO}
{<1 PRN1.line()}
{OD}
{MACRO-}
{FOR:'TYM_ROZ'}
{DO}
{IF: ROZLVAT.seek(TYM_ROZ.ROZLVAT,ROZLVAT.name())}
{IF: {?  OPERATOR.DEPT=null
     || 1
     || exec('mask','dok_fks_ks',ROZLVAT.OKRO().ROK().KOD,ROZLVAT.OKRO().NR);
        DOK.prefix();
        ROZLVAT.DOK();
        DOK.ODD=OPERATOR.DEPT
     ?}
}
{ENTIRE}
{PRN.bar()}
{SUBSTITUTE:'linia'}
{ENTIRE-}
{IF:lineleft()<3}{PRN.lbar()}{FI}
{FI}
{FI}
{OD}
{IF: lineleft()>=3 & lineleft()<4+sizesrozl}{PRN.lbar()}{FI}
{FOOTER}
{SUBSTITUTE: 'CHARFOOT'}
{~~}
{FOOTER-}
{ENTIRE}
{PRN.lbar()}
{PRN1.hbar()}
{FOR:'STYM_ROZ'}
{DO}
{SUBSTITUTE:'linia1'}
{OD}
{PRN1.lbar()}
{<1>{PRN.width()} 'KONIEC WYDRUKU'@}
{ENTIRE-}