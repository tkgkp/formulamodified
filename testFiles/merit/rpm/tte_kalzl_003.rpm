:!UTF-8
{TITLE:3. Wydruk listy stawek operacji kalkulacji zlecenia}
{PRINTER: INFO.W_PRN,,,,,'E','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
      PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   ANZH.cntx_psh();
   ANZTTO.cntx_psh();
   dalej:=0;
   PRN:=obj_new(@.CLASS.PRINT,3);
   PRN.s_frame();
   prn1:='PRN';
   color:='';
   lm:=ll:=vp:=lmt:=rsep:=0
}
{END:
   ANZH.cntx_pop();
   ANZTTO.cntx_pop();
   &dalej;
   obj_del(PRN);
   &prn1;
   &color;
   &lm; &ll; &vp; &lmt; &rsep
}
{COMMENT}
  Wydruk analizy zlecenia.
  [MKO] - 2002/04/11 - [7.53] OWwSK003_Aneks1
  Wywołanie: Zlecenia (produkcyjne, warsztatowe) -> Koszty -> Kalkulacja wstępna ->
     -> Drukuj -> 3. Wydruk listy stawek operacji kalkulacji zlecenia
{COMMENT-}
{COMMENT}---Definicja wiersza wydruku pozycji analizy zlecenia ANZP.{COMMENT-}
{  PRN.add("ANZTTO.TTOPER().KOD",10,'Kod operacji'@);
   PRN.add("ANZTTO.TTOPER().NA",30,'Nazwa operacji'@);
   PRN.add("form(ANZTTO.STAWKA,,2)",15,'Stawka'@,1);
  PAR_WYDR.TITLE:='LISTA STAWEK OPERACJI POBRANYCH\nDO KALKULACJI ZLECENIA'@; ~~}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T10'}{SPACE: 'B'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{<{lmt+1} 'PARAMETRY WYDRUKU:'@}
{<{lmt+1} 'Nr kalkulacji:'@} {<{lmt+15} form(ANZH.NRA)}
{<{lmt+1} 'Zlecenie:'@}   {<{lmt+15} ANZH.ZLEC().SYM}
{<{lmt+1} 'Wariant:'@}    {<{lmt+15} ANZH.OPC().NA}
{FONT: 'T10B'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T10'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T10B'}{SPACE: 'B'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T10'}{SPACE: 'B'}
{ rsep:=PAR_WYDR.RSEP; ~~}
{ANZTTO.index('AO');ANZTTO.prefix(ANZH.ref());~~}
{IF: ANZTTO.first()}{dalej:=1;~~}{FI}
{WHILE: dalej}
{DO}
   {SUBSTITUTE: 'LINIA0'}
   { dalej:=ANZTTO.next(); ~~}
{OD}
