:!UTF-8
{TITLE:C. Potwierdzenie zamówienia}
{PRINTER: exec('set_parw','param_wydr');exec('prt','param_wydr','v'),,,,,'Q','C',,,,,,1,
   PAR_WYDR.MBOT,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,0,1}
{BEGIN:
   {? exec('czy_grp_dr','faktury_wydruk')
   || __GRP_DR.WZ:='lzk_zdzamp01'
   ?};
   POLA.NAZ_WYDR:='Potwierdzenie zamowienia dostaw '+exec('str_to_pth','#string',ZD_NAG.SYM)+'.pdf';
   zdzam_02:="
      VAR_DEL.delete('PRN','w','s','k','p','dokl');
      VAR_DEL.delete('ok');
      VAR_DEL.delete('color','prn1','prn2');
      VAR_DEL.delete('lm','ll','vp','lmt','rsep');
      VAR_DEL.delete('il_lin');
      VAR_DEL.delete('zakoncz');
      VAR_DEL.delete('oddzial');
      VAR_DEL.delete('byl','wsk');
      VAR_DEL.delete('M_GD','S_GD');
      VAR_DEL.delete('NOMAXP')
      ";
   zdzam_02();
   VAR_DEL.delete('__tab_sel','ns');
   exec('czytaj','#stalesys',,XINFO); KSTE.get();
   VAR_DEL.delete('PRN','w','s','na');
   PRN:=obj_new(@.CLASS.PRINT,20); PRN.s_frame();
   w:=obj_new(20);
   s:=obj_new(20);
   k:=obj_new(6);  {! _i..6 |! k[_i]:=0  !}; "--szerokosc kolumn--";
   p:=obj_new(6);  {! _i..6 |! p[_i]:='' !}; "--tymczasowa do szacowania szerokosci kolumn--";
   dokl:=0; "--dokladnosc ilosci--";

   ok:=0;
   color:=prn1:=prn2:='';
   lm:=ll:=vp:=lmt:=rsep:=0;
   il_lin:=0;
   zakoncz:=1;
   oddzial:=KSTE.NAZ<>'';
   byl:=wsk:=0;

   PARAM_W.JEZYK:=0;

   FAKSO.cntx_psh;
   FAKSO.use('fakto' + (ZD_NAG.name() + 3));
   ZD_POZ.cntx_psh
;~~}
{END:
   FAKSO.cntx_pop;
   ZD_POZ.cntx_pop;
   zdzam_02(); VAR_DEL.delete('zdzam_02');VAR_DEL.delete('__tab_sel','ns')
;~~}
{INCLUDE: wsp_pw.rpi}
{INCLUDE: wsp_lic.rpi}
{INCLUDE: wsp_strony.rpi}
{DEFINEFONT: 'TM=Inter,,M,,0,0'}
{DEFINEFONT: 'TMB=Inter,,N,,0,0'}
{DEFINEFONT: 'TF=Inter,,F,,0,0'}
{IF:ZD_NAG.sel_size()>0 & __GRP_DR.PDF=0}
   {
        ZD_NAG.cntx_psh();
      __tab_sel:=ZD_NAG.sel_aget()
   ;~~}
{FOR: __tab_sel}
   {DO}
      {IF: ZD_NAG.seek(__tab_sel.REF,)}
      {
         VAR_DEL.delete('PRN','w','s','k','p');
         VAR_DEL.delete('ok');
         VAR_DEL.delete('zakoncz');
         VAR_DEL.delete('PRN','w','s','na');
         PRN:=obj_new(@.CLASS.PRINT,20); PRN.s_frame();
         w:=obj_new(20);
         s:=obj_new(20);
         k:=obj_new(6);  {! _i..6 |! k[_i]:=0  !}; "--szerokosc kolumn--";
         p:=obj_new(6);  {! _i..6 |! p[_i]:='' !}; "--tymczasowa do szacowania szerokosci kolumn--";
         NOMAXP:=1;
         ok:=0;
         zakoncz:=1;
         ~~}
         {INCLUDE: lzk_zdzamp01.rpi}
         {IF: lineleft()>0}{PAGE}{ns:=1;page(1);~~}{FI}
      {FI}
   {OD}
   {
      ZD_NAG.cntx_pop();
   ~~}
{ELSE}
   {ZD_NAG.cntx_psh();~~}
   {INCLUDE: lzk_zdzamp01.rpi}
   {ZD_NAG.cntx_pop();~~}
{FI}