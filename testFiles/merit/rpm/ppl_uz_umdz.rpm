:!UTF-8
{TITLE:Umowa o dzieło}
{PRINTER: exec('prt','param_wydr','v',KST),exec('rep_set','rap_zew','PXX_UD')='T',,,,'I','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{INCLUDE: p_zleform.rpi}
{COMMENT}OLD: uz_umdz.rpm{COMMENT-}
{COMMENT}OLD: zleform.rpi{COMMENT-}
{COMMENT}OLD: zledoc.rpi{COMMENT-}
{COMMENT}OLD: skid_pw.rpi{COMMENT-}
{COMMENT}OLD: uz_form.rpi{COMMENT-}
{COMMENT}OLD: zleumdz.rpi{COMMENT-}
{IF: (cli_ver()='jterm' & exec('rep_set','rap_zew','PXX_UD')='T') |
     (exec('cli_ver','#system')='interm' & exec('rep_set','rap_zew','PXX_UD',1)='T')}
{INCLUDE: p_zledoc.rpi}
{ELSE}
{INCLUDE: wsp_pw.rpi}
{INCLUDE: p_uzform.rpi}
{
   params_set(_par:=params_get());
   {? _par.paperless & _par.PEP.fml_after<>""
   || {? _par.PEP.CALL.first()
      || _par.TAB.REP:=_par.PEP.CALL.REP;
         _par.TAB.GODZ:=_par.PEP.CALL.GODZ;
         _par.TAB.DNI:=_par.PEP.CALL.DNI;
         _par.TAB.ZLEC:=_par.PEP.CALL.ZLEC;
         _par.TAB.NR:=_par.PEP.CALL.NR;
         _par.TAB.add();
         _par.TAB.memo_set(_par.PEP.CALL.memo_txt(,,'TR'));
         _par.TAB.memo_put(,'TR')
      ?}
   || {? czy_pep || _par.PEP.CALL:=_par.TAB ?}
   ?};
~~ }
{IF: params_get().paperless & params_get().PEP.fml_after=""}
   {
   params_get().PEP.P:=P.ref();
   params_get().PEP.fml_after:="
      _params:=params_get();
      _pep:=obj_new('active','fml_after','P','CALL');
      _pep.active:=1;
      _pep.fml_after:=\"1\";
      _pep.P:=_a;
      _pep.CALL:=_b;
      {? var_pres('_params')>100
      || {? var_pres('PEP',_params)<100
         || _new:=exec('obj_ntab_set','#array',_params,'PEP',_pep);
            obj_del(_params); &_params;
            _params:=_new;
            obj_del(_new); &_new
         ?}
      || _params:=obj_new('PEP');
         _params.PEP:=_pep
      ?};
      params_set(_params);
      _name:='@'+tmp_dir()+exec('sep','#file')+'ppl_uz_umdz_%1'[$P.tm_stamp()]+'.pdf';
      rep_exec('ppl_uz_umdz',,0,_name,1,,1);
      params_exec('dodaj_dokument','paperless',_name,ZC.uidref(),params_get())
   ";
   ~~}
   {INCLUDE: p_zleumzc.rpi}
   {EXIT}
{ELSE}
   {INCLUDE: p_zleumzc.rpi}
{FI}
{FI}