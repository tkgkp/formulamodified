:!UTF-8
{TITLE:D. Zestawienie posesji kontrahentów wg miast}
{PRINTER: exec('set_parw','param_wydr'); exec('prt','param_wydr','h'),,,,,'Q','C',,,,,,1,
   PAR_WYDR.MBOT,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,0,1,,'enable'}
{BEGIN:
   KH.cntx_psh();
   KH.win_dict('WERHOME2');
   GRKH.cntx_psh();
   GRKH.win_dict('WER');
   GRKH.index('KOD');
   VAR_DEL.delete('PRN','k','w','s','tryb');

   PRN:=obj_new(@.CLASS.PRINT,12);  PRN.s_frame();
   tryb:=rep_export();

   k:=obj_new(6);
   w:=obj_new(6);
   s:=obj_new(3);

   k[1] := 3;
   k[2] := 20;
   k[3] := 30;
   k[4] := 30;
   k[5] := 5;
   k[6] := 10;
   w[1] := w[2] := w[3] := w[4] := w[5] := w[6] := '';
   s[1] := s[2] := s[3] := 0;
   nrpos:=0;
   lp:=0;

   od_kh:='';
   do_kh:='';
   od_kod:='';
   do_kod:='';

   od_gr:='';
   do_gr:='';
   od_grk:='';
   do_grk:='';

   pref_miasto:='';
   pref_rejon:='';
   pref_ulica:='';
   pref_kod:='';

   ok:=0;
   spr_mia:='';

   'zmienne pomocnicze do wydrukow graficznych';
   color:='';
   prn1:='PRN'; prn2:='PRX';
   lm:=ll:=vp:=lmt:=0; rsep:=PAR_WYDR.RSEP;

   'parametry z tabeli WYDRUKI';
   _wydr_naz:='umo_003';
   WYDRUKIL.index('WYDRUKI');
   WYDRUKIL.prefix(OPERATOR.USER().KOD,_wydr_naz,);
   {? ~WYDRUKIL.first()
   ||
      WYDRUKIL.blank();
      WYDRUKIL.USERS:=OPERATOR.USER().KOD;
      WYDRUKIL.WYDRUK:=_wydr_naz;
      WYDRUKIL.add()
   ?};

   PAR_WYDR.TITLE:='Zestawienie posesji kontrahenów wg miast'@
;~~}
{END:
    KH.cntx_pop();
    GRKH.cntx_pop();
    VAR_DEL.delete('PRN','k','w','s','tryb');
    &nrpos;
    &lp;
    &od_kh;
    &od_kod;
    &do_kh;
    &do_kod;
    &od_gr;
    &do_gr;
    &od_grk;
    &do_grk;
    &pref_miasto;
    &pref_rejon;
    &pref_ulica;
    &pref_kod;
    &ok;
    &spr_mia
;~~}
{INCLUDE: wsp_pw.rpi}
{INCLUDE: lum_umo_003.rpi}
{ {? tryb<>1 || PRN.add("form(w[1])",k[1],'Lp.'@,1) ?}; ~~}
{ PRN.add("form(w[2])",k[2],'Miasto'@); ~~}
{ PRN.add("form(w[3])",k[3],'Rejon'@); ~~}
{ PRN.add("form(w[4])",k[4],'Ulica'@); ~~}
{ PRN.add("form(w[5])",k[5],'Nr'@); ~~}
{ PRN.add("form(w[6])",k[6],'Kontrahent'@); ~~}
{
   WYDRUKIL.win_edit('UMO_003');
   {? WYDRUKIL.edit() || ok:=WYDRUKIL.put() ?}
;~~}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: tryb<>1}{SUBSTITUTE: 'FOOT'}{FI}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{<{lmt+1}}{'Parametry wydruku:'@}
{IF: WYDRUKIL.OD_STR<>''}{<{lmt+1}'Miasto - '@+WYDRUKIL.OD_STR}{FI}
{IF: SKID.ULICAPR<>''}{<{lmt+1}'Ulica - '@+SKID.ULICAPR}{FI}
{IF: SKID.REJONPR<>''}{<{lmt+1}'Rejon - '@+SKID.REJONPR}{FI}
{FONT: 'T8GB'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{
   pref_miasto := WYDRUKIL.OD_STR;
   pref_ulica := SKID.ULICAPR;
   pref_rejon := SKID.REJONPR
;~~}
{SUBSTITUTE:'druk'}
{FOOTER: 0}
{prn1:='PRN';~~}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}