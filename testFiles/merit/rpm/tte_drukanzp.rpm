:!UTF-8
{TITLE:Porównanie analiz zlecenia}
{PRINTER: INFO.W_PRN,,,,,'E','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
      PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   params_set(params_get());
   ANZH.cntx_psh();
   dalej:=0;
   PRN:=obj_new(@.CLASS.PRINT,5); PRN.s_frame();
   PRNNAG:=obj_new(@.CLASS.PRINT,6); PRNNAG.s_frame();
   prn1:='PRNNAG';
   color:='';
   lm:=ll:=vp:=lmt:=rsep:=0
}
{END:
   ANZH.cntx_pop();
   &dalej;
   obj_del(PRNNAG);
   obj_del(PRN);
   &prn1;
   &color;
   &lm; &ll; &vp; &lmt; &rsep
}
{COMMENT}
  [MK] - 2003/02/21 - [8.10]
  Wydruk porównania analiz zlecenia.
  Wywołanie: Zlecenia (produkcyjne, warsztatowe) -> Koszty -> Analiza -> Porównanie -> Z inną analizą -> Drukuj
{COMMENT-}
{COMMENT}---Definicja wiersza wydruku pozycji analizy zlecenia ANZP.{COMMENT-}
{  PRNNAG.add("nr",5,'Nr anal.'@,1);
   PRNNAG.add("dk",10,'Data kalkulacji'@,1);
   PRNNAG.add("akt",7,'Aktywna'@,1);
   PRNNAG.add("war",23,'Wariant analizy'@,1);
   PRNNAG.add("okr",13,'Okres'@,1);
   PRN.add("form(ANZP.RUBR().NR,,0,'9')",8,'Nr rubr.'@,1);
   PRN.add("ANZP.RUBR().OPIS",25,'Opis rubryki'@);
   PRN.add("form(ANZP.WAR,,2)",12,'Wartość'@,1);
   PRN.add("form(params_get().anzp.WARTOSC,,2)",12,'Wartość por.'@,1);
   PRN.add("form(ANZP.WAR-params_get().anzp.WARTOSC,,2)",12,'Różnica'@,1);
   PAR_WYDR.TITLE:='PORÓWNANIE ANALIZ ZLECENIA'@; ~~}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T10'}{SPACE: 'B'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{<{lmt+1} 'PARAMETRY WYDRUKU:'@}
{<{lmt+1} 'Zlecenie: %1'@[VAR.A_ANZH().ZLEC().SYM]}
{FONT: 'T10B'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T10'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T10B'}{SPACE: 'B'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T10'}{SPACE: 'B'}
{ rsep:=PAR_WYDR.RSEP; ~~}
{ rsep:=PAR_WYDR.RSEP; ~~}
{nr:=VAR.A_ANZH().NRA;
 dk:=form(VAR.A_ANZH().DT);
 akt:=VAR.A_ANZH().AKT;
 war:=VAR.A_ANZH().OPC().NA;
 okr:=VAR.A_ANZH().OKR().NAZ;~~}
{SUBSTITUTE: 'LINIA0'}
{nr:=VAR.A_PANZH().NRA;
 dk:=form(VAR.A_PANZH().DT);
 akt:=VAR.A_PANZH().AKT;
 war:=VAR.A_PANZH().OPC().NA;
 okr:=VAR.A_PANZH().OKR().NAZ;~~}
{SUBSTITUTE: 'LINIA0'}
{SUBSTITUTE: 'LINIAF'}

{ prn1:='PRN'; lmt:=int((charleft()-PRN.width())/2); ~~}
{FONT: 'T10B'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T10'}{ vp:=1; ~~}
{ ANZP.index('NRARUB'); ANZP.prefix(VAR.A_ANZH); ~~}
{IF: ANZP.first()}{ dalej:=1; ~~}{FI}
{WHILE: dalej}
{DO}
   {params_get().anzp.prefix(ANZP.RUBR().NR); params_get().anzp.first();~~}
   {SUBSTITUTE: 'LINIA0'}
   { dalej:=ANZP.next(); ~~}
{OD}
