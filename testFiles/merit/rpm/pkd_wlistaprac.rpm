:!UTF-8
{TITLE:Lista pracowników}
{PRINTER: exec('prt','param_wydr','v',KST),,,,,'Q','C',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
   VAR_DEL.delete('PRN','prn1','vp','lmt','rsep','h_rat','tresc','Lp','pb','upr');

   tresc:='pkd_wpraclis';
   PAR_WYDR.TITLE:='Lista pracowników'@;
   P.cntx_psh();
   upr:=_upr:=exec('uprawnieniawrap','pkd','danych osobowych'@,'ZWS_DOS_PPDO','ZWS_DOS_PRDO');
   {? +upr
   || FUN.emsg('Brak wymaganych uprawnień do przeglądania informacji o:%1'@[_upr])
   || PRN:=obj_new(@.CLASS.PRINT,6);
      {? ~rep_export() || PRN.add("Lp+=1",5,'Lp.'@,1,,,,,',,\'9.\'') ?};
      PRN.add("P.T",10,'Nr teczki'@);
      PRN.add("P.OSOBA().NAZWISKO",25,'Nazwisko'@);
      PRN.add("OSOBA.PIERWSZE",20,'Imię'@);
      PRN.add("P.WYDZIAL().SYMBOL",16,'Jednostka organizacyjna'@);
      PRN.add("P.ST().ST",35,'Stanowisko'@);
      PRN.s_frame();

      prn1:='PRN';
      Lp:=pb:=lmt:=rsep:=0;
      vp:=h_rat:=1;

      params_set('P',exec('wybierz_parses','pracownik','PKD').P)
   ?}
}
{END:
   P.cntx_pop();
   VAR_DEL.delete('PRN','prn1','vp','lmt','rsep','h_rat','tresc','Lp','pb','upr')
}
{COMMENT}OLD: wpraclis.rpm{COMMENT-}
{COMMENT}OLD: skid_pw.rpi{COMMENT-}
{EXIT: +upr}
{EXIT: ~params_get().P.first()}
{INCLUDE: wsp_pw.rpi}
{COMMENT}
══════════════════════════════════════════════════════════════════════════════

   K O N F I G U R A C J A   -   N A G Ł Ó W E K,   S T O P K A

{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{IF: ~pb}
{FONT: 'T8'}{ h_rat:=charleft(); ~~ }
{FONT: 'T8G'}{ h_rat:=charleft()/{? rep_export() || 1 || h_rat ?}; ~~ }
{SPACE: 'C'}
{LINE}
{ pb:=1; ~~ }
{FI}
{FONT: 'T8B'}
{SPACE: 'B'}
{LINE}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{FOOTER: 0}
{FONT: 'T8'}
{SPACE: 'B'}
{SUBSTITUTE: 'LINIAF'}
{FOOTER-}
{IF: ~rep_export()}
   {SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}
══════════════════════════════════════════════════════════════════════════════

   M A K R O D E F I N I C J E

{COMMENT-}
{MACRO: tresc}
{SUBSTITUTE: 'LINIA0'}
{MACRO-}
{COMMENT}
══════════════════════════════════════════════════════════════════════════════

   Z A W A R T O Ś Ć   W Y D R U K U

{COMMENT-}
{FONT: 'T8'}
{SPACE: 'B'}
{ lmt:=int((charleft()-PRN.width())/2); ~~ }
{FOR: params_get().P}{DO}
   {IF: P.seek(params_get().P.SQL,,1)}
      {SUBSTITUTE: tresc}
   {FI}
{OD}
