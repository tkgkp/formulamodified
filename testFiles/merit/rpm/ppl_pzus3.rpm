:!UTF-8
{TITLE:Zaświadczenie płatnika składek ZUS Z-3}
{PRINTER: exec('prt','param_wydr','v',KST),,,,,'Q','C',,,,,,1,5,5,5,5,0,1}
{BEGIN:
   P.cntx_psh();
   OSOBA.cntx_psh();
   H.cntx_psh(); H.index('_HISTKOD');
   N.cntx_psh(); N.index('NIEOBECN');
   NW.cntx_psh(); NW.index('CHP');
   O.cntx_psh(); O.index('LISTYPLA');
   LS.cntx_psh();
   R.cntx_psh();
   OS_ROR.cntx_psh(); OS_ROR.index('OS_ROR');
   PKO.cntx_psh(); PKO.index('_PKO');
   PREM_OKR.cntx_psh(); PREM_OKR.index('PREM_OKR');
   PREM_EXC.cntx_psh(); PREM_EXC.index('PREM_EXC');
   ZC.cntx_psh(); ZC.index('ZLECDAT');
   RH.cntx_psh(); RH.index('RACHUNKC');
   ZC_INFO.cntx_psh(); ZC_INFO.index('ZLECDAT');
   VAR_DEL.delete('__upr');
   __upr:=exec('uprawnieniawrap','pkd','Nieobecnościach'@,'PKD_EZK_OPNN','PKD_EZK_ORNN')+
          exec('uprawnieniawrap','pkd',
               'Naliczonych składnikach płacowych'@,
               'PPL_PLL_RSKP',
               'PPL_PLL_PSKP'
              );
   {? +__upr
   || FUN.emsg('Brak wymaganych uprawnień do przeglądania informacji o:%1'@ [__upr])
   || VAR_DEL.delete('par','suf','dst','dror','dprac','nb','kol','cil','tabpr','ndxpr','sta_pom','uz','skl',
         '__PMH','__PMD','__PKH','__PKD','__PRH','__PRD','__PXH','__PXD','l_sys','lpm','nd','znaki');
      VAR_DEL.delete('url_dni','url_godz','nn_dni','nn_godz','__sumLS','potr','__n_mac','__nbref','__dane_g',
         '__dane_r','__dane_i','__dane_p');
      VAR_DEL.delete('prn1','prn2','color','rsep','vp','ll','lmt','h_rat','tresc','wysun','dzas','zs','oz','dz');
      VAR_DEL.delete('__pzmnb','__Datmc','__ustMsc','__przyczyn','__typUrl','__przeb','__kwaltmp','__SumPod','__Przest',
         '__WykRUB');

      par:=obj_new(11);
      suf:=obj_new(2);
      znaki:=obj_new('Wszystkie','Pozostałe');
      nd:="'NIE DOTYCZY'";
      kol:=obj_new(9);
      sta_pom:=obj_new(4);
      'Liczba Pelnych Miesiecy (miedzy datami)';
      lpm:="{? _a>_b || _a==_b ?}; _d1:=date(_a~1,_a~2,0)+1; _d2:=date(_b~1,_b~2,1)-1; _d2~1*12+_d2~2-_d1~1*12-_d1~2+1";

      wysun:=0;
      tresc:='pzus3';
      h_rat:=lmt:=ll:=vp:=rsep:=0;
      color:='';
      prn1:=prn2:='';
      l_sys:="
         _sum:=0;
         {! _lp:=1.._
         |! _tab:=__RUB.sys_rub(_[_lp]);
            {? _tab.first()
            || {!
               |? LS.prefix(P.ref(),_tab.RN);
                  {? LS.first()
                  || {!
                     |? _sum+=LS.KW;
                        LS.next()
                     !}
                  ?};
                  _tab.next()
               !}
            ?};
            obj_del(_tab)
         !};
         _sum
      ";
      VAR_DEL.delete('url_dni','url_godz','nn_dni','nn_godz','__sumLS');
      url_dni:=url_godz:=nn_dni:=nn_godz:=0;  'ustalane w wynchor.fml\licz_nie';
      __sumLS:="_sum:=0;
         LS.prefix(P.ref,_a);
         {? LS.first
         || {! |? _sum+=LS.KW$2; LS.next !}
         ?}; _sum";
      potr:=obj_new(4);
      {! _ix:=1..obj_len(potr) |! potr[_ix]:=0 !};
      'ER/WRT/XP/12.41/1509/0028 zmiana w atrybucie 6522 i dodanie nowego 6523';
      __dane_r:="_atr:=__RUB.sys_sql(65221); _godz:=__RUB.sys_sql(6523); _atrM:=__RUB.sys_sql(65252);
      {? _atr<>'' & _godz<>'' || _atr+=(','+_godz) ?};{? _atr='' || _atr:='0' ?};{? _atrM='' || _atrM:='0' ?};
         sql('
            select
               /* +MASK_FILTER(SK_CHO,'+(1-_a-1)+')
                   INDEX(N,NIEOPRAC)
                   INDEX(SK_CHO,SK_CHO)
               */
               sum(SK_CHO.KW) as KW
            from
               @SK_CHO join
               N using(SK_CHO.NB,N.REFERENCE)
            where
               N.P='':_a''
               and
               SK_CHO.MC=to_date(:_b)
               and
               SK_CHO.SK_NR in (:_c)
               and
               SK_CHO.SK_NR not in (:_e)
               and
               SK_CHO.NB in (select REF from :_d)
         ',$P.ref(),date(skl.ROK,skl.MC,1),_atr,__nbref,_atrM
         )
      ";
      __dane_i:="_atr:=__RUB.sys_sql(65222); {? _atr='' || _atr:='0' ?};
         sql('
            select
               /* +MASK_FILTER(SK_CHO,'+(1-_a-1)+')
                   INDEX(N,NIEOPRAC)
                   INDEX(SK_CHO,SK_CHO)
               */
               sum(SK_CHO.KW) as KW,
               SK_CHO.LT as LT,
               SK_CHO.OD as OD,
               SK_CHO.DO as DO,
               SK_CHO.MC as MC
            from
               @SK_CHO join
               N using(SK_CHO.NB,N.REFERENCE)
            where
               N.P='':_a''
               and
               SK_CHO.SK_NR in (:_c)
               and
               SK_CHO.NB in (select REF from :_d)
               and
               SK_CHO.R='':_e''
            group by
            SK_CHO.LT,SK_CHO.OD,SK_CHO.DO,SK_CHO.MC
         ',$P.ref(),date(skl.ROK,skl.MC,1),_atr,__nbref,'P'
         )
      ";
      __dane_g:="_atr:=__RUB.sys_sql(6523); {? _atr='' || _atr:='0' ?};
         sql('
            select
               /* +MASK_FILTER(G,''godz'+form(skl.ROK-1,,,'9.')+''',''godz'+form(skl.ROK,,,'9.')+''',''godz'+form(skl.ROK+1,,,'9.')+''')
                   MASK_FILTER(R_GODZ,''rzg_'+form(skl.ROK-1,,,'9.')+''',''rzg_'+form(skl.ROK,,,'9.')+''',''rzg_'+form(skl.ROK+1,,,'9.')+''')
                   INDEX(G,CONTROL)
                   INDEX(R_GODZ,RZL_GODZ)
               */
               sum(R_GODZ.KW) as KW
            from
               @R_GODZ join
               R using(R_GODZ.RN,R.REFERENCE) join
               @G using(R_GODZ.G,G.REFERENCE)
            where
               G.P='':_a''
               and
               G.D between to_date(:_b) and to_date(:_c)
               and
               R.RN in (:_d)
         ',$P.ref(),date(skl.ROK,skl.MC,1),date(skl.ROK,skl.MC,0),_atr
         )
      ";
      __ustMsc:="__pzmnb:=0;
                  _przep3mc:=0;
                  dprac.DSTART:=
                     {? dprac.DDATA & lpm(dprac.ZLDO,dprac.DATA)<3
                     || _przep3mc:=1;
                        {? dprac.ZLOD<dprac.PDZA || __pzmnb:=1; _nm:=dprac.ZLOD+1; date(_nm~1,_nm~2,0) || dprac.ZLOD ?}
                     || dprac.ODO
                     ?};
                  dprac.DSTOP:=date(dprac.DSTART~1,dprac.DSTART~2-12,0)+1;
                  {? dprac.DSTOP<dprac.PDZA || dprac.DSTOP:=dprac.PDZA ?};
                  {? dprac.DSTOP<dprac.WYOD || dprac.DSTOP:=dprac.WYOD ?};
                  {? _przep3mc & dprac.DSTOP>dprac.DSTART || dprac.DSTOP:=date(dprac.DSTART~1,dprac.DSTART~2,0)+1 ?};
                  'Podstawa z miesiaca nieobecnosci';
                  {? dprac.DSTOP-dprac.DSTART=1 | 6+dprac.DSTART$0=6+dprac.DSTOP$0
                  || __pzmnb:=1;
                     {? dprac.DSTOP>dprac.DSTART || dprac.DSTART:=date(dprac.DSTOP~1,dprac.DSTOP~2,0) ?};
                     dprac.DSTOP:=date(dprac.DSTART~1,dprac.DSTART~2,1)
                  ?}";
      __przyczyn:="{? __RUB.sys_attr(_a,1321) || 'NN'
                  |? __RUB.sys_attr(_a,1311) || 'N. uspr. pł.'
                  |? __RUB.sys_attr(_a,1322) || 'N. uspr. bezpł.'
                  |? __RUB.sys_attr(_a,124) || 'N. uspr. bezpł.'
                  |? __RUB.sys_attr(_a,112) || 'Url. bezpł.'
                  |? __RUB.sys_attr(_a,114) || 'Url. wych.'
                  |? __RUB.sys_attr(_a,115) || 'Url. macierz.'
                  |? __RUB.sys_attr(_a,121) || 'Choroba'
                  |? __RUB.sys_attr(_a,1221) || 'Choroba'
                  |? __RUB.sys_attr(_a,1222) || 'Świad. Rehab.'
                  |? __RUB.sys_attr(_a,1225) || 'Opieka'
                  |? __RUB.sys_attr(_a,136) || 'Sł. wojsk.'
                  || ''
                  ?}";
      __kwaltmp:="{? ((_a=P.DZA & _a~3<>1) | (dprac.WYOD~3<>1 & _a<dprac.WYOD)) &
                    date(_a~1,_a~2,1)<date(_b~1,_b~2,1)
                 || _mc:=_a~2+1; {? _mc=13 || _mc:=1; _rok:=_a~1+1 || _rok:=_a~1 ?};
                    date(_rok,_mc,1)=date(skl.ROK,skl.MC,1)
                 || _a=date(skl.ROK,skl.MC,1)
                 ?}";
      _args:=exec('wybierz_args','pracownik');
      _args.DOMAIN:='PPL';
      _args.UD_SCH:=exec('domyslny','schemat','PODZORG');
      _args.UD_SKL:=__PARSES.getVal('JednostkaOrganizacyjna').REF;
      _args.F_ZATR:=__PARSES.getVal('F_ZATR').KOD;
      _args.VIEW:='W';
      _args.SQL_WHERE:='P.DZ is not null';
      params_set('P',exec('wybierz','pracownik',_args).P)
   ?};
   __pzmnb:=0; __Datmc:=date(0,0,0); __SumPod:=0;
   __Przest:="_od:=_a;
             {? var_pres('_T_N')>100 || obj_del(_T_N) ?};
             {? var_pres('_tab_T_N')>100 || obj_del(_tab_T_N) ?};
             _tab_T_N:=obj_new(2);
             _tab_T_N[1]:=1314;
             _tab_T_N[2]:=1318;
             _T_N:=exec('potr_mc_lista','nieobecnosc',_tab_T_N,_od~1,_od~2);
             obj_del(_tab_T_N); &_tab_T_N;
             {? _T_N.POTR2 | _T_N.POTR3
             || _f_b_s:='';
                _dodatki:=__RUB.sys_rub(34,_a);
                _nominal:=__RUB.sys_rub(454,_a);
                {? _dodatki.first()
                || {!
                   |? {? _nominal.find_key(_dodatki.RN)
                      || _dodatki.next
                      || _dodatki.del(,1)=2
                      ?}
                   !}
                ?};
                {? _dodatki.first()
                || {? _dodatki.find_key(__RUB.sys_rub(45411,_a).RN)
                   || _f_b_s+='F'
                   ?};
                   {? _dodatki.find_key(__RUB.sys_rub(45412,_a).RN)
                   || _f_b_s+='B'
                   ?};
                   {? _dodatki.find_key(__RUB.sys_rub(45421,_a).RN)
                   || _f_b_s+='S'
                   ?}
                ?};
                {? _T_N.POTR3 & ~(_f_b_s*'S') || _T_N.POTR3-=_T_N.POTR13 ?};
                obj_del(_dodatki);
                obj_del(_nominal)
             || _f_b_s:=''
             ?};
             {? -(1+H.CP().S)='u'
             || {? _T_N.POTR2 & ~(_f_b_s*'F') || _T_N.POTR2-=_T_N.POTR12 ?}
             || {? _T_N.POTR2 & ~(_f_b_s*'B') || _T_N.POTR2-=_T_N.POTR12 ?}
             ?};
             skl.S:=(sta_pom[1]-potr[1]-_T_N.POTR1)$2*{? -(1+H.CP().S)='u' || 1 || 0 ?};
             {! _lp:=2..3 |! skl.S+=(sta_pom[_lp]-potr[_lp]-{? _lp=2 || _T_N.POTR2 || _T_N.POTR3 ?})$2 !}"
}
{END:
   ZC_INFO.cntx_pop();
   RH.cntx_pop();
   ZC.cntx_pop();
   PREM_EXC.cntx_pop();
   PREM_OKR.cntx_pop();
   PKO.cntx_pop();
   OS_ROR.cntx_pop();
   R.cntx_pop();
   LS.cntx_pop();
   O.cntx_pop();
   NW.cntx_pop();
   N.cntx_pop();
   H.cntx_pop();
   OSOBA.cntx_pop();
   P.cntx_pop();
   {? O.ref || exec('czytaj','#stalesys',date(O.RU,O.MU,1),KST,'PRFC','WSODBR') ?};
   VAR_DEL.delete('par','suf','dst','dror','dprac','nb','kol','cil','tabpr','ndxpr','sta_pom','uz','skl',
      '__PMH','__PMD','__PKH','__PKD','__PRH','__PRD','__PXH','__PXD','l_sys','lpm','nd','znaki');
   VAR_DEL.delete('url_dni','url_godz','nn_dni','nn_godz','__sumLS','potr','__n_mac','__nbref','__dane_g','__dane_r');
   VAR_DEL.delete('prn1','prn2','color','rsep','vp','ll','lmt','h_rat','tresc','wysun','dzas','zs','oz','dz','__upr');
   VAR_DEL.delete('__pzmnb','__Datmc','__dane_i','__dane_p','__ustMsc','__przyczyn','__typUrl','__przeb','pownie');
   VAR_DEL.delete('__kwaltmp','__SumPod','__Przest','__WykRUB');
   ~~
}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{COMMENT}OLD: pzus3.rpm{COMMENT-}
{COMMENT}OLD: std_info.rpi{COMMENT-}
{COMMENT}OLD: skid_pw.rpi{COMMENT-}
{EXIT: +__upr}
{EXIT: ~params_get().P.first()}
{INCLUDE: wsp_pw.rpi}
{DEFINEFONT: 'T8u='+PAR_WYDR.FONTTAB+',100,P,8'}{COMMENT} Wymagane {SPACE: 'B'} {COMMENT-}
{DEFINEFONT: 'T8BI='+PAR_WYDR.FONTTAB+',100,K,8'}{COMMENT} Wymagane {SPACE: 'B'} {COMMENT-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{EXIT:
   {? __RUB.sys_rub(6521).first() | __RUB.sys_rub(6522).first() | __RUB.sys_rub(6523).first() |
      __RUB.sys_rub(6525).first()
   || 0
   || FUN.ask(
         'Brak atrybutów dotyczących zmiennego wynagrodzenia miesięcznego brutto.'@+'\n'+
         'Czy na pewno chcesz kontynuować?'@)=0
   ?}
}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{ __WykRUB:="_kw_url:=0; _licz_f:=_a; _urlopwy:=_b;
     {? (_licz_f=1 | _licz_f=2) & _urlopwy.first()
     || {!
        |? {? LICZ.RUB_CHO.find_key(_urlopwy.RN)
           || _chrn:=LICZ.RUB_CHO.RN;
             {? ~__RUB.sys_attr(_chrn,4211) & ~__RUB.sys_attr(_chrn,422) & ~__RUB.sys_attr(_chrn,424) &
                ~__RUB.sys_attr(_chrn,425) & ~__RUB.sys_attr(_chrn,427)
            || _kw_url+=__sumLS(_chrn)
            ?}
         ?};
         _urlopwy.next()
       !}
     ?};
     _kw_url";
~~}
{
   dst:=tab_tmp(1,
      'LUCH','INTEGER','Liczba ubezpieczonych',
      'DP','INTEGER','Drukuj pouczenie i uwagę końcową',
      'DW','INTEGER','Drukuj wyjasnienie'
   );
   dst.blank();
   dst.DP:=dst.DW:=1;

   dst.fld_fml('DP','AFTER_EDIT',"dst.DW:={? fld() || 1 || -1 ?}; 1");

   dst.fld_fml('DW','BEFORE_DISPLAY',"dst.DP");
   dst.fld_fml('DW','BEFORE_EDIT',"dst.DP");


   dror:=tab_tmp(2,
      'N','STRING[50]','Numer rachunku'@,
      'B','STRING[80]','Nazwa oddziału'@
   );

   _ws:=dror.mk_sel('Rachunki bankowe'@,'N',,'#zus_z3ror',,,5);
   dror.win_fld(_ws,,'N');
   dror.win_fld(_ws,,'B',,,50);
   dror.win_act(_ws,,'Formuła','Wybierz'@@,,,"sel_exit()",,1,,,,'W');
   dror.win_act(_ws,,'Szukaj');
   dror.win_sel(_ws);

   dzas:=tab_tmp(,'ZAS','STRING[50]','Rodzaj zasiłku'@,'KOD','STRING[1]','Kod');
   dzas.KOD:='C'; dzas.ZAS:='Zasiłek chorobowy'; dzas.add();
   dzas.KOD:='O'; dzas.ZAS:='Zasiłek opiekuńczy'; dzas.add();
   dzas.KOD:='M'; dzas.ZAS:='Zasiłek macierzyński'; dzas.add();
   dzas.KOD:='R'; dzas.ZAS:='Zasiłek w wysokości zasiłu macierzyńskiego'; dzas.add();
   dzas.KOD:='W'; dzas.ZAS:='Zasiłek wyrównawczy'; dzas.add();
   dzas.KOD:='S'; dzas.ZAS:='Świadczenie rehabilitacyjne'; dzas.add();
   _wer:=dzas.mk_sel('Wnioskowany zasiłek');
   dzas.win_fld(_wer,,'ZAS',,,50,,1,'Rodzaj zasiłku'@);
   dzas.win_act(_wer,,'Formuła','Wybierz'@@,,,"sel_exit()",,1,,,,'W');
   dzas.win_sel(_wer);

   pownie:=tab_tmp(,'POWNIE','STRING[50]','Rodzaj zasiłku'@,'KOD','STRING[1]','Kod');
   pownie.KOD:='C'; pownie.POWNIE:='Choroba zawodowa'; pownie.add();
   pownie.KOD:='W'; pownie.POWNIE:='Wypadek przy pracy'; pownie.add();
   pownie.KOD:='P'; pownie.POWNIE:='Wypadek w drodze do lub z pracy'; pownie.add();
   _wer:=pownie.mk_sel('Powód niezdolności');
   pownie.win_fld(_wer,,'POWNIE',,,50,,1,'Powód niezdolności'@);
   pownie.win_act(_wer,,'Formuła','Wybierz'@@,,,"sel_exit()",,1,,,,'W');
   pownie.win_sel(_wer);
   zs:=obj_new('C','O','M','R','W','S');
   {! _ii:=1..obj_len(zs) |! zs[_ii]:=' ' !};
   oz:=obj_new(8);
   dz:=obj_new(8);
   {! _ii:=1..8 |! oz[_ii]:=dz[_ii]:=' ' !};

   dprac:=tab_tmp(1,
      'PDZA','DATE','Data "początkowa" zatrudnienia',
      'OOD','DATE','Okres - od',
      'ODO','DATE','Kores - do',
      'DSTART','DATE','Początek obliczeń',
      'DSTOP','DATE','Koniec obliczeń',
      'WYMIAR','STRING[7]','Wymiar',
      'LWYOD','DATE','Wymiar - od ostatnia zmiana',
      'WYOD','DATE','Wymiar - od',
      'ZLOD','DATE','Początek choroby pierwotnej',
      'ZLDO','DATE','Koniec ostatniego zwolnienia',
      'DDATA','INTEGER','Data dostępna do redakcji?',
      'ADR','STRING[1]','Który uwzględnić adres pracownika?',
      'DATA','DATE','Zwolnienie od',
      'DZLA','INTEGER','Dostępne ZLA?',
      'PROT','STRING[41]','Nr protokołu ',
      'DZDARZ','DATE','Data zdarzenia',
      'ZLASN','STRING[41]','Załączone zaświadczenie lekarskie (seria, numer)',
      'ZLADD','DATE','Data dostarczenia zwolnienia',
      'UWAGI','SYS_MEMO','Uwagi',
      'ROR','STRING[36]','Numer rachunku bankowego pracownika',
      'OSOBA','STRING[78]','Osoba',
      'RZAS','STRING[50]','Rodzaj wnioskowanego zasiłku',
      'KZAS','STRING[1]','Kod wnioskowanego zasiłku',
      'WOD','DATE','Okres wniosku od',
      'WDO','DATE','Okres wniosku do',
      'CZY_TMP','STRING[1]','Praca tymczasowa',
      'CZY_OUT','STRING[1]','Praca za granicą',
      'EZLA','STRING[1]','Czy wpłynęło w postaci e-ZLA',
      'POWNIE','STRING[50]','Powód powstania niezdolności',
      'KPOWNIE','STRING[1]','Kod powstania niezdolności',
      'UZ','SYS_MEMO','Umowy zlecenia',
      'EDMC','INTEGER','Edycja wyliczonych składników za okresy miesięczne'
   );

   dprac.fld_fml('DATA','BEFORE_DISPLAY',"dprac.DDATA");
   dprac.fld_fml('DATA','BEFORE_EDIT',"dprac.DDATA");

   dprac.fld_fml('ZLASN','BEFORE_DISPLAY');
   dprac.fld_fml('ZLASN','BEFORE_EDIT');
   dprac.fld_fml('ZLADD','BEFORE_DISPLAY');
   dprac.fld_fml('ZLADD','BEFORE_EDIT');
   dprac.fld_fml('PROT','BEFORE_DISPLAY',"+dprac.POWNIE");
   dprac.fld_fml('PROT','BEFORE_EDIT',"+dprac.POWNIE");
   dprac.fld_fml('DZDARZ','BEFORE_DISPLAY',"+dprac.POWNIE");
   dprac.fld_fml('DZDARZ','BEFORE_EDIT',"+dprac.POWNIE");
   dprac.fld_fml('WOD','BEFORE_EDIT',"+dprac.RZAS");
   dprac.fld_fml('WOD','AFTER_EDIT',
      "  {? dprac.WOD=#0 || dprac.WDO:=date(0,0,0) ?};
         {? +dprac.RZAS & (dprac.WOD<>#0 | 'C#O'*dprac.KZAS=0)
         || 1
         || FUN.emsg('Wymagane uzupełnienie pola \"%1\".'@ ['Data od'@])
         ?}
      "
   );
   dprac.fld_fml('WDO','BEFORE_EDIT',"dprac.WOD<>#0");
   dprac.fld_fml('WDO','AFTER_EDIT',
   "  {? +dprac.RZAS & (dprac.WDO<>#0 | 'C#O'*dprac.KZAS=0)
      || 1
      || FUN.emsg('Wymagane uzupełnienie pola \"%1\".'@ ['Data do'@])
      ?}
   "
   );

   dprac.fld_fml('ROR','F3',"{? dror.select() || dror.N ?}");
   dprac.fld_fml('ROR','AFTER_EDIT',"{? dprac.ROR='' || 1 || exec('iban_ok','#id',dprac.ROR) ?}");
   dprac.fld_fml('RZAS','F3',"{? dzas.select() || dprac.KZAS:=dzas.KOD; dprac.RZAS:=dzas.ZAS ?}");
   dprac.fld_fml('RZAS','AFTER_EDIT',
      "  {? ~dzas.find_key(dprac.RZAS,)
         || {? +dprac.RZAS
            || {? dzas.select()
               || dprac.KZAS:=dzas.KOD; dprac.RZAS:=dzas.ZAS
               || dprac.KZAS:=dprac.RZAS:=''
               ?}
            || dprac.KZAS:=dprac.RZAS:='';
               dprac.WOD:=dprac.WDO:=date(0,0,0)
            ?}
         ?}; 1
      "
   );
   dprac.fld_fml('POWNIE','F3',"{? pownie.select() || dprac.KPOWNIE:=pownie.KOD; dprac.POWNIE:=pownie.POWNIE ?}");
   dprac.fld_fml('POWNIE','AFTER_EDIT',
      "  {? ~pownie.find_key(dprac.POWNIE,)
         || {? +dprac.POWNIE
            || {? pownie.select()
               || dprac.KPOWNIE:=pownie.KOD; dprac.POWNIE:=pownie.POWNIE
               || dprac.KPOWNIE:=dprac.POWNIE:=''
               ?}
            || dprac.KPOWNIE:=dprac.POWNIE:=''
            ?}
         ?}; 1
      "
   );
   _we:=dprac.mk_edit('Zaświadczenie ZUS Z-3',,'#zus_z3dprac',,,'html_maximized');
   dprac.win_efld(_we,AH,'H',,,,,,     'Dane osoby ubezpieczonej'@);
   dprac.win_efld(_we,,'OSOBA',,,78,,1,'Osoba'@);
   dprac.win_efld(_we,,'ADR',,,,,,'Który adres pracownika uwzględnić w oświadczeniu?'@,,,
      'radio-buttons',,
      'Stały'@,"'S'",
      'Zamieszkania'@,"'C'",
      'Korespondencji'@,"'K'"
   );
   dprac.win_efld(_we,,'CZY_TMP',,,3,,,'Jest zatrudniony na podstawie umowy o pracę tymczasową'@,,,
      'check-box',,"'T'","'N'"
   );
   dprac.win_efld(_we,,'CZY_OUT',,,3,,,'Wykonuje pracę za granicą'@,,,
      'check-box',,"'T'","'N'"
   );
   dprac.win_efld(_we,,'DATA',,,,,,,,  'Data zwolnienia, w związku z którym jest wystawiane oświadczenie Z-3'@);
   dprac.win_efld(_we,AH,'H',,,,,,     'Pracownik występuje o:'@);
   dprac.win_efld(_we,,'RZAS',,,78,,,  'Rodzaj wnioskowanego zasiłku'@);
   dprac.win_efld(_we,,'WOD',,,11,,,   'Data od'@);
   dprac.win_efld(_we,,'WDO',,,11,,,   'Data do'@);
   dprac.win_efld(_we,AH,'H',,,,,,     'Informacje o zaświadczeniach lekarskich'@);
   dprac.win_efld(_we,,'EZLA',,,3,,,   'Czy wpłynęło w postaci e-ZLA'@,,,'check-box',,"'T'","'N'");
   dprac.win_efld(_we,,'ZLASN',,,41,,, 'Załączone zaświadczenie lekarskie (seria, numer)'@);
   dprac.win_efld(_we,,'ZLADD',,,,,,   'wpłynęło do płatnika składek'@);
   dprac.win_efld(_we,AH,'H',,,,,,     'Informacje o pracowniku'@);
   dprac.win_efld(_we,,'POWNIE',,,78,,,'Powód powstania niezdolności'@);
   dprac.win_efld(_we,,'PROT',,,20,,,  'nr protokołu'@);
   dprac.win_efld(_we,,'DZDARZ',,,,,,  'data zdarzenia'@);
   dprac.win_efld(_we,AH,'H',,,,,,     'Pozostałe informacje'@);
   dprac.win_efld(_we,dst,'LUCH',,,8,,,'Liczba ubezpieczonych'@,,
      'Liczba ubezpieczonych zgłaszanych przez płatnika do ubezpieczenia chorobowego'@);
   dprac.win_efld(_we,AH,'H',,,,,,     'Informacje o składnikach wynagrodzenia'@);
   dprac.win_efld(_we,,'UZ',,,78,-4,,  'Umowa zlecenia, o dzieło lub inna, składniki terminowe'@);
   dprac.win_efld(_we,,'UWAGI',,,78,-2,,'Uwagi'@);
   dprac.win_efld(_we,,'ROR',,,36,,,   'Numer rachunku bankowego pracownika'@,,
      'Podać w przypadku, gdy pracownik wyraził wolę otrzymywania zasiłku na rachunek bankowy'@);
   dprac.win_efld(_we,dst,'DP',,,,,,   'Pouczenie i uwagę końcową'@,,,'check-box',,"1","0");
   dprac.win_efld(_we,dst,'DW',,,,,,   'Wyjaśnienia'@,,,'check-box',,"1","0");
   dprac.win_efld(_we,,'EDMC',,,,,,    'Edycja wyliczonych składników za okresy miesięczne'@,,,'check-box',,"1","0");

   dprac.win_ebtn(_we,'text=&OK, btn_label_align=center, panel=bottom, align=end',"'key:F2'");
   dprac.win_ebtn(_we,'text=&Anuluj, btn_label_align=center, panel=bottom, align=end',"'key:Esc'");
   dprac.win_edit(_we);
   ~~}{
   nb:=tab_tmp(5,
      'P','INTEGER','Punkt',
      'OD','DATE','Od',
      'DO','DATE','DO',
      'KOD','STRING[3]','Kod',
      'TYP','STRING[30]','Typ',
      'PR','REAL','Procent'
   );
   __nbref:=tab_tmp(1,'REF','STRING[16]','Ref N');

   __n_mac:=tab_tmp(3,
         'OD','DATE','Od',
         'DO','DATE','Do',
         'TYP','STRING[40]','Typ',
         'DAT_WNIO','DATE','Data wniosku'
   );
   _win:=__n_mac.mk_sel('Pkt. 6  Urlopy macierzyńskie (weryfikacja daty wniosku)'@,,0,'2015101011430');
   __n_mac.win_fld(_win,,'OD',,,10,,1,'Data od'@);
   __n_mac.win_fld(_win,,'DO',,,10,,1,'Data do'@);
   __n_mac.win_fld(_win,,'TYP',,,30,,1,'Rodzaj urlopu'@);
   __n_mac.win_fld(_win,,'DAT_WNIO',,,10,,0,'Data wniosku'@);
   __n_mac.win_act(_win,,'Popraw',,,,,,1);
   __n_mac.win_act(_win,,'Formuła','Dalej'@@,,,"sel_exit()",,,,,,'D');
   __n_mac.win_btn(_win,'text='+'&Dalej'@+',icon=xwin16.png:22,btn_label_align=right,panel=right,align=begin','menu:D');
   __n_mac.win_sel(_win);

   cil:=obj_new('TITLE','T8','T8B','T8G','T10B');

   tabpr:=tab_tmp(3,
      'R','INTEGER','Rok',
      'M','INTEGER','Miesiąc',
      'LT','STRING[8]','Znak listy',
      'PR','REAL','Procent składki potrąconej'
   );
   ndxpr:=obj_new('RM','LT');
   ndxpr.RM:=tabpr.index('?');
   ndxpr.LT:=tabpr.ndx_tmp(,,'LT',,);

   uz:=tab_tmp(4,
      'UOD','DATE','Umowa - od',
      'UDO','DATE','Umowa - do',
      'R','INTEGER','Rok',
      'M','INTEGER','M-c',
      'LP','INTEGER','Lp.',
      'KW','REAL','Kwota'
   ); ~~
}
{  skl:=tab_tmp(6,
      'TYP','STRING[1]','M/K/X',
      'EMPTY','INTEGER','Puste?',
      'ROK','INTEGER','Rok',
      'MC','INTEGER','M-c',
      'KWARTAL','INTEGER','Kwartał',
      'OKRES','STRING[23]','rrrr/mm - rrrr/mm',
      'NOM','INTEGER','Dni nominalne',
      'DP','INTEGER','Dni przepracowane',
      'DR','INTEGER','Dni do przepracowania',
      'PRZYCZ','STRING[60]','Przyczyna',
      'S','REAL','Stałe wynagrodzenie zasadnicze',
      'Z1','REAL','Zmienne zasadnicze',
      'Z2','REAL','Zmienne: premie i inne',
      'PR','REAL','% składki',
      'DNI','STRING[1]','Czy pokazać dni?'
   );
   _we:=skl.mk_edit('Składniki wynagrodzenia'@,,'zus_z3_sklm');
   skl.win_efld(_we,,'ROK',,,5,,,'Rok'@);
   skl.win_efld(_we,,'MC',,,3,,,'Miesiąc'@);
   skl.win_efld(_we,AH,'H',,,,,1,'Dni, które pracownik:'@);
   skl.win_efld(_we,,'DP',,,3,,,'   - przepracował'@,,'Dni, które pracownik przepracował'@);
   skl.win_efld(_we,,'DR',,,3,,,'   - był obowiązany przepracować'@,,
      'Dni, które pracownik był obowiązany przepracować'@);
   skl.win_efld(_we,,'PRZYCZ',,,60,,,'Przyczyna nieprzepracowania'@,,'Przyczyna nieprzepracowania całego miesiąca'@);
   skl.win_efld(_we,,'S',,,14,2,,'Stałe wynagrodzenie zasadnicze'@,,
      'Stałe wynagrodzenie zasadnicze i inne składniki stałe w pełnej miesięcznej wysokości '@+
      'określonej w umowie o pracę brutto'@);
   skl.win_efld(_we,AH,'H',,,,,1,'Zmienne wynagrodzenie'@);
   skl.win_efld(_we,,'Z1',,,14,2,,'   - pomniejszone proporcjonalnie'@,,
      'Wynagrodzenie zasadnicze i inne składniki pomniejszone proporcjonalnie'@);
   skl.win_efld(_we,,'Z2',,,14,2,,'   - przyjmowane w kwocie faktycznej'@,,
      'Premie i inne składniki przyjmowane w kwocie faktycznej'@);
   skl.win_efld(_we,,'PR',,,14,2,,'Procent składki potrąconej'@);
   skl.win_ebtn(_we,'text=&OK, btn_label_align=center, panel=bottom, align=end',"'key:F2'");
   skl.win_ebtn(_we,'text=&Anuluj, btn_label_align=center, panel=bottom, align=end',"'key:Esc'");
   skl.win_edit(_we);
   ~~
}
{

   __PMD:=obj_new(@.CLASS.PRINT,9);
   __PMD.add("{? ~skl.EMPTY || skl.ROK || %255 ?}",4,'Rok',1,,,,,',0,\'9.\'');
   __PMD.add("{? ~skl.EMPTY || skl.MC || '' ?}",2,'Mc',1,,,,,',0,\'9.\'');
   __PMD.add("{? ~skl.EMPTY || skl.DP || '' ?}",5,'prze- pra- cował',1,,,,,',0,\'9.\'');
   __PMD.add("{? ~skl.EMPTY || skl.DR || '' ?}",8,'był obowią- zany przepra- cować',1,,,,,',0,\'9.\'');
   __PMD.add("{? ~skl.EMPTY || skl.PRZYCZ || '' ?}",30,'Przyczyna nieprzepracowania całego miesiąca');
   __PMD.add("{? ~skl.EMPTY || skl.S || '' ?}",19,
      'składniki stałe w pełnej miesięcznej wysokości określo- nej w umowie o pracę brutto',
      1,,,,,',2,\'9.\'');
   __PMD.add("{? ~skl.EMPTY || skl.Z1 || '' ?}",15,
      'wynagrodzenie zasadnicze i inne składniki pomniejszone proporcjonalnie',1,,,,,',2,\'9.\'');
   __PMD.add("{? ~skl.EMPTY || skl.Z2 || '' ?}",15,
      'premie i inne składniki przyjmowane w kwocie faktycznej',1,,,,,',2,\'9.\'');
   __PMD.add("{? ~skl.EMPTY || skl.PR || '' ?}",7,'Procent potrą- conej składki',1,,,,,',2,\'9.\'');
   __PMD.s_frame();

   __PMH:=obj_new(@.CLASS.PRINT,7);
   __PMH.add("''",__PMD.LEN[1],'');
   __PMH.add("''",__PMD.LEN[2],'');
   __PMH.add("''",__PMD.LEN[3]+3+__PMD.LEN[4],'Liczba dni, które pracownik:');
   __PMH.add("''",__PMD.LEN[5],'');
   __PMH.add("''",__PMD.LEN[6],'Stałe wynagrodzenie zasadnicze i inne');
   __PMH.add("''",__PMD.LEN[7]+3+__PMD.LEN[8],'Zmienne wynagrodzenie   ^miesięczne brutto',,'^');
   __PMH.add("''",__PMD.LEN[9],'');
   __PMH.s_frame();

   __PKD:=obj_new(@.CLASS.PRINT,7);
   __PKD.add("{? ~skl.EMPTY || skl.ROK || %255 ?}",4,'Rok',1,,,,,',0,\'9.\'');
   __PKD.add("{? ~skl.EMPTY || skl.KWARTAL || '' ?}",7,'Kwartał',1,,,,,',0,\'9.\'');
   __PKD.add("{? ~skl.EMPTY || skl.S || '' ?}",20,'Kwota',1,,,,,',2,\'9.\'');
   __PKD.add("{? ~skl.EMPTY & skl.DNI='T' || skl.DP || '' ?}",15,'przepracował',1,,,,,',0,\'9.\'');
   __PKD.add("{? ~skl.EMPTY & skl.DNI='T' || skl.DR || '' ?}",15,'był obowiązany przepracować',1,,,,,',0,\'9.\'');
   __PKD.add("{? ~skl.EMPTY & skl.DNI='T' || skl.PRZYCZ || '' ?}",35,'nieprzepracowania całego kwartału');
   __PKD.add("{? ~skl.EMPTY || skl.PR || '' ?}",15,'potrąconej składki',1,,,,,',2,\'9.\'');
   __PKD.s_frame();

   __PKH:=obj_new(@.CLASS.PRINT,6);
   __PKH.add("''",__PKD.LEN[1],'');
   __PKH.add("''",__PKD.LEN[2],'');
   __PKH.add("''",__PKD.LEN[3],'');
   __PKH.add("''",__PKD.LEN[4]+3+__PKD.LEN[5],'Liczba dni, które pracownik:');
   __PKH.add("''",__PKD.LEN[6],'Przyczyna');
   __PKH.add("''",__PKD.LEN[7],'Procent');
   __PKH.s_frame();

   __PRD:=obj_new(@.CLASS.PRINT,6);
   __PRD.add("{? ~skl.EMPTY || skl.ROK || %255 ?}",4,'Rok',1,,,,,',0,\'9.\'');
   __PRD.add("{? ~skl.EMPTY || skl.S || '' ?}",22,'Kwota',1,,,,,',2,\'9.\'');
   __PRD.add("{? ~skl.EMPTY & skl.DNI='T' || skl.DP || '' ?}",17,'przepracował',1,,,,,',0,\'9.\'');
   __PRD.add("{? ~skl.EMPTY & skl.DNI='T' || skl.DR || '' ?}",17,'był obowiązany przepracować',1,,,,,',0,\'9.\'');
   __PRD.add("{? ~skl.EMPTY & skl.DNI='T' || skl.PRZYCZ || '' ?}",36,'nieprzepracowania całego roku');
   __PRD.add("{? ~skl.EMPTY || skl.PR || '' ?}",18,'potrąconej składki',1,,,,,',2,\'9.\'');
   __PRD.s_frame();

   __PRH:=obj_new(@.CLASS.PRINT,5);
   __PRH.add("''",__PRD.LEN[1],'');
   __PRH.add("''",__PRD.LEN[2],'');
   __PRH.add("''",__PRD.LEN[3]+3+__PRD.LEN[4],'Liczba dni, które pracownik:');
   __PRH.add("''",__PRD.LEN[5],'Przyczyna');
   __PRH.add("''",__PRD.LEN[6],'Procent');
   __PRH.s_frame();

   __PXD:=obj_new(@.CLASS.PRINT,6);
   __PXD.add("{? ~skl.EMPTY || skl.OKRES || %255 ?}",23,'Okres',1,,,,,',0,\'9.\'');
   __PXD.add("{? ~skl.EMPTY || skl.S || '' ?}",19,'Kwota',1,,,,,',2,\'9.\'');
   __PXD.add("{? ~skl.EMPTY & skl.DNI='T' || skl.DP || '' ?}",14,'przepracował',1,,,,,',0,\'9.\'');
   __PXD.add("{? ~skl.EMPTY & skl.DNI='T' || skl.DR || '' ?}",14,'był obowiązany przepracować',1,,,,,',0,\'9.\'');
   __PXD.add("{? ~skl.EMPTY  & skl.DNI='T'|| skl.PRZYCZ || '' ?}",34,'nieprzepracowania danego okresu');
   __PXD.add("{? ~skl.EMPTY || skl.PR || '' ?}",10,'potrąconej składki',1,,,,,',2,\'9.\'');
   __PXD.s_frame();

   __PXH:=obj_new(@.CLASS.PRINT,5);
   __PXH.add("''",__PXD.LEN[1],'');
   __PXH.add("''",__PXD.LEN[2],'');
   __PXH.add("''",__PXD.LEN[3]+3+__PXD.LEN[4],'Liczba dni, które pracownik:');
   __PXH.add("''",__PXD.LEN[5],'Przyczyna');
   __PXH.add("''",__PXD.LEN[6],'Procent');
   __PXH.s_frame();

   _sql:=
      'select P.OSOBA '
      'from P '
      'where P.FIRMA=:_b and P.F_ZATR=\''+__F_ZATR.REF+'\' and '
      'P.DZA<=to_date(:_a) and (P.DZ is null or to_date(:_a)<=P.DZ) '
      'union distinct '
      'select ZC_INFO.OSOBA '
      'from ZC_INFO '
      'where ZC_INFO.FIRMA=:_b and '
      'ZC_INFO.DU<=to_date(:_a) and to_date(:_a)<=ZC_INFO.DW and ZC_INFO.FC=\'T\'';

   _dk:=date((date()~1)-1,11,0);
   _tab:=sql(_sql,_dk,exec('ref_firma','ustawienia'));
   _ub_chor:=0;
   {? _tab.first()
   || P.cntx_psh();
      P.index('PRACOSOB');
      {!
      |? P.prefix(exec('ref_firma','ustawienia'),'P',BB.sqlint(_tab.OSOBA));
         {? P.first()
         || _daneHN:=0;
            {!
            |? _daneHN:=0;
               {? ~_daneHN
               || N.prefix('N',P.ref);
                  {? N.find_le(_dk) & N.DO>=_dk
                  || {? __RUB.sys_attr(N.NB,112,N.OD) | __RUB.sys_attr(N.NB,114,N.OD)
                     || _daneHN:=1
                     ?}
                  ?}
               ?};
               ~_daneHN & P.next()
            !};
            {? ~_daneHN || _ub_chor+=1 ?}
         || _ub_chor+=1
         ?};
         _tab.next()
      !};
      P.cntx_pop()
   ?};
   dst.LUCH:=_ub_chor;
~~}
{ _wer:=skl.mk_sel('Składniki wynagrodzenia za okresy miesięczne'@,'P',0,'zus_z3_wersklm',,,,,'U');
  skl.win_fld(_wer,,'ROK',,,5,,,'1) Rok'@);
  skl.win_fld(_wer,,'MC',,,3,,,'2) Mc'@);
  skl.win_fld(_wer,,'DP',,,-10,,,'3) Dni przepracowane'@);
  skl.win_fld(_wer,,'DR',,,-10,,,'4) Dni do przepracowania'@);
  skl.win_fld(_wer,,'PRZYCZ',,,-30,,,'5) Przyczyna nieprzepracowania'@);
  skl.win_fld(_wer,,'S',,,-15,2,,'6) Stałe wynagrodzenie zasadnicze'@);
  skl.win_fld(_wer,,'Z1',,,-15,2,,'7) Zmienne pomniejszone proporcjonalnie'@);
  skl.win_fld(_wer,,'Z2',,,-15,2,,'8) Zmienne przyjmowane w kwocie faktycznej'@);
  skl.win_fld(_wer,,'PR',,,8,2,,'9) %1 składki'@['%']);
  skl.win_act(_wer,,'Dołącz');
  skl.win_act(_wer,1,'Dołącz');
  skl.win_act(_wer,,'Popraw');
  skl.win_act(_wer,,'Usuń');
  _fm_rec:="_chk:=chk_rec('ROK','MC','DR','S','PR'); {? _chk<>'' || return(_chk) ?};
    {? skl.ROK<=999
    || FUN.emsg('Podano nieprawidłową wartość w polu: Rok.'@);
       return('ROK')
    ?};
    {? ~(skl.MC>0 & skl.MC<=12)
    || FUN.emsg('Podano nieprawidłową wartość w polu: Miesiąc.'@);
       return('MC')
    ?}; 1";
  skl.win_act(_wer,,'Rekord',,,,,_fm_rec);
  skl.win_act(_wer,1,'Rekord',,,,,_fm_rec);
  skl.win_act(_wer,,'Formuła','D&alej',,,"sel_exit()",,,,,,'A');
  skl.win_btn(_wer,'text='+'D&alej'@+', icon=xwin16.png:22, btn_label_align=right, panel=bottom','menu:A');
  skl.win_sel(_wer);
~~}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{FONT: 'TITLE'}{ cil.TITLE:=charleft(); ~~}
{FONT: 'T8'}{ cil.T8:=charleft(); ~~}
{FONT: 'T8B'}{ cil.T8B:=charleft(); ~~}
{FONT: 'T8G'}{ cil.T8G:=charleft(); ~~}
{FONT: 'T10B'}{ cil.T10B:=charleft(); ~~}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO:'kratki'}{REP: '{FONT: \''+par[2]+'\'}'}
{COMMENT}
   par[1] - wyrownanie w znakach ramki do lewej
   par[2] - font ramki
   par[3] - font tekstu
   par[4] - tekst w ramce
   par[5] - tu nie uzywany
   par[6] - tekst przed ramka
   par[7] - czy znak oddzielania tekstu w ramce, brak '' oznacza pipe|, ' ' oznacza brak |
   par[8] - odstep od poczatku DIRECT - line
   par[9] - liczba wierszy
   par[10] - ilosc znakow w ramce
   par[11] - 1 czy dopelniac spacjami
{COMMENT-}
{REP:
   _co:=obj_new(2);
   _na:=obj_new(obj_len(_co));
   _co[1]:='\n'; _co[2]:='\t';
   _na[1]:=' '; _na[2]:=' ';
   par[4]:=gsub(par[4],_co,_na);
   par[6]:=gsub(par[6],_co,_na);
   par[11]:={? var_press('[11]',@.par)=type_of(0) & par[11]=1 || 1 || 0 ?};
   _ramki:="1+((_a-1)-'┌┬┐├┼┤└┴┘│─ ')";
   _poczatek:={? var_press('[10]',@.par)=type_of(0) || par[10] || +par[4] ?};
   _line:={? var_press('[8]',@.par)=type_of(0) || '{line('+$par[8]+');~~}\n' || '' ?};
   _zn:=%255+%255;
   _noPipe:={? var_press('[7]',@.par)=type_of('') & par[7]=' ' || '' || ' '+_ramki(10)+' ' ?};
   {? +_noPipe
   || _ret:='';
     {! _licz:=1..+par[4] |!
        _ret+=' '+(1+((_licz-1)-par[4]))+' '+_ramki(10)
     !};
     _ret:=_ret-1;
     par[4]:=_ret
   ?};
   par[10]:={? var_press('[10]',@.par)=type_of(0) || par[10] || +par[4] ?};
   _liniiRamka:=0;
   _liniiPrzed:=0;
   _txtRamka:=_txtPrzed:='';
   {? +|par[4]
   || {? +_noPipe
     || _txtRamka:=par[4]
     || _text:=par[4];
        {? par[11] || STR.split(_text,';') || STR.split(_text) ?};
        {! |? +STR.spl_str |!
           _ramka:=form(STR.line(par[10]));
           _txtRamka+=_ramka;
           {? par[11] || _txtRamka+=(' '*(par[10]-(+_ramka))) ?};
           _txtRamka+=_zn;
           _liniiRamka+=1
        !};
        _txtRamka:=_txtRamka-2
     ?}
   ?};
   {? +par[6]
   || _text:=par[6];
     STR.split(_text);
     _licz:=0;
     {! |? +STR.spl_str |!
        _txtPrzed+=STR.line(par[1]-2);
        _txtPrzed+=_zn;
        _liniiPrzed+=1
     !};
     _txtPrzed:=_txtPrzed-2
   ?};
   _ile:={? _liniiPrzed>_liniiRamka || _liniiPrzed || _liniiRamka?};
   _maxWierszy:={? var_press('[9]',@.par)=type_of(0) & par[9]>0 || par[9] || _ile ?};
   {? _maxWierszy<1 || _maxWierszy:=1 ?};
   _wierszy:=obj_new(_maxWierszy);
   {! _licz:=1.._maxWierszy |!
     _wierszy[_licz]:=obj_new(2);
     _wierszy[_licz][1]:=_wierszy[_licz][2]:=''
   !};
   _wiersz:="(((frac(_a/2)>0)+_a)/2)-(((frac(_b/2)>0)+_b)/2)+1";
   _txtRamka:=spli_str(_txtRamka,_zn);
   _txtPrzed:=spli_str(_txtPrzed,_zn);
   _liczRamka:=_liczPrzed:=0;
   {! _licz:=1.._maxWierszy |!
     {? _licz>=_wiersz(_maxWierszy,obj_len(_txtRamka)) & _liczRamka<obj_len(_txtRamka)
     || _liczRamka+=1;
        _uzu:=par[10]-(+_txtRamka[_liczRamka]);
        {? +_noPipe || _uzu-=2 ?};
        _wierszy[_licz][2]:=_txtRamka[_liczRamka]+(_uzu*' ')
     || _uzu:=par[10];
        {? +_noPipe || _uzu-=2 ?};
        _wierszy[_licz][2]:=(_uzu*' ')
     ?};
     {? _licz>=_wiersz(_maxWierszy,obj_len(_txtPrzed)) & _liczPrzed<obj_len(_txtPrzed)
     || _liczPrzed+=1;
        _wierszy[_licz][1]:=_txtPrzed[_liczPrzed]
     ?}
   !};
   _gora:='{FONT: \''+par[3]+'\'}\n'+'{<'+$par[1]+'}'+'{FONT: \''+par[2]+'\'}'+_ramki(1);
   _gora+=
     {? +_noPipe
     || (_ramki(11)+_ramki(11)+_ramki(11)+_ramki(2))*(_poczatek-1)+(_ramki(11)+_ramki(11)+_ramki(11))
     || (_ramki(11)*par[10])
     ?};
   _gora+=_ramki(3)+'\n';
   _srodek:='';
   {! _licz:=1.._maxWierszy |!
     _srodek+='{>'+$(par[1]-2)+'\''+_wierszy[_licz][1]+'\'}';
     _srodek+='{<'+$par[1]+'}'+_ramki(10)+_wierszy[_licz][2]+_ramki(10)+'\n'
   !};
   _dol:='{FONT: \''+par[3]+'\'}'+'{<'+$par[1]+'}'+'{FONT: \''+par[2]+'\'}'+_ramki(7);
   _dol+=
     {? +_noPipe
     || (_ramki(11)+_ramki(11)+_ramki(11)+_ramki(8))*(_poczatek-1)+(_ramki(11)+_ramki(11)+_ramki(11))
     || _ramki(11)*par[10]
     ?};
   _dol+=_ramki(9)+'\n';
   _line+
   _gora+
   '{FONT: \''+par[3]+'\'}'+
   gsub(_srodek,_ramki(10),'{FONT: \''+par[2]+'\'}'+_ramki(10)+'{FONT: \''+par[3]+'\'}')+
   _dol
}
{SUBSTITUTE: 'zero_par'}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'text_out'}
{JUSTIFY}
{ STR.split(par[3]); ~~ }
{WHILE: +(par[3]:=STR.line(par[2]-par[1]))}
{DO}
{REP:
   {? +STR.spl_str
   || '{<{par[1]}>{par[2]}'
   || '{CENTER}{<{par[1]}'
   ?}+' gsub(par[3],%255,%32)}'
}
{OD}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'ls_item'}
{JUSTIFY}
{ STR.split(par[3]); ~~ }
{WHILE: +(par[3]:=STR.line(par[2]-par[1]-4))}{DO}
{REP:
   {? 1+par[3]=%255 || par[3]:=1-par[3]; '{<{par[1]} \'•\'}'
   || ''
   ?}+
   {? +STR.spl_str || '{<{par[1]+3}>{'+$par[2]+'}' || '{CENTER}{<{par[1]+3}' ?}+' gsub(par[3],%255,%32) }'
}{OD}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'skl'}
   {FONT: 'T8'}{SPACE: 'C'}
   { lmt:=(cil.T8-par[2].width())%2; ~~}
   {SUBSTITUTE: prn1:='par[2]'; 'TABHEAD'}
   { par[3].setcolor(color); par[3].ini_head(); ~~}
   {WHILE: par[3].h_next()}
   {DO}
      {REP: par[3].h_fmline(lmt)}
   {OD}
   {REP: par[3].fbar(lmt)}
   { {! _lp:=1..par[3].nstr |! kol[_lp]:=$_lp; kol[_lp]==par[3].HEAD[_lp] !}; par[3].ini_head(); ~~}
   {WHILE: par[3].h_next()}
   {DO}
      {REP: par[3].h_fmline(lmt)}
   {OD}
   { {! _lp:=1..par[3].nstr |! kol[_lp]==par[3].HEAD[_lp] !}; ~~}
   { vp:=1; ~~}
   {FOR: skl}
   {PREFIX: par[1]}
   {DO}
      {IF: vp}
         {par[3].setcolor(color); ~~}
         {REP: par[3].fbar(lmt)}
         {par[3].setcolor('255:255:255'); vp:=0; ~~}
      {ELSE}
         {REP: par[3].fbar(lmt)}
      {FI}
      {par[3].ini_line(); ~~}
      {WHILE: par[3].next()}
      {DO}
         {REP: par[3].fline(lmt)}
      {OD}
   {OD}
   {REP: par[3].flbar(lmt)}
   { obj_del(par[2]); obj_del(par[3]); ~~}
   {SUBSTITUTE: 'zero_par'}
   {SPACE: 'B'}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'tak_nie'}
{COMMENT}
   par[1] - wyrownanie w znakach tekstu do lewej
   par[2] - font ramki
   par[3] - font tekstu
   par[4] - tekst w ramce
   par[5] - tu nie uzywany
   par[6] - teks przed ramka
   par[7] - wyrownanie w znakach ramki do lewej
   par[8] - tu nie używany
{COMMENT-}
{REP: '{FONT: \''+par[2]+'\'}'}
{REP: '{<{'+$par[7]+'}}┌───┐   {<{'+$(par[7]+20)+'}}┌───┐'}
{REP: '{<{'+$par[1]+'}\''+par[6]+'\'}{<'+$par[7]+'}{FONT: \''+par[2]+'\'}│{FONT: \''+par[3]+'\'}{\''+
      {? 1+par[4]='T' || ' X ' || '   ' ?}+'\'}{FONT: \''+par[2]+'\'}{\'│\'}{FONT: \''+par[3]+'\'}{\' TAK\'}{<'+
      $(par[7]+20)+'}{FONT: \''+par[2]+'\'}│{FONT: \''+par[3]+'\'}{\''+{? 1+par[4]='N' || ' X ' || '   ' ?}+
      '\'}{FONT: \''+par[2]+'\'}{\'│\'}{FONT: \''+par[3]+'\'}{\' NIE\'}'
}
{REP: '{FONT: \''+par[2]+'\'}{<{'+$par[7]+'}}└───┘   {<{'+$(par[7]+20)+'}}└───┘'}
{SUBSTITUTE: 'zero_par'}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'kwadrat'}
{COMMENT}
   par[1] - wyrownanie w znakach tekstu
   par[2] - font ramki
   par[3] - font tekstu
   par[4] - tekst za ramka
   par[5] - tu nie uzywany
   par[6] - tekst przed ramka
   par[7] - wyrownanie w znakach ramki do lewej
   par[8] - zaznaczony X lub nie
{COMMENT-}
{REP: '{FONT: \''+par[2]+'\'}'}
{REP: '{<{'+$par[7]+'}}┌───┐'}
{REP: '{<{'+$par[1]+'}\''+par[6]+'\'}{<'+$par[7]+'}{FONT: \''+par[2]+'\'}│{FONT: \''+par[3]+'\'}{\''+
      {? 1+par[8]='X' || ' X ' || '   ' ?}+'\'}{FONT: \''+par[2]+'\'}{\'│\'}{FONT: \''+par[3]+'\'}{\' '+par[4]+
      '\'}{FONT: \''+par[2]+'\'}'
}
{REP: '{FONT: \''+par[2]+'\'}{<{'+$par[7]+'}}└───┘'}
{SUBSTITUTE: 'zero_par'}
{MACRO-}
{MACRO: 'zero_par'}
   {
   par[1]:=par[2]:=par[3]:=par[4]:=par[6]:=par[7]:=par[8]:=par[9]:=par[10]:=par[11]:=~~
   }
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: tresc}
   {FOOTER}
      {par[5]:=0 ;~~}
      {SUBSTITUTE: 'przypisy'}
      {~~}
      {LINE: 1}
      {FONT: 'T8GB'}{SPACE: 'C'}
   {FOOTER-}
   {  __SumPod:=0;
      dprac.blank();
      {! _lp:=1..dprac.fld_num()
      |! _fld_acr:=dprac.fld_acr(_lp);
         {? var_pres(_fld_acr,dprac)=36 || dprac.memo_set('',_fld_acr) ?}
      !};

      nb.prefix();
      {? nb.first() || nb.erase() ?};
      __n_mac.prefix();
      {? __n_mac.first() || __n_mac.erase() ?};
      {? __nbref.first() || __nbref.erase() ?};

      {? uz.first() || uz.erase() ?};

      skl.prefix();
      {? skl.first() || skl.erase() ?};

      {? dror.first() || dror.erase() ?};

      {? P.OSOBA().PLEC='K'
      || suf[1]:='i';
         suf[2]:='a'
      || suf[1]:='';
         suf[2]:='y'
      ?};

      __KAL.set_cal({? P.KAL || P.KAL || 'standard' ?},P.DZA~1);
      dprac.OSOBA:=P.OSOBA().NAZWISKO+' '+OSOBA.PIERWSZE+', PESEL: '+OSOBA.PESEL;
      dprac.PDZA:=date(P.DZA~1,P.DZA~2,1);
      {? dprac.PDZA<>P.DZA & __KAL.w_days(dprac.PDZA,P.DZA-1)>0 || dprac.PDZA:=date(P.DZA~1,P.DZA~2,0)+1 ?};
      {? P.DZ<>date(0,0,0) & dprac.PDZA>P.DZ || dprac.PDZA:=P.DZA ?};

      dprac.ODO:=date(P.DZ~1,P.DZ~2,0);
      dprac.OOD:=date(P.DZ~1-1,P.DZ~2,0)+1;
      {? dprac.OOD<dprac.PDZA || dprac.OOD:=dprac.PDZA ?};

      '1. Ostatni wymiar zatrudnienia i jego poczatek.';
      H.prefix(P.ref(),'Z');
      {? H.last()
      || _wy:=H.RWY;
         dprac.WYMIAR:={? _wy=1 || '1' || $H.RWYL+'/'+$H.RWYM ?};
         dprac.WYOD:=dprac.LWYOD:=H.OD;
         {!
         |? H.prev() & _wy=H.RWY
         |! dprac.WYOD:=dprac.LWYOD:=H.OD
         !}
      ?};

      'Czy to jest praca tymczasowa?';
      dprac.CZY_TMP:={? P.F_ZATR().KOD='T' || 'T' || 'N' ?};
      dprac.CZY_OUT:='N';

      '6. Wypłacone (w b.r.) wynagrodzenie chorobowe na podst. art. 92 Kp';
      _jest6:=0;
      N.prefix('N',P.ref());
      {? N.last()
      || nb.prefix(6);
         {!
         |? {? N.OD~1=P.DZ~1 & N.DO<=P.DZ & __RUB.sys_attr(N.NB,121,N.DO)
            || {? N.OD<=P.DZ & P.DZ<=N.DO
               || dprac.DZLA:=1;
                  {? N.NEZLA<>null()
                  || dprac.ZLASN:=N.NEZLA().SERIA+' '+NEZLA.NUMER;
                     dprac.EZLA:='T'
                  || dprac.ZLASN:=N.SDOK+' '+N.NDOK;
                     dprac.EZLA:='N'
                  ?};
                  dprac.ZLADD:=N.DD
               ?};
               N.cntx_psh();
               _chp:=exec('nw_find_chp','nieobecnosc',N.ref());
               {? ~_chp || _chp:=N.ref() ?};
               NW.prefix(_chp);
               {? NW.last()
               || _ok:=1;
                  {!
                  |? _typ:={? __RUB.sys_attr(NW.CHW().NB,121,N.DO) || 'W' || 'Z' ?};
                     _kdch:=N.KDCH().KOD;
                     {? _typ='Z' & ~nb.first()
                     || '"Ostatnie" zasiłki pomijamy ...'
                     |? N.OD~1<P.DZ~1 & nb.first() & nb.OD-N.DO>60
                     || _ok:=0
                     |? nb.first() & nb.OD=N.DO+1 & nb.KOD=_kdch & nb.TYP=_typ
                     || nb.OD:=N.OD;
                        nb.put()
                     |? ~(nb.find_le(N.OD) & nb.OD<=N.OD & N.DO<=nb.DO)
                     || nb.blank();
                        nb.P:=6;
                        nb.OD:=N.OD;
                        nb.DO:=N.DO;
                        nb.KOD:=_kdch;
                        nb.TYP:=_typ;
                        nb.PR:=N.PROC;
                        _jest6+=nb.add() & nb.TYP='W'
                     ?};
                     _ok & NW.prev()
                  !}
               ?};
               N.cntx_pop()
            ?};
            N.prev() & P.DZ~1<=N.OD~1
         !}
      ?};

      '7. Zasilki chorobowe (b.r.).';

      'Przeglądamy zasiłki roku zwolnienia pracownika i ich schematy rozliczenia.';
      'Jeżeli analizowana nieobecność jest zasiłkiem - pokazujemy zawsze. Jeżeli jest wynagrodzeniem, to pokazujemy,';
      'tylko wtedy, gdy w bieżącym roku wynagrodzenia nie było.';
      'Przykład 1.';
      'Rok zaczął się kontynuacją zasiłku. W pkt. 7 pokażemy wszystkie zasiłki z tego samego okresu zasiłkowego.';
      'Część z nich będzie z  ubiegłego roku. W pkt. 6 pokażemy wynagrodzenie chorobowe z tego samego okresu';
      'zasiłkowego, które na pewno jest z ubiegłego roku.';
      'Przykład 2.';
      'Rok zaczął się kontynuacją zasiłku (A). Były 3 m-ce przerwy, potem wynagrodzenie i znowu zasiłek (B).';
      'W pkt. 6 pokażemy wypłacone wynagrodzenie chorobowe w bieżącym roku. W pkt. 7 pokażemy:';
      '- zasiłek (A) i wszystkie pozostałe zasiłki z tego samego okresu zasiłkowego (część z nich będzie oczywiście';
      '  z poprzedniego roku kalendarzowego);';
      '- zasiłek (B) i wszystkie pozostałe zasiłki z tego samego okresu zasiłkowego.';
      N.prefix('N',P.ref());
      {? PAR_SKID.get(242)='N' & N.last()
      || {!
         |? {? N.OD~1=P.DZ~1 & N.DO<=P.DZ &
               (__RUB.sys_attr(N.NB,1221,N.DO) | __RUB.sys_attr(N.NB,1222,N.DO) | __RUB.sys_attr(N.NB,1227,N.DO))
            || {? N.OD<=P.DZ & P.DZ<=N.DO
               || dprac.DZLA:=1;
                  {? N.NEZLA<>null()
                  || dprac.ZLASN:=N.NEZLA().SERIA+' '+NEZLA.NUMER;
                     dprac.EZLA:='T'
                  || dprac.ZLASN:=N.SDOK+' '+N.NDOK;
                     dprac.EZLA:='N'
                  ?};
                  dprac.ZLADD:=N.DD
               ?};
               N.cntx_psh();
               _chp:=exec('nw_find_chp','nieobecnosc',N.ref());
               {? ~_chp || _chp:=N.ref() ?};
               NW.prefix(_chp);
               {? NW.last()
               || _nod:=P.DZ+1;
                  _ok:=1;
                  {!
                  |? _typ:='';
                     _sekcja:=7;
                     _kdch:=NW.CHW().KDCH().KOD;
                     {? __RUB.sys_attr(N.NB,1221,N.DO)
                     || _typ:='Zasiłek chorobowy'
                     |? __RUB.sys_attr(N.NB,1222,N.DO)
                     || _typ:='Świadczenie rehabilitacyjne'
                     |? __RUB.sys_attr(N.NB,1227,N.DO)
                     || _typ:='Zasiłek macierzyński '+$N.PROC+'%';
                        _sekcja:=8
                     |? ~_jest6 & __RUB.sys_attr(N.NB,121,N.DO)
                     || _sekcja:=6;
                        _typ:='W'
                     ?};

                     _ok:=_ok & _nod-N.DO<60;
                     _nod:=N.OD;

                     {? _typ<>'' & (_sekcja=8 | _ok)
                     || nb.prefix(_sekcja);
                        {? nb.first() & nb.OD=N.DO+1 & nb.KOD=_kdch & nb.TYP=_typ
                        || nb.OD:=N.OD;
                           nb.put()
                        |? ~(nb.find_le(N.OD) & nb.OD<=N.OD & N.DO<=nb.DO)
                        || nb.blank();
                           nb.P:=_sekcja;
                           nb.OD:=N.OD;
                           nb.DO:=N.DO;
                           nb.KOD:=_kdch;
                           nb.TYP:=_typ;
                           nb.PR:=N.PROC;
                           nb.add()
                        ?}
                     ?};

                     {? _sekcja=8
                     || _typ:=
                           {? __RUB.sys_attr(N.NB,12271,N.DO) || 'macierzyńskiego'
                           |? __RUB.sys_attr(N.NB,12272,N.DO) || 'dodatkowego urlopu macierzyńskiego'
                           |? __RUB.sys_attr(N.NB,12273,N.DO) || 'urlopu ojcowskiego'
                           |? __RUB.sys_attr(N.NB,12274,N.DO) || 'urlopu rodzicielskiego'
                           || ''
                           ?};
                        {? _typ<>''
                        || {? __n_mac.first() & __n_mac.OD=N.DO+1 & __n_mac.TYP=_typ
                           || __n_mac.OD:=N.OD;
                              __n_mac.put()
                           |? ~(__n_mac.find_le(N.OD) & __n_mac.OD<=N.OD & N.DO<=__n_mac.DO)
                           || __n_mac.blank();
                              __n_mac.OD:=N.OD;
                              __n_mac.DO:=N.DO;
                              __n_mac.TYP:=_typ;
                              __n_mac.add()
                           ?}
                        ?}
                     ?};

                     NW.prev()
                  !}
               ?};
               N.cntx_pop()
            ?};
            N.prev() & P.DZ~1<=N.OD~1
         !}
      ?};

      '15. Umowy-zlecenia, ...';
      ZC.prefix(exec('ref_firma','ustawienia'),P.OSOBA);
      {? ZC.last()
      || LS.cntx_psh();
         {!
         |? {? dprac.ODO<ZC.DW
            || RH.prefix(ZC.ref());
               {? RH.last()
               || {!
                  |? {? dprac.OOD<date(RH.R,RH.M,0)
                     || {? RH.ZC_INFO().FC='T'
                        || uz.blank();
                           uz.UOD:=ZC.DU;
                           uz.UDO:=ZC.DW;
                           uz.R:=RH.R;
                           uz.M:=RH.M;
                           uz.KW:=exec('licz_rhs','lista_licz',200);
                           uz.add()
                        ?};
                        RH.prev()
                     ?}
                  !}
               ?};
               ZC.prev()
            ?}
         !};
         LS.cntx_pop();
         {? uz.first()
         || _uod:=uz.UOD;
            _udo:=uz.UDO;
            _lp:=1;
            {!
            |? {? _uod<>uz.UOD | _udo<>uz.UDO
               || _uod:=uz.UOD;
                  _udo:=uz.UDO;
                  _lp:=1
               ?};
               uz.LP:=_lp;
               _lp+=uz.put();
               uz.next()
            !}
         ?}
      ?};

      '17. ROR.';
      {! _lp:=1..2
      |! _tab:={? _lp=1 || OS_ROR || PKO ?};
         _tab.prefix(P.OSOBA);
         {? _tab.first()
         || {!
            |?
               {? ~dror.find_key(_tab.N,_tab.BA().NB,)
               || dror.blank();
                  dror.N:=_tab.N;
                  dror.B:=_tab.BA().NB;
                  dror.add()
               ?};
               _tab.next()
            !}
         ?};
         obj_del(_tab)
      !}; ~~
   }
   {IF:
      wysun:=0;

      'Uzupelnienie dwoch informacji niezbednych do okreslenia okresu pobierania skladnikow:';
      ' dprac.ZLDO - data zakonczenia ostatniej choroby pozwoli ustalic czy minal 3-miesieczny okres';
      '              i czy podstawa powinna zostac ustalona ponownie';
      ' dprac.ZLOD - data poczatkowa choroby pierwotnej dla ostatniej choroby';
      N.prefix('N',P.ref());
      {? N.last()
      || {!
         |? {? __RUB.sys_attr(N.NB,121,N.DO) |
               __RUB.sys_attr(N.NB,1221,N.DO) | __RUB.sys_attr(N.NB,1222,N.DO) |
               __RUB.sys_attr(N.NB,1225,N.DO) | __RUB.sys_attr(N.NB,1227,N.DO)
            || dprac.ZLOD:=N.OD;
               dprac.ZLDO:=N.DO;
               N.cntx_psh();
               N.index('NIEOBECN');
               N.prefix('N',P.ref());
               _d_cia:=exec('data_ciaglosci','nieobecnosc',N.NB().RN);
               N.cntx_pop();
               _RWY:="H.WY"; _MAC:="0";
               {? (__RUB.sys_attr(N.NB,122722) | __RUB.sys_attr(N.NB,122742))
               || _RWY:="H.RWY"
               || _RWY:="H.WY"; _MAC:="H.MAC='T'"
               ?};
               _h_mac2nb:=exec('ustal_h_wym','lista_licz','MAC',N.OD);
               N.cntx_psh();
               _chp:=exec('nw_find_chp','nieobecnosc',N.ref());
               {? _chp<>null() & N.seek(_chp)
               || _od:=date(N.OD~1,N.OD~2-1,1);
                  _zakr:=(dprac.ZLDO~1*12+dprac.ZLDO~2)-(_od~1*12+_od~2);
                  {? _zakr<1 || _zakr:=1 ?};
                  _mc_pom:=_d_cia~2-(_zakr+(12-1));
                  {? _mc_pom>=13 || _mc_pom:=12 ?};
                  _d_pom_0:=date(_d_cia~1,_mc_pom,1);
                  H.cntx_psh();
                  H.index('_HISTKOD');
                  H.prefix(P.ref,'Z');
                  {? H.last()
                  || {! |? {? H.OD>_d_cia || H.prev() ?} !};
                     _wymiar:=_RWY(); _exit:=0; _mac:=_MAC();
                     dprac.WYOD:=H.OD;
                     {!
                     |? {? H.OD<=_d_pom_0
                        || _exit:=1
                        |? H.prev()
                        || {? ~_h_mac2nb & _MAC()
                           || H.prev()
                           || {? _RWY()<>_wymiar | _MAC()<>_mac
                              || _exit:=1;
                                 dprac.WYOD:=H.DO+1
                              || dprac.WYOD:=H.OD
                              ?}
                           ?}
                        || _exit:=1
                        ?};
                        _wymiar:=_RWY(); _mac:=_MAC();
                        ~_exit
                     !}
                  ?};
                  H.cntx_pop();
                  {? N.OD<dprac.WYOD
                  || {? N.find_ge(date(dprac.WYOD~1,dprac.WYOD~2,1))
                     || {? N.OD<_d_cia
                        || dprac.ZLOD:=date(_d_cia~1,_d_cia~2,0)
                        |? N.OD~1=dprac.WYOD~1 & N.OD~2=dprac.WYOD~2
                        || dprac.ZLOD:=date(N.OD~1,N.OD~2,0)
                        || dprac.ZLOD:=date(N.OD~1,N.OD~2,1)-1
                        ?}
                     ?}
                  || dprac.ZLOD:=date(N.OD~1,N.OD~2,1)-1
                  ?}
               ?};
               N.cntx_pop();
               __nbref.REF:=$N.ref();
               __nbref.add();
               0
            || N.prev()
            ?}
         !}
      ?};

      dprac.DATA:=P.DZ+1;
      dprac.DDATA:=dprac.ZLDO<>date(0,0,0) & lpm(dprac.ZLDO,dprac.DATA)<3;

      dprac.edit("
         {! _ii:=1..obj_len(zs) |! zs[_ii]:=' ' !};
         {? +dprac.KZAS || ($('zs.'+dprac.KZAS))():='X' ?};
         {? dprac.WOD<>#0
         || _dt:=gsub(dprac.WOD$3,'/','');
            {! _ii:=1..8 |! oz[_ii]:=1+_dt; _dt:=1-_dt !}
         || {! _ii:=1..8 |! oz[_ii]:=dz[_ii]:=' ' !}
         ?};
         {? dprac.WDO<>#0
         || _dt:=gsub(dprac.WDO$3,'/','');
            {! _ii:=1..8 |! dz[_ii]:=1+_dt; _dt:=1-_dt !}
         ?};
         {? dprac.DDATA & dprac.DATA<=P.DZ
         || FUN.emsg('Data nie może być mniejsza niż data zwolnienia (%1).'@ [P.DZ$1]);
            'DATA'
         |? +dprac.KZAS
         || {? dprac.WOD=#0 & 'C#O'*dprac.KZAS>0 || FUN.emsg('Wymagane uzupełnienie pola \"%1\" dla wniosku.'@ ['Data od'@]); 'WOD'
            |? dprac.WDO=#0 & 'C#O'*dprac.KZAS>0 || FUN.emsg('Wymagane uzupełnienie pola \"%2\" dla wniosku.'@ ['Data do'@]); 'WDO'
            || ''
            ?}
         || ''
         ?}")
   }
      {  wysun:=1;

         tabpr.index(ndxpr.RM);
         tabpr.prefix();
         {? tabpr.first() || tabpr.erase() ?};

         'Ustalenie miesiaca startowego - sprawdzmy kiedy skonczyla sie ostatnia choroba';
         __ustMsc();

         '11. Skladniki miesieczne.';
         _roki:=',';
         {? var_pres('_dane_i')>100 || obj_del(_dane_i) ?};
         {? var_pres('_dane_i')>0 || &_dane_i ?};
         _dane_i:=tab_tmp(2,'ROK','INTEGER','Rok','MC','INTEGER','Miesiac','KW','REAL','Kwota','LT','STRING[8]','Lista',
                  'OD','DATE','Data od okr.','DO','DATE','Data do okr.');
         _upd_przycz:="{? _a<>'' & skl.PRZYCZ*_a=0 || skl.PRZYCZ+={? skl.PRZYCZ='' || '' || ', ' ?}+_a ?}";
         skl.prefix('M');
         H.prefix(P.ref(),'Z');
         N.prefix('N',P.ref());
         _do:=dprac.DSTART;
         _lmc:=0;
         {!
         |? _lmc<12 & dprac.DSTOP<=_do
         |! _od:=date(_do~1,_do~2,1);
            {? ~(_roki*(',\'s_ch'+form(_od~1,,,'9.')+'\','))
            || _roki+='\'s_ch'+form(_od~1,,,'9.')+'\',';
               _roki+='\'s_ch'+form((_od~1)-1,,,'9.')+'\',';
               _roki+='\'s_ch'+form((_od~1)+1,,,'9.')+'\','
            ?};
            skl.blank();
            skl.TYP:='M';
            skl.ROK:=_od~1;
            skl.MC:=_od~2;
            skl.NOM:=__KAL.w_days(_od,_do);
            skl.DR:=skl.NOM-exec('dnpzazw','nieobecnosc',_od,_do,'dr');
            skl.DP:=skl.DR;
            __Datmc:=_od;
            {? N.find_ge(_od)
            || {!
               |? {? N.OD<=_do
                  || {? ~(__RUB.sys_attr(N.NB,113,N.OD) | __RUB.sys_attr(N.NB,131,N.OD) |
                          __RUB.sys_attr(N.NB,122722) | __RUB.sys_attr(N.NB,122742) | __RUB.sys_attr(N.NB,651))
                     || _nod:={? N.OD<dprac.DSTOP || dprac.DSTOP || N.OD ?};
                        _ndo:={? P.DZ<N.DO || P.DZ || N.DO ?};
                        skl.DP-={? N.NRG_AUTO='N' & _nod=N.OD & _ndo=N.DO || N.NR || __KAL.w_days(_nod,_ndo) ?};
                        _rn:=N.NB;
                        _przycz:=__przyczyn(_rn);
                        _upd_przycz(_przycz);
                        {? ~(_roki*(',\'s_ch'+form(_nod~1,,,'9.')+'\','))
                        || _roki+='\'s_ch'+form(_nod~1,,,'9.')+'\',';
                           _roki+='\'s_ch'+form((_nod~1)-1,,,'9.')+'\',';
                           _roki+='\'s_ch'+form((_nod~1)+1,,,'9.')+'\','
                        ?}
                     ?};
                     N.next()
                  ?}
               !}
            ?};
            {? skl.NOM=0
            || FUN.emsg('Nie odnaleziono kalendarza za miesiąc %1.\nMiesiąc zostanie pominięty w wyliczeniach.'@
                  [_od$8])
            |? skl.DR=0
            || FUN.emsg('Pracownik nie przepracował żadnego dnia w miesiącu %1.\n'
                  'Miesiąc zostanie pominięty w wyliczeniach.'[_od$8])
            |? (skl.DR<>0 & skl.DP/skl.DR>=0.5) | __pzmnb
            || _Kwota:=0; _licz_f:=0;
               H.prefix(P.ref(),'Z');
               {? H.find_le(_do)
               || {! _lp:=1..obj_len(sta_pom) |! sta_pom[_lp]:=0 !};
                  {! _lp:=1..obj_len(potr) |! potr[_lp]:=0 !};
                  _godz:=exec('nominal','godziny',_od,_do,1);
                  exec('mc_placa_newzasad','lista_licz',_od,_do,_godz,{? __pzmnb || 1 || ~~ ?});
                  _Norma:=__KAL.w_days(_od,_do)+exec('dnpzazw','nieobecnosc',_od,_do,'dr');
                  url_dni:=url_godz:=nn_dni:=nn_godz:=0;  'ustalane w wynchor.fml\licz_nie';
                  H.cntx_psh();
                  _Nieob:={? _Norma>0 || exec('licz_nie_wynchor','lista_licz',_od,_do,_Norma,,1) ?};
                  H.cntx_pop();
                  {? -(1+H.CP().S)='f'
                  || _Praca:=_Norma-_Nieob; {? _Praca<0 || _Praca:=0 ?};
                     _g_akord:=exec('zlicz_G_z_MC','lista_licz',P.ref,7010,_od,_do);
                     {? _Praca>0 & _Praca=url_dni & ~_Nieob
                     || _licz_f:=1
                     |? _Praca>0 & _Praca<>_Norma-nn_dni & LICZ.RUB_CHO.first()
                     || _licz_f:=2
                     || _licz_f:=3
                     ?};
                     &_g_akord
                  ?};
                  &_Nieob;
                  __Przest(_od)
               ?};
               O.prefix(exec('ref_firma','ustawienia'),__F_ZATR.P,skl.ROK,skl.MC);
               {? var_pres('_dane_r')>0 || &_dane_r ?};
               {? var_pres('_dane_g')>0 || &_dane_g ?};
               {? var_pres('_tmp')>0 || &_tmp ?};
               _dane_r:=__dane_r(_roki);
               _dane_i.ROK:=skl.ROK;
               _dane_i.MC:=skl.MC;
               _tmp:=__dane_i(_roki);
               {? _tmp.first()
               || {!
                  |? {? __kwaltmp(_tmp.MC,_tmp.DO)
                     || _dane_i.LT:=_tmp.LT;
                        _jestkw:=_dane_i.find_rec();
                        _dane_i.KW:=_tmp.KW;
                        _dane_i.OD:=_tmp.OD;
                        _dane_i.DO:=_tmp.DO;
                        {? _dane_i.KW>0 || {? _jestkw || _dane_i.put() || _dane_i.add() ?} ?}
                     ?};
                     _tmp.next()
                  !}
               ?};
               _dane_g:={? _dane_r.KW=0 || __dane_g() || tab_tmp(1,'KW','REAL','') ?};
               skl.Z2:=_dane_r.KW+_dane_g.KW;
               {? O.first()
               || _podsts:=0;
                  _skls:=0;
                  _kw_url:=0; _zasad:=0;
                  _kw_wyp:=0;
                  {? _licz_f=1 | _licz_f=2
                  || {? var_pres('_urlopwy')>100 || obj_del(_urlopwy) ?};
                     _urlopwy:=__RUB.sys_rub(42,_do)
                  ?};
                  {!
                  |? LS.use(-O.LT);
                     LS.index('PRACNRRU');
                     LS.prefix(P.ref());
                     {? LS.first()
                     || skl.Z1+=l_sys(6521);
                        _url:=l_sys(652211);
                        _urlMwysPob:=l_sys(65252); 'Urlopy na liście, ale mają być wg. miesiąca wystąpienia';
                        _urlMw:=exec('n_wartosc','nieobecnosc',skl.ROK,skl.MC,65251)$2; 'Wg. miesiąca wystąpienia';
                        skl.S+=_url-_urlMwysPob+_urlMw;
                        {? _dane_r.KW=0
                        || skl.Z2+=(l_sys(65221)-_url)
                        || {? _licz_f<>2 || skl.Z2-=_url ?}
                        ?};
                        skl.Z2+=l_sys(6524);
                        _podst:=l_sys(5621);
                        _skl:=l_sys(5711,572);
                        _podsts+=_podst;
                        _skls+=_skl;
                        tabpr.blank();
                        tabpr.R:=O.R;
                        tabpr.M:=O.M;
                        tabpr.LT:=-O.LT;
                        {? _podst<>0
                        || tabpr.PR:=(100*_skl/_podst)$2
                        ?};
                        {? _licz_f
                        || {? (_licz_f=1 | _licz_f=2) & _urlopwy.first()
                           || _kw_url+=__WykRUB(_licz_f,_urlopwy)
                           ?};
                           {? _licz_f=1 || skl.Z2-=_kw_url ?};
                           {? _licz_f=2 | _licz_f=3
                           || _zasad+=l_sys(451)+l_sys(452)
                           ?}
                        ?};
                        tabpr.add()
                     ?};
                     O.next()
                  !};
                  {? var_pres('_urlopwy')>100 || obj_del(_urlopwy); &_urlopwy ?};
                  {? _licz_f
                  || {? _licz_f=1 | _licz_f=2
                     || _kw_wyp:=exec('n_wartosc','nieobecnosc',_od~1,_od~2,111)$2
                     ?};
                     {? _licz_f=2
                     || _Kwota+=(_zasad+_kw_url+_kw_wyp)/_Praca*(_Norma-nn_dni)$2;
                        _Kwota-=(_kw_url+_kw_wyp)
                     |? _licz_f=3
                     || _Kwota+=_zasad
                     ?};
                     {? _Kwota<0 || _Kwota:=0 ?};
                     skl.S+=_Kwota
                  ?};
                  _dt:=date(O.RU,O.MU,1);
                  exec('czytaj','#stalesys',_dt,KST,'PRFC','WSODBR');
                  {? _podsts<>0
                  || skl.PR:=(100*_skls/_podsts)$2
                  || _bl:=exec('spr_blok_podst_sk','lista_licz',OSOBA.ref(),_dt,1);
                     skl.PR:={? type_of(_bl)=type_of('') & _bl='T' || KST.PRFC || KST.WSODBR ?}
                  ?};
                  'Zabezpieczenie przed błędami zaokrągleń';
                  {? skl.PR>KST.WSODBR || skl.PR:=KST.WSODBR ?};
                  'Zapamietajmy % dla b.m.';
                  {? skl.PR<>0
                  || tabpr.prefix(O.R,O.M,);
                     {? tabpr.first()
                     || {!
                        |? {? tabpr.PR=0 || tabpr.PR:=skl.PR; tabpr.put() ?};
                           tabpr.next()
                        !}
                     ?};
                     tabpr.prefix()
                  ?}
               ?};
               {? skl.PR=0 || exec('czytaj','#stalesys',_od,KST,'PRFC','WSODBR'); skl.PR:=KST.WSODBR ?};
               skl.add()
            || skl.add()
            ?};
            _lmc+=1;
            _do:=_od-1
         !};
         VAR_DEL.delete('__dane_p');
         __dane_p:=_dane_i;
         ~~
      }
      {
         '12, 13, 14. Skladniki okresowe (kwartalne/roczne/inne).';
         'formula na ustalenie liczby dni przepracowanych w okresie i przyczyn nieoebcności.';
         _ustDni:="skl.NOM:=__KAL.w_days(_a,_b);
                  skl.DR:=skl.NOM-exec('dnpzazw','nieobecnosc',_a,_b,'dr');
                  skl.DP:=skl.DR;
                  N.prefix('N',P.ref());
                  {? N.find_ge(_a)
                  || {!
                     |? {? N.OD<=_b
                        || {? ~(__RUB.sys_attr(N.NB,113,N.OD) | __RUB.sys_attr(N.NB,131,N.OD) |
                              __RUB.sys_attr(N.NB,122722) | __RUB.sys_attr(N.NB,122742) | __RUB.sys_attr(N.NB,651))
                           || _ndo:={? P.DZ<N.DO || P.DZ || N.DO ?};
                              skl.DP-={? N.NRG_AUTO='N' & _ndo=N.DO || N.NR || __KAL.w_days(N.OD,_ndo) ?};
                              _rn:=N.NB;
                              _przycz:=__przyczyn(_rn);
                              {? _przycz<>'' & skl.PRZYCZ*_przycz=0 || skl.PRZYCZ+={? skl.PRZYCZ='' || '' || ', ' ?}+_przycz ?}
                           ?};
                           N.next()
                        ?}
                     !}
                  ?}";

         O.cntx_psh();
         O.index('LISTYPZN');
         O.prefix(exec('ref_firma','ustawienia'));
         tabpr.index(ndxpr.LT);
         skl.prefix();
         {? __dane_p.first()
         || {!
            |? _okres:=$(__dane_p.OD)+' - '+$(__dane_p.DO);
               skl.blank();
               skl.TYP:='X';
               skl.EMPTY:=0;
               skl.ROK:=0;
               skl.MC:=0;
               skl.KWARTAL:=0;
               skl.OKRES:=_okres;
               skl.S:=__dane_p.KW;
               skl.DNI:='T';
               'Ustalenie ilości dni w okresie.';
               _ustDni(__dane_p.OD,__dane_p.DO);

               _pr:=0;
               {? tabpr.find_key(-__dane_p.LT,)
               || _pr:=tabpr.PR
               |? O.find_key(-__dane_p.LT,)
               || LS.use(-O.LT);
                  LS.index('PRACNRRU');
                  LS.prefix(P.ref());
                  {? LS.first()
                  || _podst:=l_sys(5621);
                     _skl:=l_sys(5711,572);
                     tabpr.blank();
                     tabpr.R:=O.R;
                     tabpr.M:=O.M;
                     tabpr.LT:=-O.LT;
                     {? _podst<>0
                     || _pr:=tabpr.PR:=(100*_skl/_podst)$2
                     ?};
                     tabpr.add()
                  ?}
               ?};
               _dt:=date(O.RU,O.MU,1);
               exec('czytaj','#stalesys',_dt,KST,'PRFC','WSODBR');
               {? _pr=0
               || _bl:=exec('spr_blok_podst_sk','lista_licz',OSOBA.ref(),_dt,1);
                  _pr:={? type_of(_bl)=type_of('') & _bl='T' || KST.PRFC || KST.WSODBR ?}
               ?};
               skl.Z1:=__dane_p.KW*_pr;
               {? skl.S<>0
               || skl.PR:=(skl.Z1/skl.S)$2;
                  'Zabezpieczenie przed bledami zaokraglen';
                  {? skl.PR>KST.WSODBR || skl.PR:=KST.WSODBR ?}
               ?};
               skl.add();
               __dane_p.next()
            !}
         ?};

         _dk:=dprac.DSTART;
         _dp:=dprac.DSTOP;
         PREM_OKR.prefix(P.ref(),'R',);
         {? PREM_OKR.first()
         || {!
            |? {? (PREM_OKR.O_DO<>date(0,0,0) & PREM_OKR.O_DO<_dp) | _dk<PREM_OKR.O_OD
               || 'Okres premii NIE ma czesci wspolnej z ostatnim rokiem zatrudnienia.'

               |? _ok:=1;
                  PREM_EXC.prefix(P.ref(),PREM_OKR.SKP);
                  {? PREM_EXC.first()
                  || _ok:=0;
                     {!
                     |? _ok:=PREM_EXC.OD<=_dk & (PREM_EXC.DO=date(0,0,0) | _dk<=PREM_EXC.DO);
                        ~_ok & PREM_EXC.next()
                     !}
                  ?};
                  ~_ok
               || 'Pracownik utracil prawo do premii - nie pokazemy jej.'

               || _typ:=_okres:='';
                  _empty:=_rok:=_mc:=_kwartal:=0;
                  skl.blank();
                  skl.TYP:=PREM_OKR.RP;
                  {? PREM_OKR.RP='M'
                  || _typ:='M';
                     _rok:=PREM_OKR.O_OD~1;
                     _mc:=PREM_OKR.O_OD~2
                  |? PREM_OKR.RP='K'
                  || _typ:='K';
                     _rok:=PREM_OKR.O_OD~1;
                     _mc:=PREM_OKR.O_OD~2;
                     _kwartal:=
                        {? _mc=12 || _rok+=1; 1
                        |? _mc<=2 || 1
                        |? _mc<=5 || 2
                        |? _mc<=8 || 3
                        || 4
                        ?};
                     _mc:=0
                  |? PREM_OKR.RP='R'
                  || _typ:='R';
                     _rok:=PREM_OKR.O_OD~1;
                     {? PREM_OKR.O_OD~2>6 || _rok+=1 ?};
                     _okres:=$PREM_OKR.O_OD+' - '+$PREM_OKR.O_DO
                  |? PREM_OKR.RP='X' | PREM_OKR.RP='P' | PREM_OKR.RP='S'
                  || _typ:='X';
                     _okres:=$PREM_OKR.O_OD+' - '+$PREM_OKR.O_DO
                  ?};
                  {? _typ<>''
                  || {? skl.find_key(_typ,_empty,_rok,_mc,_kwartal,_okres,)
                     || _new:=0
                     || skl.blank();
                        skl.TYP:=_typ;
                        skl.EMPTY:=_empty;
                        skl.ROK:=_rok;
                        skl.MC:=_mc;
                        skl.KWARTAL:=_kwartal;
                        skl.OKRES:=_okres;
                        {? PREM_OKR.SKP().RZ='T' & PREM_OKR.SKP().KZ='W'
                        || skl.DNI:='T';
                           _od:={? PREM_OKR.O_OD<P.DZA || P.DZA || PREM_OKR.O_OD ?};
                           _do:={? PREM_OKR.O_DO>P.DZ & P.DZ<>date(0,0,0) || P.DZ || PREM_OKR.O_DO ?};
                           'Ustalenie ilości dni w okresie.';
                           _ustDni(_od,_do)
                        || skl.DNI:='N'
                        ?};
                        _new:=1
                     ?};
                     _pr:=0;
                     {? tabpr.find_key(-PREM_OKR.LT,)
                     || _pr:=tabpr.PR
                     |? O.find_key(-PREM_OKR.LT,)
                     || LS.use(-O.LT);
                        LS.index('PRACNRRU');
                        LS.prefix(P.ref());
                        {? LS.first()
                        || _podst:=l_sys(5621);
                           _skl:=l_sys(5711,572);
                           tabpr.blank();
                           tabpr.R:=O.R;
                           tabpr.M:=O.M;
                           tabpr.LT:=-O.LT;
                           {? _podst<>0
                           || _pr:=tabpr.PR:=(100*_skl/_podst)$2
                           ?};
                           tabpr.add()
                        ?}
                     ?};
                     _dt:=date(O.RU,O.MU,1);
                     exec('czytaj','#stalesys',_dt,KST,'PRFC','WSODBR');
                     {? _pr=0
                     || _bl:=exec('spr_blok_podst_sk','lista_licz',OSOBA.ref(),_dt,1);
                        _pr:={? type_of(_bl)=type_of('') & _bl='T' || KST.PRFC || KST.WSODBR ?}
                     ?};
                     {? _typ='M'
                     || skl.Z2+={? PREM_OKR.SKP().KZ='W' || PREM_OKR.KW_W || PREM_OKR.KW_N ?}
                     || {? PREM_OKR.SKP().KZ='W'
                        || skl.S+=PREM_OKR.KW_W;
                           skl.Z1+=PREM_OKR.KW_W*_pr
                        || skl.S+=PREM_OKR.KW_N;
                           skl.Z1+=PREM_OKR.KW_N*_pr
                        ?};
                        {? skl.S<>0
                        || skl.PR:=(skl.Z1/skl.S)$2;
                           'Zabezpieczenie przed bledami zaokraglen';
                           {? skl.PR>KST.WSODBR || skl.PR:=KST.WSODBR ?}
                        ?}
                     ?};
                     {? _new || skl.add() || skl.put() ?}
                  ?}
               ?};
               PREM_OKR.next()
            !}
         ?};
         O.cntx_pop(); ~~}
         { 'sprawdzenie podstaw czy nie sa rowne 0 i trzeba policzyc z biezacego mca';
         __SumPod:=0;
         skl.cntx_psh();
         skl.prefix('M');
         {? skl.first()
         || {!
            |? __SumPod+=(skl.S+skl.Z1);
               skl.next()
            !}
         ?};
         skl.cntx_pop();
         {? __SumPod=0
         || __Datmc:=dprac.DSTART;
            dprac.DSTOP:=dprac.DSTART;
            __pzmnb:=1
         ?}; ~~}
         {IF: __SumPod=0}
         { 'przeliczenie przypadku, gdy brak podstaw z zakresu mcy i liczymy z biezacego mca';
            tabpr.index(ndxpr.RM);
         __Datmc:=dprac.DSTART;
         dprac.DSTOP:=date(dprac.DSTART~1,dprac.DSTART~2,1);
         __pzmnb:=1;
         skl.prefix('M');
         {? skl.first() || {! |? skl.del() !} ?};
            '11. Skladniki miesieczne.';
         _roki:=',';
         {? var_pres('_dane_i')>100 || obj_del(_dane_i) ?};
         {? var_pres('_dane_i')>0 || &_dane_i ?};
         _dane_i:=tab_tmp(2,'ROK','INTEGER','Rok','MC','INTEGER','Miesiac','KW','REAL','Kwota','LT','STRING[8]','Lista',
                  'OD','DATE','Data od okr.','DO','DATE','Data do okr.');
         _upd_przycz:="{? _a<>'' & skl.PRZYCZ*_a=0 || skl.PRZYCZ+={? skl.PRZYCZ='' || '' || ', ' ?}+_a ?}";
         skl.prefix('M');
         H.prefix(P.ref(),'Z');
         N.prefix('N',P.ref());
         _do:=dprac.DSTART;
         _lmc:=0;
         {!
         |? _lmc<12 & dprac.DSTOP<=_do
         |! _od:=date(_do~1,_do~2,1);
            {? ~(_roki*(',\'s_ch'+form(_od~1,,,'9.')+'\','))
            || _roki+='\'s_ch'+form(_od~1,,,'9.')+'\',';
               _roki+='\'s_ch'+form((_od~1)-1,,,'9.')+'\',';
               _roki+='\'s_ch'+form((_od~1)+1,,,'9.')+'\','
            ?};
            skl.blank();
            skl.TYP:='M';
            skl.ROK:=_od~1;
            skl.MC:=_od~2;
            skl.NOM:=__KAL.w_days(_od,_do);
            skl.DR:=skl.NOM-exec('dnpzazw','nieobecnosc',_od,_do,'dr');
            skl.DP:=skl.DR;
            __Datmc:=_od;
            {? N.find_ge(_od)
            || {!
               |? {? N.OD<=_do
                  || {? ~(__RUB.sys_attr(N.NB,113,N.OD) | __RUB.sys_attr(N.NB,131,N.OD) |
                          __RUB.sys_attr(N.NB,122722) | __RUB.sys_attr(N.NB,122742) | __RUB.sys_attr(N.NB,651))
                     || _nod:={? N.OD<dprac.DSTOP || dprac.DSTOP || N.OD ?};
                        _ndo:={? P.DZ<N.DO || P.DZ || N.DO ?};
                        skl.DP-={? N.NRG_AUTO='N' & _nod=N.OD & _ndo=N.DO || N.NR || __KAL.w_days(_nod,_ndo) ?};
                        _rn:=N.NB;
                        _przycz:=__przyczyn(_rn);
                        _upd_przycz(_przycz);
                        {? ~(_roki*(',\'s_ch'+form(_nod~1,,,'9.')+'\','))
                        || _roki+='\'s_ch'+form(_nod~1,,,'9.')+'\',';
                           _roki+='\'s_ch'+form((_nod~1)-1,,,'9.')+'\',';
                           _roki+='\'s_ch'+form((_nod~1)+1,,,'9.')+'\','
                        ?}
                     ?};
                     N.next()
                  ?}
               !}
            ?};
            {? skl.NOM=0
            || FUN.emsg('Nie odnaleziono kalendarza za miesiąc %1.\nMiesiąc zostanie pominięty w wyliczeniach.'@
                  [_od$8])
            |? skl.DR=0
            || FUN.emsg('Pracownik nie przepracował żadnego dnia w miesiącu %1.\n'
                  'Miesiąc zostanie pominięty w wyliczeniach.'[_od$8])
            |? (skl.DR<>0 & skl.DP/skl.DR>=0.5) | __pzmnb
            || _Kwota:=0; _licz_f:=0;
               H.prefix(P.ref(),'Z');
               {? H.find_le(_do)
               || {! _lp:=1..obj_len(sta_pom) |! sta_pom[_lp]:=0 !};
                  {! _lp:=1..obj_len(potr) |! potr[_lp]:=0 !};
                  _godz:=exec('nominal','godziny',_od,_do,1);
                  exec('mc_placa_newzasad','lista_licz',_od,_do,_godz,{? __pzmnb || 1 || ~~ ?});
                  _Norma:=__KAL.w_days(_od,_do)+exec('dnpzazw','nieobecnosc',_od,_do,'dr');
                  url_dni:=url_godz:=nn_dni:=nn_godz:=0;  'ustalane w wynchor.fml\licz_nie';
                  H.cntx_psh();
                  _Nieob:={? _Norma>0 || exec('licz_nie_wynchor','lista_licz',_od,_do,_Norma,,1) ?};
                  H.cntx_pop();
                  {? -(1+H.CP().S)='f'
                  || _Praca:=_Norma-_Nieob; {? _Praca<0 || _Praca:=0 ?};
                     _g_akord:=exec('zlicz_G_z_MC','lista_licz',P.ref,7010,_od,_do);
                     {? _Praca>0 & _Praca=url_dni & ~_Nieob
                     || _licz_f:=1
                     |? _Praca>0 & _Praca<>_Norma-nn_dni & LICZ.RUB_CHO.first()
                     || _licz_f:=2
                     || _licz_f:=3
                     ?};
                     &_g_akord
                  ?};
                  &_Nieob;
                  __Przest(_od)
               ?};
               O.prefix(exec('ref_firma','ustawienia'),__F_ZATR.P,skl.ROK,skl.MC);
               {? var_pres('_dane_r')>0 || &_dane_r ?};
               {? var_pres('_dane_g')>0 || &_dane_g ?};
               {? var_pres('_tmp')>0 || &_tmp ?};
               _dane_r:=__dane_r(_roki);
               _dane_i.ROK:=skl.ROK;
               _dane_i.MC:=skl.MC;
               _tmp:=__dane_i(_roki);
               {? _tmp.first()
               || {!
                  |? {? __kwaltmp(_tmp.MC,_tmp.DO)
                     || _dane_i.LT:=_tmp.LT;
                        _jestkw:=_dane_i.find_rec();
                        _dane_i.KW:=_tmp.KW;
                        _dane_i.OD:=_tmp.OD;
                        _dane_i.DO:=_tmp.DO;
                        {? _dane_i.KW>0 || {? _jestkw || _dane_i.put() || _dane_i.add() ?} ?}
                     ?};
                     _tmp.next()
                  !}
               ?};
               _dane_g:={? _dane_r.KW=0 || __dane_g() || tab_tmp(1,'KW','REAL','') ?};
               skl.Z2:=_dane_r.KW+_dane_g.KW;
               {? O.first()
               || _podsts:=0;
                  _skls:=0;
                  _kw_url:=0; _zasad:=0;
                  _kw_wyp:=0;
                  {? _licz_f=1 | _licz_f=2
                  || {? var_pres('_urlopwy')>100 || obj_del(_urlopwy) ?};
                     _urlopwy:=__RUB.sys_rub(42,_do)
                  ?};
                  {!
                  |? LS.use(-O.LT);
                     LS.index('PRACNRRU');
                     LS.prefix(P.ref());
                     {? LS.first()
                     || skl.Z1+=l_sys(6521);
                        _url:=l_sys(652211);
                        _urlMwysPob:=l_sys(65252); 'Urlopy na liście, ale mają być wg. miesiąca wystąpienia';
                        _urlMw:=exec('n_wartosc','nieobecnosc',skl.ROK,skl.MC,65251)$2; 'Wg. miesiąca wystąpienia';
                        skl.S+=_url-_urlMwysPob+_urlMw;
                        {? _dane_r.KW=0
                        || skl.Z2+=(l_sys(65221)-_url)
                        || {? _licz_f<>2 || skl.Z2-=_url ?}
                        ?};
                        skl.Z2+=l_sys(6524);
                        _podst:=l_sys(5621);
                        _skl:=l_sys(5711,572);
                        _podsts+=_podst;
                        _skls+=_skl;
                        tabpr.blank();
                        tabpr.R:=O.R;
                        tabpr.M:=O.M;
                        tabpr.LT:=-O.LT;
                        {? _podst<>0
                        || tabpr.PR:=(100*_skl/_podst)$2
                        ?};
                        {? _licz_f
                        || {? (_licz_f=1 | _licz_f=2) & _urlopwy.first()
                           || _kw_url+=__WykRUB(_licz_f,_urlopwy)
                           ?};
                           {? _licz_f=1 || skl.Z2-=_kw_url ?};
                           {? _licz_f=2 | _licz_f=3
                           ||  _zasad+=l_sys(451)+l_sys(452)
                           ?}
                        ?};
                        tabpr.add()
                     ?};
                     O.next()
                  !};
                  {? var_pres('_urlopwy')>100 || obj_del(_urlopwy); &_urlopwy ?};
                  {? _licz_f
                  || {? _licz_f=1 | _licz_f=2
                     || _kw_wyp:=exec('n_wartosc','nieobecnosc',_od~1,_od~2,111)$2
                     ?};
                     {? _licz_f=2
                     || _Kwota+=(_zasad+_kw_url+_kw_wyp)/_Praca*(_Norma-nn_dni)$2;
                        _Kwota-=(_kw_url+_kw_wyp)
                     |? _licz_f=3
                     || _Kwota+=_zasad
                     ?};
                     {? _Kwota<0 || _Kwota:=0 ?};
                     skl.S+=_Kwota
                  ?};
                  _dt:=date(O.RU,O.MU,1);
                  exec('czytaj','#stalesys',_dt,KST,'PRFC','WSODBR');
                  {? _podsts<>0
                  || skl.PR:=(100*_skls/_podsts)$2
                  || _bl:=exec('spr_blok_podst_sk','lista_licz',OSOBA.ref(),_dt,1);
                     skl.PR:={? type_of(_bl)=type_of('') & _bl='T' || KST.PRFC || KST.WSODBR ?}
                  ?};
                  'Zabezpieczenie przed błędami zaokrągleń';
                  {? skl.PR>KST.WSODBR || skl.PR:=KST.WSODBR ?};
                  'Zapamietajmy % dla b.m.';
                  {? skl.PR<>0
                  || tabpr.prefix(O.R,O.M,);
                     {? tabpr.first()
                     || {!
                        |? {? tabpr.PR=0 || tabpr.PR:=skl.PR; tabpr.put() ?};
                           tabpr.next()
                        !}
                     ?};
                     tabpr.prefix()
                  ?}
               ?};
               skl.add()
            || skl.add()
            ?};
            _lmc+=1;
            _do:=_od-1
         !};
         VAR_DEL.delete('__dane_p');
         ~~}
         {FI}
         {  {? __pzmnb & ~dprac.EDMC
            || skl.prefix('M',0,__Datmc~1,__Datmc~2);
               {? skl.first()
               || FUN.info('Podstawa zasiłku/wynagrodzenia za chorobę liczona z miesiąca nieobecności.\n'
                     'Proszę sprawdzić dane (dni, kwoty, procent).\n\n'
                     'Wprowadzone informacje nie podlegają weryfikacji w programie.'@);
                  {!
                  |? {? skl.edit("_chk:=chk_rec('ROK','MC','DR','S','PR');
                                  {? _chk<>'' || return(_chk) ?};
                                  {? skl.ROK<=999
                                  || FUN.emsg('Podano nieprawidłową wartość w polu: Rok.'@);
                                     return('ROK')
                                  ?};
                                  {? ~(skl.MC>0 & skl.MC<=12)
                                  || FUN.emsg('Podano nieprawidłową wartość w polu: Miesiąc.'@);
                                     return('MC')
                                  ?}; 1")
                  || skl.prefix();
                     skl.put();
                     skl.prefix('M',0,skl.ROK,skl.MC);
                     0
                     || ~FUN.ask('Czy na pewno rezygnujesz?')
                     ?}
                  !}
               ?};
               skl.prefix()
            ?};
            {? dprac.EDMC
            || FUN.info('Funkcja umożliwia edycję wyliczonych miesięcznych podstaw.\n'
                  'Proszę sprawdzić dane (dni, kwoty, procent).\n\n'
                  'Wprowadzone informacje nie podlegają weryfikacji w programie.'@);
               skl.fld_fml('TYP','BLANK',"'M'");
               skl.fld_fml('S','EDIT_FORMAT',"'in_prec=2'");
               skl.fld_fml('S','DISPLAY_FORMAT',"'out_prec=2'");
               skl.fld_fml('Z1','EDIT_FORMAT',"'in_prec=2'");
               skl.fld_fml('Z1','DISPLAY_FORMAT',"'out_prec=2'");
               skl.fld_fml('Z2','EDIT_FORMAT',"'in_prec=2'");
               skl.fld_fml('Z2','DISPLAY_FORMAT',"'out_prec=2'");
               skl.fld_fml('PR','EDIT_FORMAT',"'in_prec=2'");
               skl.fld_fml('PR','DISPLAY_FORMAT',"'out_prec=2'");
               skl.prefix('M',0);
               skl.hdr_sel();
               skl.hdr_sel(': '+dprac.OSOBA);
               skl.select(,1);
               skl.prefix();
               skl.fld_fml('TYP','BLANK',"*");
               skl.fld_fml('S','EDIT_FORMAT',"*");
               skl.fld_fml('S','DISPLAY_FORMAT',"*");
               skl.fld_fml('Z1','EDIT_FORMAT',"*");
               skl.fld_fml('Z1','DISPLAY_FORMAT',"*");
               skl.fld_fml('Z2','EDIT_FORMAT',"*");
               skl.fld_fml('Z2','DISPLAY_FORMAT',"*");
               skl.fld_fml('PR','EDIT_FORMAT',"*");
               skl.fld_fml('PR','DISPLAY_FORMAT',"*")
            ?};

            _fill:="
               skl.prefix(_a);
               {! _nr:=skl.size().._b-1 |! skl.blank(); skl.TYP:=_a; skl.EMPTY:=1; skl.add() !}";

            _fill('M',12);
            _fill('K',4);
            _fill('R',2);
            _fill('X',4);

            ~~
      }
      {SUBSTITUTE: 'pracownik'}
   {FI}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'przypisy'}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'pouczenie'}
   {ENTIRE}
   {FONT: 'T10B'}{SPACE: 'B'}
   {<1>{cil.T10B} 'POUCZENIE'}
   {ENTIRE-}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'wyjasnienia'}
   {ENTIRE}
   {FONT: 'T8'}
   {LINE: 1}
   {FONT: 'T8BI'}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {<1'Informacje wstępne'}
   {FONT: 'T8'}
   {LINE: 1}
   {SUBSTITUTE:
      par[3]:=
'Pracownik nabywa prawo do zasiłku chorobowego po upływie 30 dni nieprzerwanego okresu zatrudnienia (okres wyczekiwania). '+
'Do tego okresu wlicza się poprzednie okresy zatrudnienia lub okresy podlegania ubezpieczeniu chorobowemu (dobrowolnie lub '+
'obowiązkowo) z innego tytułu jeśli przerwa między nimi nie przekroczyła 30 dni lub była spowodowana urlopem bezpłatnym, '+
'urlopem wychowawczym albo odbywaniem czynnej służby wojskowej przez żołnierza niezawodowego. Pracownik ma prawo do '+
'zasiłku chorobowego bez okresu wyczekiwania, jeśli: ';
      'text_out'
   }
   {SUBSTITUTE:
      par[3]:=%255+
'jest absolwentem szkoły lub studiów wyższych i podjął pracę w ciągu 90 dni od ukończenia szkoły lub uzyskania dyplomu, ';
      'ls_item'
   }
   {SUBSTITUTE:
      par[3]:=%255+
'był posłem lub senatorem i podjął pracę w ciągu 90 dni od ukończenia kadencji, ';
      'ls_item'
   }
   {SUBSTITUTE:
      par[3]:=%255+
'posiada co najmniej 10-letni okres obowiązkowego ubezpieczenia chorobowego, ';
      'ls_item'
   }
   {SUBSTITUTE:
      par[3]:=%255+
'jego niezdolność do pracy z powodu choroby jest spowodowana wypadkiem przy pracy, wypadkiem w drodze do pracy lub '+
'z pracy, lub chorobą zawodową ';
      'ls_item'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'W celu udokumentowania prawa do zasiłku chorobowego od pierwszego dnia zatrudnienia, pracownik powinien przedłożyć '+
'odpowiedni dokument np.: dyplom ukończenia studiów, świadectwo pracy z poprzedniego zakładu pracy. ';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8'}
   {LINE: 1}
   {FONT: 'T8B'}{<1'Sekcja:'}{FONT: 'T8BI'}{'Informacje o zaświadczeniach lekarskich'}
   {FONT: 'T8'}
   {LINE: 1}
   {FONT: 'T8B'}
   {<{par[1]} 'Do pkt. 1'}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
'Jeśli pracownik otrzymał zaświadczenie lekarskie na druku ZUS ZLA dołącz je. ';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'Pracownik powinien dostarczyć zaświadczenie lekarskie na druku ZUS ZLA do pracodawcy w ciągu 7 dni od jego otrzymania. '+
'Jeżeli ten termin zostanie przekroczony, zasiłek chorobowy jest obniżany o 25%, od 8 dnia orzeczonej niezdolności do pracy do '+
'dnia dostarczenia zaświadczenia lekarskiego.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'W przypadku kolejnego zaświadczenia lekarskiego wystawionego na druku ZUS ZLA za okres dalszej, nieprzerwanej niezdolności '+
'do pracy nie przesyłaj ponownie zaświadczenia płatnika składek Z-3, podaj jednak datę dostarczenia przez pracownika '+
'zaświadczenia lekarskiego ZUS ZLA oraz, czy zatrudnienie trwa nadal. Informacje te poświadcz pieczątką i podpisem. ';
      'text_out'
   }
   {LINE: 1}
   {FONT: 'T8B'}
   {<{par[1]} 'Do pkt. 2'}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
'Jeśli zaświadczenie lekarskie zostało wystawione pracownikowi w formie elektronicznej (e-ZLA), podaj tylko jego serię oraz '+
'numer (jeżeli je znasz). Jeśli zaświadczenie lekarskie zostało wystawione pracownikowi elektronicznie, nie obowiązują terminy '+
'na jego dostarczenie.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'W przypadku kolejnego zaświadczenia lekarskiego wystawionego elektronicznie za okres nieprzerwanej niezdolności do pracy, ';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'prześlij do ZUS zaświadczenie płatnika składek Z-3, wypełnione do pkt. 1 sekcji Informacje o pracowniku włącznie.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8'}
   {LINE: 1}
   {FONT: 'T8B'}{<1'Sekcja:'}{FONT: 'T8BI'}{'Informacje o pracowniku'}
   {FONT: 'T8'}
   {LINE: 1}
   {FONT: 'T8B'}
   {<{par[1]} 'Do pkt. 1'}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
'Wpisz datę początku i końca zatrudnienia (dzień, miesiąc, rok). W przypadku gdy zatrudnienie trwa, wpisz tylko datę początkową. '+
'Jeśli w trakcie zatrudnienia pracownik miał zmieniany wymiar czasu pracy w pozycji „podaj wymiar czasu pracy” podaj wymiar '+
'czasu pracy obowiązujący pracownika w miesiącu, w którym zachorował. W pozycji „podaj datę od kiedy” podaj datę, od której '+
'pracownik pracuje w aktualnym wymiarze czasu pracy.';
      'text_out'
   }
   {LINE: 1}
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8B'}
   {<{par[1]} 'Do pkt. 4'}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
'Jeśli niezdolność do pracy jest spowodowana wypadkiem przy pracy, wypadkiem w drodze do pracy lub z pracy do wniosku o zasiłek '+
'chorobowy powinien być dołączony protokół lub karta wypadku. W przypadku choroby zawodowej dołącz decyzję o stwierdzeniu '+
'choroby zawodowej i zaświadczenie lekarza, które stwierdza, że niezdolność do pracy pracownika jest spowodowana chorobą '+
'zawodową.';
      'text_out'
   }
   {LINE: 1}
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8B'}
   {<{par[1]} 'Do pkt. 6'}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
'Jeśli pracownik ubiega się o zasiłek macierzyński, wpisz okres udzielonego urlopu macierzyńskiego, urlopu na warunkach urlopu '+
'macierzyńskiego, urlopu rodzicielskiego lub urlopu ojcowskiego.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'Jeżeli urlop rodzicielski/ urlop ojcowski udzielany jest w więcej niż jednej części, wpisz okresy urlopów udzielonych w tych '+
'częściach oraz datę złożenia wniosków o poszczególne części urlopu rodzicielskiego/ urlopu ojcowskiego.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8'}
   {LINE: 1}
   {FONT: 'T8B'}{<1'Sekcja:'}{FONT: 'T8BI'}{'Informacje o wypłaconych świadczeniach'}
   {FONT: 'T8'}
   {LINE: 1}
   {FONT: 'T8B'}
   {<{par[1]} 'Do pkt. 1'}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
'Jeżeli w poprzednim roku kalendarzowym wypłaciłeś pracownikowi wynagrodzenie chorobowe na podstawie art. 92 Kodeksu '+
'pracy, za okresy wliczane do jednego okresu zasiłkowego, podaj również okresy wypłaty wynagrodzenia w poprzednim roku.';
      'text_out'
   }
   {LINE: 1}
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8B'}
   {<{par[1]} 'Do pkt. 1 i 2'}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
'Do jednego okresu zasiłkowego wlicza się wszystkie okresy nieprzerwanej niezdolności do pracy, oraz okresy przedzielone '+
'przerwą, o ile przerwa pomiędzy ustaniem poprzedniej a powstaniem ponownej niezdolności do pracy, która jest spowodowana '+
'tą samą chorobą lub tą samą przyczyną, nie przekraczała 60 dni.';
      'text_out'
   }
   {LINE: 1}
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8B'}
   {<{par[1]} 'Do pkt. 3'}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
'Jeśli z pracownicą umowa o pracę została przedłużona do dnia porodu, a płatnik składek byłby zobowiązany do wypłaty zasiłku '+
'macierzyńskiego tylko za jeden dzień, wypłaty zasiłku za cały okres dokonuje ZUS.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8'}
   {LINE: 1}
   {FONT: 'T8B'}{<1'Sekcja:'}{FONT: 'T8BI'}{'Pozostałe informacje'}
   {FONT: 'T8'}
   {LINE: 1}
   {SUBSTITUTE:
      par[3]:=
'Liczbę ubezpieczonych, ustala się według stanu na dzień 30 listopada poprzedniego roku kalendarzowego. Jeśli na ten dzień '+
'płatnik składek nie zgłaszał nikogo do ubezpieczenia chorobowego, liczbę ubezpieczonych ustala się według stanu na pierwszy '+
'miesiąc, w którym dokonał takiego zgłoszenia.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8'}
   {LINE: 1}
   {FONT: 'T8B'}{<1'Sekcja:'}{FONT: 'T8BI'}{'Informacje o składnikach wynagrodzenia'}
   {FONT: 'T8'}
   {LINE: 1}
   {FONT: 'T8B'}
   {<{par[1]} 'Informacje ogólne:'}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
'W tabelach podaj kwoty składników wynagrodzenia niepomniejszone o składki na ubezpieczenia społeczne.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'Podaj wyłącznie składniki wynagrodzenia uwzględniane przy obliczaniu podstawy wymiaru zasiłku. Nie wykazuj takich składników '+
'wynagrodzenia, do których pracownik zachowuje prawo za okres pobierania zasiłku i które są mu wypłacane za okres pobierania '+
'zasiłku oraz składników wynagrodzenia, na których przyznanie i wypłatę pobieranie zasiłków nie ma żadnego wpływu, takich jak '+
'm.in.: jednorazowe zasiłki na zagospodarowanie, wartość szczepień ochronnych finansowanych przez pracodawcę, wartość badań '+
'mammograficznych lub innych nieodpłatnych badań, nagrody za ukończenie przez pracownika szkoły (studiów), sfinansowanie '+
'lub dofinansowanie przez pracodawcę kosztów wynajmu mieszkania przez pracownika, dopłata pracodawcy do dodatkowego '+
'ubezpieczenia pracownika z tytułu różnych ryzyk, bony lub wypłaty w gotówce przyznawane w jednakowej wysokości lub według '+
'jednakowego wskaźnika procentowego w stosunku do płacy pracownika, określonej w umowie o pracę, wszystkim pracownikom '+
'lub grupom pracowników, z okazji uroczystych dni, świąt, rocznicy powstania firmy itp. Jeśli zasiłek przysługuje za okres po '+
'ustaniu zatrudnienia, podaj wszystkie składniki wynagrodzenia, które stanowiły podstawę wymiaru składek na ubezpieczenie '+
'chorobowe pracownika, także te do których pracownik zachowywał prawo za okres pobierania zasiłku oraz na których przyznanie '+
'i wypłatę pobieranie zasiłków nie miało wpływu.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'Wynagrodzenie za urlop wypoczynkowy traktuje się na równi z wynagrodzeniem za pracę.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'Składniki wynagrodzenia, które przysługują do określonego terminu uwzględnia się w podstawie wymiaru zasiłku, który przysługuje '+
'tylko do tego terminu. W związku z tym w tabelach nie podawaj składników przyznanych do określonego terminu, jeżeli zasiłek '+
'przysługuje za okres po upływie tego terminu. Jeżeli okres, do którego składnik jest przyznany nie upłynął przed rozpoczęciem '+
'niezdolności do pracy, podaj w pkt. 5 okres, do którego składnik wynagrodzenia przysługuje, oraz jego kwotę.';
      'text_out'
   }
   {LINE: 1}
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8B'}
   {<{par[1]} 'Do pkt. 1 (tabele Składniki wynagrodzenia za okresy miesięczne)'}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
'Podaj wynagrodzenie wypłacone pracownikowi za okres 12 miesięcy kalendarzowych poprzedzających miesiąc, w którym '+
'powstała nieprzerwana niezdolność do pracy. Jeśli pracownik przed okresem tej nieprzerwanej niezdolności do pracy pobierał '+
'zasiłek albo wynagrodzenie chorobowe oraz przerwa między okresami pobierania zasiłku/ wynagrodzenia chorobowego była '+
'krótsza niż 3 miesiące kalendarzowe, podaj wynagrodzenie za okres poprzedzający miesiąc, w którym powstała najwcześniejsza '+
'z niezdolności do pracy. W razie zmiany wymiaru czasu pracy w okresie 12 miesięcy kalendarzowych poprzedzających powstanie '+
'niezdolności do pracy albo w miesiącu, w którym powstała niezdolność do pracy, podaj wynagrodzenie tylko za pełne kalendarzowe '+
'miesiące po zmianie wymiaru czasu pracy. Wynagrodzenie określone dla nowego wymiaru czasu pracy podaj również, jeśli '+
'pomiędzy okresami pobierania zasiłków zarówno tego samego rodzaju, jak i innego rodzaju nie było przerwy albo przerwa była '+
'krótsza niż 3 miesiące kalendarzowe.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'Jeżeli pracownik otrzymuje wynagrodzenie zasadnicze lub inne składniki miesięczne w stałej wysokości, w tym wynagrodzenie '+
'godzinowe, w kolumnie 6 tabeli podaj je w pełnej kwocie określonej w umowie o pracę lub innym akcie nawiązującym '+
'stosunek pracy.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'W przypadku pracownika tymczasowego podaj kwotę ustaloną odpowiednio do okresu umowy o pracę tymczasową.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'W przypadku pracownika, który wykonuje pracę za granicą, kwoty które są podstawą wymiaru składki na ubezpieczenie chorobowe '+
'wykaż bez uzupełnienia.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'Jeżeli w miesiącu, z którego wynagrodzenie jest uwzględniane przy ustalaniu podstawy wymiaru zasiłku, przychód pracownika '+
'przekroczył roczną podstawę wymiaru składek na ubezpieczenia emerytalne i rentowe, oblicz średni wskaźnik potrąconej '+
'pracownikowi za ten miesiąc składki na ubezpieczenia społeczne w następujący sposób:';
      'text_out'
   }
   {LINE: 1}
   {FONT: 'T8u'}{<1>{par[2]} 'kwota potrąconej składki x 100' }
   {FONT: 'T8'}{<1>{par[2]} 'przychód stanowiący podstawę wymiaru składek' }
   {LINE: 1}
   {SUBSTITUTE:
      par[3]:=
'Jeżeli pracownik otrzymuje wynagrodzenie zmienne:';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=%255+
'w kolumnie 7 tabeli podaj wynagrodzenie zasadnicze i inne składniki wynagrodzenia, które są pomniejszane proporcjonalnie za '+
'okres pobierania zasiłku i w związku z tym w podstawie wymiaru zasiłku będą uwzględnione po uprzednim uzupełnieniu przez ZUS,';
      'ls_item'
   }
   {SUBSTITUTE:
      par[3]:=%255+
'w kolumnie 8 tabeli podaj składniki wynagrodzenia, które są zmniejszane za okres pobierania zasiłku w inny sposób niż '+
'proporcjonalnie i w związku z tym w podstawie wymiaru zasiłku będą uwzględnione w kwocie faktycznie wypłaconej bez '+
'uzupełniania, np. wynagrodzenie za pracę w godzinach nadliczbowych wraz z dopłatami.';
      'ls_item'
   }
   {ENTIRE-}
   {ENTIRE}
   {LINE: 1}
   {FONT: 'T8B'}
   {<{par[1]} 'Do pkt. 2, 3, 4 (tabele Składniki wynagrodzeń za okresy kwartalne, roczne oraz inne okresy)'}
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
'W tabelach zamieszczonych w pkt. 2, 3, 4, kolumny dotyczące liczby dni, które pracownik przepracował lub był obowiązany '+
'przepracować, wypełnij tylko wtedy, gdy składnik wynagrodzenia odpowiednio kwartalny, roczny lub za inne okresy jest składnikiem '+
'pomniejszanym proporcjonalnie za okresy pobierania zasiłku.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {LINE: 1}
   {FONT: 'T8B'}
   {SUBSTITUTE:
      par[3]:=
'Do pkt. 5 (dane o wynagrodzeniu z tytułu wykonywania umowy zlecenia, umowy agencyjnej lub innej umowy o świadczenie '+
'usług oraz o składnikach wynagrodzenia, które przysługują pracownikowi do określonego terminu)';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
'Jeżeli pracownikowi przysługuje składnik wynagrodzenia do określonego terminu i termin ten nie upłynął przed rozpoczęciem '+
'niezdolności do pracy, podaj datę, do której składnik wynagrodzenia przysługuje oraz kwoty wypłacone pracownikowi za poszczególne '+
'miesiące, z których wynagrodzenie jest przyjmowane do ustalenia podstawy wymiaru zasiłku. Wynagrodzenie z tytułu wykonywania '+
'umowy zlecenia, umowy agencyjnej lub innej umowy o świadczenie usług, do której zgodnie z Kodeksem cywilnym stosuje się '+
'przepisy dotyczące zlecenia albo umowy o dzieło, zawartej po dniu 13 stycznia 2000 r. z pracodawcą, z którym osoba ta pozostaje '+
'w stosunku pracy, lub jeżeli w ramach takiej umowy wykonuje pracę na rzecz pracodawcy, traktuje się jako składnik wynagrodzenia '+
'przysługujący do określonego terminu. Jeżeli okres, na który umowa jest zawarta, nie upłynął przed rozpoczęciem niezdolności '+
'do pracy, podaj okres, na jaki umowa została zawarta oraz przychód osiągnięty z tytułu wykonywania tej umowy, w rozbiciu na '+
'poszczególne miesiące, z których wynagrodzenie jest przyjmowane do ustalenia podstawy wymiaru zasiłku.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8'}
   {LINE: 1}
   {FONT: 'T8B'}{<1'Sekcja:'}{FONT: 'T8BI'}{'Uwagi'}
   {FONT: 'T8'}
   {LINE: 1}
   {SUBSTITUTE:
      par[3]:=
'Podstawy wymiaru zasiłku nie ustala się na nowo, jeżeli między okresami pobierania zasiłków tego samego rodzaju, jak i innego rodzaju '+
'nie było przerwy albo przerwa była krótsza niż 3 miesiące kalendarzowe. Jeżeli w związku z tym w tabelach podałeś wynagrodzenie '+
'pracownika z innego okresu niż 12 miesięcy kalendarzowych poprzedzających powstanie niezdolności do pracy, w sekcji Uwagi '+
'podaj dodatkowo poprzedni(e) okres(y) pobierania zasiłku lub wynagrodzenia za okres choroby, jeżeli nie zostały wykazane w sekcji '+
'Informacje o wypłaconych świadczeniach. W przypadku gdy wynagrodzenie pracownika, które stanowi podstawę wymiaru zasiłku wraz '+
'ze składnikami przysługującymi za okres pobierania zasiłku jest na poziomie minimalnego wynagrodzenia za pracę, w sekcji Uwagi '+
'podaj miesięczne kwoty składników wynagrodzenia, do których pracownik zachowuje prawo za okres niezdolności do pracy.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[3]:=
'Jeśli w okresie 12 miesięcy kalendarzowych poprzedzających powstanie niezdolności do pracy albo w miesiącu, w którym '+
'powstała niezdolność do pracy, zmienił się wymiar czasu pracy, w sekcji Uwagi podaj poprzedni wymiar czasu pracy, a w tabeli '+
'w pkt. 1 podaj wynagrodzenie ustalone dla nowego wymiaru czasu pracy.';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8'}
   {LINE: 1}
   {FONT: 'T8B'}{<1'Sekcja:'}{FONT: 'T8BI'}{'Rachunek bankowy'}
   {FONT: 'T8'}
   {LINE: 1}
   {SUBSTITUTE:
      par[3]:=
'Podaj, jeśli pracownik wyraził wolę otrzymywania zasiłku na rachunek bankowy.';
      'text_out'
   }
   {LINE: 1}
   {ENTIRE-}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'uwaga'}
   {ENTIRE}
   {FONT: 'T8B'}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {SUBSTITUTE:
      par[3]:=
'Ważne!';
      'text_out'
   }
   {FONT: 'T8B'}
   {SUBSTITUTE:
      par[3]:=
'Zaświadczenie płatnika składek Z-3 złóż ponownie, jeśli zmieni się rodzaj pobieranego przez pracownika zasiłku. Nie '+
'dotyczy to świadczenia rehabilitacyjnego, jeżeli zaświadczenie płatnika składek złożyłeś do ustalenia prawa do zasiłku '+
'chorobowego.';
      'text_out'
   }
   {FONT: 'T8B'}
   {SUBSTITUTE:
      par[3]:=
'Poinformuj placówkę ZUS o okolicznościach mających wpływ na prawo, wysokość i podstawę wymiaru zasiłku, które '+
'uległy zmianie w stosunku do podanych w zaświadczeniu płatnika składek, w szczególności o ustaniu zatrudnienia albo '+
'o podjęciu przez pracownika korzystającego z urlopu rodzicielskiego pracy w wymiarze nie wyższym niż połowa etatu. '+
'Do wniosku o zasiłek chorobowy, zasiłek opiekuńczy, zasiłek macierzyński, zasiłek w wysokości zasiłku macierzyńskiego, '+
'zasiłek wyrównawczy oraz świadczenie rehabilitacyjne dołącz otrzymane od pracownika dokumenty określone '+
'w rozporządzeniu Ministra Rodziny, Pracy i Polityki Społecznej z 8 grudnia 2015 r. w sprawie zakresu informacji '+
'o okolicznościach mających wpływ na prawo do zasiłków z ubezpieczenia społecznego w razie choroby i macierzyństwa '+
'lub ich wysokość oraz dokumentów niezbędnych do przyznania i wypłaty zasiłków.';
      'text_out'
   }
   {LINE: 1}
   {FONT: 'T8B'}
   {SUBSTITUTE:
      par[3]:=
'Podstawa prawna: ustawa z dnia 25 czerwca 1999 r. o świadczeniach pieniężnych z ubezpieczenia społecznego w razie '+
'choroby i macierzyństwa, ustawa z dnia 30 października 2002 r. o ubezpieczeniu społecznym z tytułu wypadków przy pracy '+
'i chorób zawodowych oraz rozporządzenie Ministra Rodziny, Pracy i Polityki Społecznej z 8 grudnia 2015 r. w sprawie '+
'zakresu informacji o okolicznościach mających wpływ na prawo do zasiłków z ubezpieczenia społecznego w razie choroby '+
'i macierzyństwa lub ich wysokość oraz dokumentów niezbędnych do przyznania i wypłaty zasiłków.';
      'text_out'
   }
   {ENTIRE-}
   {FOOTER}
      { par[5]:=~par[5]; ~~}
   {FOOTER-}
{MACRO-}
{MACRO: 'h_start'}
   {HEADER}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {FONT: 'TITLE'}{SPACE: 'A'}{>{charleft}'Z-3'}
   {FONT: 'T8B'}{SPACE: 'C'}
   {<2 ('─'*(cil.T8B-1))}
   {HEADER-}
{MACRO-}
{MACRO: 'h_stop'}
   {HEADER}{HEADER-}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{MACRO: 'pracownik'}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{COMMENT}                                          STRONA 1                                                   {COMMENT-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
   {ENTIRE}
   {page(1);~~}
   {SUBSTITUTE: 'h_start'}
   {FONT: 'T8G'}{SPACE: 'C'}
   {LINE: 1}
   {<2'┌────────────────────────────────────────────┐'}
   {<2'│                                            │'}
   {<2'│                                            │'}
   {<2'│                                            │'}{FONT: 'TITLE'}{SPACE: 'A'}{<50'ZAŚWIADCZENIE PŁATNIKA SKŁADEK'
                                                                                  }{FONT: 'T8G'}{SPACE: 'C'}
   {<2'│                                            │'}
   {<2'│                                            │'}
   {<2'│                                            │'}
   {<2'└────────────────────────────────────────────┘'}
   {<2' Pieczątka płatnika składek, jeśli ją posiadasz'}
   {FONT: 'TITLE'}{SPACE: 'B'}
   {LINE: 1}
   {FONT: 'T8B'}{SPACE: 'C'}
   {<2 'Instrukcja wypełniania'}
   {<2 ('─'*(cil.T8B-1))}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
           'Wypełnij to zaświadczenie i przekaż je do nas, jeśli Twojemu pracownikowi mamy ustalić prawo do zasiłku '
           'chorobowego, zasiłku opiekuńczego, zasiłku macierzyńskiego, zasiłku w wysokości zasiłku macierzyńskiego, '
           'zasiłku wyrównawczego lub świadczenia rehabilitacyjnego.';
      'text_out'
   }
   {SUBSTITUTE:
      par[3]:=
           '1. Wypełnij WIELKIMI LITERAMI';
      'text_out'
   }
   {SUBSTITUTE:
      par[3]:=
           '2. Pola wyboru zaznacz znakiem X';
      'text_out'
   }
   {SUBSTITUTE:
      par[3]:=
           '3. Wypełnij kolorem czarnym lub niebieskim (nie ołówkiem)';
      'text_out'
   }
   {SUBSTITUTE:
      par[3]:=
           '4. Zanim wypełnisz zaświadczenie, zapoznaj się z Pouczeniem';
      'text_out'
   }
   {LINE: 1}
   {ENTIRE-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
   {ENTIRE}
   {FONT: 'T8B'}{SPACE: 'C'}
   {<2 'Dane płatnika składek'}
   {<2 ('─'*(cil.T8B-1))}
   {FONT: 'T8G'}{SPACE: 'C'}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=form(gsub(~(-KST.NIP),'-'),10);
      par[6]:='NIP';
      par[7]:='';
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:={? ~+|KST.NIP || form(gsub(~(-KST.REG),'-'),10) || ' '*10 ?};
      par[6]:='Numer REGON';
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:=cil.T8B;
      par[3]:=
           'Jeśli nie podałeś NIP, podaj REGON';
      'text_out'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:={? ~+(|KST.NIP+|KST.REG) || form(gsub(~(-KST.PESEL),'-'),11) || ' '*11 ?};
      par[6]:='Numer PESEL';
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:=cil.T8;
      par[3]:=
           'Jeśli nie masz nadanego NIP i REGON, podaj PESEL';
      'text_out'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:='';
      par[6]:='Rodzaj, seria i numer dokumentu potwierdzającego tożsamość';
      par[7]:=' ';
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:=cil.T8;
      par[3]:=
           'Jeśli nie masz nadanego NIP, REGON i PESEL, podaj serię i numer dokumentu potwierdzającego tożsamość';
      'text_out'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=~-KST.SKROT;
      par[6]:='Nazwa albo imię i nazwisko';
      par[7]:=' ';
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=~-KST.ULICA;
      par[6]:='Ulica';
      par[7]:=' ';
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {ENTIRE-}
   {DIRECT}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=form(~-KST.DOM,14);
      par[6]:='Numer domu';
      par[7]:=' ';
      par[8]:=1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=94;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=~-KST.LOKAL;
      par[6]:='Numer lokalu';
      par[7]:=' ';
      par[8]:=1;
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {DIRECT-}
   {par[8]:=~~}
   {DIRECT}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=
         {? KST.KRAJ().SYM<>'PL'
         || form('',14)
         || form(~(-KST.KOD),14)
         ?};
      par[6]:='Kod pocztowy';
      par[7]:=' ';
      par[8]:=1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=94;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=~-KST.MIASTO;
      par[6]:='Miejscowość';
      par[7]:=' ';
      par[8]:=1;
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {par[8]:=~~}
   {DIRECT-}
   {ENTIRE}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=
         {? KST.KRAJ().SYM='PL'
         || ''
         || ~-KST.KRAJ().NAZ
         ?};
      par[6]:='Nazwa państwa';
      par[7]:=' ';
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:=cil.T8;
      par[3]:=
           'Podaj, jeśli Twój adres jest inny niż polski';
      'text_out'
   }
   {ENTIRE-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
   {ENTIRE}
   {FONT: 'T8B'}{SPACE: 'C'}
   {<2 'Dane osoby ubezpieczonej'}
   {<2 ('─'*(cil.T8B-1))}
   {FONT: 'T8G'}{SPACE: 'C'}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=form(~-OSOBA.PESEL,11);
      par[6]:='Numer PESEL';
      par[7]:='';
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=
         {? OSOBA.PESEL=''
         || {? OSOBA.DOWOD<>''
            || 'dowód '+gsub(~-OSOBA.DOWOD,' ','')
            |? OSOBA.PASZPORT<>''
            || 'paszport '+gsub(~-OSOBA.PASZPORT,' ','')
            || ''
            ?}
         || ''
         ?};
      par[6]:='Rodzaj, seria i numer dokumentu potwierdzającego tożsamość';
      par[7]:=' ';
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:=cil.T8;
      par[3]:=
           'Jeśli nie ma nadanego PESEL, podaj serię i numer dokumentu potwierdzającego tożsamość';
      'text_out'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=~-OSOBA.PIERWSZE;
      par[6]:='Imię';
      par[7]:=' ';
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=~-OSOBA.NAZWISKO;
      par[6]:='Nazwisko';
      par[7]:=' ';
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {  {? ~exec('szukaj','osoba',{? 'SCK'*(~-dprac.ADR) || ~-dprac.ADR || 'S' ?})
      || OS_ADRES.blank(1)
      ?};
   ~~}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=~-OS_ADRES.ULICA;
      par[6]:='Ulica';
      par[7]:=' ';
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {ENTIRE-}
   {DIRECT}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=form(~-OS_ADRES.DOM,14);
      par[6]:='Numer domu';
      par[7]:=' ';
      par[8]:=1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=94;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=form(~-OS_ADRES.LOKAL,(ceil((cil.T8-par[1])/2)));
      par[6]:='Numer lokalu';
      par[7]:=' ';
      par[8]:=1;
      'kratki'
   }
   {DIRECT-}
   {par[8]:=~~}
   {DIRECT}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=
         {? OS_ADRES.KRAJ().SYM<>'PL'
         || form('',14)
         || form(~-OS_ADRES.KOD,14)
         ?};
      par[6]:='Kod pocztowy';
      par[7]:=' ';
      par[8]:=1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=94;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=~-OS_ADRES.MIASTO;
      par[6]:='Miejscowość';
      par[7]:=' ';
      par[8]:=1;
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {DIRECT-}
   {par[8]:=~~}
   {ENTIRE}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=
         {? OS_ADRES.KRAJ().SYM='PL'
         || ''
         || ~-OS_ADRES.KRAJ().NAZ
         ?};
      par[6]:='Nazwa państwa';
      par[7]:=' ';
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:=cil.T8;
      par[3]:=
           'Podaj, jeśli Twój adres jest inny niż polski';
      'text_out'
   }
   {ENTIRE-}
   {IF: lineleft()}{PAGE}{FI}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{COMMENT}                                          STRONA 2                                                   {COMMENT-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
   {ENTIRE}
   {LINE: 1}
   {FONT: 'T8B'}{SPACE: 'C'}
   {<2 'Pracownik występuje o:'}
   {<2 ('─'*(cil.T8B-1))}
   {FONT: 'T8'}
   {<3}┌───┐                               ┌───┐                       ┌───┐
   {<3 '│ '+zs.C+' │ zasiłek chorobowy             │ '+zs.O+' │ zasiłek opiekuńczy    │ '+zs.M+' │ zasiłek macierzyński'}
   {<3}└───┘                               └───┘                       └───┘
   {<3}┌───┐                               ┌───┐                       ┌───┐
   {<3 '│ '+zs.R+' │ zasiłek w wysokości zasiłku   │ '+zs.W+' │ zasiłek wyrównawczy   │ '+zs.S+' │ świadczenie rehabilitacyjne'}
   {<3}└───┘ macierzyńskiego               └───┘                       └───┘
   {SUBSTITUTE:
      par[1]:=40;
      par[2]:='T8';
      par[3]:='T8';
      _txt:='od: '+oz[1]+oz[2]+'/'+oz[3]+oz[4]+'/'+oz[5]+oz[6]+oz[7]+oz[8]+' do: '+dz[1]+dz[2]+'/'+dz[3]+dz[4]+
         '/'+dz[5]+dz[6]+dz[7]+dz[8];
      par[4]:={? +form(oz[1]) || _txt || '' ?};
      par[6]:='za okres';
      par[7]:=' ';
      par[9]:=4;
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=40;
      par[2]:=cil.T8;
      par[3]:=
           'Podaj okres od–do';
      'text_out'
   }
   {LINE: 1}
   {FONT: 'T8B'}{SPACE: 'C'}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {<2 'Informacje o zaświadczeniach lekarskich'}
   {<2 ('─'*(cil.T8B-1))}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[3]:=
           'Wypełnij, gdy pracownik wystąpił o zasiłek chorobowy lub zasiłek opiekuńczy z powodu opieki nad chorym dzieckiem lub '
           'innym chorym członkiem rodziny';
      'text_out'
   }
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:={? dprac.ZLADD<>date(0,0,0) & dprac.EZLA='N' || 'T' || 'N' ?};
      par[6]:='1. Czy załączasz zaświadczenie lekarskie';
      par[7]:=100;
      'tak_nie'
   }
   {SUBSTITUTE:
      _txt:={? dprac.ZLADD<>date(0,0,0) & dprac.EZLA='N'
            || 'wpłynęło do płatnika składek w dniu '+dprac.ZLADD$4+' r.'
            || ''
            ?};
      par[1]:=4;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=_txt;
      par[6]:='';
      par[7]:=' ';
      par[9]:=4;
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {par[9]:=~~}
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:=cil.T8;
      par[3]:=
           'Jeśli TAK, podaj datę, kiedy wpłynęło do płatnika składek';
      'text_out'
   }
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=dprac.EZLA;
      par[6]:='2. Czy zaświadczenie lekarskie zostało wystawione w formie elektronicznej (e-ZLA)';
      par[7]:=100;
      'tak_nie'
   }
   {SUBSTITUTE:
      _txt:={? dprac.EZLA='T' || dprac.ZLASN  || '' ?};
      par[1]:=4;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=_txt;
      par[6]:='';
      par[7]:=' ';
      par[9]:=4;
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {par[9]:=~~}
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:=cil.T8;
      par[3]:=
           'Jeśli TAK, podaj, jeśli znasz – serię i numer zaświadczenia lekarskiego';
      'text_out'
   }
   {ENTIRE-}
   {LINE: 1}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
   {ENTIRE}
   {FONT: 'T8B'}{SPACE: 'C'}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {<2 'Informacje o pracowniku'}
   {<2 ('─'*(cil.T8B-1))}
   {ENTIRE-}
   {DIRECT}
   {FONT: 'T8'}
   {SUBSTITUTE:
      _txt:='od dnia '+P.DZA$4+' r. do dnia '+P.DZ$4+' r. ';
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=_txt;
      par[6]:='';
      par[7]:=' ';
      par[9]:=4;
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {line(3);~~}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:=cil.T8;
      par[3]:=
           '1. Jest zatrudniony';
      'text_out'
   }
   {DIRECT-}
   {ENTIRE}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:=cil.T8;
      par[3]:=
           'Podaj datę, od kiedy jest zatrudniony lub okres zatrudnienia od–do';
      'text_out'
   }
   {ENTIRE-}
   {DIRECT}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=form({? dprac.WYMIAR='1' || 'pełny etat' || dprac.WYMIAR+' etatu' ?},30);
      par[6]:='';
      par[7]:=' ';
      par[9]:=4;
      'kratki'
   }
   {line(1);~~}
   {SUBSTITUTE:
      par[1]:=94;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=dprac.LWYOD$4+' r.';
      par[6]:='';
      par[7]:=' ';
      par[9]:=4;
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {par[9]:=~~}
   {line(3);~~}
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:=cil.T8;
      par[3]:=
           'w wymiarze czasu pracy';
      'text_out'
   }
   {line(7);~~}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:=cil.T8;
      par[3]:=
           'Podaj wymiar czasu pracy';
      'text_out'
   }
   {line(7);~~}
   {SUBSTITUTE:
      par[1]:=94;
      par[2]:=cil.T8;
      par[3]:=
           'Podaj datę, od kiedy jest zatrudniony w tym wymiarze (dd/mm/rrrr)';
      'text_out'
   }
   {DIRECT-}
   {ENTIRE}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=dprac.CZY_TMP;
      par[6]:='2. Czy jest zatrudniony na podstawie umowy o pracę tymczasową';
      par[7]:=100;
      'tak_nie'
   }
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=dprac.CZY_OUT;
         par[6]:='3. Czy wykonuje pracę za granicą';
      par[7]:=100;
      'tak_nie'
   }
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:=cil.T8;
      par[3]:=
           '4. Czy niezdolność do pracy powstała z powodu';
      'text_out'
   }
   {<3'┌───┐                         ┌───┐                          ┌───┐'}
   {<3'│ '+ {? dprac.KPOWNIE='C' || 'X' || ' ' ?}+' │ choroby zawodowej       │ '+
            {? dprac.KPOWNIE='W' || 'X' || ' ' ?}+' │ wypadku przy pracy       │ '+
            {? dprac.KPOWNIE='P' || 'X' || ' ' ?}+' │ wypadku w drodze do pracy lub z pracy'}
   {<3'└───┘                         └───┘                          └───┘'}
   {ENTIRE-}
   {DIRECT}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:={? +dprac.PROT || 'T' || 'N' ?};
      par[6]:='';
      par[7]:=3;
      'tak_nie'
   }
   {line(1);~~}
   {SUBSTITUTE:
      _txt:={? +dprac.PROT || dprac.PROT+' z dnia '+dprac.DZDARZ$4+' r.' || '' ?};
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=_txt;
      par[6]:='';
      par[7]:=' ';
      par[9]:=4;
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:=cil.T8;
      par[3]:=
           'Jeśli TAK, podaj dokument potwierdzający (decyzja/ protokół karta wypadku), numer oraz datę jego sporządzenia';
      'text_out'
   }
   {DIRECT-}
   {IF: lineleft()}{PAGE}{FI}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{COMMENT}                                          STRONA 3                                                   {COMMENT-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
   {ENTIRE}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:=cil.T8;
      par[3]:=
           '5. Czy w okresie niezdolności do pracy z powodu choroby, sprawowania opieki lub macierzyństwa';
      'text_out'
   }
   {ENTIRE-}
   {DIRECT}
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:='korzysta z urlopu bezpłatnego';
      par[6]:='';
      par[7]:=4;
      par[8]:='';
      'kwadrat'
   }
   {line(1);~~}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:='przebywa w areszcie tymczasowym';
      par[6]:='';
      par[7]:=50;
      par[8]:='';
      'kwadrat'
   }
   {DIRECT-}
   {DIRECT}
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:='korzysta z urlopu wychowawczego';
      par[6]:='';
      par[7]:=4;
      par[8]:='';
      'kwadrat'
   }
   {line(1);~~}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:='odbywa karę pozbawienia wolności';
      par[6]:='';
      par[7]:=50;
      par[8]:='';
      'kwadrat'
   }
   {DIRECT-}
   {DIRECT}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:='N';
      par[6]:='';
      par[7]:=4;
      'tak_nie'
   }
   {line(1);~~}
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=form('',cil.T8-par[1]-1);
      par[6]:='';
      par[7]:=' ';
      par[9]:=4;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=50;
      par[2]:=cil.T8;
      par[3]:=
           'Jeśli TAK, podaj okresy od–do';
      'text_out'
   }
   {LINE: 1}
   {DIRECT-}
   {ENTIRE}
   {SUBSTITUTE:
      __typUrl:='';
      {? dprac.KZAS='M' & __n_mac.first()
      || __n_mac.select();
         _opis:=sql('select distinct TYP from :_a',__n_mac);
         {? _opis.first()
         || {!
            |? __typUrl+=
                  {? _opis.TYP='macierzyńskiego' || 'M'
                  |? _opis.TYP='dodatkowego urlopu macierzyńskiego' || 'D'
                  |? _opis.TYP='urlopu ojcowskiego' || 'O'
                  |? _opis.TYP='urlopu rodzicielskiego' || 'R'
                  || ''
                  ?};
               _opis.next()
            !}
         ?}
      ?};
      par[1]:=1;
      par[2]:=cil.T8;
      par[3]:=
           '6. Pracownikowi udzielono (wypełnij, jeśli pracownik występuje o zasiłek macierzyński)';
      'text_out'
   }
   {ENTIRE-}
   {DIRECT}
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:='urlopu macierzyńskiego';
      par[6]:='';
      par[7]:=4;
      par[8]:={? __typUrl*'M' || 'X' || '' ?};
      'kwadrat'
   }
   {line(1);~~}
   {SUBSTITUTE:
      par[1]:=60;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:='urlopu rodzicielskiego';
      par[6]:='';
      par[7]:=60;
      par[8]:={? __typUrl*'R' || 'X' || '' ?};
      'kwadrat'
   }
   {DIRECT-}
   {DIRECT}
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:='urlopu na warunkach urlopu macierzyńskiego';
      par[6]:='';
      par[7]:=4;
      par[8]:={? __typUrl*'D' || 'X' || '' ?};
      'kwadrat'
   }
   {line(1);~~}
   {SUBSTITUTE:
      par[1]:=60;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:='urlopu ojcowskiego';
      par[6]:='';
      par[7]:=60;
      par[8]:={? __typUrl*'O' || 'X' || '' ?};
      'kwadrat'
   }
   {DIRECT-}
   {ENTIRE}
   {SUBSTITUTE:
      par[1]:=4;
      _txt:='';
      {? dprac.KZAS='M' & __n_mac.first()
      || {!
         |? _nap:=
               'od dnia '+__n_mac.OD$4+' r. do dnia '+__n_mac.DO$4+' r. '+
               {? __n_mac.DAT_WNIO<>date(0,0,0) || ' data wniosku '+__n_mac.DAT_WNIO$4+' r.' || '' ?}+'; ';
            _txt+=_nap+(' '*(cil.T8-par[1]-1-(+_nap)));
            __n_mac.next()
         !}
      ?};
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=_txt;
      par[6]:='';
      par[7]:=' ';
      par[9]:={? __n_mac.size()>4 || __n_mac.size() || 4 ?};
      par[10]:=cil.T8-par[1]-1;
      par[11]:=1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:=cil.T8;
      par[3]:=
           'Podaj okres od–do oraz datę wniosku';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:='T8';
      par[3]:='T8';
      {? var_press('__przeb')>0 || &__przeb ?};
      _sql:=sql('select * from :_a where TYP like \'%urlopu rodzicielskiego%\'',__n_mac);
      __przeb:=tab_tmp(1
         ,'OD','DATE','Data od'
         ,'DO','DATE','Data do'
         ,'WYM','STRING[50]','wymiar'
         );
      {? _sql.first()
      || H.index('_HISTKOD');
         H.prefix(P.ref(),'Z',);
         {! |?
            {? H.first()
            || {! |?
                  {? var_pres('MAC',H)>0 & H.MAC='T' & H.OD<=_sql.OD & (H.DO>=_sql.OD | H.DO=#0)
                  || __przeb.OD:={? H.OD<_sql.OD || _sql.OD || H.OD ?};
                     __przeb.DO:={? H.DO>_sql.DO | H.DO=#0 || _sql.DO || H.DO ?};
                     __przeb.WYM:={? H.WY=1 || '1' || $H.WYL+'/'+$H.WYM ?};
                     {? ~__przeb.find_rec()
                     || __przeb.add()
                     ?}
                  ?};
                  H.next()
               !}
            ?};
            _sql.next()
         !}
      ?};
      par[4]:=
         {? __typUrl*'R' & __przeb.first() || 'T'
         |? __typUrl*'R' & ~__przeb.first() || 'N'
         || ' '
         ?};
      par[6]:='7. Czy pracownik w czasie urlopu rodzicielskiego wykonuje pracę u swojego pracodawcy';
      par[7]:=100;
      'tak_nie'
   }
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:='T8';
      par[3]:='T8';
      _txt:='';
      {? __typUrl*'R' & __przeb.first()
      || {!
         |? _nap:=
               'od dnia '+__przeb.OD$4+' r. do dnia '+__przeb.DO$4+' r. '+
               ' w wymiarze '+__przeb.WYM+' etatu; ';
            _txt+=_nap+(' '*(cil.T8-par[1]-1-(+_nap)));
            __przeb.next()
         !}
      ?};
      par[4]:=_txt;
      par[6]:='';
      par[7]:=' ';
      par[9]:={? __przeb.size()>4 || __przeb.size() || 4 ?};
      par[10]:=cil.T8-par[1]-1;
      par[11]:=1;
      'kratki'
   }
   {par[9]:=~~}
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:=cil.T8;
      par[3]:=
           'Jeśli TAK, podaj okres od–do oraz wymiar czasu pracy';
      'text_out'
   }
   {LINE: 1}
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8B'}{SPACE: 'C'}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {<2 'Informacje o wypłaconych świadczeniach'}
   {<2 ('─'*(cil.T8B-1))}
   {FONT: 'T8'}
   {ENTIRE-}
   {DIRECT}
   {SUBSTITUTE:
      nb.prefix(6);
      _jestW:='N';
      {? nb.first()
      || {!
         |? {? nb.TYP='W'
            || _jestW:='T';
               0
            || nb.next()
            ?}
         !}
      ?};
      par[1]:=1;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=_jestW;
      par[6]:='';
      par[7]:=100;
      'tak_nie'
   }
   {line(1);~~}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:=90;
      par[3]:=
           '1. Czy wypłaciłeś wynagrodzenie za okresy orzeczonej niezdolności do pracy w danym roku kalendarzowym '
           'na podstawie art. 92 Kodeksu pracy';
      'text_out'
   }
   {DIRECT-}
   {ENTIRE}
   {SUBSTITUTE:
      par[1]:=4;
      _txt:='';
      _ll:=0;
      {? nb.first()
      || {!
         |? {? nb.TYP='W'
            || _nap:='od dnia '+nb.OD$4+' r. do dnia '+nb.DO$4+' r. kod literowy ';
               _nap+={? nb.KOD='' || 5*'.' || form(nb.KOD,5) ?}+'; ';
               _txt+=_nap+(' '*(cil.T8-par[1]-1-(+_nap)));
               _ll+=1
            ?};
            nb.next()
         !}
      ?};
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=_txt;
      par[6]:='';
      par[7]:=' ';
      par[9]:={? _ll>4 || _ll || 4 ?};
      par[10]:=cil.T8-par[1]-1;
      par[11]:=1;
      'kratki'
   }
   {par[9]:=~~}
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:=cil.T8;
      par[3]:=
           'Jeśli TAK, podaj okresy od–do oraz kod literowy. Podaj także okresy wynagrodzenia wypłaconego w poprzednim '
           'roku, wliczane do jednego okresu zasiłkowego';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      nb.prefix(7);
      par[1]:=1;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:={? nb.first() || 'T' || 'N' ?};
      par[6]:='2. Czy wypłaciłeś zasiłek chorobowy/ świadczenie rehabilitacyjne';
      par[7]:=100;
      'tak_nie'
   }
   {SUBSTITUTE:
      par[1]:=4;
      _txt:='';
      {? nb.first()
      || {!
         |? _nap:='od dnia '+nb.OD$4+' r. do dnia '+nb.DO$4+' r. kod literowy ';
            _nap+={? nb.KOD='' || 5*'.' || form(nb.KOD,5) ?}+';';
            _txt+=_nap+(' '*(cil.T8-par[1]-1-(+_nap)));
            nb.next()
         !}
      ?};
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=_txt;
      par[6]:='';
      par[7]:=' ';
      par[9]:={? nb.size()>4 || nb.size() || 4 ?};
      par[10]:=cil.T8-par[1]-1;
      par[11]:=1;
      'kratki'
   }
   {par[9]:=~~}
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:=cil.T8;
      par[3]:=
           'Jeśli TAK, podaj okresy od–do oraz kod literowy. Podaj okresy wliczone do jednego okresu zasiłkowego';
      'text_out'
   }
   {ENTIRE-}
   {ENTIRE}
   {SUBSTITUTE:
      nb.prefix(8);
      par[1]:=1;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:={? nb.first() || 'T' || 'N' ?};
      par[6]:='3. Czy wypłaciłeś zasiłek macierzyński';
      par[7]:=100;
      'tak_nie'
   }
   {SUBSTITUTE:
      par[1]:=4;
      _txt:='';
      {? nb.first()
      || {!
         |? _nap:='od dnia '+nb.OD$4+' r. do dnia '+nb.DO$4+' r.';
            _nap+=', stawka '+$nb.PR+'%;';
            _txt+=_nap+(' '*(cil.T8-par[1]-1-(+_nap)));
            nb.next()
         !}
      ?};
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=_txt;
      par[6]:='';
      par[7]:=' ';
      par[9]:={? nb.size()>4 || nb.size() || 4 ?};
      par[10]:=cil.T8-par[1]-1;
      par[11]:=1;
      'kratki'
   }
   {par[9]:=~~}
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:=cil.T8;
      par[3]:=
           'Jeśli TAK, podaj okresy od–do oraz stawkę % zasiłku macierzyńskiego';
      'text_out'
   }
   {LINE: 1}
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8B'}{SPACE: 'C'}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {<2 'Pozostałe informacje'}
   {<2 ('─'*(cil.T8B-1))}
   {FONT: 'T8'}
   {ENTIRE-}
   {DIRECT}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:='do 20 ubezpieczonych';
      par[6]:='Czy zgłosiłeś do ubezpieczenia chorobowego';
      par[7]:=50;
      par[8]:={? dst.LUCH<=20 || 'X' || '' ?};
      'kwadrat'
   }
   {line(1);~~}
   {SUBSTITUTE:
      par[1]:=100;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:='powyżej 20 ubezpieczonych';
      par[6]:='';
      par[7]:=100;
      par[8]:={? dst.LUCH>20 || 'X' || '' ?};
      'kwadrat'
   }
   {DIRECT-}
   {IF: lineleft()}{PAGE}{FI}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{COMMENT}                                          STRONA 4                                                   {COMMENT-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
   {ENTIRE}
   {LINE: 1}
   {FONT: 'T8B'}{SPACE: 'C'}
   {<2 'Informacje o składnikach wynagrodzenia'}
   {<2 ('─'*(cil.T8B-1))}
   {FONT: 'T8'}{SPACE: 'C'}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:=cil.T8;
      par[3]:=
           '1. Składniki wynagrodzenia za okresy miesięczne';
      'text_out'
   }
   {SUBSTITUTE:
      par[1]:='M';
      par[2]:=__PMH;
      par[3]:=__PMD;
      'skl'
   }
   {LINE:1}
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8'}{SPACE: 'C'}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:=cil.T8;
      par[3]:=
           '2. Składniki wynagrodzenia za okresy kwartalne';
      'text_out'
   }
   {SUBSTITUTE:
      par[1]:='K';
      par[2]:=__PKH;
      par[3]:=__PKD;
      'skl'
   }
   {LINE:1}
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8'}{SPACE: 'C'}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:=cil.T8;
      par[3]:=
           '3. Składniki wynagrodzenia za okresy roczne';
      'text_out'
   }
   {SUBSTITUTE:
      par[1]:='R';
      par[2]:=__PRH;
      par[3]:=__PRD;
      'skl'
   }
   {LINE:1}
   {ENTIRE-}
   {IF: lineleft()}{PAGE}{FI}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{COMMENT}                                          STRONA 5                                                   {COMMENT-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
   {ENTIRE}
   {FONT: 'T8'}{SPACE: 'C'}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:=cil.T8;
      par[3]:=
           '4. Składniki wynagrodzenia za inne okresy';
      'text_out'
   }
   {SUBSTITUTE:
      par[1]:='X';
      par[2]:=__PXH;
      par[3]:=__PXD;
      'skl'
   }
   {ENTIRE-}
   {ENTIRE}
   {FONT: 'T8'}{SPACE: 'C'}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:=cil.T8;
      par[3]:=
           '5. Czy z pracownikiem jest zawarta umowa zlecenia, umowa agencyjna lub inna umowa o świadczenie usług, '
           'do której zgodnie z Kodeksem cywilnym stosuje się przepisy dotyczące zlecenia albo umowa o dzieło lub '
           'inna umowa, czy przysługuje pracownikowi składnik wynagrodzenia przyznany do określonego terminu?';
      'text_out'
   }
   {ENTIRE-}
   {DIRECT}
   {SUBSTITUTE:
      par[1]:=1;
      par[2]:='T8';
      par[3]:='T8';
      _txt:=dprac.memo_txt(,,'UZ');
      par[4]:={? uz.first() | +_txt || 'T' || 'N' ?};
      par[6]:='';
      par[7]:=3;
      'tak_nie'
   }
   {line(1);~~}
   {SUBSTITUTE:
      par[1]:=35;
      _txt:='';
      {? uz.first()
      || {!
         |? _nap:='od dnia '+uz.UOD$4+' r. do dnia '+uz.UDO$4+' r., wynagrodzenie za '+date(uz.R,uz.M,1)$8+' r. ';
            _nap+=form(uz.KW,,2,'9.')+';';
            _txt+=(_nap-1)+(' '*(cil.T8-par[1]-1-(+_nap)))+';';
            uz.next()
         !}
      ?};
      _txt:=_txt-1+' ';
      _memo:=dprac.memo_txt(,,'UZ');
      STR.spl_word();
      STR.split(gsub(_memo,'\n',' '));
      _licz:=0;
      _wiersz:='';
      {!
      |? STR.next()
      |! _word:=STR.get_word();
         {? (+_wiersz)+(+_word)>cil.T8-par[1]-1
         || _wiersz:=_wiersz+(' '*(cil.T8-par[1]-2-(+_wiersz)))+';';
            _txt+=_wiersz;
            _wiersz:=_word;
            _licz+=1
         || {? (+_wiersz)+(+_word)=cil.T8-par[1]-1
            || _wiersz+=_word
            || _wiersz+=_word+' '
            ?}
         ?}
      !};
      {? _wiersz<>'' || _txt+=_wiersz ?};
      {? _txt+1 = ';' || _txt:=_txt-1+' ' ?};
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=_txt;
      par[6]:='';
      par[7]:=' ';
      par[9]:={? (uz.size()+_licz)>4 || uz.size()+_licz || 4 ?};
      par[10]:=cil.T8-par[1]-1;
      par[11]:=1;
      'kratki'
   }
   {SUBSTITUTE:
      par[1]:=35;
      par[2]:=cil.T8;
      par[3]:=
           'Jeśli TAK, podaj datę, do której zawarta jest umowa zlecenia (lub inna) – podaj datę, do której składnik '
           'przysługuje oraz podaj kwotę wynagrodzenia z tych tytułów za poszczególne miesiące';
      'text_out'
   }
   {LINE:1}
   {DIRECT-}
   {ENTIRE}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {FONT: 'T8B'}{SPACE: 'C'}
   {<2 'Uwagi:'}
   {<2 ('─'*(cil.T8B-1))}
   {FONT: 'T8G'}{SPACE: 'C'}
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=dprac.memo_txt(,,'UWAGI');
      par[6]:='';
      par[7]:=' ';
      par[9]:=8;
      par[10]:=cil.T8-par[1]-1;
      'kratki'
   }
   {LINE:1}
   {ENTIRE-}
   {ENTIRE}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {FONT: 'T8B'}{SPACE: 'C'}
   {<2 'Rachunek bankowy'}
   {<2 ('─'*(cil.T8B-1))}
   {FONT: 'T8G'}{SPACE: 'C'}
   {FONT: 'T8'}
   {SUBSTITUTE:
      par[1]:=2;
      par[3]:=
            'Podaj rachunek bankowy pracownika';
      'text_out'
   }
   {SUBSTITUTE:
      par[1]:=4;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=form(gsub(dprac.ROR,' ',''),30);
      par[6]:='';
      par[7]:='';
      par[9]:=~~;
      'kratki'
   }
   {LINE:1}
   {ENTIRE-}
   {ENTIRE}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {FONT: 'T8B'}{SPACE: 'C'}
   {<2 ('─'*(cil.T8B-1))}
   {SUBSTITUTE:
      par[1]:=2;
      par[3]:=
           'Oświadczam, że dane zawarte w zaświadczeniu podałem zgodnie z prawdą. Jeżeli ulegną one zmianie, '
           'zobowiązuję się poinformować o nich ZUS.';
      'text_out'
   }
   {<2 ('─'*(cil.T8B-1))}
   {LINE:6}
   {ENTIRE-}
   {DIRECT}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {FONT: 'T8G'}{SPACE: 'C'}
   {SUBSTITUTE:
      par[1]:=10;
      par[2]:='T8';
      par[3]:='T8';
      par[4]:=form('',8);
      par[6]:='Data';
      par[7]:='';
      'kratki'
   }
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {SUBSTITUTE:
      par[1]:=13;
      par[3]:='dd';
      'text_out'
   }
   {line(4);~~}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {SUBSTITUTE:
      par[1]:=18;
      par[3]:='/';
      'text_out'
   }
   {line(4);~~}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {SUBSTITUTE:
      par[1]:=21;
      par[3]:='mm';
      'text_out'
   }
   {line(4);~~}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {SUBSTITUTE:
      par[1]:=26;
      par[3]:='/';
      'text_out'
   }
   {line(4);~~}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {SUBSTITUTE:
      par[1]:=33;
      par[3]:='rrrr';
      'text_out'
   }
   {FONT: 'T8B'}{SPACE: 'C'}
   {line(1);~~}
   {<70 ('─'*(cil.T8B-70))}
   {par[1]:=1; par[2]:=cil.T8B; ~~}
   {SUBSTITUTE:
      par[1]:=70;
      par[3]:=
           'Podpis upoważnionego pracownika, nr telefonu oraz pieczątka zawierająca imię, nazwisko i stanowisko';
      'text_out'
   }
   {DIRECT-}
   {SUBSTITUTE: 'h_stop'}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{COMMENT}                                          STRONA                                                    {COMMENT-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
   {IF: dst.DP}
      {PAGE}
      {SUBSTITUTE: 'pouczenie'}
      {IF: dst.DW}{SUBSTITUTE: 'wyjasnienia'}{FI}
      {SUBSTITUTE: 'uwaga'}
   {FI}
{MACRO-}
{COMMENT}-----------------------------------------------------------------------------------------------------{COMMENT-}
{FONT: 'T8'}
{SPACE: 'B'}
{FOR: params_get().P}{DO}
   {IF: P.seek(params_get().P.SQL,,1)}
     {IF: P.DZ=date(0,0,0)}
        { melody(); ~~}
     {ELSE}
        {IF: wysun}{PAGE}
        {FI}
        {SUBSTITUTE: tresc}
     {FI}
   {FI}
{OD}