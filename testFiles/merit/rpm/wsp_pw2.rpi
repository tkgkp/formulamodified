:!UTF-8
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzezone
==============================================================================
Nazwa pliku: wsp_pw2.rpi
  Utworzony: 2005-03-18 [CS]
==============================================================================
Zawartosc: Moduł pomocniczy do sporządzania wydruków
           zgodnych z OWwSK003_aneks1.
{COMMENT-}
{COMMENT}------------------------------MACRO-LINIA03-----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania rekordu bez linii poprzedzającej
dla wydruków z obiektem PRINTER o nazwie przekazywanej przez zmienną prn1.
{COMMENT-}
{MACRO: 'LINIA03'}
{  ll:=lineleft(); ~~}
{IF:  _f:=prn1+'.ini_line()'; _v:=($(_f))();
      _f:=prn1+'.length()'; _v:=($(_f))();
      ll<(rsep+_v) & ll<>0}{PAGE}{FI}
{ENTIRE}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}{ vp:=0; ~~}
{FI}
{WHILE: _f:=prn1+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.fline(lmt)'; ($(_f))()}
{OD}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{ENTIRE-}
{MACRO-}
{COMMENT}------------------------------MACRO-LINIA12-----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania rekordu z linia poprzedzającej
dla wydruków z obiektem PRINTER o nazwie przekazywanej przez zmienną prn2.
{COMMENT-}
{MACRO: 'LINIA12'}
{  ll:=lineleft(); ~~}
{IF:  _f:=prn2+'.ini_line()'; _v:=($(_f))();
      _f:=prn2+'.length()'; _v:=($(_f))();
      ll<(rsep+_v) & ll<>0}{PAGE}{ vp:=1;~~}{FI}
{ENTIRE}
{IF: vp>0}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
{FI}
{IF: vp<0}
   {REP: _f:=prn2+'.fhbar(lmt)'; ($(_f))()}{ vp:=0; ~~}
{ELSE}
   {REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
{FI}
{IF: vp>0}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}{ vp:=0; ~~}
{FI}
{WHILE: _f:=prn2+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn2+'.fline(lmt)'; ($(_f))()}
{OD}
   {REP: _f:=prn2+'.flbar(lmt)'; ($(_f))()}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{ENTIRE-}
{MACRO-}
