:!UTF-8
{TITLE:A. Sprawozdanie o stosowanych terminach zapłaty w transakcjach handlowych}
{PRINTER: FINFO.SZ_PRN,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
   VAR_DEL.delete('PRN1','PRN2','NOMAXP','w','helper');
   PRN1:=obj_new(@.CLASS.PRINT,1); PRN1.s_frame();
   PRN2:=obj_new(@.CLASS.PRINT,2); PRN2.s_frame();

   w:=obj_new(2);
   color:=prn1:=prn2:='';
   lm:=ll:=vp:=lmt:=rsep:=NOMAXP:=0;
   helper:=obj_new('set','value');
   helper.set:="
      {! _ii:=1..obj_len(w) |! w[_ii]:='' !};
      {! _ii:=1.._ |! w[_ii]:=_[_ii] !};
      ~~
   ";
   helper.value:="
      form(_a,,2,' ,')
   ";
   dalej:=0;
   ~~
}
{END:
   VAR_DEL.delete('PRN1','PRN2','NOMAXP','w','helper');
   &color; &prn1; &prn2;
   &lm; &ll; &vp; &lmt; &rsep
}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}----------------------------- MACRO LINH -----------------{COMMENT-}
{MACRO: 'LINH'}
{COMMENT}{REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}{COMMENT-}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}
{ELSE}
   {REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}
{FI}
{vp:=0; rsep:=0;~~}
{MACRO-}
{COMMENT}--------------------------------WYDRUK---------------------{COMMENT-}
{  PRN1.add("w[1]",134,'');
   PRN2.add("w[1]",30,'');
   PRN2.add("w[2]",101,'',1);
~~}
{PAR_WYDR.TITLE:=~-('Sprawozdanie o stosowanych terminach zapłaty w transakcjch handlowych za '+UNPAR.PRF1().NAZ+' rok');~~}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN1.width())/2); ~~}

{>22 'Zestaw kont: '}{<23 {? PAR_WYDR.ZESTKONP || PAR_WYDR.ZESTKONP().KOD || 'nie wskazano' ?}}

{ PRN1.ini_head(); ~~}
{REP: PRN1.fhbar(lmt)}
{PRN1.setcolor(color); ~~}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8GB'}{SPACE: 'C'}
{PRN1.setcolor(color); prn1:='PRN1';~~}{SUBSTITUTE: 'LINH'}{vp:=0; rsep:=0; ~~}
{HEADER-}
{FOOTER: 0}
{ prn1:=last;~~}{SUBSTITUTE: 'LINIAF'}{vp:=0;vpp; rsep:=0;~~}
{~~}
{~~}
{FOOTER-}
{fun:="rsep:=1; last:=prn2;''";~~}
{helper.set('Firma'); prn1:=prn2:='PRN1';vp:=0;~~}{FONT: 'T8GB'}{SUBSTITUTE: 'LINIA0'}{FONT: 'T8G'}
{helper.set('Nazwa',SprObj.FIRMA.NAZ); prn1:='PRN1';prn2:='PRN2';rsep:=1;~~}{SUBSTITUTE: 'LINIA02'}
{helper.set('NIP',SprObj.FIRMA.NIP); prn1:='PRN2';~~}{SUBSTITUTE: 'LINIA0'}
{helper.set('Świadczenia pieniężne otrzymane'); prn1:='PRN2';prn2:='PRN1';vpp:=1;~~}{FONT: 'T8GB'}{SUBSTITUTE: 'LINIA02'}{vpp:=0;~~}{FONT: 'T8G'}
{helper.set('Do 30 dni',helper.value(SprObj.NAL.K[1])); prn1:='PRN1';prn2:='PRN2';rsep:=1;~~}{SUBSTITUTE: 'LINIA02'}
{helper.set('Od 31 do 60 dni',helper.value(SprObj.NAL.K[2])); prn1:='PRN2';~~}{SUBSTITUTE: 'LINIA0'}
{helper.set('Od 61 do 120 dni',helper.value(SprObj.NAL.K[3])); ~~}{SUBSTITUTE: 'LINIA0'}
{helper.set('Powyżej 120 dni',helper.value(SprObj.NAL.K[4])); ~~}{SUBSTITUTE: 'LINIA0'}
{helper.set('Świadczenia pieniężne nieotrzymane'); prn1:='PRN2';prn2:='PRN1';vpp:=1;~~}{FONT: 'T8GB'}{SUBSTITUTE: 'LINIA02'}{vpp:=0;~~}{FONT: 'T8G'}
{helper.set('Kwota',helper.value(SprObj.NAL.N)); prn1:='PRN1';prn2:='PRN2';rsep:=1;~~}{SUBSTITUTE: 'LINIA02'}
{helper.set('Procent',helper.value(SprObj.NAL.P)+' %'); prn1:='PRN2';~~}{SUBSTITUTE: 'LINIA0'}
{helper.set('Świadczenia pieniężne spełnione'); prn1:='PRN2';prn2:='PRN1';vpp:=1;~~}{FONT: 'T8GB'}{SUBSTITUTE: 'LINIA02'}{vpp:=0;~~}{FONT: 'T8G'}
{helper.set('Do 30 dni',helper.value(SprObj.ZOB.K[1])); prn1:='PRN1';prn2:='PRN2';rsep:=1;~~}{SUBSTITUTE: 'LINIA02'}
{helper.set('Od 31 do 60 dni',helper.value(SprObj.ZOB.K[2])); prn1:='PRN2';~~}{SUBSTITUTE: 'LINIA0'}
{helper.set('Od 61 do 120 dni',helper.value(SprObj.ZOB.K[3])); ~~}{SUBSTITUTE: 'LINIA0'}
{helper.set('Powyżej 120 dni',helper.value(SprObj.ZOB.K[4])); ~~}{SUBSTITUTE: 'LINIA0'}
{helper.set('Świadczenia pieniężne niespełnione'); prn1:='PRN2';prn2:='PRN1';vpp:=1;~~}{FONT: 'T8GB'}{SUBSTITUTE: 'LINIA02'}{vpp:=0;~~}{FONT: 'T8G'}
{helper.set('Kwota',helper.value(SprObj.ZOB.N)); prn1:='PRN1';prn2:='PRN2';rsep:=1;~~}{SUBSTITUTE: 'LINIA02'}
{helper.set('Procent',helper.value(SprObj.ZOB.P)+' %'); prn1:='PRN2';~~}{SUBSTITUTE: 'LINIA0'}