:!UTF-8
{TITLE:A. Lista wierszy dla wybranego sprawozdania}
{PRINTER: SIK.PRT,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
   PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
   dz:=obj_new(5); i:=0;
   PRN:=obj_new(@.CLASS.PRINT,10); PRN.sl_frame();
   color:=prn1:=prn2:=''; lm:=ll:=vp:=lmt:=rsep:=0
}
{END:
   VAR_DEL.delete('PRN','dz'); &i;
   &color; &prn1; &prn2; &lm; &ll; &vp; &lmt; &rsep
}
{  PRN.add("dz[1]",4,'Lp.'@);
   PRN.add("dz[2]",15,'      Kod'@);
   PRN.add("dz[3]",60,28*' '+'Nazwa'@);
   PRN.add("dz[4]",8,'Algorytm'@);
   PRN.add("form(DEFW.WSPOL,,6,' ,')",15,'  Współczynnik'@,1);
   PRN.add("DEFW.WSPOLF",47,'Współczynnik - formuła'@);
   PRN.add("{? +DEFW.TAB
            ||
  'TABELA: [%1] INDEX: [%1] PREFIX: [%2] KOD: [%3] MASKA: [%4] NAZWA: [%5]'@[DEFW.TAB,DEFW.INDEX,DEFW.PREFIX,DEFW.KODF,DEFW.MASKA,DEFW.TR]
            |? DEFW.SLU<>null
            || 'SŁOWNIK: [%1] MASKA: [%2]'@[DEFW.SLU().SLU().NAZ,DEFW.MASKA]
            ||''
            ?}",34,'Param. dot. Sł.uż./dow. Kartoteki'@);
   PRN.add("' '+DEFW.DOKRES",3,'OKR'@);
   PRN.add("{? -DEFW.ALGORYTM<>'p' || $DEFW.ZAOKR || '' ?}",7,'Zaokr.',1);
   PRN.add("{? -DEFW.ALGORYTM<>'p' || $DEFW.DOKL || '' ?}",5,'Dokł.',1);
   PAR_WYDR.TITLE:='%1\nLista wierszy'@[GR_SIK.NAZWA];
   prn1:=prn2:='PRN'; ~~}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------petla------------------------{COMMENT-}
{MACRO: 'petla'}
{ dz[1]:=form(i);
  dz[2]:=DEFW.KOD;
  dz[3]:=DEFW.NAZWA;
  dz[4]:=DEFW.ALGORYTM;~~}
{SUBSTITUTE: 'LINIA0'}
{i+=1;~~}
{MACRO-}
{COMMENT}------------------------------naglowek---------------------{COMMENT-}
{MACRO: 'NAGLOWEK'}
{FONT: 'HEAD'}{SPACE: 'B'}
{ lm:=charleft(); ~~}
{SPACE: 'A'}
{IF: PAR_WYDR.TITLE<>''}
{SPACE: 'A'}{FONT: 'TITLE'}{lm:=charleft();~~}
   {<1>{lm} _poz:=PAR_WYDR.TITLE*'\n';
            {? _poz
               || (_poz-1)+PAR_WYDR.TITLE
               || PAR_WYDR.TITLE
            ?}}
   {IF: PAR_WYDR.TITLE*'\n'}
      {<1>{lm} _poz:=PAR_WYDR.TITLE*'\n';
            PAR_WYDR.TITLE+(+PAR_WYDR.TITLE-_poz)}
   {FI}
{FI}
{MACRO-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: page=1 & ~rep_export()}
{SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{IF: ~rep_export()}
{SUBSTITUTE: 'HEAD'}
{ELSE}
{SUBSTITUTE: 'NAGLOWEK'}
{FI}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{<1 'PARAMETRY WYDRUKU:'@}
{<1
{? OPERATOR.DEPT
||
   {? SSTALE.AO().ZAM='T'
   ||'Jednostka księgowa: %1 Waluta: %2   Rodzaj okresu: zamknięty'@[OPERATOR.DEPT().OD,SSTALE.WAL().KOD]
   ||'Jednostka księgowa: %1 Waluta: %2   Rodzaj okresu: otwarty'@[OPERATOR.DEPT().OD,SSTALE.WAL().KOD]
   ?}
||
   {? SSTALE.AO().ZAM='T'
   ||'Jednostka księgowa: wszystkie jednostki księgowe  Waluta: %1   Rodzaj okresu: zamknięty'@[SSTALE.WAL().KOD]
   ||'Jednostka księgowa: wszystkie jednostki księgowe  Waluta: %1   Rodzaj okresu: otwarty'@[SSTALE.WAL().KOD]
   ?}
?}

}
{<1 'Okres: %1 %2'@[SSTALE.AO().NAZ,SSTALE.AO().ROK().NAZ]}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{IF: ~rep_export()}
{SUBSTITUTE: 'HEAD'}
{ELSE}
{SUBSTITUTE: 'NAGLOWEK'}
{FI}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{IF: ~rep_export()}
{SUBSTITUTE: 'LINIAF'}
{~~}
{FI}
{FOOTER-}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{  rsep:=PAR_WYDR.RSEP; ~~}
{ dz[1]:=dz[2]:=dz[3]:=dz[4]:='';i:=1; ~~}
{ WYRAZ.GRUPA:=GR_SIK.ref;~~}
{FOR: 'DEFW'}{INDEX: 'LP'}{PREFIX: WYRAZ.GRUPA}
{DO}{SUBSTITUTE: 'petla'}{OD}
{FOOTER}{FOOTER-}
{IF: lineleft()=0}{ PRN.setcolor(color);~~}{FI}
{ENTIRE}
{REP: PRN.flbar(lmt)}
{IF: ~rep_export()}
{<1>{PRN.width()} 'KONIEC WYDRUKU'@}
{FI}
{ENTIRE-}
