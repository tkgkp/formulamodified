:!UTF-8
{TITLE:I. Zestawienie stanu środków do bilansu}
{PRINTER: FINFO.SZ_PRN,,,,,'M','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
   PRN:=obj_new(@.CLASS.PRINT,12+{? rep_export() || 18 ?}); PRN.s_frame();
   PRNF:=obj_new(@.CLASS.PRINT,12); PRNF.s_frame();
   PRN2:=obj_new(@.CLASS.PRINT,12); PRN2.s_frame();
   PRN3:=obj_new(@.CLASS.PRINT,12); PRN3.s_frame();
   c:=obj_new(12+{? rep_export() || 18 ?});
   {! _i:=1..12+{? rep_export() || 18 ?} |! c[_i]:='' !};
   sum_pod:=obj_new(12);
   sum_fin:=obj_new(12);
   sum_dod:=obj_new(12);
   {! _i:=1..12 |! sum_pod[_i]:=0; sum_fin[_i]:=0; sum_dod[_i]:=0  !};
   SRST.cntx_psh(); SRSR.cntx_psh();
   i:=0;
   color:=prn1:=prn2:=prn3:='';
   lm:=ll:=vp:=lmt:=rsep:=0;
   par1:=0; par2:=0; par3:=0; par4:=0
}
{END:
   obj_del(PRN);
   obj_del(PRNF);
   obj_del(PRN2);
   obj_del(PRN3);
   obj_del(c); obj_del(sum_pod); obj_del(sum_fin); obj_del(sum_dod);
   SRST.cntx_pop(); SRSR.cntx_pop();
   VAR_DEL.delete('TAB_SQL');
   &i; &color; &prn1; &prn2; &prn3;
   &lm; &ll; &vp; &lmt; &rsep;
   &par1; &par2; &par3; &par4
}
{EXIT:
   exec('clear_par','fst');
   exec('set_parw','param_wydr');
   {? OPERATOR.DEPT<>null
   || PAR_WYDR.ODD:=OPERATOR.DEPT
   || PAR_WYDR.ODD:=0
   ?};
   exec('init','fst');
   SRD.maski('r');
   {? SSTALE.AO().KON<>date(0,0,0)
   || PAR_WYDR.STAN_NA:=SSTALE.AO().KON
   |? SSTALE.AO().OES=0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().POCZ_ROK
   |? SSTALE.AO().OES>0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().KON_ROK
   ?};
   PAR_WYDR.WART_PN:=2;
   PAR_WYDR.DANE:=1;
   PAR_WYDR.RODZAJ2:=1;
   SRD.PAR_WYDR:='T';
   PAR_WYDR.MO_DO:=1;
   PAR_WYDR.JORG:=null; EDIT_ES.JORG:='';
   exec('odd_filtr','fst');
   {? FINFO.TOR_D<>'T'
   || PAR_WYDR.win_edit('BILANS')
   || PAR_WYDR.win_edit('BILANSD')
   ?};
   PAR_WYDR.hdr_edit(': I. Zestawienie stanu środków do bilansu'@);
   {? PAR_WYDR.edit("exec('check_bilans','fst')")
   || VAR_DEL.delete('TAB_SQL');
      TAB_SQL:=exec('o_tabbil','fst2',PAR_WYDR.ZAKRESDR,PAR_WYDR.ODD,PAR_WYDR.PRZYCHOD,PAR_WYDR.ROZCHOD,PAR_WYDR.SKR_ONLY,PAR_WYDR.DANE,PAR_WYDR.SKRESL,PAR_WYDR.MO_DO);
      {? exec('if_ok','fst','TAB_SQL') || _exit:=0 || _exit:=1 ?}
   || _exit:=1
   ?};
   _exit
}
{COMMENT}
==================================================
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
Nazwa pliku: fst_o_tabbil.rpm
Utworzony  : 2016-12-06
Zawartość  : Zestawienie stanu środków do bilansu
==================================================
------------------------ OPIS PÓL ZMIENNEJ PAR_WYDR ------------{COMMENT-}
{COMMENT}
ODD    : jedn. ksiegowa
{COMMENT-}
{COMMENT}zmienne pomocnicze do wydrukow graficznych:
i - licznik, color, prn1, lm, ll, vp, lmt, rsep
{COMMENT-}
{PAR_WYDR.cntx_psh();~~}
{INCLUDE: wsp_pw.rpi}
{PAR_WYDR.cntx_pop();~~}
{MACRO: 'TABHEAD2'}
{ _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
{ _f:=prn1+'.ini_head()'; ($(_f))()}
{REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}
{WHILE: _f:=prn1+'.h_next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.h_fmline(lmt)'; ($(_f))()}
{OD}
{REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
{ _f:=prn2+'.ini_head()'; ($(_f))()}
{ _f:=prn2+'.setcolor(color)'; ($(_f))(); ~~}
{WHILE: _f:=prn2+'.h_next()'; ($(_f))()}
{DO}
   {REP: _f:=prn2+'.h_fmline(lmt)'; ($(_f))()}
{OD}
{MACRO-}
{COMMENT}--Definicja wiersza wydruku--------------------{COMMENT-}
{  prn1:='PRN'; prn2:='PRN'; ~~}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{

      PRN.add("c[1]",10,'Dane');
      PRN.add("{? type_of(c[2]) = 1 || form(c[2],,2,' ,') || c[2] ?}",14,'Pocz. okresu'@,1,'#');
      PRN.add("{? type_of(c[4]) = 1 || form(c[4],,2,' ,') || c[4] ?}",14,'Ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[5]) = 1 || form(c[5],,2,' ,') || c[5] ?}",14,'Skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[6]) = 1 || form(c[6],,2,' ,') || c[6] ?}",14,'Koniec okresu'@,1,'#');
      PRN.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}",14,'Pocz. okresu'@,1,'#');
      PRN.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}",14,'W ciągu okresu'@,1,'#');
      PRN.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}",14,'Ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}",14,'Skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}",14,'Koniec okresu'@,1,'#');

      PRNF.add("c[1]",10,'Dane');
      PRNF.add("{? type_of(c[2]) = 1 || form(c[2],,2,' ,') || c[2] ?}",14,'Pocz. okresu'@,1,'#');
      PRNF.add("{? type_of(c[4]) = 1 || form(c[4],,2,' ,') || c[4] ?}",14,'Ze zwiększenia'@,1,'#');
      PRNF.add("{? type_of(c[5]) = 1 || form(c[5],,2,' ,') || c[5] ?}",14,'Skreśl.z ewid.@',1,'#');
      PRNF.add("{? type_of(c[6]) = 1 || form(c[6],,2,' ,') || c[6] ?}",14,'Koniec okresu'@,1,'#');
      PRNF.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}",14,'Pocz. okresu'@,1,'#');
      PRNF.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}",14,'W ciągu okresu'@,1,'#');
      PRNF.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}",14,'Ze zwiększenia'@,1,'#');
      PRNF.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}",14,'Skreśl.z ewid.'@,1,'#');
      PRNF.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}",14,'Koniec okresu'@,1,'#');

      PRN2.add("c[1]", 163, '');

      PRN3.add("", 78, 'Wartość'@);
      PRN3.add("", 82, 'Umorzenie'@);

      PAR_WYDR.TITLE:='Zestawienie stanu środków do bilansu - stan na dzień %1 roku'@[(PAR_WYDR.STAN_NA$6)]; ~~}
{FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
   PRN.add("c[1]",10,'Dane');
{? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
   || PRN.add("{? type_of(c[2]) = 1 || form(c[2],,2,' ,') || c[2] ?}",14,'Wartość POD pocz. okresu'@,1,'#');
      PRN.add("{? type_of(c[4]) = 1 || form(c[4],,2,' ,') || c[4] ?}",14,'Wartość POD ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[5]) = 1 || form(c[5],,2,' ,') || c[5] ?}",14,'Wartość POD skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[6]) = 1 || form(c[6],,2,' ,') || c[6] ?}",14,'Wartość POD koniec okresu'@,1,'#');
      PRN.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}",14,'Umorzenie POD pocz. okresu'@,1,'#');
      PRN.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}",14,'Umorzenie POD w ciągu okresu'@,1,'#');
      PRN.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}",14,'Umorzenie POD ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}",14,'Umorzenie POD skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}",14,'Umorzenie POD koniec okresu'@,1,'#') ?};
      {? PAR_WYDR.DANE = 3 | PAR_WYDR.DANE = 2
   || PRN.add("{? type_of(c[13]) = 1 || form(c[13],,2,' ,') || c[13] ?}",14,'Wartość BIL pocz. okresu'@,1,'#');
      PRN.add("{? type_of(c[14]) = 1 || form(c[14],,2,' ,') || c[14] ?}",14,'Wartość BIL ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[15]) = 1 || form(c[15],,2,' ,') || c[15] ?}",14,'Wartość BIL skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[16]) = 1 || form(c[16],,2,' ,') || c[16] ?}",14,'Wartość BIL koniec okresu'@,1,'#');
      PRN.add("{? type_of(c[17]) = 1 || form(c[17],,2,' ,') || c[17] ?}",14,'Umorzenie BIL pocz. okresu'@,1,'#');
      PRN.add("{? type_of(c[18]) = 1 || form(c[18],,2,' ,') || c[18] ?}",14,'Umorzenie BIL w ciągu okresu'@,1,'#');
      PRN.add("{? type_of(c[19]) = 1 || form(c[19],,2,' ,') || c[19] ?}",14,'Umorzenie BIL ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[20]) = 1 || form(c[20],,2,' ,') || c[20] ?}",14,'Umorzenie BIL skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[21]) = 1 || form(c[21],,2,' ,') || c[21] ?}",14,'Umorzenie BIL koniec okresu'@,1,'#')?};
      {? FINFO.TOR_D='T'
   || PRN.add("{? type_of(c[22]) = 1 || form(c[22],,2,' ,') || c[22] ?}",14,'Wartość DOD pocz. okresu'@,1,'#');
      PRN.add("{? type_of(c[23]) = 1 || form(c[23],,2,' ,') || c[23] ?}",14,'Wartość DOD ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[24]) = 1 || form(c[24],,2,' ,') || c[24] ?}",14,'Wartość DOD skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[25]) = 1 || form(c[25],,2,' ,') || c[25] ?}",14,'Wartość DOD koniec okresu'@,1,'#');
      PRN.add("{? type_of(c[26]) = 1 || form(c[26],,2,' ,') || c[26] ?}",14,'Umorzenie DOD pocz. okresu'@,1,'#');
      PRN.add("{? type_of(c[27]) = 1 || form(c[27],,2,' ,') || c[27] ?}",14,'Umorzenie DOD w ciągu okresu'@,1,'#');
      PRN.add("{? type_of(c[28]) = 1 || form(c[28],,2,' ,') || c[28] ?}",14,'Umorzenie DOD ze zwiększenia'@,1,'#');
      PRN.add("{? type_of(c[29]) = 1 || form(c[29],,2,' ,') || c[29] ?}",14,'Umorzenie DOD skreśl.z ewid.'@,1,'#');
      PRN.add("{? type_of(c[30]) = 1 || form(c[30],,2,' ,') || c[30] ?}",14,'Umorzenie DOD koniec okresu'@,1,'#')?};

      PRNF.add("c[1]",10,'Dane');
      PRNF.add("{? type_of(c[2]) = 1 || form(c[2],,2,' ,') || c[2] ?}",14,'Pocz. okresu'@,1,'#');
      PRNF.add("{? type_of(c[4]) = 1 || form(c[4],,2,' ,') || c[4] ?}",14,'Ze zwiększenia'@,1,'#');
      PRNF.add("{? type_of(c[5]) = 1 || form(c[5],,2,' ,') || c[5] ?}",14,'Skreśl.z ewid.@',1,'#');
      PRNF.add("{? type_of(c[6]) = 1 || form(c[6],,2,' ,') || c[6] ?}",14,'Koniec okresu'@,1,'#');
      PRNF.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}",14,'Pocz. okresu'@,1,'#');
      PRNF.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}",14,'W ciągu okresu'@,1,'#');
      PRNF.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}",14,'Ze zwiększenia'@,1,'#');
      PRNF.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}",14,'Skreśl.z ewid.'@,1,'#');
      PRNF.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}",14,'Koniec okresu'@,1,'#');



      PAR_WYDR.TITLE:='Zestawienie stanu środków do bilansu - stan na dzień %1 roku'@[(PAR_WYDR.STAN_NA$6)]; ~~}
{FI}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{COMMENT}------------------------------Parametry wydruku------------{COMMENT-}
{FONT: 'W8'}{SPACE: 'C'}
{<1 'PARAMETRY WYDRUKU:'@}
{COMMENT} ---- Stan na, Jedn. ksiegowa ---- {COMMENT-}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
  {? PAR_WYDR.ODD<>null || par1:=PAR_WYDR.ODD().OD || par1:='dowolna'@ ?};

  {? PAR_WYDR.DANE=1
  || par2:='podatkowe'@
  |? PAR_WYDR.DANE=2
  || par2:='bilansowe'@
  |? PAR_WYDR.DANE=3
  || par2:='wszystkie'@
  |? PAR_WYDR.DANE=4
  || par2:='dodatkowe'@
  ?};

  {? PAR_WYDR.ZAKRESDR=0
  || par3:='trwałe i niskocenne'@
  |? PAR_WYDR.ZAKRESDR=1
  || par3:='trwałe'@
  |? PAR_WYDR.ZAKRESDR=2
  || par3:='niskocenne'@
  ?}
;~~}
{IF: PAR_WYDR.SKR_ONLY=1 | PAR_WYDR.SKRESL=1 }
{FONT: 'W8B'}{<1 'Jednostka księgowa: '@}{FONT: 'W8'}{<21 par1}{FONT: 'W8B'}{<43 'Dane: '@}{FONT: 'W8'}{<61 par2}{FONT: 'W8B'}{<88 'Zakres środków: '@}{FONT: 'W8'}{<105 par3}
{ELSE}
{FONT: 'W8B'}{<1 'Jednostka księgowa: '@}{FONT: 'W8'}{<21 par1}{FONT: 'W8B'}{<43 'Dane: '@}{FONT: 'W8'}{<61 par2}{FONT: 'W8B'}{<88 'Zakres środków: '@}{FONT: 'W8'}{<120 par3}
{FI}
{ par1:={? PAR_WYDR.PRZYCHOD<>null || PAR_WYDR.PRZYCHOD().R || 'dowolny'@ ?};
  par2:={? PAR_WYDR.ROZCHOD<>null || PAR_WYDR.ROZCHOD().R || 'dowolny'@ ?};
  par3:={? PAR_WYDR.SKR_ONLY=1
        || 'Wydruk uwzględnia tylko środki skreślone (w bieżącym roku)'@
        |? PAR_WYDR.SKRESL=1
        || 'Wydruk nie uwzględnia środków skreślonych w bieżącym roku, przed datą Stan na dzień'@
        || ''
        ?};
  par4:={? PAR_WYDR.MO_DO=1 || 'okresu obowiązywania'@  |? PAR_WYDR.MO_DO=2 || 'daty operacji'@ || '' ?}
;~~}
{IF: PAR_WYDR.SKR_ONLY=1 | PAR_WYDR.SKRESL=1 }
{FONT: 'W8B'}{<1 'Rodzaj przychodu: '@}{FONT: 'W8'}{<21 par1}{FONT: 'W8B'}{<43 'Rodzaj rozchodu: '@}{FONT: 'W8'}{<61 par2}{IF: +par3}{FONT: 'W8B'}{<88 'Uwaga: '@}{FI}{FONT: 'W8'}{<105 par3}
{ELSE}
{FONT: 'W8B'}{<1 'Rodzaj przychodu: '@}{FONT: 'W8'}{<21 par1}{FONT: 'W8B'}{<43 'Rodzaj rozchodu: '@}{FONT: 'W8'}{<61 par2}{FONT: 'W8B'}{<88 'Dokumenty wartościowe według: '@}{FONT: 'W8'} {<120 par4} 
{FI}
{FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
  {? PAR_WYDR.ODD<>null || par1:=PAR_WYDR.ODD().OD || par1:='dowolna'@ ?};

  {? PAR_WYDR.DANE=1
  || par2:='podatkowe'@
  |? PAR_WYDR.DANE=2
  || par2:='bilansowe'@
  |? PAR_WYDR.DANE=3
  || par2:='wszystkie'@
  |? PAR_WYDR.DANE=4
  || par2:='dodatkowe'@
  ?};

  {? PAR_WYDR.ZAKRESDR=0
  || par3:='trwałe i niskocenne'@
  |? PAR_WYDR.ZAKRESDR=1
  || par3:='trwałe'@
  |? PAR_WYDR.ZAKRESDR=2
  || par3:='niskocenne'@
  ?}
;~~}
{FONT: 'W8B'}{ 'Jednostka księgowa: '@}{FONT: 'W8'}{ par1}
{FONT: 'W8B'}{ 'Dane: '@}{FONT: 'W8'}{ par2}
{FONT: 'W8B'}{ 'Zakres środków: '@}{FONT: 'W8'}{ par3}
{ par1:={? PAR_WYDR.PRZYCHOD<>null || PAR_WYDR.PRZYCHOD().R || 'dowolny'@ ?};
  par2:={? PAR_WYDR.ROZCHOD<>null || PAR_WYDR.ROZCHOD().R || 'dowolny'@ ?};
  par3:={? PAR_WYDR.SKR_ONLY=1
        || 'Wydruk uwzględnia tylko środki skreślone (w bieżącym roku)'@
        |? PAR_WYDR.SKRESL=1
        || 'Wydruk nie uwzględnia środków skreślonych w bieżącym roku, przed datą Stan na dzień'@
        || ''
        ?};
  par4:={? PAR_WYDR.MO_DO=1 || 'okresu obowiązywania'@  |? PAR_WYDR.MO_DO=2 || 'daty operacji'@ || '' ?}
;~~}
{IF: PAR_WYDR.SKR_ONLY=1 | PAR_WYDR.SKRESL=1 }
{FONT: 'W8B'}{ 'Rodzaj przychodu: '@}{FONT: 'W8'}{ par1}
{FONT: 'W8B'}{ 'Rodzaj rozchodu: '@}{FONT: 'W8'}{ par2}
{IF: +par3}{FONT: 'W8B'}{ 'Uwaga: '@}{FI}{FONT: 'W8'}{ par3}
{ELSE}
{FONT: 'W8B'}{ 'Rodzaj przychodu: '@}{FONT: 'W8'}{ par1}
{FONT: 'W8B'}{ 'Rodzaj rozchodu: '@}{FONT: 'W8'}{ par2}
{FONT: 'W8B'}{ 'Dokumenty wartościowe według: '@}{FONT: 'W8'} { par4}
{FI}
{FI}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{prn1:='PRN3';prn2:='PRN';~~}
{SUBSTITUTE: 'TABHEAD2'}
{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8GB'}{SPACE: 'C'}
{prn1:='PRN3';prn2:='PRN';~~}
{SUBSTITUTE: 'TABHEAD2'}
{prn1:='PRN'; prn2:='PRN2'; "vp:=0";~~}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: ~rep_export()}
{SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{ rsep:=1; ~~}
{FOR: TAB_SQL}
 {DO}
{COMMENT} ---- zwykłe wiersze ---- {COMMENT-}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
 {
   {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
   ||
      c[1] :=TAB_SQL.TAB_OPIS + ':';
      c[2]:=TAB_SQL.WARP;
      c[4]:=TAB_SQL.WARP_ZW;
      c[5]:=TAB_SQL.WARP_SKR;
      c[6]:=TAB_SQL.WARP_KON;
      c[7]:=TAB_SQL.UMOP;
      c[9]:=TAB_SQL.UMP_CO;
      c[10]:=TAB_SQL.UMP_ZW;
      c[11]:=TAB_SQL.UMP_SKR;
      c[12]:=TAB_SQL.UMP_KON;

      sum_pod[2] += TAB_SQL.WARP;  "poczatek okresu";
      sum_pod[4] += TAB_SQL.WARP_ZW;  "ze zwiekszenia";
      sum_pod[5] += TAB_SQL.WARP_SKR;  "skreslone z ewidencji";
      sum_pod[6] += TAB_SQL.WARP_KON;  "koniec okresu";
      sum_pod[7] += TAB_SQL.UMOP;  "poczatek okresu";
      sum_pod[9] += TAB_SQL.UMP_CO;  "w ciagu okresu";
      sum_pod[10] += TAB_SQL.UMP_ZW; "ze zwiekszenia";
      sum_pod[11] += TAB_SQL.UMP_SKR; "skreslone z ewidencji";
      sum_pod[12] += TAB_SQL.UMP_KON; "koniec okresu"
   |? PAR_WYDR.DANE = 2
   ||
      c[1] :=TAB_SQL.TAB_OPIS + ':';
      c[2]:=TAB_SQL.WARF;
      c[4]:=TAB_SQL.WARF_ZW;
      c[5]:=TAB_SQL.WARF_SKR;
      c[6]:=TAB_SQL.WARF_KON;
      c[7]:=TAB_SQL.UMOF;
      c[9]:=TAB_SQL.UMF_CO;
      c[10]:=TAB_SQL.UMF_ZW;
      c[11]:=TAB_SQL.UMF_SKR;
      c[12]:=TAB_SQL.UMF_KON;

      sum_fin[2] += TAB_SQL.WARF;  "poczatek okresu";
      sum_fin[4] += TAB_SQL.WARF_ZW;  "ze zwiekszenia";
      sum_fin[5] += TAB_SQL.WARF_SKR;  "skreslone z ewidencji";
      sum_fin[6] += TAB_SQL.WARF_KON;  "koniec okresu";
      sum_fin[7] += TAB_SQL.UMOF;  "poczatek okresu";
      sum_fin[9] += TAB_SQL.UMF_CO;  "w ciagu okresu";
      sum_fin[10] += TAB_SQL.UMF_ZW;  "ze zwiekszenia";
      sum_fin[11] += TAB_SQL.UMF_SKR;  "skreslone z ewidencji";
      sum_fin[12] += TAB_SQL.UMF_KON;  "koniec okresu"

   |? PAR_WYDR.DANE=4
   ||
      c[1] :=TAB_SQL.TAB_OPIS + ':';
      c[2]:=TAB_SQL.WARD;
      c[4]:=TAB_SQL.WARD_ZW;
      c[5]:=TAB_SQL.WARD_SKR;
      c[6]:=TAB_SQL.WARD_KON;
      c[7]:=TAB_SQL.UMOD;
      c[9]:=TAB_SQL.UMD_CO;
      c[10]:=TAB_SQL.UMD_ZW;
      c[11]:=TAB_SQL.UMD_SKR;
      c[12]:=TAB_SQL.UMD_KON;

      sum_dod[2] += TAB_SQL.WARD;  "poczatek okresu";
      sum_dod[4] += TAB_SQL.WARD_ZW;  "ze zwiekszenia";
      sum_dod[5] += TAB_SQL.WARD_SKR;  "skreslone z ewidencji";
      sum_dod[6] += TAB_SQL.WARD_KON;  "koniec okresu";
      sum_dod[7] += TAB_SQL.UMOD;  "poczatek okresu";
      sum_dod[9] += TAB_SQL.UMD_CO;  "w ciagu okresu";
      sum_dod[10] += TAB_SQL.UMD_ZW;  "ze zwiekszenia";
      sum_dod[11] += TAB_SQL.UMD_SKR;  "skreslone z ewidencji";
      sum_dod[12] += TAB_SQL.UMD_KON;  "koniec okresu"
   ?}
 ;~~}
  {prn1:='PRN'; prn2:='PRN2';rsep:=1;~~}{IF: lineleft() <= 4 & lineleft()<>0}{PAGE}{FI}{SUBSTITUTE: 'LINIA02'}
  { {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
    || c[1]:='Podatkowe:'@
    |? PAR_WYDR.DANE = 2
    || c[1]:='Bilansowe:'@
    |? PAR_WYDR.DANE = 4
    || c[1]:='Dodatkowe:'@
    ?}
  ;~~}
  {prn1:='PRN2'; prn2:='PRN'; rsep:=1;~~}
  {SUBSTITUTE: 'LINIA02'}
  {prn1:='PRN'; prn2:='PRN';~~}
{COMMENT} ---- druga linia---- {COMMENT-}
{IF: PAR_WYDR.DANE = 3}
  {
      c[1]:='Bilansowe:'@;
      c[2]:=TAB_SQL.WARF;
      c[4]:=TAB_SQL.WARF_ZW;
      c[5]:=TAB_SQL.WARF_SKR;
      c[6]:=TAB_SQL.WARF_KON;
      c[7]:=TAB_SQL.UMOF;
      c[9]:=TAB_SQL.UMF_CO;
      c[10]:=TAB_SQL.UMF_ZW;
      c[11]:=TAB_SQL.UMF_SKR;
      c[12]:=TAB_SQL.UMF_KON;

      sum_fin[2] += TAB_SQL.WARF;  "poczatek okresu";
      sum_fin[4] += TAB_SQL.WARF_ZW;  "ze zwiekszenia";
      sum_fin[5] += TAB_SQL.WARF_SKR;  "skreslone z ewidencji";
      sum_fin[6] += TAB_SQL.WARF_KON;  "koniec okresu";
      sum_fin[7] += TAB_SQL.UMOF;  "poczatek okresu";
      sum_fin[9] += TAB_SQL.UMF_CO;  "w ciagu okresu";
      sum_fin[10] += TAB_SQL.UMF_ZW;  "ze zwiekszenia";
      sum_fin[11] += TAB_SQL.UMF_SKR;  "skreslone z ewidencji";
      sum_fin[12] += TAB_SQL.UMF_KON;  "koniec okresu";

   rsep:=PAR_WYDR.RSEP;
   prn1:='PRN'; prn2:='PRN'
   ;~~}
  {SUBSTITUTE: 'LINIA02'}
{COMMENT} ---- Trzecia linia---- {COMMENT-}
{IF: FINFO.TOR_D='T'}
  {
      c[1]:='Dodatkowe:'@;
      c[2]:=TAB_SQL.WARD;
      c[4]:=TAB_SQL.WARD_ZW;
      c[5]:=TAB_SQL.WARD_SKR;
      c[6]:=TAB_SQL.WARD_KON;
      c[7]:=TAB_SQL.UMOD;
      c[9]:=TAB_SQL.UMD_CO;
      c[10]:=TAB_SQL.UMD_ZW;
      c[11]:=TAB_SQL.UMD_SKR;
      c[12]:=TAB_SQL.UMD_KON;

      sum_dod[2] += TAB_SQL.WARD;  "poczatek okresu";
      sum_dod[4] += TAB_SQL.WARD_ZW;  "ze zwiekszenia";
      sum_dod[5] += TAB_SQL.WARD_SKR;  "skreslone z ewidencji";
      sum_dod[6] += TAB_SQL.WARD_KON;  "koniec okresu";
      sum_dod[7] += TAB_SQL.UMOD;  "poczatek okresu";
      sum_dod[9] += TAB_SQL.UMD_CO;  "w ciagu okresu";
      sum_dod[10] += TAB_SQL.UMD_ZW;  "ze zwiekszenia";
      sum_dod[11] += TAB_SQL.UMD_SKR;  "skreslone z ewidencji";
      sum_dod[12] += TAB_SQL.UMD_KON + TAB_SQL.UMF_CO;  "koniec okresu";

   rsep:=PAR_WYDR.RSEP;
   prn1:='PRN'; prn2:='PRN'
   ;~~}
  {SUBSTITUTE: 'LINIA02'}
{FI}
{FI}
{FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{   {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
   ||
      c[1] :=TAB_SQL.TAB_OPIS + ':';
      c[2]:=TAB_SQL.WARP;
      c[4]:=TAB_SQL.WARP_ZW;
      c[5]:=TAB_SQL.WARP_SKR;
      c[6]:=TAB_SQL.WARP_KON;
      c[7]:=TAB_SQL.UMOP;
      c[9]:=TAB_SQL.UMP_CO;
      c[10]:=TAB_SQL.UMP_ZW;
      c[11]:=TAB_SQL.UMP_SKR;
      c[12]:=TAB_SQL.UMP_KON;

      sum_pod[2] += TAB_SQL.WARP;  "poczatek okresu";
      sum_pod[4] += TAB_SQL.WARP_ZW;  "ze zwiekszenia";
      sum_pod[5] += TAB_SQL.WARP_SKR;  "skreslone z ewidencji";
      sum_pod[6] += TAB_SQL.WARP_KON;  "koniec okresu";
      sum_pod[7] += TAB_SQL.UMOP;  "poczatek okresu";
      sum_pod[9] += TAB_SQL.UMP_CO;  "w ciagu okresu";
      sum_pod[10] += TAB_SQL.UMP_ZW; "ze zwiekszenia";
      sum_pod[11] += TAB_SQL.UMP_SKR; "skreslone z ewidencji";
      sum_pod[12] += TAB_SQL.UMP_KON; "koniec okresu"
   |? PAR_WYDR.DANE = 2
   ||
      c[1] :=TAB_SQL.TAB_OPIS + ':';
      c[13]:=TAB_SQL.WARF;
      c[14]:=TAB_SQL.WARF_ZW;
      c[15]:=TAB_SQL.WARF_SKR;
      c[16]:=TAB_SQL.WARF_KON;
      c[17]:=TAB_SQL.UMOF;
      c[18]:=TAB_SQL.UMF_CO;
      c[19]:=TAB_SQL.UMF_ZW;
      c[20]:=TAB_SQL.UMF_SKR;
      c[21]:=TAB_SQL.UMF_KON;

      sum_fin[2] += TAB_SQL.WARF;  "poczatek okresu";
      sum_fin[4] += TAB_SQL.WARF_ZW;  "ze zwiekszenia";
      sum_fin[5] += TAB_SQL.WARF_SKR;  "skreslone z ewidencji";
      sum_fin[6] += TAB_SQL.WARF_KON;  "koniec okresu";
      sum_fin[7] += TAB_SQL.UMOF;  "poczatek okresu";
      sum_fin[9] += TAB_SQL.UMF_CO;  "w ciagu okresu";
      sum_fin[10] += TAB_SQL.UMF_ZW;  "ze zwiekszenia";
      sum_fin[11] += TAB_SQL.UMF_SKR;  "skreslone z ewidencji";
      sum_fin[12] += TAB_SQL.UMF_KON;  "koniec okresu"

   |? PAR_WYDR.DANE=4
   || c[1] :=TAB_SQL.TAB_OPIS + ':';
      c[22]:=TAB_SQL.WARD;
      c[23]:=TAB_SQL.WARD_ZW;
      c[24]:=TAB_SQL.WARD_SKR;
      c[25]:=TAB_SQL.WARD_KON;
      c[26]:=TAB_SQL.UMOD;
      c[27]:=TAB_SQL.UMD_CO;
      c[28]:=TAB_SQL.UMD_ZW;
      c[29]:=TAB_SQL.UMD_SKR;
      c[30]:=TAB_SQL.UMD_KON;

      sum_dod[2] += TAB_SQL.WARD;  "poczatek okresu";
      sum_dod[4] += TAB_SQL.WARD_ZW;  "ze zwiekszenia";
      sum_dod[5] += TAB_SQL.WARD_SKR;  "skreslone z ewidencji";
      sum_dod[6] += TAB_SQL.WARD_KON;  "koniec okresu";
      sum_dod[7] += TAB_SQL.UMOD;  "poczatek okresu";
      sum_dod[9] += TAB_SQL.UMD_CO;  "w ciagu okresu";
      sum_dod[10] += TAB_SQL.UMD_ZW;  "ze zwiekszenia";
      sum_dod[11] += TAB_SQL.UMD_SKR;  "skreslone z ewidencji";
      sum_dod[12] += TAB_SQL.UMD_KON;  "koniec okresu"
   ?}
 ;~~}
  {prn1:='PRN2'; prn2:='PRN'; rsep:=1;~~}
  {prn1:='PRN'; prn2:='PRN';~~}
{COMMENT} ---- druga linia---- {COMMENT-}
{IF: PAR_WYDR.DANE = 3}
  {
      c[13]:=TAB_SQL.WARF;
      c[14]:=TAB_SQL.WARF_ZW;
      c[15]:=TAB_SQL.WARF_SKR;
      c[16]:=TAB_SQL.WARF_KON;
      c[17]:=TAB_SQL.UMOF;
      c[18]:=TAB_SQL.UMF_CO;
      c[19]:=TAB_SQL.UMF_ZW;
      c[20]:=TAB_SQL.UMF_SKR;
      c[21]:=TAB_SQL.UMF_KON;

      sum_fin[2] += TAB_SQL.WARF;  "poczatek okresu";
      sum_fin[4] += TAB_SQL.WARF_ZW;  "ze zwiekszenia";
      sum_fin[5] += TAB_SQL.WARF_SKR;  "skreslone z ewidencji";
      sum_fin[6] += TAB_SQL.WARF_KON;  "koniec okresu";
      sum_fin[7] += TAB_SQL.UMOF;  "poczatek okresu";
      sum_fin[9] += TAB_SQL.UMF_CO;  "w ciagu okresu";
      sum_fin[10] += TAB_SQL.UMF_ZW;  "ze zwiekszenia";
      sum_fin[11] += TAB_SQL.UMF_SKR;  "skreslone z ewidencji";
      sum_fin[12] += TAB_SQL.UMF_KON;  "koniec okresu";

   rsep:=PAR_WYDR.RSEP;
   prn1:='PRN'; prn2:='PRN'
   ;~~}
{COMMENT} ---- Trzecia linia---- {COMMENT-}
{IF: FINFO.TOR_D='T'}
  {
      c[22]:=TAB_SQL.WARD;
      c[23]:=TAB_SQL.WARD_ZW;
      c[24]:=TAB_SQL.WARD_SKR;
      c[25]:=TAB_SQL.WARD_KON;
      c[26]:=TAB_SQL.UMOD;
      c[27]:=TAB_SQL.UMD_CO;
      c[28]:=TAB_SQL.UMD_ZW;
      c[29]:=TAB_SQL.UMD_SKR;
      c[30]:=TAB_SQL.UMD_KON;

      sum_dod[2] += TAB_SQL.WARD;  "poczatek okresu";
      sum_dod[4] += TAB_SQL.WARD_ZW;  "ze zwiekszenia";
      sum_dod[5] += TAB_SQL.WARD_SKR;  "skreslone z ewidencji";
      sum_dod[6] += TAB_SQL.WARD_KON;  "koniec okresu";
      sum_dod[7] += TAB_SQL.UMOD;  "poczatek okresu";
      sum_dod[9] += TAB_SQL.UMD_CO;  "w ciagu okresu";
      sum_dod[10] += TAB_SQL.UMD_ZW;  "ze zwiekszenia";
      sum_dod[11] += TAB_SQL.UMD_SKR;  "skreslone z ewidencji";
      sum_dod[12] += TAB_SQL.UMD_KON + TAB_SQL.UMF_CO;  "koniec okresu";

   rsep:=PAR_WYDR.RSEP;
   prn1:='PRN'; prn2:='PRN'
   ;~~}
{FI}
{FI}
 {SUBSTITUTE: 'LINIA02'}
{FI}
 {OD}
{COMMENT}------------------------------FOOTER-LAST------------------{COMMENT-}
{IF: lineleft()<>0 & lineleft()<6}{PAGE}{FI}
{FOOTER}{FOOTER-}
{COMMENT}{ vp:=0; ~~}{COMMENT-}
{COMMENT} ---- podsumowanie nie występuje dla excela ---- {COMMENT-}
{IF: ~rep_export()}
{FONT: 'T8GB'}{SPACE: 'C'}
{
   {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
   ||
      c[1]:='Ogółem:'@;
      c[2]:=sum_pod[2];
      c[4]:=sum_pod[4];
      c[5]:=sum_pod[5];
      c[6]:=sum_pod[6];
      c[7]:=sum_pod[7];
      c[9]:=sum_pod[9];
      c[10]:=sum_pod[10];
      c[11]:=sum_pod[11];
      c[12]:=sum_pod[12]
   |? PAR_WYDR.DANE = 2
   ||
      c[1]:='Ogółem:'@;
      c[2]:=sum_fin[2];
      c[4]:=sum_fin[4];
      c[5]:=sum_fin[5];
      c[6]:=sum_fin[6];
      c[7]:=sum_fin[7];
      c[9]:=sum_fin[9];
      c[10]:=sum_fin[10];
      c[11]:=sum_fin[11];
      c[12]:=sum_fin[12]
   |? PAR_WYDR.DANE=4
   ||
      c[1]:='Ogółem:'@;
      c[2]:=sum_dod[2];
      c[4]:=sum_dod[4];
      c[5]:=sum_dod[5];
      c[6]:=sum_dod[6];
      c[7]:=sum_dod[7];
      c[9]:=sum_dod[9];
      c[10]:=sum_dod[10];
      c[11]:=sum_dod[11];
      c[12]:=sum_dod[12]
   ?}
;~~}
{prn1:='PRN'; prn2:='PRN2';rsep:=1;~~}
{SUBSTITUTE: 'LINIA02'}
{prn1:='PRN2'; prn2:='PRNF';~~}
{
  {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
  || c[1]:='Podatkowe'@
  |? PAR_WYDR.DANE = 2
  || c[1]:='Bilansowe'@
  |? PAR_WYDR.DANE=4
  || c[1]:='Dodatkowe'@
  ?};
  rsep:=1
;~~}
{SUBSTITUTE: 'LINIA02'}
{  prn1:='PRNF';prn2:='PRNF';
   "vp:=0";
   rsep:=PAR_WYDR.RSEP
;~~}
{IF: PAR_WYDR.DANE = 3}
{
   c[1]:='Bilansowe:'@;
   c[2]:=sum_fin[2];
   c[4]:=sum_fin[4];
   c[5]:=sum_fin[5];
   c[6]:=sum_fin[6];
   c[7]:=sum_fin[7];
   c[9]:=sum_fin[9];
   c[10]:=sum_fin[10];
   c[11]:=sum_fin[11];
   c[12]:=sum_fin[12]
;~~}
{SUBSTITUTE: 'LINIA02'}
{IF: FINFO.TOR_D='T'}
{  prn1:='PRNF';prn2:='PRNF';
   "vp:=0";
   rsep:=PAR_WYDR.RSEP
;~~}
{
   c[1]:='Dodatkowe:'@;
   c[2]:=sum_dod[2];
   c[4]:=sum_dod[4];
   c[5]:=sum_dod[5];
   c[6]:=sum_dod[6];
   c[7]:=sum_dod[7];
   c[9]:=sum_dod[9];
   c[10]:=sum_dod[10];
   c[11]:=sum_dod[11];
   c[12]:=sum_dod[12]
;~~}
{SUBSTITUTE: 'LINIA02'}
{FI}
{FI}
{FI}
{ "vp:=0"; ~~}
{REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}