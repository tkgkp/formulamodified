:!UTF-8
{TITLE:A. Lista wierszy dla wybranego sprawozdania}
{PRINTER: SIK.PRT,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
   PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   i:=0;
   PRN:=obj_new(@.CLASS.PRINT,10); PRN.sl_frame();
   rap_name:=color:=prn1:=prn2:=''; first:=lm:=ll:=vp:=lmt:=rsep:=0
}
{END:
   VAR_DEL.delete('PRN','dz'); &i;
   &first; &rap_name; &color; &prn1; &prn2; &lm; &ll; &vp; &lmt; &rsep
}
{  PRN.add("KONTRAHENT.NAZWA", 41, 'Znacznik');
   PRN.add("KONTRAHENT.DANE", 94, 'Treść');
   PAR_WYDR.TITLE:='Raport zbiorowy'@;
   prn1:=prn2:='PRN'; ~~}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: page=1 & ~rep_export()}
{SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}------------------------------REPORT-HEADER---------------cos sobie pisz-{COMMENT-}
{IF: ~rep_export()}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{MACRO: 'PARAMETRY'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{<1 'Typ kontrahenta w bazie: %1'@[KH.TYP]}
{<1 'Typ kontrahenta w GUS: %1'@[__typ]}
{IF:first=0}
{KONTRAHENT.index(KONTRAHENT.ndx_tmp(,,'NUMER',,));
 KONTRAHENT.prefix('1')}
{IF:KONTRAHENT.first()}
{rap_name:=KONTRAHENT.RAPORT; first:=1;~~}
{FI}
{FI}
{<1>{charleft()} rap_name}
{LINE: 1}
{MACRO-}
{SUBSTITUTE: 'PARAMETRY'}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
{FI}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{SUBSTITUTE: 'PARAMETRY'}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{IF: ~rep_export()}
{SUBSTITUTE: 'LINIAF'}
{~~}
{FI}
{FOOTER-}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{KONTRAHENT.index(KONTRAHENT.ndx_tmp(,,'NUMER',,));
 KONTRAHENT.prefix('1')}
{IF:KONTRAHENT.first()}
{rap_name:=KONTRAHENT.RAPORT;~~}
{FOR: KONTRAHENT}
{INDEX: KONTRAHENT.ndx_tmp(,,'NUMER',,)}
{PREFIX: '1'}
{DO}
{SUBSTITUTE: 'LINIA0'}
{WHILE: PRN.next()}{DO}{OD}
{OD}
{FI}
{KONTRAHENT.prefix('2')}
{IF:KONTRAHENT.first()}
{rap_name:=KONTRAHENT.RAPORT;~~}
{PAGE}
{FONT: 'T8G'}{SPACE: 'C'}
{FOR: KONTRAHENT}
{INDEX: KONTRAHENT.ndx_tmp(,,'NUMER',,)}
{PREFIX: '2'}
{DO}
{SUBSTITUTE: 'LINIA0'}
{WHILE: PRN.next()}{DO}{OD}
{OD}
{FI}
{KONTRAHENT.prefix('3')}
{IF:KONTRAHENT.first()}
{rap_name:=KONTRAHENT.RAPORT;~~}
{PAGE}
{FONT: 'T8G'}{SPACE: 'C'}
{FOR: KONTRAHENT}
{INDEX: KONTRAHENT.ndx_tmp(,,'NUMER',,)}
{PREFIX: '3'}
{DO}
{SUBSTITUTE: 'LINIA0'}
{WHILE: PRN.next()}{DO}{OD}
{OD}
{FI}
{KONTRAHENT.prefix('4')}
{IF:KONTRAHENT.first()}
{rap_name:=KONTRAHENT.RAPORT;~~}
{PAGE}
{FONT: 'T8G'}{SPACE: 'C'}
{FOR: KONTRAHENT}
{INDEX: KONTRAHENT.ndx_tmp(,,'NUMER',,)}
{PREFIX: '4'}
{DO}
{SUBSTITUTE: 'LINIA0'}
{WHILE: PRN.next()}{DO}{OD}
{OD}
{FI}