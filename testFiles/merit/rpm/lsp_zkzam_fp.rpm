:!UTF-8
{TITLE:C. Faktura PROFORMA}
{PRINTER: exec('set_parw','param_wydr');exec('prt','param_wydr','v'),,,,,'Q','C',,,,,,1,10,
   10,10,10,0,exec('get','#params',2121,2,OPERATOR.USER)<>'T'}
{BEGIN:
   {? exec('czy_grp_dr','faktury_wydruk_new')
   || __GRP_DR.WZ:='lsp_zkzam_fp'
   ?};
   POLA.NAZ_WYDR:='Faktura pro-forma '+exec('str_to_pth','#string',ZK_N.SYM)+'.pdf';
   exec('begin_p_new','zamsiw_wydruk');
   VAR_DEL.delete('__tab_sel','wl','wl_pdf');
   {? ZK_N.sel_size()
   ||
      {? PARAM_W.KOPIA
      ||
      wl:=ZK_N.sel_size()*(PARAM_W.KOPIA+1)
      ||
      wl:=ZK_N.sel_size()
      ?}
   ||
      wl:=(PARAM_W.KOPIA+1)
   ?};
   wl-=1;
   stron:=0
}
{END:
   exec('end_p_new','zamsiw_wydruk');
   VAR_DEL.delete('__tab_sel','wl','wl_pdf')
}
{IF: exec('upr_cs','ceny')=0}{ FUN.info('Brak uprawnień do wartości sprzedaży.'@);~~}{EXIT}{FI}
{IF: wyjscie=1}{EXIT}{FI}
{INCLUDE: lsp_fak_pro.rpi}
{INCLUDE: wsp_pw.rpi}
{INCLUDE: wsp_lic.rpi}
{INCLUDE: wsp_strony_new.rpi}
{IF:ZK_N.sel_size()>0 & __GRP_DR.PDF=0}
   {
        ZK_N.cntx_psh();
      __tab_sel:=ZK_N.sel_aget()
   ;~~}
{FOR: __tab_sel}
   {DO}
      {IF: ZK_N.seek(__tab_sel.REF,)}
         {SUBSTITUTE: 'druk'}
         {page(1);ilkop:=0;~~}
      {FI}
   {OD}
   {
      ZK_N.cntx_pop();
      ilkop:=1
   ;~~}
{ELSE}
   {wl_pdf:=PARAM_W.KOPIA;~~}
   {SUBSTITUTE: 'druk'}
{FI}