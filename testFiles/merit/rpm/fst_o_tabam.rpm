:!UTF-8
{TITLE:H. Tabela roczna amortyzacji}
{PRINTER: FINFO.SZ_PRN,,,,,'M','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT+3,0,1,,'enable'}
{BEGIN:
   PRN:=obj_new(@.CLASS.PRINT,13+{? rep_export() || 54 ?}); PRN.sl_frame();
   PRN1:=obj_new(@.CLASS.PRINT,13); PRN1.sl_frame();
   PRN2:=obj_new(@.CLASS.PRINT,13); PRN2.sl_frame();
   PRN3:=obj_new(@.CLASS.PRINT,13); PRN3.sl_frame();
   c:=obj_new(13+{? rep_export() || 54 ?});
   gp:=obj_new(16);
   gf:=obj_new(16);
   gd:=obj_new(16);
   {! _i:=1..13+{? rep_export() || 54 ?} |! c[_i] := '' !};
   {! _i:=1..16 |! gp[_i] := 0 !};
   {! _i:=1..16 |! gf[_i] := 0 !};
   {! _i:=1..16 |! gd[_i] := 0 !};
   sum_pod:=obj_new(16);
   sum_fin:=obj_new(16);
   sum_dod:=obj_new(16);
   {! _i:=1..16 |! sum_pod[_i] := 0; sum_fin[_i] := 0; sum_dod[_i] := 0  !};
   SRST.cntx_psh(); SRSR.cntx_psh();
   i:=0;
   sum_grupa:=''; test_grupa:='';
   color:=prn1:=prn2:=prn3:='';
   podsum:=0;
   lm:=ll:=vp:=lmt:=rsep:=0;
   par1:=0; par2:=0; par3:=0; par4:=0; par5:=0
}
{END:
   obj_del(PRN);
   obj_del(PRN1);
   obj_del(PRN2);
   obj_del(PRN3);
   obj_del(c); obj_del(gp); obj_del(gf); obj_del(gd);
   obj_del(sum_pod); obj_del(sum_fin); obj_del(sum_dod);
   SRST.cntx_pop(); SRSR.cntx_pop();
   &sum_grupa; &test_grupa;
   &i; &color; &prn1; &prn2; &prn3;
   &podsum;
   &lm; &ll; &vp; &lmt; &rsep;
   &par1; &par2;  &par3; &par4; &par5
}
{EXIT:
   exec('clear_par','fst');
   exec('set_parw','param_wydr');
   {? OPERATOR.DEPT<>null
   || PAR_WYDR.ODD:=OPERATOR.DEPT
   || PAR_WYDR.ODD:=0
   ?};
   exec('init','fst');
   SRD.maski('r');
   {? SSTALE.AO().KON<>date(0,0,0)
   || PAR_WYDR.STAN_NA:=SSTALE.AO().KON
   |? SSTALE.AO().OES=0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().POCZ_ROK
   |? SSTALE.AO().OES>0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().KON_ROK
   ?};
   PAR_WYDR.WART_PN:=2;
   PAR_WYDR.ZESTAW:=2;
   PAR_WYDR.ZMIANY:='T';
   PAR_WYDR.RODZAJ2:=1;
   SRD.PAR_WYDR:='T';
   PAR_WYDR.JORG:=null; EDIT_ES.JORG:='';
   exec('odd_filtr','fst');
   exec('set_gr_list','fst');
   {? FINFO.TOR_D = 'T'
   || PAR_WYDR.win_edit('TABAMOD')
   || PAR_WYDR.win_edit('TABAMO')
   ?};
   PAR_WYDR.hdr_edit(': H. Tabela roczna amortyzacji'@);
   {? PAR_WYDR.edit("exec('check_tabamo','fst')")
   || VAR_DEL.delete('TAB_SQL');
      TAB_SQL:=exec('o_tabam','fst2',PAR_WYDR.RODZAJ,PAR_WYDR.ZAKRESDR,PAR_WYDR.PRZYCHOD,PAR_WYDR.ROZCHOD,PAR_WYDR.ODD().OD);
      {? exec('if_ok','fst','TAB_SQL') || _exit:=0 || _exit:=1 ?}
   || _exit:=1
   ?};
   _exit
}
{COMMENT}
==================================================
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
Nazwa pliku: fst_o_tabam.rpm
Utworzony  : 2004-09-10
Zawartość  : Tabela roczna amortyzacji
==================================================
------------------------ OPIS PÓL ZMIENNEJ PAR_WYDR ------------{COMMENT-}
{COMMENT}
ODD    : jedn. ksiegowa
{COMMENT-}
{COMMENT}zmienne pomocnicze do wydrukow graficznych:
i - licznik, color, prn1, lm, ll, vp, lmt, rsep
{COMMENT-}
{PAR_WYDR.cntx_psh(); ~~}
{INCLUDE: wsp_pw.rpi}
{PAR_WYDR.cntx_pop(); ~~}
{MACRO: 'TABHEAD2'}
{ _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
{ _f:=prn1+'.ini_head()'; ($(_f))()}
{REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}
{WHILE: _f:=prn1+'.h_next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.h_fmline(lmt)'; ($(_f))()}
{OD}
{REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
{ _f:=prn2+'.ini_head()'; ($(_f))()}
{ _f:=prn2+'.setcolor(color)'; ($(_f))(); ~~}
{WHILE: _f:=prn2+'.h_next()'; ($(_f))()}
{DO}
   {REP: _f:=prn2+'.h_fmline(lmt)'; ($(_f))()}
{OD}
{MACRO-}
{COMMENT}--Definicja wiersza wydruku--------------------{COMMENT-}
{  prn1:='PRN'; prn2:='PRN'; ~~}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
      PRN.add("{? type_of(c[1]) = 1 || form(c[1],,2,' ,') || c[1] ?}",15,'I',1,'#');
      PRN.add("{? type_of(c[2]) = 1 || form(c[2],,2,' ,') || c[2] ?}",14,'II',1,'#');
      PRN.add("{? type_of(c[3]) = 1 || form(c[3],,2,' ,') || c[3] ?}",14,'III',1,'#');
      PRN.add("{? type_of(c[4]) = 1 || form(c[4],,2,' ,') || c[4] ?}",14,'IV',1,'#');
      PRN.add("{? type_of(c[5]) = 1 || form(c[5],,2,' ,') || c[5] ?}",14,'V',1,'#');
      PRN.add("{? type_of(c[6]) = 1 || form(c[6],,2,' ,') || c[6] ?}",20,'VI',1,'#');
      PRN.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}",21,'VII',1,'#');
      PRN.add("{? type_of(c[8]) = 1 || form(c[8],,2,' ,') || c[8] ?}",14,'VIII',1,'#');
      PRN.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}",15,'IX',1,'#');
      PRN.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}",14,'X',1,'#');
      PRN.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}",14,'XI',1,'#');
      PRN.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}",14,'XII',1,'#');
      PRN.add("{? type_of(c[13]) = 1 || form(c[13],,2,' ,') || c[13] ?}",14,'ZA ROK'@,1,'#');

      {? PAR_WYDR.RODZAJ = 1 & (PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 2 | PAR_WYDR.DANE = 4)
      || PRN1.add("c[1]",164,'');
         PRN1.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}", 14, '',1);
         PRN1.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}", 14, '',1);
         PRN1.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}", 14, '',1)
      |? PAR_WYDR.RODZAJ = 2 | PAR_WYDR.DANE = 3
      || PRN1.add("c[1]",209,'')
      ?};

      PRN2.add("{? type_of(c[3]) = 1 || form(c[3],,2,' ,') || c[3] ?}", 15, 'Numer'@);
      PRN2.add("c[1]", 44, 'Nazwa'@);
      PRN2.add("c[12]", 14, 'Jednostka#księgowa'@,,'#');
      PRN2.add("{? type_of(c[2]) = 1 || form(c[2],,2,' ,') || c[2] ?}", 15, 'Metoda'@);
      PRN2.add("{? type_of(c[4]) = 1 || form(c[4],,2,' ,') || c[4] ?}", 4, 'Gr.'@);
      PRN2.add("{? type_of(c[5]) = 1 || form(c[5],,2,' ,') || c[5] ?}", 21, 'Stawka'@,1);
      PRN2.add("{? type_of(c[6]) = 1 || form(c[6],,2,' ,') || c[6] ?}", 14, 'Data ekspl.'@);
      PRN2.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}", 15, 'Rozchód'@);
      PRN2.add("{? type_of(c[8]) = 1 || form(c[8],,2,' ,') || c[8] ?}", 14, 'Data skr.'@);
      PRN2.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}", 14, 'Wartość'@,1);
      PRN2.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}", 14, 'Umorzenie'@,1);
      PRN2.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}", 14, 'Netto'@,1);

      PRN3.add("", 15, 'Numer#inwentarzowy'@,,'#');
      PRN3.add("", 44, 'Nazwa środka'@);
      PRN3.add("", 14, 'Jednostka#księgowa'@,,'#');
      PRN3.add("", 15, 'Metoda amort.'@,,'#');
      PRN3.add("",  4, 'Gr.'@,,'#');
      PRN3.add("", 21, 'Stawka amort.'@ + {? PAR_WYDR.DANE = 3
                                          || {? FINFO.TOR_D = 'T'
                                             || '#POD/BIL/DOD'@
                                             || '#POD/BIL'@
                                             ?}
                                           || ''
                                           ?},,'#');
      PRN3.add("", 14, 'Data# eksploat. '@,,'#');
      PRN3.add("", 15, 'Rodzaj  #rozchodu'@,,'#');
      PRN3.add("", 14, 'Data   # skresl.'@,,'#');
      {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 2 | PAR_WYDR.DANE = 4
      || PRN3.add("", 14, 'Wartość#inwentarz.'@,,'#');
         PRN3.add("", 14, 'Umorzenie'@,,'#');
         PRN3.add("", 14, 'Wartość   #netto'@,,'#')
      || PRN3.add("", 14, 'Wart. inw.#podatkowa'@,,'#');
         PRN3.add("", 14, 'Umorzenie#podatkowe'@,,'#');
         PRN3.add("", 14, 'Wart. netto#podatkowa'@,,'#')
      ?};

      PAR_WYDR.TITLE:='Tabela roczna amortyzacji - rok obrachunkowy %1'@[SSTALE.AR().NAZ]; ~~}
{FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
{? PAR_WYDR.RODZAJ=2 ||
      {? PAR_WYDR.ZESTAW=1
      || PRN.add("c[17]", 15, 'Jedn. ks.'@,,'#')
      |? PAR_WYDR.ZESTAW=2
      || PRN.add("c[17]", 15, 'Grupa'@,,'#')
      ?} ?};
{? PAR_WYDR.RODZAJ=1 ||
      PRN.add("c[17]", 15, 'Numer inwentarzowy'@,,'#');
      PRN.add("c[18]", 44, 'Nazwa środka'@);
      PRN.add("c[19]", 14, 'Jednostka księgowa'@,,'#');
      PRN.add("c[21]",  4, 'Gr.'@,,'#');
   {? PAR_WYDR.DANE = 3
   || {? FINFO.TOR_D = 'T'
      || PRN.add("c[20]", 15, 'Metoda amort. POD'@,,'#');
         PRN.add("c[60]", 15, 'Metoda amort. BIL'@,,'#');
         PRN.add("c[61]", 15, 'Metoda amort. DOD'@,,'#');
         PRN.add("c[22]", 21, 'Stawka amort. POD'@,,'#');
         PRN.add("c[45]", 21, 'Stawka amort. BIL'@,,'#');
         PRN.add("c[46]", 21, 'Stawka amort. DOD'@,,'#')
      || PRN.add("c[20]", 15, 'Metoda amort. POD'@,,'#');
         PRN.add("c[60]", 15, 'Metoda amort. BIL'@,,'#');
         PRN.add("c[22]", 21, 'Stawka amort. POD'@,,'#');
         PRN.add("c[45]", 21, 'Stawka amort. BIL'@,,'#') ?}
      || PRN.add("c[20]", 15, 'Metoda amort.'@,,'#');
         PRN.add("c[22]", 21, 'Stawka amort.'@,,'#') ?};

      PRN.add("c[23]", 14, 'Data eksploat. '@,,'#');
      PRN.add("c[24]", 15, 'Rodzaj  rozchodu'@,,'#');
      PRN.add("c[25]", 14, 'Data    skresl.'@,,'#');
      {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 2 | PAR_WYDR.DANE = 4
      || PRN.add("{? type_of(c[26]) = 1 || form(c[26],,2,' ,') || c[26] ?}", 14, 'Wartość inwentarz.'@,1,'#');
         PRN.add("{? type_of(c[27]) = 1 || form(c[27],,2,' ,') || c[27] ?}", 14, 'Umorzenie'@,1,'#');
         PRN.add("{? type_of(c[28]) = 1 || form(c[28],,2,' ,') || c[28] ?}", 14, 'Wartość   netto'@,1,'#')
      || PRN.add("{? type_of(c[26]) = 1 || form(c[26],,2,' ,') || c[26] ?}", 14, 'Wart. inw. podatkowa'@,1,'#');
         PRN.add("{? type_of(c[27]) = 1 || form(c[27],,2,' ,') || c[27] ?}", 14, 'Umorzenie podatkowe'@,1,'#');
         PRN.add("{? type_of(c[28]) = 1 || form(c[28],,2,' ,') || c[28] ?}", 14, 'Wart. netto podatkowa'@,1,'#')
      ?} ?};
   {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
   || PRN.add("{? type_of(c[1]) = 1 || form(c[1],,2,' ,') || c[1] ?}",15,'POD I',1,'#');
      PRN.add("{? type_of(c[2]) = 1 || form(c[2],,2,' ,') || c[2] ?}",14,'POD II',1,'#');
      PRN.add("{? type_of(c[3]) = 1 || form(c[3],,2,' ,') || c[3] ?}",14,'POD III',1,'#');
      PRN.add("{? type_of(c[4]) = 1 || form(c[4],,2,' ,') || c[4] ?}",14,'POD IV',1,'#');
      PRN.add("{? type_of(c[5]) = 1 || form(c[5],,2,' ,') || c[5] ?}",14,'POD V',1,'#');
      PRN.add("{? type_of(c[6]) = 1 || form(c[6],,2,' ,') || c[6] ?}",20,'POD VI',1,'#');
      PRN.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}",21,'POD VII',1,'#');
      PRN.add("{? type_of(c[8]) = 1 || form(c[8],,2,' ,') || c[8] ?}",14,'POD VIII',1,'#');
      PRN.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}",15,'POD IX',1,'#');
      PRN.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}",14,'POD X',1,'#');
      PRN.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}",14,'POD XI',1,'#');
      PRN.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}",14,'POD XII',1,'#');
      PRN.add("{? type_of(c[13]) = 1 || form(c[13],,2,' ,') || c[13] ?}",14,'POD ZA ROK'@,1,'#') ?};
   {? PAR_WYDR.DANE = 2 | PAR_WYDR.DANE = 3
   || PRN.add("{? type_of(c[32]) = 1 || form(c[32],,2,' ,') || c[32] ?}",15,'BIL I',1,'#');
      PRN.add("{? type_of(c[33]) = 1 || form(c[33],,2,' ,') || c[33] ?}",14,'BIL II',1,'#');
      PRN.add("{? type_of(c[34]) = 1 || form(c[34],,2,' ,') || c[34] ?}",14,'BIL III',1,'#');
      PRN.add("{? type_of(c[35]) = 1 || form(c[35],,2,' ,') || c[35] ?}",14,'BIL IV',1,'#');
      PRN.add("{? type_of(c[36]) = 1 || form(c[36],,2,' ,') || c[36] ?}",14,'BIL V',1,'#');
      PRN.add("{? type_of(c[37]) = 1 || form(c[37],,2,' ,') || c[37] ?}",20,'BIL VI',1,'#');
      PRN.add("{? type_of(c[38]) = 1 || form(c[38],,2,' ,') || c[38] ?}",21,'BIL VII',1,'#');
      PRN.add("{? type_of(c[39]) = 1 || form(c[39],,2,' ,') || c[39] ?}",14,'BIL VIII',1,'#');
      PRN.add("{? type_of(c[40]) = 1 || form(c[40],,2,' ,') || c[40] ?}",15,'BIL IX',1,'#');
      PRN.add("{? type_of(c[41]) = 1 || form(c[41],,2,' ,') || c[41] ?}",14,'BIL X',1,'#');
      PRN.add("{? type_of(c[42]) = 1 || form(c[42],,2,' ,') || c[42] ?}",14,'BIL XI',1,'#');
      PRN.add("{? type_of(c[43]) = 1 || form(c[43],,2,' ,') || c[43] ?}",14,'BIL XII',1,'#');
      PRN.add("{? type_of(c[44]) = 1 || form(c[44],,2,' ,') || c[44] ?}",14,'BIL ZA ROK'@,1,'#') ?};
   {? PAR_WYDR.DANE = 4
   || PRN.add("{? type_of(c[47]) = 1 || form(c[47],,2,' ,') || c[47] ?}",15,'DOD I',1,'#');
      PRN.add("{? type_of(c[48]) = 1 || form(c[48],,2,' ,') || c[48] ?}",14,'DOD II',1,'#');
      PRN.add("{? type_of(c[49]) = 1 || form(c[49],,2,' ,') || c[49] ?}",14,'DOD III',1,'#');
      PRN.add("{? type_of(c[50]) = 1 || form(c[50],,2,' ,') || c[50] ?}",14,'DOD IV',1,'#');
      PRN.add("{? type_of(c[51]) = 1 || form(c[51],,2,' ,') || c[51] ?}",14,'DOD V',1,'#');
      PRN.add("{? type_of(c[52]) = 1 || form(c[52],,2,' ,') || c[52] ?}",20,'DOD VI',1,'#');
      PRN.add("{? type_of(c[53]) = 1 || form(c[53],,2,' ,') || c[53] ?}",21,'DOD VII',1,'#');
      PRN.add("{? type_of(c[54]) = 1 || form(c[54],,2,' ,') || c[54] ?}",14,'DOD VIII',1,'#');
      PRN.add("{? type_of(c[55]) = 1 || form(c[55],,2,' ,') || c[55] ?}",15,'DOD IX',1,'#');
      PRN.add("{? type_of(c[56]) = 1 || form(c[56],,2,' ,') || c[56] ?}",14,'DOD X',1,'#');
      PRN.add("{? type_of(c[57]) = 1 || form(c[57],,2,' ,') || c[57] ?}",14,'DOD XI',1,'#');
      PRN.add("{? type_of(c[58]) = 1 || form(c[58],,2,' ,') || c[58] ?}",14,'DOD XII',1,'#');
      PRN.add("{? type_of(c[59]) = 1 || form(c[59],,2,' ,') || c[59] ?}",14,'DOD ZA ROK'@,1,'#') ?};

      {? PAR_WYDR.RODZAJ = 1 & (PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 2 | PAR_WYDR.DANE = 4)
      || PRN1.add("c[1]",164,'');
         PRN1.add("{? type_of(c[14]) = 1 || form(c[14],,2,' ,') || c[14] ?}", 14, '',1);
         PRN1.add("{? type_of(c[15]) = 1 || form(c[15],,2,' ,') || c[15] ?}", 14, '',1);
         PRN1.add("{? type_of(c[16]) = 1 || form(c[16],,2,' ,') || c[16] ?}", 14, '',1)
      ?};

      PAR_WYDR.TITLE:='Tabela roczna amortyzacji - rok obrachunkowy %1'@[SSTALE.AR().NAZ]; ~~}
{FI}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{COMMENT}------------------------------Parametry wydruku------------{COMMENT-}
{FONT: 'W8'}{SPACE: 'C'}
{<1 'PARAMETRY WYDRUKU:'@}
{COMMENT} ---- Stan na, Grupa, Rodzaj zestawienia ---- {COMMENT-}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
  par1:=(PAR_WYDR.STAN_NA$6)+ ' r.'@;

  {? PAR_WYDR.WAR_GR = 1
  || {? |PAR_WYDR.GRUPA<>'' || par2:=|PAR_WYDR.GRUPA || par2:='dowolna'@ ?}
  |? PAR_WYDR.WAR_GR = 2
  || {? |PAR_WYDR.GRUPA_OD<>'' || _od:='od: '@ + |PAR_WYDR.GRUPA_OD || _od:=''?};
     {? |PAR_WYDR.GRUPA_DO<>'' || _do:='do: '@ + |PAR_WYDR.GRUPA_DO || _do:=''?};
     {? _od<>'' & _do<>'' || par2:=_od + ' ' + _do
     |? _od<>'' & _do='' ||  par2:=_od
     |? _od='' & _do<>'' || par2:=_do
    ?}
  |? PAR_WYDR.WAR_GR=4
  || par2:='wszystkie'
  ?};

  {? PAR_WYDR.RODZAJ=1
  || par3:='analityczne'@ || par3:='syntetyczne'@
  ?};

  {? PAR_WYDR.ZAKRESDR=0
  || par4:='trwałe i niskocenne'@
  |? PAR_WYDR.ZAKRESDR=1
  || par4:='trwałe'@
  |? PAR_WYDR.ZAKRESDR=2
  || par4:='niskocenne'@
  ?}
;~~}
{IF: PAR_WYDR.WAR_GR<>3}
{FONT: 'W8B'}{<1 'Stan środków na: '@}{FONT: 'W8'}{<19 par1}{FONT: 'W8B'}{<51 'Grupa: '@}{FONT: 'W8'}{<63 par2}{FONT: 'W8B'}{<86 'Rodzaj zestawienia: '@}{FONT: 'W8'}{<103 par3}{FONT: 'W8B'}{<123 'Zakres środków: '@}{FONT: 'W8'}{<132 par4}
{ELIF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{<1 'Stan środków na: '@}{FONT: 'W8'}{<19  par1}{FONT: 'W8B'}{<86 'Rodzaj zestawienia: '@}{FONT: 'W8'}{<103 par3}{FONT: 'W8B'}{<123 'Zakres środków: '@}{FONT: 'W8'}{<131 par4}
{FONT: 'W8B'}{<1 'Wybór grup: '@}{FONT: 'W8'}{<20 exec('create_list_gr','fst')}
{FI}
{COMMENT} ---- Dane, jedn. ksiegowa, Zestawienie według ---- {COMMENT-}
{
  {? PAR_WYDR.DANE=1
  || par1:='podatkowe'@
  |? PAR_WYDR.DANE=2
  || par1:='bilansowe'@
  |? PAR_WYDR.DANE=3
  || par1:='wszystkie'@
  |? PAR_WYDR.DANE=4
  || par1:='dodatkowe'@
  ?};
  {? PAR_WYDR.ODD<>null || par2:=PAR_WYDR.ODD().OD || par2:='wszystkie'@ ?};
  {? PAR_WYDR.ZESTAW = 1
  || par3:='jedn. księgowych'@
  |? PAR_WYDR.ZESTAW = 2
  || par3:='grup'@
  ?};
  {? PAR_WYDR.JORG<>null
  || par5:=PAR_WYDR.JORG().SYMBOL
  || par5:='dowolna'@
  ?}
;~~}
{FONT: 'W8B'}{<1 'Dane: '@}{FONT: 'W8'}{<7 par1}{FONT: 'W8B'}{<51 'J. księgowa: '@}{FONT: 'W8'}{<63 par2}{FONT: 'W8B'}{<86 'Zestawienie według: '@}{FONT: 'W8'}{<103 par3}{FONT: 'W8B'}{<123 'J. organizacyjna: '@}{FONT: 'W8'}{<132 par5}
{ par1:='Środki przeniesione w bieżącym roku uwzględniono: '@;
  par2:={? PAR_WYDR.ZMIANY='T' || 'tylko w obecnej jedn. księgowej'@ || 'w obecnej i poprzednich jedn. księgowych'@ ?}
;~~}
{
  {? PAR_WYDR.MO_DO=1 || par3:='miesiąca obowiązywania'@ || par3:='daty operacji'@ ?}
;~~}
{FONT: 'W8B'}{<1 par1}{FONT: 'W8'}{<47 par2}{FONT: 'W8B'}{<86 'Dokumenty wartościowe według: '@}{FONT: 'W8'}{par3}
{ par1:={? PAR_WYDR.PRZYCHOD<>null || PAR_WYDR.PRZYCHOD().R || 'dowolny'@ ?};
  par2:={? PAR_WYDR.ROZCHOD<>null || PAR_WYDR.ROZCHOD().R || 'dowolny'@ ?};
  par3:={? PAR_WYDR.SKR_ONLY=1
        || 'wydruk uwzględnia tylko środki skreślone (w bieżącym roku)'@
        |? PAR_WYDR.SKRESL=1
        || 'wydruk nie uwzględnia środków skreślonych w bieżącym roku przed datą Stan na dzień'@
        ?}
;~~}
{IF: PAR_WYDR.SKR_ONLY=1 | PAR_WYDR.SKRESL=1 }
{FONT: 'W8B'}{<1 'Rodzaj przychodu: '@}{FONT: 'W8'}{<20 par1}{FONT: 'W8B'}{<51 'Rodzaj rozchodu: '@}{FONT: 'W8'}{<69 par2}{FONT: 'W8B'}{<86 'Uwaga: '@}{FONT: 'W8'}{<93 par3}
{ELSE}
{FONT: 'W8B'}{<1 'Rodzaj przychodu: '@}{FONT: 'W8'}{<20 par1}{FONT: 'W8B'}{<51 'Rodzaj rozchodu: '@}{FONT: 'W8'}{<69 par2}
{FI}
{IF: FINFO.TOR_D='T'}
{IF: PAR_WYDR.DANE=3}{FONT: 'W8B'}{<1 'Uwaga: '}{FONT: 'W8'}{'W kolejnych wierszach tabeli prezentowane są dane podatkowe, bilansowe i dodatkowe'@}{FI}
{ELSE}
{IF: PAR_WYDR.DANE=3}{FONT: 'W8B'}{<1 'Uwaga: '}{FONT: 'W8'}{'W wierszach tabeli najpierw prezentowane są dane podatkowe, w następnym wierszu - dane bilansowe'@}{FI}
{FI}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{IF: PAR_WYDR.RODZAJ=1}
{prn1:='PRN3';prn2:='PRN';~~}
{SUBSTITUTE: 'TABHEAD2'}
{ELIF: PAR_WYDR.RODZAJ=2}
{prn1:='PRN';prn2:='PRN';~~}
{SUBSTITUTE: 'TABHEAD'}
{FI}
{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
  par1:=(PAR_WYDR.STAN_NA$6)+ ' r.'@;

  {? PAR_WYDR.WAR_GR = 1
  || {? |PAR_WYDR.GRUPA<>'' || par2:=|PAR_WYDR.GRUPA || par2:='dowolna'@ ?}
  |? PAR_WYDR.WAR_GR = 2
  || {? |PAR_WYDR.GRUPA_OD<>'' || _od:='od: '@ + |PAR_WYDR.GRUPA_OD || _od:=''?};
     {? |PAR_WYDR.GRUPA_DO<>'' || _do:='do: '@ + |PAR_WYDR.GRUPA_DO || _do:=''?};
     {? _od<>'' & _do<>'' || par2:=_od + ' ' + _do
     |? _od<>'' & _do='' ||  par2:=_od
     |? _od='' & _do<>'' || par2:=_do
    ?}
  |? PAR_WYDR.WAR_GR=4
  || par2:='wszystkie'
  ?};

  {? PAR_WYDR.RODZAJ=1
  || par3:='analityczne'@ || par3:='syntetyczne'@
  ?};

  {? PAR_WYDR.ZAKRESDR=0
  || par4:='trwałe i niskocenne'@
  |? PAR_WYDR.ZAKRESDR=1
  || par4:='trwałe'@
  |? PAR_WYDR.ZAKRESDR=2
  || par4:='niskocenne'@
  ?}
;~~}
{IF: PAR_WYDR.WAR_GR<>3}
{FONT: 'W8B'}{'Stan środków na: '@}{FONT: 'W8'}{par1}
{FONT: 'W8B'}{'Grupa: '@}{FONT: 'W8'}{par2}
{FONT: 'W8B'}{'Rodzaj zestawienia: '@}{FONT: 'W8'}{par3}
{FONT: 'W8B'}{'Zakres środków: '@}{FONT: 'W8'}{par4}
{ELIF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{'Stan środków na: '@}{FONT: 'W8'}{par1}
{FONT: 'W8B'}{'Rodzaj zestawienia: '@}{FONT: 'W8'}{par3}
{FONT: 'W8B'}{'Zakres środków: '@}{FONT: 'W8'}{par4}
{FONT: 'W8B'}{'Wybór grup: '@}{FONT: 'W8'}{ exec('create_list_gr','fst')}
{FI}
{COMMENT} ---- Dane, jedn. ksiegowa, Zestawienie według ---- {COMMENT-}
{
  {? PAR_WYDR.DANE=1
  || par1:='podatkowe'@
  |? PAR_WYDR.DANE=2
  || par1:='bilansowe'@
  |? PAR_WYDR.DANE=3
  || par1:='wszystkie'@
  |? PAR_WYDR.DANE=4
  || par1:='dodatkowe'@
  ?};
  {? PAR_WYDR.ODD<>null || par2:=PAR_WYDR.ODD().OD || par2:='wszystkie'@ ?};
  {? PAR_WYDR.ZESTAW = 1
  || par3:='jedn. księgowych'@
  |? PAR_WYDR.ZESTAW = 2
  || par3:='grup'@
  ?};
  {? PAR_WYDR.JORG<>null
  || par5:=PAR_WYDR.JORG().SYMBOL
  || par5:='dowolna'@
  ?}
;~~}
{FONT: 'W8B'}{'Dane: '@}{FONT: 'W8'}{par1}
{FONT: 'W8B'}{'J. księgowa: '@}{FONT: 'W8'}{par2}
{FONT: 'W8B'}{'Zestawienie według: '@}{FONT: 'W8'}{par3}
{FONT: 'W8B'}{'J. organizacyjna: '@}{FONT: 'W8'}{par5}
{ par1:={? PAR_WYDR.PRZYCHOD<>null || PAR_WYDR.PRZYCHOD().R || 'dowolny'@ ?};
  par2:={? PAR_WYDR.ROZCHOD<>null || PAR_WYDR.ROZCHOD().R || 'dowolny'@ ?};
  par3:={? PAR_WYDR.SKR_ONLY=1
        || 'wydruk uwzględnia tylko środki skreślone (w bieżącym roku)'@
        |? PAR_WYDR.SKRESL=1
        || 'wydruk nie uwzględnia środków skreślonych w bieżącym roku przed datą Stan na dzień'@
        ?}
;~~}
{IF: PAR_WYDR.SKR_ONLY=1 | PAR_WYDR.SKRESL=1 }
{FONT: 'W8B'}{'Rodzaj przychodu: '@}{FONT: 'W8'}{par1}
{FONT: 'W8B'}{'Rodzaj rozchodu: '@}{FONT: 'W8'}{par2}
{FONT: 'W8B'}{'Uwaga: '@}{FONT: 'W8'}{par3}
{ELSE}
{FONT: 'W8B'}{'Rodzaj przychodu: '@}{FONT: 'W8'}{par1}
{FONT: 'W8B'}{'Rodzaj rozchodu: '@}{FONT: 'W8'}{par2}
{FI}
{ par1:='Środki przeniesione w bieżącym roku uwzględniono: '@;
  par2:={? PAR_WYDR.ZMIANY='T' || 'tylko w obecnej jedn. księgowej'@ || 'w obecnej i poprzednich jedn. księgowych'@ ?}
;~~}
{FONT: 'W8B'}{par1}{FONT: 'W8'}{par2}
{IF: FINFO.TOR_D='T'}
{IF: PAR_WYDR.DANE=3}{FONT: 'W8B'}{<1 'Uwaga: '}{FONT: 'W8'}{'W kolejnych wierszach tabeli prezentowane są dane podatkowe, bilansowe i dodatkowe'@}{FI}
{ELSE}
{IF: PAR_WYDR.DANE=3}{FONT: 'W8B'}{<1 'Uwaga: '}{FONT: 'W8'}{'W wierszach tabeli najpierw prezentowane są dane podatkowe, w następnym wierszu - dane bilansowe'@}{FI}
{FI}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{IF: PAR_WYDR.RODZAJ=1}
{prn1:='PRN3';prn2:='PRN';~~}
{SUBSTITUTE: 'TABHEAD2'}
{ELIF: PAR_WYDR.RODZAJ=2}
{prn1:='PRN';prn2:='PRN';~~}
{SUBSTITUTE: 'TABHEAD'}
{FI}
{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{FI}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8GB'}{SPACE: 'C'}
{IF: PAR_WYDR.RODZAJ=1}
{prn1:='PRN3';prn2:='PRN';~~}
{SUBSTITUTE: 'TABHEAD2'}
{ELIF: PAR_WYDR.RODZAJ=2}
{prn1:='PRN';prn2:='PRN';~~}
{SUBSTITUTE: 'TABHEAD'}
{FI}
{ {? podsum=0
  || prn1:='PRN'; prn2:='PRN2'
  |? podsum=1 | podsum=2
  || prn1:='PRN'; prn2:='PRN1'
  ?};
  "vp:=0";~~}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: ~rep_export()}{SUBSTITUTE: 'FOOT'}{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{ rsep:=1; ~~}
{FOR: TAB_SQL}
 {DO}
{COMMENT} ---- Podsumowanie cząstkowe według grup lub jedn. ksiegowych ---- {COMMENT-}
{COMMENT}----------NIE EXCEL (nie występują podsumowania dla excela) -------------{COMMENT-}
{IF: ~rep_export()}
  { {? PAR_WYDR.RODZAJ=1
   ||
      {? PAR_WYDR.ZESTAW=1
      || test_grupa:=TAB_SQL.ODDZIAL
      |? PAR_WYDR.ZESTAW=2
      || test_grupa:=TAB_SQL.GR
      ?};
      {? sum_grupa='' || test_grupa:=''?}
   ?}
  ;~~}
{IF: PAR_WYDR.RODZAJ=1 & sum_grupa<>test_grupa}
{COMMENT}Pierwsza linia podsumowania czastkowego{COMMENT-}
   {
   podsum:=1;
   {? PAR_WYDR.ZESTAW=1
   || c[1]:='Razem jedn. ks. : '@+sum_grupa
   |? PAR_WYDR.ZESTAW=2
   || c[1]:='Razem grupa : '@+{? PAR_WYDR.GRUPA<>'' || PAR_WYDR.GRUPA || sum_grupa ?}
   ?};
   c[2]:=c[3]:=c[4]:=c[5]:=c[6]:=c[7]:=c[8]:=c[9]:=c[10]:=c[11]:=c[12]:=c[13]:='';
   {? PAR_WYDR.RODZAJ=1
   || {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
      || c[9]:=gp[14];
         c[10]:=gp[15];
         c[11]:=gp[16]
      |? PAR_WYDR.DANE=2
      || c[9]:=gf[14];
         c[10]:=gf[15];
         c[11]:=gf[16]
      |? PAR_WYDR.DANE=4
      || c[9]:=gd[14];
         c[10]:=gd[15];
         c[11]:=gd[16]
      ?}
   ?};
   rsep:=1
  ;~~}
  {FONT: 'T8GB'}{SPACE: 'C'}
  {"vp:=0"; prn1:='PRN'; prn2:='PRN1'; ~~}
  {IF: lineleft()<=(6+{? PAR_WYDR.DANE=3 || 6 || 0 ?}) & lineleft()<>0 }{PAGE}{FI}{SUBSTITUTE: 'LINIA02'}
  {
   {? PAR_WYDR.DANE = 1 | PAR_WYDR.DANE = 3
   || c[1]:=gp[1]; c[2]:=gp[2]; c[3]:=gp[3]; c[4]:=gp[4]; c[5]:=gp[5]; c[6]:=gp[6];
      c[7]:=gp[7]; c[8]:=gp[8]; c[9]:=gp[9]; c[10]:=gp[10]; c[11]:=gp[11]; c[12]:=gp[12];
      {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
      ?};
      _suma:=0;
      {! _i:=1..12 |! {? type_of(c[_i]) = 1 || _suma+=c[_i] ?} !};
      c[13]:=_suma

   |? PAR_WYDR.DANE = 2
   || c[1]:=gf[1]; c[2]:=gf[2]; c[3]:=gf[3]; c[4]:=gf[4]; c[5]:=gf[5]; c[6]:=gf[6];
      c[7]:=gf[7]; c[8]:=gf[8]; c[9]:=gf[9]; c[10]:=gf[10]; c[11]:=gf[11]; c[12]:=gf[12];
      {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
      ?};
      _suma:=0;
      {! _i:=1..12 |! {? type_of(c[_i])=1 || _suma+=c[_i] ?} !};
      c[13]:=_suma
   |? PAR_WYDR.DANE = 4
   || c[1]:=gd[1]; c[2]:=gd[2]; c[3]:=gd[3]; c[4]:=gd[4]; c[5]:=gd[5]; c[6]:=gd[6];
      c[7]:=gd[7]; c[8]:=gd[8]; c[9]:=gd[9]; c[10]:=gd[10]; c[11]:=gd[11]; c[12]:=gd[12];
      {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
      ?};
      _suma:=0;
      {! _i:=1..12 |! {? type_of(c[_i])=1 || _suma+=c[_i] ?} !};
      c[13]:=_suma
   ?}
  ;~~}
  {prn1:='PRN1'; prn2:='PRN'; rsep:=1 ; ~~}
  {SUBSTITUTE: 'LINIA02'}
{COMMENT}Druga linia podsumowania czastkowego{COMMENT-}
  {IF: PAR_WYDR.DANE = 3}
  {
   c[1]:=gf[1]; c[2]:=gf[2]; c[3]:=gf[3]; c[4]:=gf[4]; c[5]:=gf[5]; c[6]:=gf[6];
   c[7]:=gf[7]; c[8]:=gf[8]; c[9]:=gf[9]; c[10]:=gf[10]; c[11]:=gf[11]; c[12]:=gf[12];
   {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
   ?};
   _suma:=0;
   {! _i:=1..12 |! {? type_of(c[_i])=1 || _suma+=c[_i] ?} !};
   c[13]:=_suma
   ;~~}
  {"vp:=0"; prn1:='PRN'; prn2:='PRN'; rsep:=PAR_WYDR.RSEP; ~~}
{COMMENT}Trzecia linia podsumowania czastkowego{COMMENT-}
  {IF: FINFO.TOR_D='T'}
  {SUBSTITUTE: 'LINIA02'}
  {
   c[1]:=gd[1]; c[2]:=gd[2]; c[3]:=gd[3]; c[4]:=gd[4]; c[5]:=gd[5]; c[6]:=gd[6];
   c[7]:=gd[7]; c[8]:=gd[8]; c[9]:=gd[9]; c[10]:=gd[10]; c[11]:=gd[11]; c[12]:=gd[12];
   {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
   ?};
   _suma:=0;
   {! _i:=1..12 |! {? type_of(c[_i])=1 || _suma+=c[_i] ?} !};
   c[13]:=_suma
   ;~~}
  {"vp:=0"; prn1:='PRN'; prn2:='PRN'; rsep:=PAR_WYDR.RSEP; ~~}
  {SUBSTITUTE: 'LINIA0'}
  {ELSE}
  {SUBSTITUTE: 'LINIA0'}
  {FI}
  {FI}
  {rsep:=PAR_WYDR.RSEP;
  prn1:='PRN'; prn2:='PRN'; "vp:=0"
  ;~~}
  {FONT: 'T8G'}{SPACE: 'C'}
{COMMENT} ---- wyzerowanie podsumowań cząstkowych---- {COMMENT-}
  {
     {? PAR_WYDR.RODZAJ = 1
     || {! _i:=1..16 |! gp[_i]:=gf[_i]:=gd[_i]:=0 !}
     ?}
  ;~~}
{FI}
{FI}
{COMMENT} ---- zwykłe wiersze ---- {COMMENT-}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
   podsum:=0;
   {? PAR_WYDR.RODZAJ=1
   || c[1]:=TAB_SQL.NST;
      c[12]:=TAB_SQL.ODDZIAL;
      c[2]:={? PAR_WYDR.DANE=1
            || TAB_SQL.MPOD
            |? PAR_WYDR.DANE=2
            || TAB_SQL.MFIN
            |? PAR_WYDR.DANE=4
            || TAB_SQL.MDOD
            || TAB_SQL.MPOD + ' - ' + TAB_SQL.MFIN + {? FINFO.TOR_D='T' || ' - ' + TAB_SQL.MDOD ?}
            ?};
      c[3]:=TAB_SQL.NRI;
      c[4]:=3+TAB_SQL.GRUPA;
      c[5]:={? PAR_WYDR.DANE=1
            || TAB_SQL.STAP*TAB_SQL.WKP
            |? PAR_WYDR.DANE=2
            || TAB_SQL.STAF*TAB_SQL.WKF
            |? PAR_WYDR.DANE=4
            || TAB_SQL.STAD*TAB_SQL.WKD
            || form(TAB_SQL.STAP*TAB_SQL.WKP,,2, ' ,') + ' / ' + form(TAB_SQL.STAF*TAB_SQL.WKF,,2,',') +  {? FINFO.TOR_D='T' || ' / ' + form(TAB_SQL.STAD*TAB_SQL.WKD,,2,',') ?}
            ?};
      c[6]:=form(TAB_SQL.DE,,1);
      c[7]:=TAB_SQL.ROZCH;
      c[8]:={? TAB_SQL.DES<>date(0,0,0) || form(TAB_SQL.DES,,1) || '' ?};
      {? TAB_SQL.AKTYWNY<>'N'
      || c[9]:={? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
               || TAB_SQL.WARP
               |? PAR_WYDR.DANE=2
               || TAB_SQL.WARF
               |? PAR_WYDR.DANE=4
               || TAB_SQL.WARD
               ?};
         c[10]:={? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
                || TAB_SQL.UMOP
                |? PAR_WYDR.DANE=2
                || TAB_SQL.UMOF
                |? PAR_WYDR.DANE=4
                || TAB_SQL.UMOD
                ?};
         c[11]:={? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
                || TAB_SQL.NETP
                |? PAR_WYDR.DANE=2
                || TAB_SQL.NETF
                |? PAR_WYDR.DANE=4
                || TAB_SQL.NETD
                ?};

         {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
         || gp[14]+=TAB_SQL.WARP;
            gp[15]+=TAB_SQL.UMOP;
            gp[16]+=TAB_SQL.NETP;
            sum_pod[14]+=TAB_SQL.WARP;
            sum_pod[15]+=TAB_SQL.UMOP;
            sum_pod[16]+=TAB_SQL.NETP
         |? PAR_WYDR.DANE=2
         || gf[14]+=TAB_SQL.WARF;
            gf[15]+=TAB_SQL.UMOF;
            gf[16]+=TAB_SQL.NETF;
            sum_fin[14]+=TAB_SQL.WARF;
            sum_fin[15]+=TAB_SQL.UMOF;
            sum_fin[16]+=TAB_SQL.NETF
         |? PAR_WYDR.DANE=4
         || gd[14]+=TAB_SQL.WARD;
            gd[15]+=TAB_SQL.UMOD;
            gd[16]+=TAB_SQL.NETD;
            sum_dod[14]+=TAB_SQL.WARD;
            sum_dod[15]+=TAB_SQL.UMOD;
            sum_dod[16]+=TAB_SQL.NETD
         ?}
      || c[9]:='-';
         c[10]:='-';
         c[11]:='-'
      ?}


   |? PAR_WYDR.RODZAJ=2
   || {? PAR_WYDR.ZESTAW=1
      || c[1]:='Jedn. ks. '+TAB_SQL.ODDZIAL+':'
      |? PAR_WYDR.ZESTAW=2
      || c[1]:='Grupa '+TAB_SQL.GR+':'
      ?}
   ?}
;~~}
{prn1:='PRN'; {? PAR_WYDR.RODZAJ=1 || prn2:='PRN2' || podsum:=1;prn2:='PRN1' ?}; rsep:=1;~~}
{IF: lineleft()<=(6+{? PAR_WYDR.DANE=3 || 6 || 0 ?}) & lineleft()<>0}{PAGE}{FI}{SUBSTITUTE: 'LINIA02'}
{
   {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
   || {? PAR_WYDR.RODZAJ=1
      || {? TAB_SQL.AKTYWNY='T'
         || c[1]:=TAB_SQL.AMP1;
            c[2]:=TAB_SQL.AMP2;
            c[3]:=TAB_SQL.AMP3;
            c[4]:=TAB_SQL.AMP4;
            c[5]:=TAB_SQL.AMP5;
            c[6]:=TAB_SQL.AMP6;
            c[7]:=TAB_SQL.AMP7;
            c[8]:=TAB_SQL.AMP8;
            c[9]:=TAB_SQL.AMP9;
            c[10]:=TAB_SQL.AMP10;
            c[11]:=TAB_SQL.AMP11;
            c[12]:=TAB_SQL.AMP12
         || c[1]:={? TAB_SQL.MIE_OD<=1 & TAB_SQL.MIE_DO>=1 || TAB_SQL.AMP1 || '-' ?};
            c[2]:={? TAB_SQL.MIE_OD<=2 & TAB_SQL.MIE_DO>=2 || TAB_SQL.AMP2 || '-' ?};
            c[3]:={? TAB_SQL.MIE_OD<=3 & TAB_SQL.MIE_DO>=3 || TAB_SQL.AMP3 || '-' ?};
            c[4]:={? TAB_SQL.MIE_OD<=4 & TAB_SQL.MIE_DO>=4 || TAB_SQL.AMP4 || '-' ?};
            c[5]:={? TAB_SQL.MIE_OD<=5 & TAB_SQL.MIE_DO>=5 || TAB_SQL.AMP5 || '-' ?};
            c[6]:={? TAB_SQL.MIE_OD<=6 & TAB_SQL.MIE_DO>=6 || TAB_SQL.AMP6 || '-' ?};
            c[7]:={? TAB_SQL.MIE_OD<=7 & TAB_SQL.MIE_DO>=7 || TAB_SQL.AMP7 || '-' ?};
            c[8]:={? TAB_SQL.MIE_OD<=8 & TAB_SQL.MIE_DO>=8 || TAB_SQL.AMP8 || '-' ?};
            c[9]:={? TAB_SQL.MIE_OD<=9 & TAB_SQL.MIE_DO>=9 || TAB_SQL.AMP9 || '-' ?};
            c[10]:={? TAB_SQL.MIE_OD<=10 & TAB_SQL.MIE_DO>=10 || TAB_SQL.AMP10 || '-' ?};
            c[11]:={? TAB_SQL.MIE_OD<=11 & TAB_SQL.MIE_DO>=11 || TAB_SQL.AMP11 || '-' ?};
            c[12]:={? TAB_SQL.MIE_OD<=12 & TAB_SQL.MIE_DO>=12 || TAB_SQL.AMP12 || '-' ?}
         ?}
      || c[1]:=TAB_SQL.AMP1;
         c[2]:=TAB_SQL.AMP2;
         c[3]:=TAB_SQL.AMP3;
         c[4]:=TAB_SQL.AMP4;
         c[5]:=TAB_SQL.AMP5;
         c[6]:=TAB_SQL.AMP6;
         c[7]:=TAB_SQL.AMP7;
         c[8]:=TAB_SQL.AMP8;
         c[9]:=TAB_SQL.AMP9;
         c[10]:=TAB_SQL.AMP10;
         c[11]:=TAB_SQL.AMP11;
         c[12]:=TAB_SQL.AMP12
      ?};

      gp[1]+=TAB_SQL.AMP1;
      gp[2]+=TAB_SQL.AMP2;
      gp[3]+=TAB_SQL.AMP3;
      gp[4]+=TAB_SQL.AMP4;
      gp[5]+=TAB_SQL.AMP5;
      gp[6]+=TAB_SQL.AMP6;
      gp[7]+=TAB_SQL.AMP7;
      gp[8]+=TAB_SQL.AMP8;
      gp[9]+=TAB_SQL.AMP9;
      gp[10]+=TAB_SQL.AMP10;
      gp[11]+=TAB_SQL.AMP11;
      gp[12]+=TAB_SQL.AMP12;

      _suma:=0;
      _do_okr:={? PAR_WYDR.AMOR_ALL || 12 || SSTALE.AO().OES ?};
      {! _i:=1.._do_okr
      |! _suma+=($('TAB_SQL.AMP'+$_i))()
      !};

      {? PAR_WYDR.RODZAJ=1
      || {? TAB_SQL.AKTYWNY='T'
         || c[13]:=_suma
         || c[13]:='[' + form(_suma,,2,' ,') + ']'
         ?}
      || c[13]:=_suma
      ?};

      {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
      ?};
      sum_pod[1]+=TAB_SQL.AMP1;
      sum_pod[2]+=TAB_SQL.AMP2;
      sum_pod[3]+=TAB_SQL.AMP3;
      sum_pod[4]+=TAB_SQL.AMP4;
      sum_pod[5]+=TAB_SQL.AMP5;
      sum_pod[6]+=TAB_SQL.AMP6;
      sum_pod[7]+=TAB_SQL.AMP7;
      sum_pod[8]+=TAB_SQL.AMP8;
      sum_pod[9]+=TAB_SQL.AMP9;
      sum_pod[10]+=TAB_SQL.AMP10;
      sum_pod[11]+=TAB_SQL.AMP11;
      sum_pod[12]+=TAB_SQL.AMP12

   |? PAR_WYDR.DANE = 2
   || {? PAR_WYDR.RODZAJ = 1
      || {? TAB_SQL.AKTYWNY = 'T'
         || c[1]:=TAB_SQL.AMF1;
            c[2]:=TAB_SQL.AMF2;
            c[3]:=TAB_SQL.AMF3;
            c[4]:=TAB_SQL.AMF4;
            c[5]:=TAB_SQL.AMF5;
            c[6]:=TAB_SQL.AMF6;
            c[7]:=TAB_SQL.AMF7;
            c[8]:=TAB_SQL.AMF8;
            c[9]:=TAB_SQL.AMF9;
            c[10]:=TAB_SQL.AMF10;
            c[11]:=TAB_SQL.AMF11;
            c[12]:=TAB_SQL.AMF12;

            gf[1]+=TAB_SQL.AMF1;
            gf[2]+=TAB_SQL.AMF2;
            gf[3]+=TAB_SQL.AMF3;
            gf[4]+=TAB_SQL.AMF4;
            gf[5]+=TAB_SQL.AMF5;
            gf[6]+=TAB_SQL.AMF6;
            gf[7]+=TAB_SQL.AMF7;
            gf[8]+=TAB_SQL.AMF8;
            gf[9]+=TAB_SQL.AMF9;
            gf[10]+=TAB_SQL.AMF10;
            gf[11]+=TAB_SQL.AMF11;
            gf[12]+=TAB_SQL.AMF12

         || c[1]:={? TAB_SQL.MIE_OD <= 1 & TAB_SQL.MIE_DO >= 1 || TAB_SQL.AMF1 || '-' ?};
            c[2]:={? TAB_SQL.MIE_OD <= 2 & TAB_SQL.MIE_DO >= 2 || TAB_SQL.AMF2 || '-' ?};
            c[3]:={? TAB_SQL.MIE_OD <= 3 & TAB_SQL.MIE_DO >= 3 || TAB_SQL.AMF3 || '-' ?};
            c[4]:={? TAB_SQL.MIE_OD <= 4 & TAB_SQL.MIE_DO >= 4 || TAB_SQL.AMF4 || '-' ?};
            c[5]:={? TAB_SQL.MIE_OD <= 5 & TAB_SQL.MIE_DO >= 5 || TAB_SQL.AMF5 || '-' ?};
            c[6]:={? TAB_SQL.MIE_OD <= 6 & TAB_SQL.MIE_DO >= 6 || TAB_SQL.AMF6 || '-' ?};
            c[7]:={? TAB_SQL.MIE_OD <= 7 & TAB_SQL.MIE_DO >= 7 || TAB_SQL.AMF7 || '-' ?};
            c[8]:={? TAB_SQL.MIE_OD <= 8 & TAB_SQL.MIE_DO >= 8 || TAB_SQL.AMF8 || '-' ?};
            c[9]:={? TAB_SQL.MIE_OD <= 9 & TAB_SQL.MIE_DO >= 9 || TAB_SQL.AMF9 || '-' ?};
            c[10]:={? TAB_SQL.MIE_OD <= 10 & TAB_SQL.MIE_DO >= 10 || TAB_SQL.AMF10 || '-' ?};
            c[11]:={? TAB_SQL.MIE_OD <= 11 & TAB_SQL.MIE_DO >= 11 || TAB_SQL.AMF11 || '-' ?};
            c[12]:={? TAB_SQL.MIE_OD <= 12 & TAB_SQL.MIE_DO >= 12 || TAB_SQL.AMF12 || '-' ?}
         ?}
      || c[1]:=TAB_SQL.AMF1;
         c[2]:=TAB_SQL.AMF2;
         c[3]:=TAB_SQL.AMF3;
         c[4]:=TAB_SQL.AMF4;
         c[5]:=TAB_SQL.AMF5;
         c[6]:=TAB_SQL.AMF6;
         c[7]:=TAB_SQL.AMF7;
         c[8]:=TAB_SQL.AMF8;
         c[9]:=TAB_SQL.AMF9;
         c[10]:=TAB_SQL.AMF10;
         c[11]:=TAB_SQL.AMF11;
         c[12]:=TAB_SQL.AMF12
      ?};

      _suma:=0;
      _do_okr:={? PAR_WYDR.AMOR_ALL || 12 || SSTALE.AO().OES ?};
      {! _i:=1.._do_okr
      |! _suma+=($('TAB_SQL.AMF'+$_i))()
      !};

      {? PAR_WYDR.RODZAJ=1
      || {? TAB_SQL.AKTYWNY='T'
         || c[13]:=_suma
         || c[13]:='[' + form(_suma,,2,' ,') + ']'
         ?}
      || c[13]:=_suma
      ?};

      {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
      ?};

      sum_fin[1]+=TAB_SQL.AMF1;
      sum_fin[2]+=TAB_SQL.AMF2;
      sum_fin[3]+=TAB_SQL.AMF3;
      sum_fin[4]+=TAB_SQL.AMF4;
      sum_fin[5]+=TAB_SQL.AMF5;
      sum_fin[6]+=TAB_SQL.AMF6;
      sum_fin[7]+=TAB_SQL.AMF7;
      sum_fin[8]+=TAB_SQL.AMF8;
      sum_fin[9]+=TAB_SQL.AMF9;
      sum_fin[10]+=TAB_SQL.AMF10;
      sum_fin[11]+=TAB_SQL.AMF11;
      sum_fin[12]+=TAB_SQL.AMF12

   |? PAR_WYDR.DANE = 4
   || {? PAR_WYDR.RODZAJ = 1
      || {? TAB_SQL.AKTYWNY = 'T'
         || c[1]:=TAB_SQL.AMD1;
            c[2]:=TAB_SQL.AMD2;
            c[3]:=TAB_SQL.AMD3;
            c[4]:=TAB_SQL.AMD4;
            c[5]:=TAB_SQL.AMD5;
            c[6]:=TAB_SQL.AMD6;
            c[7]:=TAB_SQL.AMD7;
            c[8]:=TAB_SQL.AMD8;
            c[9]:=TAB_SQL.AMD9;
            c[10]:=TAB_SQL.AMD10;
            c[11]:=TAB_SQL.AMD11;
            c[12]:=TAB_SQL.AMD12;

            gd[1]+=TAB_SQL.AMD1;
            gd[2]+=TAB_SQL.AMD2;
            gd[3]+=TAB_SQL.AMD3;
            gd[4]+=TAB_SQL.AMD4;
            gd[5]+=TAB_SQL.AMD5;
            gd[6]+=TAB_SQL.AMD6;
            gd[7]+=TAB_SQL.AMD7;
            gd[8]+=TAB_SQL.AMD8;
            gd[9]+=TAB_SQL.AMD9;
            gd[10]+=TAB_SQL.AMD10;
            gd[11]+=TAB_SQL.AMD11;
            gd[12]+=TAB_SQL.AMD12

         || c[1]:={? TAB_SQL.MIE_OD <= 1 & TAB_SQL.MIE_DO >= 1 || TAB_SQL.AMD1 || '-' ?};
            c[2]:={? TAB_SQL.MIE_OD <= 2 & TAB_SQL.MIE_DO >= 2 || TAB_SQL.AMD2 || '-' ?};
            c[3]:={? TAB_SQL.MIE_OD <= 3 & TAB_SQL.MIE_DO >= 3 || TAB_SQL.AMD3 || '-' ?};
            c[4]:={? TAB_SQL.MIE_OD <= 4 & TAB_SQL.MIE_DO >= 4 || TAB_SQL.AMD4 || '-' ?};
            c[5]:={? TAB_SQL.MIE_OD <= 5 & TAB_SQL.MIE_DO >= 5 || TAB_SQL.AMD5 || '-' ?};
            c[6]:={? TAB_SQL.MIE_OD <= 6 & TAB_SQL.MIE_DO >= 6 || TAB_SQL.AMD6 || '-' ?};
            c[7]:={? TAB_SQL.MIE_OD <= 7 & TAB_SQL.MIE_DO >= 7 || TAB_SQL.AMD7 || '-' ?};
            c[8]:={? TAB_SQL.MIE_OD <= 8 & TAB_SQL.MIE_DO >= 8 || TAB_SQL.AMD8 || '-' ?};
            c[9]:={? TAB_SQL.MIE_OD <= 9 & TAB_SQL.MIE_DO >= 9 || TAB_SQL.AMD9 || '-' ?};
            c[10]:={? TAB_SQL.MIE_OD <= 10 & TAB_SQL.MIE_DO >= 10 || TAB_SQL.AMD10 || '-' ?};
            c[11]:={? TAB_SQL.MIE_OD <= 11 & TAB_SQL.MIE_DO >= 11 || TAB_SQL.AMD11 || '-' ?};
            c[12]:={? TAB_SQL.MIE_OD <= 12 & TAB_SQL.MIE_DO >= 12 || TAB_SQL.AMD12 || '-' ?}
         ?}
      || c[1]:=TAB_SQL.AMD1;
         c[2]:=TAB_SQL.AMD2;
         c[3]:=TAB_SQL.AMD3;
         c[4]:=TAB_SQL.AMD4;
         c[5]:=TAB_SQL.AMD5;
         c[6]:=TAB_SQL.AMD6;
         c[7]:=TAB_SQL.AMD7;
         c[8]:=TAB_SQL.AMD8;
         c[9]:=TAB_SQL.AMD9;
         c[10]:=TAB_SQL.AMD10;
         c[11]:=TAB_SQL.AMD11;
         c[12]:=TAB_SQL.AMD12
      ?};

      _suma:=0;
      _do_okr:={? PAR_WYDR.AMOR_ALL || 12 || SSTALE.AO().OES ?};
      {! _i:=1.._do_okr
      |! _suma+=($('TAB_SQL.AMD'+$_i))()
      !};

      {? PAR_WYDR.RODZAJ=1
      || {? TAB_SQL.AKTYWNY='T'
         || c[13]:=_suma
         || c[13]:='[' + form(_suma,,2,' ,') + ']'
         ?}
      || c[13]:=_suma
      ?};

      {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
      ?};

      sum_dod[1]+=TAB_SQL.AMD1;
      sum_dod[2]+=TAB_SQL.AMD2;
      sum_dod[3]+=TAB_SQL.AMD3;
      sum_dod[4]+=TAB_SQL.AMD4;
      sum_dod[5]+=TAB_SQL.AMD5;
      sum_dod[6]+=TAB_SQL.AMD6;
      sum_dod[7]+=TAB_SQL.AMD7;
      sum_dod[8]+=TAB_SQL.AMD8;
      sum_dod[9]+=TAB_SQL.AMD9;
      sum_dod[10]+=TAB_SQL.AMD10;
      sum_dod[11]+=TAB_SQL.AMD11;
      sum_dod[12]+=TAB_SQL.AMD12
   ?}
 ;~~}
  { {? PAR_WYDR.RODZAJ = 1 || prn1:='PRN2' || prn1:='PRN1' ?}; prn2:='PRN';~~}
  {SUBSTITUTE: 'LINIA02'}
  {prn1:='PRN'; prn2:='PRN';~~}
{COMMENT} ---- druga linia---- {COMMENT-}
  {IF: PAR_WYDR.DANE=3}
  {
   {? PAR_WYDR.RODZAJ=1
   ||
      {? TAB_SQL.AKTYWNY='T'
      || c[1]:=TAB_SQL.AMF1;
         c[2]:=TAB_SQL.AMF2;
         c[3]:=TAB_SQL.AMF3;
         c[4]:=TAB_SQL.AMF4;
         c[5]:=TAB_SQL.AMF5;
         c[6]:=TAB_SQL.AMF6;
         c[7]:=TAB_SQL.AMF7;
         c[8]:=TAB_SQL.AMF8;
         c[9]:=TAB_SQL.AMF9;
         c[10]:=TAB_SQL.AMF10;
         c[11]:=TAB_SQL.AMF11;
         c[12]:=TAB_SQL.AMF12
      || c[1]:={? TAB_SQL.MIE_OD<=1 & TAB_SQL.MIE_DO>=1 || TAB_SQL.AMF1 || '-' ?};
         c[2]:={? TAB_SQL.MIE_OD<=2 & TAB_SQL.MIE_DO>=2 || TAB_SQL.AMF2 || '-' ?};
         c[3]:={? TAB_SQL.MIE_OD<=3 & TAB_SQL.MIE_DO>=3 || TAB_SQL.AMF3 || '-' ?};
         c[4]:={? TAB_SQL.MIE_OD<=4 & TAB_SQL.MIE_DO>=4 || TAB_SQL.AMF4 || '-' ?};
         c[5]:={? TAB_SQL.MIE_OD<=5 & TAB_SQL.MIE_DO>=5 || TAB_SQL.AMF5 || '-' ?};
         c[6]:={? TAB_SQL.MIE_OD<=6 & TAB_SQL.MIE_DO>=6 || TAB_SQL.AMF6 || '-' ?};
         c[7]:={? TAB_SQL.MIE_OD<=7 & TAB_SQL.MIE_DO>=7 || TAB_SQL.AMF7 || '-' ?};
         c[8]:={? TAB_SQL.MIE_OD<=8 & TAB_SQL.MIE_DO>=8 || TAB_SQL.AMF8 || '-' ?};
         c[9]:={? TAB_SQL.MIE_OD<=9 & TAB_SQL.MIE_DO>=9 || TAB_SQL.AMF9 || '-' ?};
         c[10]:={? TAB_SQL.MIE_OD<=10 & TAB_SQL.MIE_DO>=10 || TAB_SQL.AMF10 || '-' ?};
         c[11]:={? TAB_SQL.MIE_OD<=11 & TAB_SQL.MIE_DO>=11 || TAB_SQL.AMF11 || '-' ?};
         c[12]:={? TAB_SQL.MIE_OD<=12 & TAB_SQL.MIE_DO>=12 || TAB_SQL.AMF12 || '-' ?}
      ?}
   || c[1]:=TAB_SQL.AMF1;
      c[2]:=TAB_SQL.AMF2;
      c[3]:=TAB_SQL.AMF3;
      c[4]:=TAB_SQL.AMF4;
      c[5]:=TAB_SQL.AMF5;
      c[6]:=TAB_SQL.AMF6;
      c[7]:=TAB_SQL.AMF7;
      c[8]:=TAB_SQL.AMF8;
      c[9]:=TAB_SQL.AMF9;
      c[10]:=TAB_SQL.AMF10;
      c[11]:=TAB_SQL.AMF11;
      c[12]:=TAB_SQL.AMF12
   ?};

   gf[1]+=TAB_SQL.AMF1;
   gf[2]+=TAB_SQL.AMF2;
   gf[3]+=TAB_SQL.AMF3;
   gf[4]+=TAB_SQL.AMF4;
   gf[5]+=TAB_SQL.AMF5;
   gf[6]+=TAB_SQL.AMF6;
   gf[7]+=TAB_SQL.AMF7;
   gf[8]+=TAB_SQL.AMF8;
   gf[9]+=TAB_SQL.AMF9;
   gf[10]+=TAB_SQL.AMF10;
   gf[11]+=TAB_SQL.AMF11;
   gf[12]+=TAB_SQL.AMF12;

   _suma:=0;
   _do_okr:={? PAR_WYDR.AMOR_ALL || 12 || SSTALE.AO().OES ?};
   {! _i:=1.._do_okr
   |! _suma+=($('TAB_SQL.AMF'+$_i))()
   !};
   c[13]:=_suma;

   {? PAR_WYDR.AMOR_ALL=0
   || {! _i:=(SSTALE.AO().OES+1)..12 |!
         c[_i]:=''
      !}
   ?};

   sum_fin[1]+=TAB_SQL.AMF1;
   sum_fin[2]+=TAB_SQL.AMF2;
   sum_fin[3]+=TAB_SQL.AMF3;
   sum_fin[4]+=TAB_SQL.AMF4;
   sum_fin[5]+=TAB_SQL.AMF5;
   sum_fin[6]+=TAB_SQL.AMF6;
   sum_fin[7]+=TAB_SQL.AMF7;
   sum_fin[8]+=TAB_SQL.AMF8;
   sum_fin[9]+=TAB_SQL.AMF9;
   sum_fin[10]+=TAB_SQL.AMF10;
   sum_fin[11]+=TAB_SQL.AMF11;
   sum_fin[12]+=TAB_SQL.AMF12;

   rsep:=PAR_WYDR.RSEP
   ;~~}
  {SUBSTITUTE: 'LINIA02'}
{COMMENT} ---- Trzecia linia---- {COMMENT-}
  {IF: FINFO.TOR_D='T'}
  {
   {? PAR_WYDR.RODZAJ=1
   ||
      {? TAB_SQL.AKTYWNY='T'
      || c[1]:=TAB_SQL.AMD1;
         c[2]:=TAB_SQL.AMD2;
         c[3]:=TAB_SQL.AMD3;
         c[4]:=TAB_SQL.AMD4;
         c[5]:=TAB_SQL.AMD5;
         c[6]:=TAB_SQL.AMD6;
         c[7]:=TAB_SQL.AMD7;
         c[8]:=TAB_SQL.AMD8;
         c[9]:=TAB_SQL.AMD9;
         c[10]:=TAB_SQL.AMD10;
         c[11]:=TAB_SQL.AMD11;
         c[12]:=TAB_SQL.AMD12
      || c[1]:={? TAB_SQL.MIE_OD<=1 & TAB_SQL.MIE_DO>=1 || TAB_SQL.AMD1 || '-' ?};
         c[2]:={? TAB_SQL.MIE_OD<=2 & TAB_SQL.MIE_DO>=2 || TAB_SQL.AMD2 || '-' ?};
         c[3]:={? TAB_SQL.MIE_OD<=3 & TAB_SQL.MIE_DO>=3 || TAB_SQL.AMD3 || '-' ?};
         c[4]:={? TAB_SQL.MIE_OD<=4 & TAB_SQL.MIE_DO>=4 || TAB_SQL.AMD4 || '-' ?};
         c[5]:={? TAB_SQL.MIE_OD<=5 & TAB_SQL.MIE_DO>=5 || TAB_SQL.AMD5 || '-' ?};
         c[6]:={? TAB_SQL.MIE_OD<=6 & TAB_SQL.MIE_DO>=6 || TAB_SQL.AMD6 || '-' ?};
         c[7]:={? TAB_SQL.MIE_OD<=7 & TAB_SQL.MIE_DO>=7 || TAB_SQL.AMD7 || '-' ?};
         c[8]:={? TAB_SQL.MIE_OD<=8 & TAB_SQL.MIE_DO>=8 || TAB_SQL.AMD8 || '-' ?};
         c[9]:={? TAB_SQL.MIE_OD<=9 & TAB_SQL.MIE_DO>=9 || TAB_SQL.AMD9 || '-' ?};
         c[10]:={? TAB_SQL.MIE_OD<=10 & TAB_SQL.MIE_DO>=10 || TAB_SQL.AMD10 || '-' ?};
         c[11]:={? TAB_SQL.MIE_OD<=11 & TAB_SQL.MIE_DO>=11 || TAB_SQL.AMD11 || '-' ?};
         c[12]:={? TAB_SQL.MIE_OD<=12 & TAB_SQL.MIE_DO>=12 || TAB_SQL.AMD12 || '-' ?}
      ?}
   || c[1]:=TAB_SQL.AMD1;
      c[2]:=TAB_SQL.AMD2;
      c[3]:=TAB_SQL.AMD3;
      c[4]:=TAB_SQL.AMD4;
      c[5]:=TAB_SQL.AMD5;
      c[6]:=TAB_SQL.AMD6;
      c[7]:=TAB_SQL.AMD7;
      c[8]:=TAB_SQL.AMD8;
      c[9]:=TAB_SQL.AMD9;
      c[10]:=TAB_SQL.AMD10;
      c[11]:=TAB_SQL.AMD11;
      c[12]:=TAB_SQL.AMD12
   ?};

   gd[1]+=TAB_SQL.AMD1;
   gd[2]+=TAB_SQL.AMD2;
   gd[3]+=TAB_SQL.AMD3;
   gd[4]+=TAB_SQL.AMD4;
   gd[5]+=TAB_SQL.AMD5;
   gd[6]+=TAB_SQL.AMD6;
   gd[7]+=TAB_SQL.AMD7;
   gd[8]+=TAB_SQL.AMD8;
   gd[9]+=TAB_SQL.AMD9;
   gd[10]+=TAB_SQL.AMD10;
   gd[11]+=TAB_SQL.AMD11;
   gd[12]+=TAB_SQL.AMD12;

   _suma:=0;
   _do_okr:={? PAR_WYDR.AMOR_ALL || 12 || SSTALE.AO().OES ?};
   {! _i:=1.._do_okr
   |! _suma+=($('TAB_SQL.AMD'+$_i))()
   !};
   c[13]:=_suma;

   {? PAR_WYDR.AMOR_ALL=0
   || {! _i:=(SSTALE.AO().OES+1)..12 |!
         c[_i]:=''
      !}
   ?};

   sum_dod[1]+=TAB_SQL.AMD1;
   sum_dod[2]+=TAB_SQL.AMD2;
   sum_dod[3]+=TAB_SQL.AMD3;
   sum_dod[4]+=TAB_SQL.AMD4;
   sum_dod[5]+=TAB_SQL.AMD5;
   sum_dod[6]+=TAB_SQL.AMD6;
   sum_dod[7]+=TAB_SQL.AMD7;
   sum_dod[8]+=TAB_SQL.AMD8;
   sum_dod[9]+=TAB_SQL.AMD9;
   sum_dod[10]+=TAB_SQL.AMD10;
   sum_dod[11]+=TAB_SQL.AMD11;
   sum_dod[12]+=TAB_SQL.AMD12;

   rsep:=PAR_WYDR.RSEP
   ;~~}
  {SUBSTITUTE: 'LINIA02'}
  {FI}
  {FI}
  {
   {? PAR_WYDR.RODZAJ=1
   || {? PAR_WYDR.ZESTAW=1
      || sum_grupa:=TAB_SQL.ODDZIAL
      |? PAR_WYDR.ZESTAW=2
      || sum_grupa:=TAB_SQL.GR
      ?}
   ?}
  ;~~}
  {rsep:=PAR_WYDR.RSEP;~~}
 {FI}
 {COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
   podsum:=0;
   {? PAR_WYDR.RODZAJ=1
   || c[17]:=TAB_SQL.NRI;
      c[18]:=TAB_SQL.NST;
      c[19]:=TAB_SQL.ODDZIAL;
      {? PAR_WYDR.DANE=1
      || c[22]:=TAB_SQL.STAP*TAB_SQL.WKP
      |? PAR_WYDR.DANE=2
      || c[22]:=TAB_SQL.STAF*TAB_SQL.WKF
      |? PAR_WYDR.DANE=4
      || c[22]:=TAB_SQL.STAD*TAB_SQL.WKD
      || c[22]:=form(TAB_SQL.STAP*TAB_SQL.WKP,,2, ' ,');
         c[45]:=form(TAB_SQL.STAF*TAB_SQL.WKF,,2,',');
      {? FINFO.TOR_D='T'
      || c[46]:=form(TAB_SQL.STAD*TAB_SQL.WKD,,2,',') ?} ?};
      c[21]:=3+TAB_SQL.GRUPA;

      c[23]:=form(TAB_SQL.DE,,1);
      c[24]:=TAB_SQL.ROZCH;

      c[25]:={? TAB_SQL.DES<>date(0,0,0) || form(TAB_SQL.DES,,1) || '' ?};
      {? TAB_SQL.AKTYWNY<>'N'
      || c[26]:={? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
               || TAB_SQL.WARP
               |? PAR_WYDR.DANE=2
               || TAB_SQL.WARF
               |? PAR_WYDR.DANE=4
               || TAB_SQL.WARD
               ?};
         c[27]:={? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
                || TAB_SQL.UMOP
                |? PAR_WYDR.DANE=2
                || TAB_SQL.UMOF
                |? PAR_WYDR.DANE=4
                || TAB_SQL.UMOD
                ?};
         c[28]:={? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
                || TAB_SQL.NETP
                |? PAR_WYDR.DANE=2
                || TAB_SQL.NETF
                |? PAR_WYDR.DANE=4
                || TAB_SQL.NETD
                ?};
         {? PAR_WYDR.DANE=1
            || c[20]:=TAB_SQL.MPOD
            |? PAR_WYDR.DANE=2
            || c[60]:=TAB_SQL.MFIN
            |? PAR_WYDR.DANE=4
            || c[20]:=TAB_SQL.MDOD
            || c[20]:=TAB_SQL.MPOD;
               c[60]:=TAB_SQL.MFIN;
               {? FINFO.TOR_D='T' ||  c[61]:=TAB_SQL.MDOD ?}
            ?};

         {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
         || gp[14]+=TAB_SQL.WARP;
            gp[15]+=TAB_SQL.UMOP;
            gp[16]+=TAB_SQL.NETP;
            sum_pod[14]+=TAB_SQL.WARP;
            sum_pod[15]+=TAB_SQL.UMOP;
            sum_pod[16]+=TAB_SQL.NETP
         |? PAR_WYDR.DANE=2
         || gf[14]+=TAB_SQL.WARF;
            gf[15]+=TAB_SQL.UMOF;
            gf[16]+=TAB_SQL.NETF;
            sum_fin[14]+=TAB_SQL.WARF;
            sum_fin[15]+=TAB_SQL.UMOF;
            sum_fin[16]+=TAB_SQL.NETF
         |? PAR_WYDR.DANE=4
         || gd[14]+=TAB_SQL.WARD;
            gd[15]+=TAB_SQL.UMOD;
            gd[16]+=TAB_SQL.NETD;
            sum_dod[14]+=TAB_SQL.WARD;
            sum_dod[15]+=TAB_SQL.UMOD;
            sum_dod[16]+=TAB_SQL.NETD
         ?}
      || c[26]:='-';
         c[27]:='-';
         c[28]:='-'
      ?}


   |? PAR_WYDR.RODZAJ=2
   || {? PAR_WYDR.ZESTAW=1
      || c[17]:='Jedn. ks. '+TAB_SQL.ODDZIAL+':'
      |? PAR_WYDR.ZESTAW=2
      || c[17]:='Grupa '+TAB_SQL.GR+':'
      ?}
   ?}
;~~}
{prn1:='PRN'; {? PAR_WYDR.RODZAJ=1 || prn2:='PRN2' || podsum:=1;prn2:='PRN1' ?}; rsep:=1;~~}
{
   {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
   || {? PAR_WYDR.RODZAJ=1
      || {? TAB_SQL.AKTYWNY='T'
         || c[1]:=TAB_SQL.AMP1;
            c[2]:=TAB_SQL.AMP2;
            c[3]:=TAB_SQL.AMP3;
            c[4]:=TAB_SQL.AMP4;
            c[5]:=TAB_SQL.AMP5;
            c[6]:=TAB_SQL.AMP6;
            c[7]:=TAB_SQL.AMP7;
            c[8]:=TAB_SQL.AMP8;
            c[9]:=TAB_SQL.AMP9;
            c[10]:=TAB_SQL.AMP10;
            c[11]:=TAB_SQL.AMP11;
            c[12]:=TAB_SQL.AMP12
         || c[1]:={? TAB_SQL.MIE_OD<=1 & TAB_SQL.MIE_DO>=1 || TAB_SQL.AMP1 || '-' ?};
            c[2]:={? TAB_SQL.MIE_OD<=2 & TAB_SQL.MIE_DO>=2 || TAB_SQL.AMP2 || '-' ?};
            c[3]:={? TAB_SQL.MIE_OD<=3 & TAB_SQL.MIE_DO>=3 || TAB_SQL.AMP3 || '-' ?};
            c[4]:={? TAB_SQL.MIE_OD<=4 & TAB_SQL.MIE_DO>=4 || TAB_SQL.AMP4 || '-' ?};
            c[5]:={? TAB_SQL.MIE_OD<=5 & TAB_SQL.MIE_DO>=5 || TAB_SQL.AMP5 || '-' ?};
            c[6]:={? TAB_SQL.MIE_OD<=6 & TAB_SQL.MIE_DO>=6 || TAB_SQL.AMP6 || '-' ?};
            c[7]:={? TAB_SQL.MIE_OD<=7 & TAB_SQL.MIE_DO>=7 || TAB_SQL.AMP7 || '-' ?};
            c[8]:={? TAB_SQL.MIE_OD<=8 & TAB_SQL.MIE_DO>=8 || TAB_SQL.AMP8 || '-' ?};
            c[9]:={? TAB_SQL.MIE_OD<=9 & TAB_SQL.MIE_DO>=9 || TAB_SQL.AMP9 || '-' ?};
            c[10]:={? TAB_SQL.MIE_OD<=10 & TAB_SQL.MIE_DO>=10 || TAB_SQL.AMP10 || '-' ?};
            c[11]:={? TAB_SQL.MIE_OD<=11 & TAB_SQL.MIE_DO>=11 || TAB_SQL.AMP11 || '-' ?};
            c[12]:={? TAB_SQL.MIE_OD<=12 & TAB_SQL.MIE_DO>=12 || TAB_SQL.AMP12 || '-' ?}
         ?}
      || c[1]:=TAB_SQL.AMP1;
         c[2]:=TAB_SQL.AMP2;
         c[3]:=TAB_SQL.AMP3;
         c[4]:=TAB_SQL.AMP4;
         c[5]:=TAB_SQL.AMP5;
         c[6]:=TAB_SQL.AMP6;
         c[7]:=TAB_SQL.AMP7;
         c[8]:=TAB_SQL.AMP8;
         c[9]:=TAB_SQL.AMP9;
         c[10]:=TAB_SQL.AMP10;
         c[11]:=TAB_SQL.AMP11;
         c[12]:=TAB_SQL.AMP12
      ?};

      gp[1]+=TAB_SQL.AMP1;
      gp[2]+=TAB_SQL.AMP2;
      gp[3]+=TAB_SQL.AMP3;
      gp[4]+=TAB_SQL.AMP4;
      gp[5]+=TAB_SQL.AMP5;
      gp[6]+=TAB_SQL.AMP6;
      gp[7]+=TAB_SQL.AMP7;
      gp[8]+=TAB_SQL.AMP8;
      gp[9]+=TAB_SQL.AMP9;
      gp[10]+=TAB_SQL.AMP10;
      gp[11]+=TAB_SQL.AMP11;
      gp[12]+=TAB_SQL.AMP12;

      _suma:=0;
      _do_okr:={? PAR_WYDR.AMOR_ALL || 12 || SSTALE.AO().OES ?};
      {! _i:=1.._do_okr
      |! _suma+=($('TAB_SQL.AMP'+$_i))()
      !};

      {? PAR_WYDR.RODZAJ=1
      || {? TAB_SQL.AKTYWNY='T'
         || c[13]:=_suma
         || c[13]:='[' + form(_suma,,2,' ,') + ']'
         ?}
      || c[13]:=_suma
      ?};

      {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
      ?};
      sum_pod[1]+=TAB_SQL.AMP1;
      sum_pod[2]+=TAB_SQL.AMP2;
      sum_pod[3]+=TAB_SQL.AMP3;
      sum_pod[4]+=TAB_SQL.AMP4;
      sum_pod[5]+=TAB_SQL.AMP5;
      sum_pod[6]+=TAB_SQL.AMP6;
      sum_pod[7]+=TAB_SQL.AMP7;
      sum_pod[8]+=TAB_SQL.AMP8;
      sum_pod[9]+=TAB_SQL.AMP9;
      sum_pod[10]+=TAB_SQL.AMP10;
      sum_pod[11]+=TAB_SQL.AMP11;
      sum_pod[12]+=TAB_SQL.AMP12

   |? PAR_WYDR.DANE = 2
   || {? PAR_WYDR.RODZAJ = 1
      || {? TAB_SQL.AKTYWNY = 'T'
         || c[32]:=TAB_SQL.AMF1;
            c[33]:=TAB_SQL.AMF2;
            c[34]:=TAB_SQL.AMF3;
            c[35]:=TAB_SQL.AMF4;
            c[36]:=TAB_SQL.AMF5;
            c[37]:=TAB_SQL.AMF6;
            c[38]:=TAB_SQL.AMF7;
            c[39]:=TAB_SQL.AMF8;
            c[40]:=TAB_SQL.AMF9;
            c[41]:=TAB_SQL.AMF10;
            c[42]:=TAB_SQL.AMF11;
            c[43]:=TAB_SQL.AMF12;

            gf[1]+=TAB_SQL.AMF1;
            gf[2]+=TAB_SQL.AMF2;
            gf[3]+=TAB_SQL.AMF3;
            gf[4]+=TAB_SQL.AMF4;
            gf[5]+=TAB_SQL.AMF5;
            gf[6]+=TAB_SQL.AMF6;
            gf[7]+=TAB_SQL.AMF7;
            gf[8]+=TAB_SQL.AMF8;
            gf[9]+=TAB_SQL.AMF9;
            gf[10]+=TAB_SQL.AMF10;
            gf[11]+=TAB_SQL.AMF11;
            gf[12]+=TAB_SQL.AMF12

         || c[32]:={? TAB_SQL.MIE_OD <= 1 & TAB_SQL.MIE_DO >= 1 || TAB_SQL.AMF1 || '-' ?};
            c[33]:={? TAB_SQL.MIE_OD <= 2 & TAB_SQL.MIE_DO >= 2 || TAB_SQL.AMF2 || '-' ?};
            c[34]:={? TAB_SQL.MIE_OD <= 3 & TAB_SQL.MIE_DO >= 3 || TAB_SQL.AMF3 || '-' ?};
            c[35]:={? TAB_SQL.MIE_OD <= 4 & TAB_SQL.MIE_DO >= 4 || TAB_SQL.AMF4 || '-' ?};
            c[36]:={? TAB_SQL.MIE_OD <= 5 & TAB_SQL.MIE_DO >= 5 || TAB_SQL.AMF5 || '-' ?};
            c[37]:={? TAB_SQL.MIE_OD <= 6 & TAB_SQL.MIE_DO >= 6 || TAB_SQL.AMF6 || '-' ?};
            c[38]:={? TAB_SQL.MIE_OD <= 7 & TAB_SQL.MIE_DO >= 7 || TAB_SQL.AMF7 || '-' ?};
            c[39]:={? TAB_SQL.MIE_OD <= 8 & TAB_SQL.MIE_DO >= 8 || TAB_SQL.AMF8 || '-' ?};
            c[40]:={? TAB_SQL.MIE_OD <= 9 & TAB_SQL.MIE_DO >= 9 || TAB_SQL.AMF9 || '-' ?};
            c[41]:={? TAB_SQL.MIE_OD <= 10 & TAB_SQL.MIE_DO >= 10 || TAB_SQL.AMF10 || '-' ?};
            c[42]:={? TAB_SQL.MIE_OD <= 11 & TAB_SQL.MIE_DO >= 11 || TAB_SQL.AMF11 || '-' ?};
            c[43]:={? TAB_SQL.MIE_OD <= 12 & TAB_SQL.MIE_DO >= 12 || TAB_SQL.AMF12 || '-' ?}
         ?}
      || c[32]:=TAB_SQL.AMF1;
         c[33]:=TAB_SQL.AMF2;
         c[34]:=TAB_SQL.AMF3;
         c[35]:=TAB_SQL.AMF4;
         c[36]:=TAB_SQL.AMF5;
         c[37]:=TAB_SQL.AMF6;
         c[38]:=TAB_SQL.AMF7;
         c[39]:=TAB_SQL.AMF8;
         c[40]:=TAB_SQL.AMF9;
         c[41]:=TAB_SQL.AMF10;
         c[42]:=TAB_SQL.AMF11;
         c[43]:=TAB_SQL.AMF12
      ?};

      _suma:=0;
      _do_okr:={? PAR_WYDR.AMOR_ALL || 12 || SSTALE.AO().OES ?};
      {! _i:=1.._do_okr
      |! _suma+=($('TAB_SQL.AMF'+$_i))()
      !};

      {? PAR_WYDR.RODZAJ=1
      || {? TAB_SQL.AKTYWNY='T'
         || c[44]:=_suma
         || c[44]:='[' + form(_suma,,2,' ,') + ']'
         ?}
      || c[44]:=_suma
      ?};

      {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
      ?};

      sum_fin[1]+=TAB_SQL.AMF1;
      sum_fin[2]+=TAB_SQL.AMF2;
      sum_fin[3]+=TAB_SQL.AMF3;
      sum_fin[4]+=TAB_SQL.AMF4;
      sum_fin[5]+=TAB_SQL.AMF5;
      sum_fin[6]+=TAB_SQL.AMF6;
      sum_fin[7]+=TAB_SQL.AMF7;
      sum_fin[8]+=TAB_SQL.AMF8;
      sum_fin[9]+=TAB_SQL.AMF9;
      sum_fin[10]+=TAB_SQL.AMF10;
      sum_fin[11]+=TAB_SQL.AMF11;
      sum_fin[12]+=TAB_SQL.AMF12

   |? PAR_WYDR.DANE = 4
   || {? PAR_WYDR.RODZAJ = 1
      || {? TAB_SQL.AKTYWNY = 'T'
         || c[47]:=TAB_SQL.AMD1;
            c[48]:=TAB_SQL.AMD2;
            c[49]:=TAB_SQL.AMD3;
            c[50]:=TAB_SQL.AMD4;
            c[51]:=TAB_SQL.AMD5;
            c[52]:=TAB_SQL.AMD6;
            c[53]:=TAB_SQL.AMD7;
            c[54]:=TAB_SQL.AMD8;
            c[55]:=TAB_SQL.AMD9;
            c[56]:=TAB_SQL.AMD10;
            c[57]:=TAB_SQL.AMD11;
            c[58]:=TAB_SQL.AMD12;

            gd[1]+=TAB_SQL.AMD1;
            gd[2]+=TAB_SQL.AMD2;
            gd[3]+=TAB_SQL.AMD3;
            gd[4]+=TAB_SQL.AMD4;
            gd[5]+=TAB_SQL.AMD5;
            gd[6]+=TAB_SQL.AMD6;
            gd[7]+=TAB_SQL.AMD7;
            gd[8]+=TAB_SQL.AMD8;
            gd[9]+=TAB_SQL.AMD9;
            gd[10]+=TAB_SQL.AMD10;
            gd[11]+=TAB_SQL.AMD11;
            gd[12]+=TAB_SQL.AMD12

         || c[47]:={? TAB_SQL.MIE_OD <= 1 & TAB_SQL.MIE_DO >= 1 || TAB_SQL.AMD1 || '-' ?};
            c[48]:={? TAB_SQL.MIE_OD <= 2 & TAB_SQL.MIE_DO >= 2 || TAB_SQL.AMD2 || '-' ?};
            c[49]:={? TAB_SQL.MIE_OD <= 3 & TAB_SQL.MIE_DO >= 3 || TAB_SQL.AMD3 || '-' ?};
            c[50]:={? TAB_SQL.MIE_OD <= 4 & TAB_SQL.MIE_DO >= 4 || TAB_SQL.AMD4 || '-' ?};
            c[51]:={? TAB_SQL.MIE_OD <= 5 & TAB_SQL.MIE_DO >= 5 || TAB_SQL.AMD5 || '-' ?};
            c[52]:={? TAB_SQL.MIE_OD <= 6 & TAB_SQL.MIE_DO >= 6 || TAB_SQL.AMD6 || '-' ?};
            c[53]:={? TAB_SQL.MIE_OD <= 7 & TAB_SQL.MIE_DO >= 7 || TAB_SQL.AMD7 || '-' ?};
            c[54]:={? TAB_SQL.MIE_OD <= 8 & TAB_SQL.MIE_DO >= 8 || TAB_SQL.AMD8 || '-' ?};
            c[55]:={? TAB_SQL.MIE_OD <= 9 & TAB_SQL.MIE_DO >= 9 || TAB_SQL.AMD9 || '-' ?};
            c[56]:={? TAB_SQL.MIE_OD <= 10 & TAB_SQL.MIE_DO >= 10 || TAB_SQL.AMD10 || '-' ?};
            c[57]:={? TAB_SQL.MIE_OD <= 11 & TAB_SQL.MIE_DO >= 11 || TAB_SQL.AMD11 || '-' ?};
            c[58]:={? TAB_SQL.MIE_OD <= 12 & TAB_SQL.MIE_DO >= 12 || TAB_SQL.AMD12 || '-' ?}
         ?}
      || c[47]:=TAB_SQL.AMD1;
         c[48]:=TAB_SQL.AMD2;
         c[49]:=TAB_SQL.AMD3;
         c[50]:=TAB_SQL.AMD4;
         c[51]:=TAB_SQL.AMD5;
         c[52]:=TAB_SQL.AMD6;
         c[53]:=TAB_SQL.AMD7;
         c[54]:=TAB_SQL.AMD8;
         c[55]:=TAB_SQL.AMD9;
         c[56]:=TAB_SQL.AMD10;
         c[57]:=TAB_SQL.AMD11;
         c[58]:=TAB_SQL.AMD12
      ?};

      _suma:=0;
      _do_okr:={? PAR_WYDR.AMOR_ALL || 12 || SSTALE.AO().OES ?};
      {! _i:=1.._do_okr
      |! _suma+=($('TAB_SQL.AMD'+$_i))()
      !};

      {? PAR_WYDR.RODZAJ=1
      || {? TAB_SQL.AKTYWNY='T'
         || c[59]:=_suma
         || c[59]:='[' + form(_suma,,2,' ,') + ']'
         ?}
      || c[59]:=_suma
      ?};

      {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
      ?};

      sum_dod[1]+=TAB_SQL.AMD1;
      sum_dod[2]+=TAB_SQL.AMD2;
      sum_dod[3]+=TAB_SQL.AMD3;
      sum_dod[4]+=TAB_SQL.AMD4;
      sum_dod[5]+=TAB_SQL.AMD5;
      sum_dod[6]+=TAB_SQL.AMD6;
      sum_dod[7]+=TAB_SQL.AMD7;
      sum_dod[8]+=TAB_SQL.AMD8;
      sum_dod[9]+=TAB_SQL.AMD9;
      sum_dod[10]+=TAB_SQL.AMD10;
      sum_dod[11]+=TAB_SQL.AMD11;
      sum_dod[12]+=TAB_SQL.AMD12
   ?}
 ;~~}
  {prn1:='PRN'; prn2:='PRN';~~}
{COMMENT} ---- druga linia---- {COMMENT-}
  {IF: PAR_WYDR.DANE=3}
  {
   {? PAR_WYDR.RODZAJ=1
   ||
      {? TAB_SQL.AKTYWNY='T'
      || c[32]:=TAB_SQL.AMF1;
         c[33]:=TAB_SQL.AMF2;
         c[34]:=TAB_SQL.AMF3;
         c[35]:=TAB_SQL.AMF4;
         c[36]:=TAB_SQL.AMF5;
         c[37]:=TAB_SQL.AMF6;
         c[38]:=TAB_SQL.AMF7;
         c[39]:=TAB_SQL.AMF8;
         c[40]:=TAB_SQL.AMF9;
         c[41]:=TAB_SQL.AMF10;
         c[42]:=TAB_SQL.AMF11;
         c[43]:=TAB_SQL.AMF12
      || c[32]:={? TAB_SQL.MIE_OD<=1 & TAB_SQL.MIE_DO>=1 || TAB_SQL.AMF1 || '-' ?};
         c[33]:={? TAB_SQL.MIE_OD<=2 & TAB_SQL.MIE_DO>=2 || TAB_SQL.AMF2 || '-' ?};
         c[34]:={? TAB_SQL.MIE_OD<=3 & TAB_SQL.MIE_DO>=3 || TAB_SQL.AMF3 || '-' ?};
         c[35]:={? TAB_SQL.MIE_OD<=4 & TAB_SQL.MIE_DO>=4 || TAB_SQL.AMF4 || '-' ?};
         c[36]:={? TAB_SQL.MIE_OD<=5 & TAB_SQL.MIE_DO>=5 || TAB_SQL.AMF5 || '-' ?};
         c[37]:={? TAB_SQL.MIE_OD<=6 & TAB_SQL.MIE_DO>=6 || TAB_SQL.AMF6 || '-' ?};
         c[38]:={? TAB_SQL.MIE_OD<=7 & TAB_SQL.MIE_DO>=7 || TAB_SQL.AMF7 || '-' ?};
         c[39]:={? TAB_SQL.MIE_OD<=8 & TAB_SQL.MIE_DO>=8 || TAB_SQL.AMF8 || '-' ?};
         c[40]:={? TAB_SQL.MIE_OD<=9 & TAB_SQL.MIE_DO>=9 || TAB_SQL.AMF9 || '-' ?};
         c[41]:={? TAB_SQL.MIE_OD<=10 & TAB_SQL.MIE_DO>=10 || TAB_SQL.AMF10 || '-' ?};
         c[42]:={? TAB_SQL.MIE_OD<=11 & TAB_SQL.MIE_DO>=11 || TAB_SQL.AMF11 || '-' ?};
         c[43]:={? TAB_SQL.MIE_OD<=12 & TAB_SQL.MIE_DO>=12 || TAB_SQL.AMF12 || '-' ?}
      ?}
   || c[32]:=TAB_SQL.AMF1;
      c[33]:=TAB_SQL.AMF2;
      c[34]:=TAB_SQL.AMF3;
      c[35]:=TAB_SQL.AMF4;
      c[36]:=TAB_SQL.AMF5;
      c[37]:=TAB_SQL.AMF6;
      c[38]:=TAB_SQL.AMF7;
      c[39]:=TAB_SQL.AMF8;
      c[40]:=TAB_SQL.AMF9;
      c[41]:=TAB_SQL.AMF10;
      c[42]:=TAB_SQL.AMF11;
      c[43]:=TAB_SQL.AMF12
   ?};

   gf[1]+=TAB_SQL.AMF1;
   gf[2]+=TAB_SQL.AMF2;
   gf[3]+=TAB_SQL.AMF3;
   gf[4]+=TAB_SQL.AMF4;
   gf[5]+=TAB_SQL.AMF5;
   gf[6]+=TAB_SQL.AMF6;
   gf[7]+=TAB_SQL.AMF7;
   gf[8]+=TAB_SQL.AMF8;
   gf[9]+=TAB_SQL.AMF9;
   gf[10]+=TAB_SQL.AMF10;
   gf[11]+=TAB_SQL.AMF11;
   gf[12]+=TAB_SQL.AMF12;

   _suma:=0;
   _do_okr:={? PAR_WYDR.AMOR_ALL || 12 || SSTALE.AO().OES ?};
   {! _i:=1.._do_okr
   |! _suma+=($('TAB_SQL.AMF'+$_i))()
   !};
   c[44]:=_suma;

   {? PAR_WYDR.AMOR_ALL=0
   || {! _i:=(SSTALE.AO().OES+1)..12 |!
         c[_i]:=''
      !}
   ?};

   sum_fin[1]+=TAB_SQL.AMF1;
   sum_fin[2]+=TAB_SQL.AMF2;
   sum_fin[3]+=TAB_SQL.AMF3;
   sum_fin[4]+=TAB_SQL.AMF4;
   sum_fin[5]+=TAB_SQL.AMF5;
   sum_fin[6]+=TAB_SQL.AMF6;
   sum_fin[7]+=TAB_SQL.AMF7;
   sum_fin[8]+=TAB_SQL.AMF8;
   sum_fin[9]+=TAB_SQL.AMF9;
   sum_fin[10]+=TAB_SQL.AMF10;
   sum_fin[11]+=TAB_SQL.AMF11;
   sum_fin[12]+=TAB_SQL.AMF12;

   rsep:=PAR_WYDR.RSEP
   ;~~}
{COMMENT} ---- Trzecia linia---- {COMMENT-}
  {IF: FINFO.TOR_D='T'}
  {
   {? PAR_WYDR.RODZAJ=1
   ||
      {? TAB_SQL.AKTYWNY='T'
      || c[47]:=TAB_SQL.AMD1;
         c[48]:=TAB_SQL.AMD2;
         c[49]:=TAB_SQL.AMD3;
         c[50]:=TAB_SQL.AMD4;
         c[51]:=TAB_SQL.AMD5;
         c[52]:=TAB_SQL.AMD6;
         c[53]:=TAB_SQL.AMD7;
         c[54]:=TAB_SQL.AMD8;
         c[55]:=TAB_SQL.AMD9;
         c[56]:=TAB_SQL.AMD10;
         c[57]:=TAB_SQL.AMD11;
         c[58]:=TAB_SQL.AMD12
      || c[47]:={? TAB_SQL.MIE_OD<=1 & TAB_SQL.MIE_DO>=1 || TAB_SQL.AMD1 || '-' ?};
         c[48]:={? TAB_SQL.MIE_OD<=2 & TAB_SQL.MIE_DO>=2 || TAB_SQL.AMD2 || '-' ?};
         c[49]:={? TAB_SQL.MIE_OD<=3 & TAB_SQL.MIE_DO>=3 || TAB_SQL.AMD3 || '-' ?};
         c[50]:={? TAB_SQL.MIE_OD<=4 & TAB_SQL.MIE_DO>=4 || TAB_SQL.AMD4 || '-' ?};
         c[51]:={? TAB_SQL.MIE_OD<=5 & TAB_SQL.MIE_DO>=5 || TAB_SQL.AMD5 || '-' ?};
         c[52]:={? TAB_SQL.MIE_OD<=6 & TAB_SQL.MIE_DO>=6 || TAB_SQL.AMD6 || '-' ?};
         c[53]:={? TAB_SQL.MIE_OD<=7 & TAB_SQL.MIE_DO>=7 || TAB_SQL.AMD7 || '-' ?};
         c[54]:={? TAB_SQL.MIE_OD<=8 & TAB_SQL.MIE_DO>=8 || TAB_SQL.AMD8 || '-' ?};
         c[55]:={? TAB_SQL.MIE_OD<=9 & TAB_SQL.MIE_DO>=9 || TAB_SQL.AMD9 || '-' ?};
         c[56]:={? TAB_SQL.MIE_OD<=10 & TAB_SQL.MIE_DO>=10 || TAB_SQL.AMD10 || '-' ?};
         c[57]:={? TAB_SQL.MIE_OD<=11 & TAB_SQL.MIE_DO>=11 || TAB_SQL.AMD11 || '-' ?};
         c[58]:={? TAB_SQL.MIE_OD<=12 & TAB_SQL.MIE_DO>=12 || TAB_SQL.AMD12 || '-' ?}
      ?}
   || c[47]:=TAB_SQL.AMD1;
      c[48]:=TAB_SQL.AMD2;
      c[49]:=TAB_SQL.AMD3;
      c[50]:=TAB_SQL.AMD4;
      c[51]:=TAB_SQL.AMD5;
      c[52]:=TAB_SQL.AMD6;
      c[53]:=TAB_SQL.AMD7;
      c[54]:=TAB_SQL.AMD8;
      c[55]:=TAB_SQL.AMD9;
      c[56]:=TAB_SQL.AMD10;
      c[57]:=TAB_SQL.AMD11;
      c[58]:=TAB_SQL.AMD12
   ?};

   gd[1]+=TAB_SQL.AMD1;
   gd[2]+=TAB_SQL.AMD2;
   gd[3]+=TAB_SQL.AMD3;
   gd[4]+=TAB_SQL.AMD4;
   gd[5]+=TAB_SQL.AMD5;
   gd[6]+=TAB_SQL.AMD6;
   gd[7]+=TAB_SQL.AMD7;
   gd[8]+=TAB_SQL.AMD8;
   gd[9]+=TAB_SQL.AMD9;
   gd[10]+=TAB_SQL.AMD10;
   gd[11]+=TAB_SQL.AMD11;
   gd[12]+=TAB_SQL.AMD12;

   _suma:=0;
   _do_okr:={? PAR_WYDR.AMOR_ALL || 12 || SSTALE.AO().OES ?};
   {! _i:=1.._do_okr
   |! _suma+=($('TAB_SQL.AMD'+$_i))()
   !};
   c[59]:=_suma;

   {? PAR_WYDR.AMOR_ALL=0
   || {! _i:=(SSTALE.AO().OES+1)..12 |!
         c[_i]:=''
      !}
   ?};

   sum_dod[1]+=TAB_SQL.AMD1;
   sum_dod[2]+=TAB_SQL.AMD2;
   sum_dod[3]+=TAB_SQL.AMD3;
   sum_dod[4]+=TAB_SQL.AMD4;
   sum_dod[5]+=TAB_SQL.AMD5;
   sum_dod[6]+=TAB_SQL.AMD6;
   sum_dod[7]+=TAB_SQL.AMD7;
   sum_dod[8]+=TAB_SQL.AMD8;
   sum_dod[9]+=TAB_SQL.AMD9;
   sum_dod[10]+=TAB_SQL.AMD10;
   sum_dod[11]+=TAB_SQL.AMD11;
   sum_dod[12]+=TAB_SQL.AMD12;

   rsep:=PAR_WYDR.RSEP
   ;~~}
  {FI}
  {FI}
  {
   {? PAR_WYDR.RODZAJ=1
   || {? PAR_WYDR.ZESTAW=1
      || sum_grupa:=TAB_SQL.ODDZIAL
      |? PAR_WYDR.ZESTAW=2
      || sum_grupa:=TAB_SQL.GR
      ?}
   ?}
  ;~~}
  {rsep:=PAR_WYDR.RSEP;~~}
  { {? PAR_WYDR.RODZAJ = 1 || prn1:='PRN2' || prn1:='PRN1' ?}; prn2:='PRN';~~}
  {SUBSTITUTE: 'LINIA02'}
{FI}
 {OD}
{COMMENT} ---- podsumowanie czastkowe za ostatnim rekordem tabeli TAB_SQL ---- {COMMENT-}
{COMMENT} ---- podsumowanie nie występuje dla excela ---- {COMMENT-}
{IF: ~rep_export()}
{ {? PAR_WYDR.RODZAJ=1
   ||
      {? PAR_WYDR.ZESTAW=1
      || test_grupa:=TAB_SQL.ODDZIAL
      |? PAR_WYDR.ZESTAW=2
      || test_grupa:=TAB_SQL.GR
      ?};
      {? sum_grupa='' || test_grupa:='' ?}
   ?}
;~~}
{IF: PAR_WYDR.RODZAJ=1}
{COMMENT}Pierwsza linia podsumowania czastkowego{COMMENT-}
{
   podsum:=1;
   {? PAR_WYDR.ZESTAW=1
   || c[1]:='Razem jedn. ks. : '@ + sum_grupa
   |? PAR_WYDR.ZESTAW=2
   || c[1]:='Razem grupa : '@ + {? PAR_WYDR.GRUPA<>'' || PAR_WYDR.GRUPA || sum_grupa ?}
   ?};
   {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
   || c[9]:=gp[14];
      c[10]:=gp[15];
      c[11]:=gp[16]
   |? PAR_WYDR.DANE=2
   || c[9]:=gf[14];
      c[10]:=gf[15];
      c[11]:=gf[16]
   |? PAR_WYDR.DANE=4
   || c[9]:=gd[14];
      c[10]:=gd[15];
      c[11]:=gd[16]
   ?};
   c[2]:=c[3]:=c[4]:=c[5]:=c[6]:=c[7]:=c[8]:=c[12]:=c[13]:='';
   rsep:=1; "vp:=0"
  ;~~}
  {FONT: 'T8GB'}{SPACE: 'C'}
  {prn1:='PRN'; prn2:='PRN1';~~}
  {IF: lineleft()<=(6  + {? PAR_WYDR.DANE=3 || 4 || 0 ?}) & lineleft()<>0 }{PAGE}{FI}{SUBSTITUTE: 'LINIA02'}
  {
    {? PAR_WYDR.DANE= 1 | PAR_WYDR.DANE = 3
    || c[1]:=gp[1]; c[2]:=gp[2]; c[3]:=gp[3]; c[4]:=gp[4]; c[5]:=gp[5]; c[6]:=gp[6];
       c[7]:=gp[7]; c[8]:=gp[8]; c[9]:=gp[9]; c[10]:=gp[10]; c[11]:=gp[11]; c[12]:=gp[12];
       {? PAR_WYDR.AMOR_ALL=0
       ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
           !}
       ?};
       _suma:=0;
       {! _i:=1..12 |! {? type_of(c[_i])=1 || _suma+=c[_i] ?} !};
       c[13]:=_suma
    |? PAR_WYDR.DANE = 2
    || c[1]:=gf[1]; c[2]:=gf[2]; c[3]:=gf[3]; c[4]:=gf[4]; c[5]:=gf[5]; c[6]:=gf[6];
       c[7]:=gf[7]; c[8]:=gf[8]; c[9]:=gf[9]; c[10]:=gf[10]; c[11]:=gf[11]; c[12]:=gf[12];
       {? PAR_WYDR.AMOR_ALL = 0
       ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
              c[_i]:=''
           !}
       ?};
       _suma:=0;
       {! _i:=1..12 |! {? type_of(c[_i])=1 || _suma+=c[_i] ?} !};
       c[13]:=_suma
    |? PAR_WYDR.DANE = 4
    || c[1]:=gd[1]; c[2]:=gd[2]; c[3]:=gd[3]; c[4]:=gd[4]; c[5]:=gd[5]; c[6]:=gd[6];
       c[7]:=gd[7]; c[8]:=gd[8]; c[9]:=gd[9]; c[10]:=gd[10]; c[11]:=gd[11]; c[12]:=gd[12];
       {? PAR_WYDR.AMOR_ALL = 0
       ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
              c[_i]:=''
           !}
       ?};
       _suma:=0;
       {! _i:=1..12 |! {? type_of(c[_i])=1 || _suma+=c[_i] ?} !};
       c[13]:=_suma
    ?}
  ;~~}
  {prn1:='PRN1'; prn2:='PRN';~~}
  {SUBSTITUTE: 'LINIA02'}
{COMMENT}Druga linia podsumowania czastkowego{COMMENT-}
  {IF: PAR_WYDR.DANE = 3}
  {
   c[1]:=gf[1]; c[2]:=gf[2]; c[3]:=gf[3]; c[4]:=gf[4]; c[5]:=gf[5]; c[6]:=gf[6];
   c[7]:=gf[7]; c[8]:=gf[8]; c[9]:=gf[9]; c[10]:=gf[10]; c[11]:=gf[11]; c[12]:=gf[12];
   {? PAR_WYDR.AMOR_ALL=0
   ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
          c[_i]:=''
       !}
   ?};
   _suma:=0;
   {! _i:=1..12 |! {? type_of(c[_i])=1 || _suma+=c[_i] ?} !};
   c[13]:=_suma;
   rsep:=0; "vp:=0"
   ;~~}
  {prn1:='PRN'; prn2:='PRN'; rsep:=PAR_WYDR.RSEP; ~~}
{COMMENT}Trzecia linia podsumowania czastkowego{COMMENT-}
  {IF: FINFO.TOR_D='T'}
  {SUBSTITUTE: 'LINIA02'}
  {rsep:=PAR_WYDR.RSEP;
  prn1:='PRN'; prn2:='PRN'
  ;~~}
  {
   c[1]:=gd[1]; c[2]:=gd[2]; c[3]:=gd[3]; c[4]:=gd[4]; c[5]:=gd[5]; c[6]:=gd[6];
   c[7]:=gd[7]; c[8]:=gd[8]; c[9]:=gd[9]; c[10]:=gd[10]; c[11]:=gd[11]; c[12]:=gd[12];
   {? PAR_WYDR.AMOR_ALL=0
   ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
          c[_i]:=''
       !}
   ?};
   _suma:=0;
   {! _i:=1..12 |! {? type_of(c[_i])=1 || _suma+=c[_i] ?} !};
   c[13]:=_suma;
   rsep:=0; "vp:=0"
   ;~~}
  {prn1:='PRN'; prn2:='PRN'; rsep:=PAR_WYDR.RSEP; ~~}
  {SUBSTITUTE: 'LINIA0'}
  {ELSE}
  {SUBSTITUTE: 'LINIA0'}
  {FI}
  {rsep:=PAR_WYDR.RSEP;
  prn1:='PRN'; prn2:='PRN'
  ;~~}
  {FI}
{FI}
{COMMENT}------------------------------FOOTER-LAST------------------{COMMENT-}
{IF: lineleft()<>0 & lineleft()<8}{PAGE}{FI}
{FOOTER}{FOOTER-}
{COMMENT}{ vp:=0; ~~}{COMMENT-}
{FONT: 'T8GB'}{SPACE: 'C'}
{
   podsum:=2;
   c[1]:='Razem:'@;
   c[2]:='';
   c[3]:='';
   c[4]:='';
   c[5]:='';
   c[6]:='';
   c[7]:='';
   c[8]:='';
   c[9]:='';
   c[10]:='';
   c[11]:='';
   {? PAR_WYDR.RODZAJ=1
   || {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
      || c[9]:=sum_pod[14];
         c[10]:=sum_pod[15];
         c[11]:=sum_pod[16]
      |? PAR_WYDR.DANE=2
      || c[9]:=sum_fin[14];
         c[10]:=sum_fin[15];
         c[11]:=sum_fin[16]
      |? PAR_WYDR.DANE=4
      || c[9]:=sum_dod[14];
         c[10]:=sum_dod[15];
         c[11]:=sum_dod[16]
      ?}
   ?}
;~~}
{prn1:='PRN'; prn2:='PRN1'; rsep:=1; ~~}
{SUBSTITUTE: 'LINIA02'}
{
   {? PAR_WYDR.DANE=1 | PAR_WYDR.DANE=3
   || c[1]:=sum_pod[1];
      c[2]:=sum_pod[2];
      c[3]:=sum_pod[3];
      c[4]:=sum_pod[4];
      c[5]:=sum_pod[5];
      c[6]:=sum_pod[6];
      c[7]:=sum_pod[7];
      c[8]:=sum_pod[8];
      c[9]:=sum_pod[9];
      c[10]:=sum_pod[10];
      c[11]:=sum_pod[11];
      c[12]:=sum_pod[12];

      {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
      ?};

      _suma:=0;
      {! _i:=1..12 |! {? type_of(c[_i])=1 || _suma+=c[_i] ?} !};
      c[13]:=_suma
   |? PAR_WYDR.DANE = 2
   || c[1]:=sum_fin[1];
      c[2]:=sum_fin[2];
      c[3]:=sum_fin[3];
      c[4]:=sum_fin[4];
      c[5]:=sum_fin[5];
      c[6]:=sum_fin[6];
      c[7]:=sum_fin[7];
      c[8]:=sum_fin[8];
      c[9]:=sum_fin[9];
      c[10]:=sum_fin[10];
      c[11]:=sum_fin[11];
      c[12]:=sum_fin[12];

      {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
      ?};

      _suma:=0;
      {! _i:=1..12 |! {? type_of(c[_i]) = 1 || _suma+=c[_i] ?} !};
      c[13]:=_suma
   |? PAR_WYDR.DANE = 4
   || c[1]:=sum_dod[1];
      c[2]:=sum_dod[2];
      c[3]:=sum_dod[3];
      c[4]:=sum_dod[4];
      c[5]:=sum_dod[5];
      c[6]:=sum_dod[6];
      c[7]:=sum_dod[7];
      c[8]:=sum_dod[8];
      c[9]:=sum_dod[9];
      c[10]:=sum_dod[10];
      c[11]:=sum_dod[11];
      c[12]:=sum_dod[12];

      {? PAR_WYDR.AMOR_ALL=0
      ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
             c[_i]:=''
          !}
      ?};

      _suma:=0;
      {! _i:=1..12 |! {? type_of(c[_i]) = 1 || _suma+=c[_i] ?} !};
      c[13]:=_suma
   ?}
;~~}
{prn1:='PRN1'; prn2:='PRN'; rsep:=1; ~~}
{SUBSTITUTE: 'LINIA02'}
{IF: PAR_WYDR.DANE = 3}
{
   c[1]:=sum_fin[1];
   c[2]:=sum_fin[2];
   c[3]:=sum_fin[3];
   c[4]:=sum_fin[4];
   c[5]:=sum_fin[5];
   c[6]:=sum_fin[6];
   c[7]:=sum_fin[7];
   c[8]:=sum_fin[8];
   c[9]:=sum_fin[9];
   c[10]:=sum_fin[10];
   c[11]:=sum_fin[11];
   c[12]:=sum_fin[12];
   {? PAR_WYDR.AMOR_ALL=0
   ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
          c[_i]:=''
       !}
   ?};
   _suma:=0;
   {! _i:=1..12 |! {? type_of(c[_i])=1 || _suma+=c[_i] ?} !};
   c[13]:=_suma;
   prn1:='PRN';prn2:='PRN';
   "vp:=0";
   rsep:=PAR_WYDR.RSEP
;~~}
{SUBSTITUTE: 'LINIA02'}
{IF: FINFO.TOR_D='T'}
{
   c[1]:=sum_dod[1];
   c[2]:=sum_dod[2];
   c[3]:=sum_dod[3];
   c[4]:=sum_dod[4];
   c[5]:=sum_dod[5];
   c[6]:=sum_dod[6];
   c[7]:=sum_dod[7];
   c[8]:=sum_dod[8];
   c[9]:=sum_dod[9];
   c[10]:=sum_dod[10];
   c[11]:=sum_dod[11];
   c[12]:=sum_dod[12];
   {? PAR_WYDR.AMOR_ALL=0
   ||  {! _i:=(SSTALE.AO().OES+1)..12 |!
          c[_i]:=''
       !}
   ?};
   _suma:=0;
   {! _i:=1..12 |! {? type_of(c[_i])=1 || _suma+=c[_i] ?} !};
   c[13]:=_suma;
   prn1:='PRN';prn2:='PRN';
   "vp:=0";
   rsep:=PAR_WYDR.RSEP
;~~}
{SUBSTITUTE: 'LINIA02'}
{FI}
{FI}
{FI}
{prn1:='PRN';prn2:='PRN'; vp:=0; ~~}
{REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}