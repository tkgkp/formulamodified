:!UTF-8
{TITLE: Wydruk wyciągów}
{PRINTER: FINFO.SZ_PRN,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
   PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   PRN:=obj_new(@.CLASS.PRINT,5); PRN.s_frame(); w:=obj_new(5);
   PRNF:=obj_new(@.CLASS.PRINT,2); PRNF.s_frame();
   l:=1; vsum:=0; rb:='';
   PW.cntx_psh();
   pw_ref:=PW.ref();
   color:=prn1:=prn2:=''; lm:=ll:=vp:=lmt:=rsep:=0
}
{END:
   obj_del(PRN); obj_del(PRNF); obj_del(w);
   &l; &vsum; &rb;
   PW.seek(pw_ref);
   PW.cntx_pop();
   &color; &prn1; &prn2; &lm; &ll; &vp; &lmt; &rsep; &pw_ref
}
{  PRN.add("w[1]",12,'Data wyciągu#Nr wyciągu'@,,'#');
   PRN.add("w[2]",35,'Przelew z rachunku'@,,'#');
   PRN.add("w[3]",60,'Kontrahent / rachunek bankowy / typ transakcji'@,,'#');
   PRN.add("w[4]",35,'Tytuł operacji'@);
   PRN.add("form(w[5],,2,' ,')",20,'Kwota'@,1);
   PRNF.add("'Razem'@",151);
   PRNF.add("form(vsum,,2,' ,')",20,,1);
   PAR_WYDR.TITLE:='WYCIĄGI BANKOWE'@;
   prn1:='PRN'; prn2:=prn3:='PRNF'; ~~}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{~~}
{FOOTER-}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{  rsep:=PAR_WYDR.RSEP; rb:=PW.RBL; PW.first(); ~~}
{WHILE: l}
{DO}
      {  w[1]:=$PW.DK+'#'+PW.NRW;
         w[2]:=PW.RBL;
         w[3]:=form(PW.KONTR+' /',60)+'#'+form(PW.RBK+' /',60)+'#'+PW.TYPTRAN;
         w[4]:=PW.TYTOP;
         w[5]:=PW.KW;
         vsum+=PW.KW; ~~}
      {SUBSTITUTE: 'LINIA0'}
   { l:=PW.next(); ~~}
{OD}
{COMMENT}------------------------------REPORT-FOOTER----------------{COMMENT-}
{IF: lineleft()<>0 & lineleft()<4}{PAGE}{FI}
{FOOTER}{FOOTER-}
{SUBSTITUTE: 'LINIAFS'}
