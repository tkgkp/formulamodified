:!UTF-8
{COMMENT}
Strona nr 1
{COMMENT-}
{ exec('czytaj','#stalesys',,XINFO); KSTE.get();~~}
{FOR: npage}
{DO}
{GRAPHIC: 'cmr.pdf'; npage.NR; 0; 0; 0; 0 }
{GRAPHICFONT: 'Arial'; hchar; ''; '0:0:0'}
{COMMENT}Sekcja 1: Nadawca{COMMENT-}
{nline:=0;nrsect:=1;~~}
{GRAPHICTEXT: XINFO.KRAJ().NAZ
              ;sect[nrsect][1]
              ;sect[nrsect][2]+(nline*space)
              ;sect[nrsect][3]}{nline+=1;~~}
{STR.split(XINFO.NAZ);~~}
{GRAPHICTEXT: STR.line(sect[nrsect][3])
              ;sect[nrsect][1]
              ;sect[nrsect][2]+(nline*space)
              ;sect[nrsect][3]}{nline+=1;~~}
{WHILE: STR.next()}
{DO}
   {GRAPHICTEXT: STR.line(sect[nrsect][3])
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]}{nline+=1;~~}
{OD}
{GRAPHICTEXT: XINFO.UL+' '+XINFO.NR_D+' '+XINFO.NR_L
              ;sect[nrsect][1]
              ;sect[nrsect][2]+(nline*space)
              ;sect[nrsect][3]}{nline+=1;~~}
{country:={? XINFO.KRAJ().SYM<>'' || '(%1)'[XINFO.KRAJ().SYM] || '' ?};~~}
{GRAPHICTEXT: '%1 %2 %3'[XINFO.KOD_P,XINFO.MIA,country]
              ;sect[nrsect][1]
              ;sect[nrsect][2]+(nline*space)
              ;sect[nrsect][3]}{nline+=1;~~}
{COMMENT}Sekcja 2: Nadawca{COMMENT-}
{nline:=0;nrsect:=2;~~}
{IF: TR_NZL.KH<>null()}
   {STR.split(TR_NZL.KH().NAZ_P);~~}
   {GRAPHICTEXT: STR.line(sect[nrsect][3])
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]}{nline+=1;~~}
   {WHILE: STR.next()}
   {DO}
      {GRAPHICTEXT: STR.line(sect[nrsect][3])
                    ;sect[nrsect][1]
                    ;sect[nrsect][2]+(nline*space)
                    ;sect[nrsect][3]}{nline+=1;~~}
   {OD}
   {GRAPHICTEXT: exec('adr','faktury_wydruk',TR_NZL.KH().UL,TR_NZL.KH().DOM,TR_NZL.KH().LOKAL,TR_NZL.KH().MIASTO,TR_NZL.KH().POCZ)
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]}{nline+=1;~~}
   {country:={? TR_NZL.KH().KRAJ<>'' || '(%1)'[TR_NZL.KH().KRAJ] || '' ?};~~}
   {GRAPHICTEXT: '%1 %2 %3'[TR_NZL.KH().KPOCZ,TR_NZL.KH().MIASTO,country]
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]}{nline+=1;~~}
{ELSE}
   {GRAPHICTEXT: TR_NZL.UL+' '+exec('trnzl_dom_lokal','transport_wspolne')
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]}{nline+=1;~~}
   {country:={? TR_NZL.KRAJ<>'' || '(%1)'[TR_NZL.KRAJ] || '' ?};~~}
   {GRAPHICTEXT: '%1 %2 %3'[TR_NZL.KPOCZ,TR_NZL.MIASTO,country]
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]}{nline+=1;~~}
{FI}
{COMMENT}Sekcja 3: Miejsce przeznaczenia{COMMENT-}
{nline:=0;nrsect:=3;~~}
{country:={? form(TR_NZL.KRAJ)<>'' || TR_NZL.KRAJ || XINFO.KRAJ().SYM ?};
 country:={? country<>'' || '(%1)'[country] || '' ?};~~}
{GRAPHICTEXT: '%1 %2 %3'[TR_NZL.MIASTO,TR_NZL.KPOCZ,country]
              ;sect[nrsect][1]
              ;sect[nrsect][2]+(nline*space)
              ;sect[nrsect][3]}{nline+=1;~~}
{COMMENT}Sekcja 4: Miejsce i data załadunku{COMMENT-}
{nline:=0;nrsect:=4;
VAR_DEL.delete('tr_mia','tr_kod','tr_kraj');
tr_mia:=XINFO.MIA;
tr_kod:=XINFO.KOD_P;
tr_kraj:=XINFO.KRAJ().SYM;
TR_NZL.cntx_psh();
TR_NZL.index('DOK_REF');
TR_NZL.prefix(TR_NZL.uidref());
{? TR_NZL.first()
|| {!
   |? {? TR_NZL.WHERE='TR_NZL'
      ||  tr_mia:=TR_NZL.MIASTO;
          tr_kod:=TR_NZL.KPOCZ;
          {? form(TR_NZL.KRAJ)<>'' || tr_kraj:=TR_NZL.KRAJ ?};
          0
      || TR_NZL.next()
      ?}
   !}
?};
TR_NZL.cntx_pop();~~}
{country:={? tr_kraj<>'' || '(%1)'[tr_kraj] || '' ?};~~}
{GRAPHICTEXT: '%1 %2 %3'[tr_kod,tr_mia,country]
              ;sect[nrsect][1]
              ;sect[nrsect][2]+(nline*space)
              ;sect[nrsect][3]}{nline+=1;~~}
{GRAPHICTEXT: form(TR_NZL.TR_NAG().WYJ_D,,2)
              ;sect[nrsect][1]
              ;sect[nrsect][2]+(nline*space)
              ;sect[nrsect][3]}{nline+=1;~~}
{COMMENT}Sekcja 5: Załączone dokumenty{COMMENT-}
{VAR_DEL.delete('tr_mia','tr_kod','tr_kraj');nline:=0;nrsect:=5;~~}
{IF: TR_NZL.CMR005<>''}
   {GRAPHICTEXT: TR_NZL.CMR005;sect[nrsect][1];sect[nrsect][2]+(nline*space);sect[nrsect][3]}{nline+=1;~~}
{FI}
{objetosc:=0;nline:=0;~~}
{FOR: TR_ZL}
{INDEX: 'POZ'}
{PREFIX: TR_NZL.ref()}
{DO}
   {COMMENT}Sekcja 6: Cechy numery{COMMENT-}
   {nrsect:=6;~~}
   {GRAPHICTEXT: TR_ZL.M().N
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]}
   {COMMENT}Sekcja 7: Ilość sztuk{COMMENT-}
   {nrsect:=7;~~}
   {GRAPHICTEXT: form({? TR_ZL.IL_SZT=0 || 1 || TR_ZL.IL_SZT ?},,0)
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]
                 ;'right'}
   {COMMENT}Sekcja 8: Sposób opakowania{COMMENT-}
   {nrsect:=8;~~}
   {GRAPHICTEXT: {? TR_ZL.SP_OP<>''
                 || TR_ZL.SP_OP
                 || ''
                 ?}
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]}
   {COMMENT}Sekcja 9: Rodzaj opakowania{COMMENT-}
   {nrsect:=9;~~}
   {GRAPHICTEXT: {? TR_ZL.RODZ_M<>''
                 || TR_ZL.RODZ_M
                 || ''
                 ?}
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]}
   {nrsect:=10;~~}
   {GRAPHICTEXT: {? TR_ZL.NRSTAT<>''
                 || TR_ZL.NRSTAT
                 || ''
                 ?}
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]}
   {nrsect:=11;~~}
   {GRAPHICTEXT: form(TR_ZL.IL_T*1000,,3)
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]
                 ;'right'}
   {nrsect:=12;~~}
   {objetosc:={? TR_ZL.DLUG>0
              || (TR_ZL.SZER*TR_ZL.DLUG*TR_ZL.WYSO)/1000 $3
              || TR_ZL.IL_M3
              ?};~~}
   {IF: objetosc>0}
      {GRAPHICTEXT: form(objetosc,,3)
                    ;sect[nrsect][1]
                    ;sect[nrsect][2]+(nline*space)
                    ;sect[nrsect][3]
                    ;'right'}
   {FI}
   {nline+=1;~~}
{OD}
{VAR_DEL.delete('objetosc');nline:=0;nrsect:=13;~~}
{STR.split(TR_NZL.memo_txt(,1,'CMR013'));~~}
{GRAPHICTEXT: STR.line(sect[nrsect][3])
              ;sect[nrsect][1]
              ;sect[nrsect][2]+(nline*space)
              ;sect[nrsect][3]}{nline+=1;~~}
{WHILE: STR.next()}
{DO}
   {GRAPHICTEXT: STR.line(sect[nrsect][3])
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]}{nline+=1;~~}
{OD}
{nline:=0;nrsect:=14;~~}
{COMMENT}
{GRAPHICTEXT: 'uzupełnij';sect[nrsect][1];sect[nrsect][2]+(nline*space);sect[nrsect][3]}{nline+=1;~~}
{COMMENT-}
{IF: TR_NZL.CMR014<>''}
   {IF: TR_NZL.CMR014='N'}
      {GRAPHICTEXT: 'X';sect[nrsect][1];sect[nrsect][2];sect[nrsect][3]}{nline+=1;~~}
   {ELSE}
      {GRAPHICTEXT: 'X';sect[nrsect][1];3.9+sect[nrsect][2];sect[nrsect][3]}{nline+=1;~~}
   {FI}
{FI}
{nline:=0;nrsect:=15;~~}
{COMMENT}
Nie uzupełniamy
{GRAPHICTEXT: 'uzupełnij';sect[nrsect][1];sect[nrsect][2]+(nline*space);sect[nrsect][3]}{nline+=1;~~}
{COMMENT-}
{nline:=0;nrsect:=16;~~}
{IF: TR_NZL.TR_NAG().TR_KH<>null()}
   {STR.split(TR_NZL.TR_NAG().TR_KH().NAZ_P);~~}
   {GRAPHICTEXT: STR.line(sect[nrsect][3])
                ;sect[nrsect][1]
                ;sect[nrsect][2]+(nline*space)
                ;sect[nrsect][3]}{nline+=1;~~}
   {WHILE: STR.next()}
   {DO}
      {GRAPHICTEXT: STR.line(sect[nrsect][3])
                ;sect[nrsect][1]
                ;sect[nrsect][2]+(nline*space)
                ;sect[nrsect][3]}{nline+=1;~~}
   {OD}
   {GRAPHICTEXT: TR_NZL.TR_NAG().TR_KH().UL
                ;sect[nrsect][1]
                ;sect[nrsect][2]+(nline*space)
                ;sect[nrsect][3]}{nline+=1;~~}
   {country:={? TR_NZL.TR_NAG().TR_KH().KRAJ<>'' || '(%1)'[TR_NZL.TR_NAG().TR_KH().KRAJ] || '' ?};~~}
   {GRAPHICTEXT: '%1 %2 %3'[TR_NZL.TR_NAG().TR_KH().KPOCZ
                             ,TR_NZL.TR_NAG().TR_KH().MIASTO
                             ,country]
                ;sect[nrsect][1]
                ;sect[nrsect][2]+(nline*space)
                ;sect[nrsect][3]}
   {nline+=1;~~}
{FI}
{IF: TR_NZL.TR_NAG().NRREJ<>'' & TR_NZL.TR_NAG().NRDOD<>''}
   {GRAPHICTEXT: '%1 / %2'[TR_NZL.TR_NAG().NRREJ,TR_NZL.TR_NAG().NRDOD];sect[nrsect][1];12+sect[nrsect][2];25}
{ELSE}
   {GRAPHICTEXT: TR_NZL.TR_NAG().NRREJ;sect[nrsect][1];12+sect[nrsect][2];25}
{FI}
{nline:=0;nrsect:=17;~~}
{STR.split(TR_NZL.TR_NAG().memo_txt(,1,'TR_KHBIS'));~~}
{GRAPHICTEXT: STR.line(sect[nrsect][3])
              ;sect[nrsect][1]
              ;sect[nrsect][2]+(nline*space)
              ;sect[nrsect][3]}{nline+=1;~~}
{WHILE: STR.next()}
{DO}
   {GRAPHICTEXT: STR.line(sect[nrsect][3])
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]}{nline+=1;~~}
{OD}
{nline:=0;nrsect:=18;~~}
{COMMENT}
Nie uzupełniamy
{GRAPHICTEXT: 'uzupełnij';sect[nrsect][1];sect[nrsect][2]+(nline*space);sect[nrsect][3]}{nline+=1;~~}
{COMMENT-}
{nline:=0;nrsect:=19;~~}
{STR.split(TR_NZL.memo_txt(,1,'CMR019'));~~}
{GRAPHICTEXT: STR.line(sect[nrsect][3])
              ;sect[nrsect][1]
              ;sect[nrsect][2]+(nline*space)
              ;sect[nrsect][3]}{nline+=1;~~}
{WHILE: STR.next()}
{DO}
   {GRAPHICTEXT: STR.line(sect[nrsect][3])
                 ;sect[nrsect][1]
                 ;sect[nrsect][2]+(nline*space)
                 ;sect[nrsect][3]}{nline+=1;~~}
{OD}
{nline:=0;nrsect:=21;~~}
{GRAPHICTEXT: form(XINFO.MIA)
              ;sect[nrsect][1]
              ;sect[nrsect][2]+(nline*space)
              ;sect[nrsect][3]}
{GRAPHICTEXT: form(TR_NZL.TR_NAG().WYJ_D,,2)
              ;60+sect[nrsect][1]
              ;sect[nrsect][2]+(nline*space)
              ;sect[nrsect][3]}{nline+=1;~~}
{GRAPHICFONT: 'System'; 6; ; '0:0:0'; 1; 0; 1 }
{GRAPHICTEXT: __Stopka; 60.0; 294}
{GRAPHIC-}
{OD}