:!UTF-8
{COMMENT}--Definicja wiersza wydruku grupy op.--------------------{COMMENT-}
{"------------------------------------------------------------------------"; ~~}
{"---Definicja wiersza zasobów grupy operacji.                    "; ~~}
{PRNGROPS.add("' '",50,'Kod kreskowy'@); ~~}
{PRNGROPS.add("GROPS.KOD",20,'Kod'@); ~~}
{PRNGROPS.add("GROPS.PL_RES().SYM",20,'Zasób'@); ~~}
{PRNGROPS.add("form(GROPS.CZAS)",20,'Czas'@,1); ~~}
{"---Definicja wiersza pozycji grupy operacji.                    "; ~~}
{PRNGROPP.add("GROPP.ZL().SYM",20,'Zlecenie'@); ~~}
{PRNGROPP.add("GROPP.M().KTM",50,'Produkt'@); ~~}
{PRNGROPP.add("form(GROPP.IL)",20,'Ilość'@,1); ~~}
{"---Definicja wiersza surowca grupy operacji.                    "; ~~}
{PRNZLIM.add("ZLIM.KTM().KTM",40,'Kod'@); ~~}
{PRNZLIM.add("ZLIM.KTM().KTM",40,'Nazwa'@); ~~}
{PRNZLIM.add("ZLIM.LIMIT",6,'Limi- towany'@); ~~}
{PRNZLIM.add("ZLIM.LIL",20,'Ilość'@,1); ~~}
{IF: variant='grops'}
{PAR_WYDR.TITLE:='ZASÓB GRUPY OPERACJI: %1'@[GROP.KOD];~~}
{ELSE}
{PAR_WYDR.TITLE:='ZASOBY GRUPY OPERACJI: %1'@[GROP.KOD];~~}
{FI}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8'}{SPACE: 'B'}
{ lmt:=int((charleft()-PRNGROPS.width())/2); ~~}
{<{lmt} 'Opis: %1'@[GROP.OPIS]}
{<{lmt} 'Ilość uruchomień: %1'@[form(GROP.IL)]}
{FONT: 'T8B'}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8'}{SPACE: 'B'}
{ rsep:=PAR_WYDR.RSEP; ~~}
{"---Teraz drukuj tabelke zasobów grupy operacji.                   "; ~~}
  {FOR: 'GROPS'}
    {INDEX: {? variant='grops' || 'IDEAN' || 'DEFAULT' ?}}
    {PREFIX: {? variant='grops' || GROPS.IDEAN || GROP.ref() ?}}
  {DO}
    {FIRST}
     {"---Istnieja zasoby.                                    "; ~~}
      { gropsexist:=1; ~~}
{      lk:=charleft();prn1:='PRNGROPS'; ~~}
{IF: variant='grops'}
      {<1>{lk} 'Zasób'@}
{ELSE}
      {<1>{lk} 'Zasoby'@}
{FI}
{ lmt:=int((charleft()-PRNGROPS.width())/2); ~~}
      {FONT: 'T8B'}
      {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}
     {FIRST-}
        {IF: lineleft > 5} {SUBSTITUTE: 'LINIA0'}
        {ELSE}{SUBSTITUTE: 'LINIAF'}{PAGE}{FONT: 'T8B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}{SUBSTITUTE: 'LINIA0'}
        {FI}
   {SPACE: 'B'
   }{temp:=GROPS.IDEAN;~~
   }{<{lmt+1}ramka
   }{<{(lmt+10)}
   }{BARCODE: temp;30;BARCODE_H;BARCODE_TYPE
   }{>{lmt+54}ramka
   }{>{lmt+77}ramka
   }{>{lmt+100}ramka
   }{>{lmt+123}ramka
   }
  {OD}
{IF:gropsexist=1}{SUBSTITUTE: 'LINIAF'}{FI}
{"---Teraz drukuj tabelke pozycji grupy operacji.                   "; ~~}
  {FOR: 'GROPP'}
    {INDEX: 'GROP2'}
    {PREFIX: GROP.ref()}
  {DO}
    {FIRST}
     {"---Istnieja pozycje.                                    "; ~~}
      { groppexist:=1; ~~}
{      lk:=charleft();prn1:='PRNGROPP'; ~~}

      {<1>{lk} 'Pozycje'@}
{ lmt:=int((charleft()-PRNGROPP.width())/2); ~~}
      {FONT: 'T8B'}
      {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}
     {FIRST-}
        {IF: lineleft > 5} {SUBSTITUTE: 'LINIA0'}
        {ELSE}{SUBSTITUTE: 'LINIAF'}{PAGE}{FONT: 'T8B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}{SUBSTITUTE: 'LINIA0'}
        {FI}
  {OD}
{IF:groppexist=1}{SUBSTITUTE: 'LINIAF'}{FI}
{"---Teraz drukuj tabelke surowców grupy operacji.                   "; ~~}
{ exec('openmask','zl_common',null(),GROP.ref()); ndx:=ZLIM.ndx_tmp(,,'GROP',,,'KOR',,); ~~}
  {FOR: 'ZLIM'}
    {INDEX: ndx}
    {PREFIX: GROP.ref(),0}
  {DO}
    {FIRST}
     {"---Istnieja pozycje.                                    "; ~~}
      { zlimexist:=1; ~~}
{      lk:=charleft();prn1:='PRNZLIM'; ~~}

      {<1>{lk} 'Surowce'@}
{ lmt:=int((charleft()-PRNZLIM.width())/2); ~~}
      {FONT: 'T8B'}
      {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}
     {FIRST-}
        {IF: lineleft > 5} {SUBSTITUTE: 'LINIA0'}
        {ELSE}{SUBSTITUTE: 'LINIAF'}{PAGE}{FONT: 'T8B'}{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8'}{ vp:=1; ~~}{SUBSTITUTE: 'LINIA0'}
        {FI}
  {OD}
{ ZLIM.ndx_drop(ndx); &ndx; ~~}
{IF:zlimexist=1}{SUBSTITUTE: 'LINIAF'}{FI}
