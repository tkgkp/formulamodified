:!UTF-8
{TITLE: Wydruk syntetyczny deklaracji JPK_V7}
{PRINTER: FINFO.SZ_PRN,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN: PRN1:=obj_new(@.CLASS.PRINT,13); PRN1.sl_frame(); w:=obj_new(6); {! _i:=1..6 |! w[_i]:=''  !};
        PRN2:=obj_new(@.CLASS.PRINT,6); PRN2.sl_frame(); s:=obj_new(3);
        PRN3:=obj_new(@.CLASS.PRINT,6); PRN3.sl_frame(); ww:=obj_new(18); {! _i:=1..18 |! ww[_i]:=''  !};
        PRN4:=obj_new(@.CLASS.PRINT,6); PRN4.sl_frame(); short:=0;
        color:=''; prn1:='PRN1'; prn2:='PRN2'; prn3:='PRN3'; lm:=ll:=lmt:=0; vp:=1; warunek:=0; rsep:=1; ost:=''; pierwszy:=1; tryb:=0;
        JPK_SYN.cntx_psh();
        _ndx:=JPK_SYN.ndx_tmp(,,'ZAKL',,,'KOL',,);
        JPK_SYN.index(_ndx);
        PAR_WYDR.TITLE:='Wydruk syntetyczny deklaracji JPK_V7'
}
{END: VAR_DEL.delete('PRN1','PRN2','PRN3','PRN4','w','ww','s','short'); &color; &prn1; &prn2; &lm; &ll; &vp; &lmt; &rsep; &warunek; &ost;
      &pierwszy; &tryb;
      JPK_SYN.cntx_pop()
}
{EXIT: 0}
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzezone
==================================================
Nazwa pliku: fks_jpk_synt.rpm
Utworzony:   16-03-2021 [MP] Michał Polak
==================================================
Zawartosc: Wydruk syntetyczny deklaracji JPK_V7
{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{INCLUDE: wsp_pw2.rpi}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{ {? ~rep_export()
  || PRN2.add("form(s[1],,,' ,')",142,'Nazwa',0);

     PRN1.add("form(w[1],,,' ,')",7,'Kod',0);
     PRN1.add("form(w[2],,,' ,')",100,'Nazwa',0);
     PRN1.add("form(w[3],,2,' ,')",16,'Netto',1);
     PRN1.add("form(w[4],,2,' ,')",16,'Kwota VAT',1);

     PRN3.add("form(w[2],,,' ,')",125,'Nazwa',0);
     PRN3.add("form(w[4],,,' ,')",16,'Wartość',1);

     PRN4.add("form(w[1],,,' ,')",15,'Kod',0);
     PRN4.add("form(w[2],,,' ,')",115,'Nazwa',0);
     PRN4.add("form(w[3],,,' ,')",10,'Liczba dokumentów',1)
  || PRN2.add("form(s[1],,,' ,')",150,'Nazwa',0);

     PRN1.add("form(w[5],,,' ,')",7,'Rodzaj',0);
     PRN1.add("form(w[1],,,' ,')",7,'Kod',0);
     PRN1.add("form(w[2],,,' ,')",100,'Nazwa',0);
     PRN1.add("form(w[3],,2,' ,')",16,'Netto',1);
     PRN1.add("form(w[4],,2,' ,')",16,'Kwota VAT',1);
     PRN1.add("form(w[6],,2,' ,')",16,'Liczba dokumentów',1);

     PRN3.add("form(w[5],,,' ,')",7,'Rodzaj',0);
     PRN3.add("form(w[1],,,' ,')",15,'Kod',0);
     PRN3.add("form(w[2],,,' ,')",125,'Nazwa',0);
     PRN3.add("form(w[6],,,' ,')",16,'Wartość',1);
     PRN3.add("form(w[6],,,' ,')",16,'Wartość',1);
     PRN3.add("form(w[4],,,' ,')",16,'Wartość',1);

     PRN4.add("form(w[5],,,' ,')",7,'Rodzaj',0);
     PRN4.add("form(w[1],,,' ,')",15,'Kod',0);
     PRN4.add("form(w[2],,,' ,')",115,'Nazwa',0);
     PRN4.add("form(w[6],,,' ,')",115,'Nazwa',0);
     PRN4.add("form(w[6],,,' ,')",115,'Nazwa',0);
     PRN4.add("form(w[3],,,' ,')",10,'Liczba dokumentów',1)
  ?};
~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{MACRO: 'SRODEK'}
{
  {! _i:=1 .. 4 |! w[_i]:='' !};
~~}
{IF: lineleft<=2&lineleft>0}{PAGE}{FI}
{IF: ~rep_export() & s[1]<>''}
{IF: vp=1}
{SUBSTITUTE: 'LINIA02'}
{ELIF: pierwszy>1 }
{prn1:='PRN2'; ~~}
{SUBSTITUTE: 'LINIA0'}
{prn1:='PRN1'; ~~}
{ELSE}
{SUBSTITUTE: 'LINIA02'}
{FI}
{FI}
{{? short=0 || pierwszy:=1 ?};~~}
{FOR: 'JPK_SYN'}
{INDEX:JPK_SYN.ndx_tmp(,,'ZAKL',,,'KOL',,0)}
{PREFIX: zakladka}
{DO}
{
  w[1]:=JPK_SYN.KOD;
  w[2]:=JPK_SYN.NAZWA;
  {? short || w[3]:=JPK_SYN.STR || w[3]:=JPK_SYN.VALUE ?};
  {? short || w[4]:=JPK_SYN.STR || w[4]:=JPK_SYN.VALUE2 ?};
  ~~
  }
{IF: lineleft<=2&lineleft>0}{PAGE}{FI}
{IF: vp=1}
{SUBSTITUTE: 'LINIA0'}
{ELIF: pierwszy=1}
{prn1:='PRN2';prn2:='PRN1'; ~~}
{SUBSTITUTE: 'LINIA02'}
{prn1:='PRN1';prn2:='PRN2'; ~~}
{ELSE}
{IF: 1+w[1]<>'C' & 1+w[1]<>'D'}
{prn1:='PRN3'; prn2:='PRN3'; ~~}
{SUBSTITUTE: 'LINIA02'}
{ELSE}
{SUBSTITUTE: 'LINIA03'}
{FI}
{prn1:='PRN1';prn2:='PRN2'; ~~}
{FI}
{pierwszy:=0;~~}
{OD}
{MACRO-}
{MACRO: 'SRODEK2'}
{IF: lineleft<=2&lineleft>0}{PAGE}{FI}
{IF: ~rep_export()}
{IF: vp=1}
{SUBSTITUTE: 'LINIA02'}
{ELIF: pierwszy=1 }
{prn1:='PRN1'; ~~}
{SUBSTITUTE: 'LINIA0'}
{prn1:='PRN2'; ~~}
{ELSE}
{SUBSTITUTE: 'LINIA02'}
{FI}
{FI}
{pierwszy:=1;~~}
{FOR: 'JPK_SYN'}
{PREFIX: zakladka}
{DO}
{ w[1]:=JPK_SYN.KOD;
  w[2]:=JPK_SYN.NAZWA;
  w[3]:=JPK_SYN.STR;
  ~~
  }
{IF: lineleft<=2&lineleft>0}{PAGE}{FI}
{IF: vp=1}
{SUBSTITUTE: 'LINIA0'}
{ELIF: pierwszy=1}
{prn1:='PRN2';prn2:='PRN4'; ~~}
{SUBSTITUTE: 'LINIA02'}
{prn1:='PRN4';prn2:='PRN2'; ~~}
{ELSE}
{SUBSTITUTE: 'LINIA03'}
{FI}
{pierwszy:=0;~~}
{OD}
{MACRO-}
{HEADER}
{SUBSTITUTE: 'HEAD'}{FONT: 'W8'}{SPACE: 'C'}
{IF: page=1}
{ _ndx:=JPK_SYN.ndx_tmp(,,'ZAKL',,,'KOD',,); JPK_SYN.index(_ndx);
 JPK_SYN.prefix(1,'IDPOD'); {? JPK_SYN.first() || ww[1]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'MSC'); {? JPK_SYN.first() || ww[2]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'ROK'); {? JPK_SYN.first() || ww[3]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'NRDOK'); {? JPK_SYN.first() || ww[4]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'STATUS'); {? JPK_SYN.first() || ww[5]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'DATA'); {? JPK_SYN.first() || ww[6]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'US'); {? JPK_SYN.first() || ww[9]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'KOR'); {? JPK_SYN.first() || ww[10]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'RODZPOD'); {? JPK_SYN.first() || ww[11]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'NAZWA'); {? JPK_SYN.first() || ww[12]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'TEL'); {? JPK_SYN.first() || ww[13]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'MAIL'); {? JPK_SYN.first() || ww[14]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'KOR'); {? JPK_SYN.first() || ww[15]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'IMIE'); {? JPK_SYN.first() || ww[16]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'NAZWISKO'); {? JPK_SYN.first() || ww[17]:=JPK_SYN.STR ?};
 JPK_SYN.prefix(1,'DATA_UR'); {? JPK_SYN.first() || ww[18]:=JPK_SYN.STR ?};
~~}
{<2 'Identyfikator NIP podatnika: '+ww[1]}
{<2 'JPK za: miesiąc '+ww[2]+', Rok: '+ww[3]}{<50 'Wariant deklaracji: '+ww[4]}{<100 'Status: '+ww[5]}
{<2 'Data utworzenia deklaracji: '+ww[6]}
{IF: ww[9]<>''}{<2 'Urząd skarbowy, do którego jest adresowany plik JPK: '+ww[9]}{FI}
{<2 'Rodzaj podatnika: '+ww[11]}{IF: ww[11]<>'Osoba fizyczna'}{<50 'Pełna nazwa podatnika: '+ww[12]}{FI}
{IF: ww[11]='Osoba fizyczna'}{<2 'Nazwisko:'+ww[16]}{<50 'Imię: '+ww[17]}{<100 'Data urodzenia: '+ww[18]}{FI}
{IF: ww[13]<>''}{<2 'Telefon kontaktowy: '+ww[13]}{<50 'Adres e-mail: '+ww[14]}{ELSE}{<2 'Adres e-mail: '+ww[14]}{FI}
{<2 'Korekta podstawy opodatkowania oraz: '+ww[15]}
{<2 'Cel złożenia: '+ww[10]}
{FI}
{FONT: 'T8B'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{ vp:=1;~~}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}{FONT: 'T8'}{SPACE: 'C'}
{prn1:=last;~~}{SUBSTITUTE: 'LINIAF'}{ prn1:='PRN1';vp:=1;~~}
{FOOTER-}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8'}{SPACE: 'C'}
{s[1]:='Podsumowanie ewidencji sprzedaży'; w[5]:='Sprzedaż';
zakladka:=2;
podsum:=1;
last:='PRN3';
 short:=0; ~~}
{SUBSTITUTE: 'SRODEK'}
{s[1]:=''; w[5]:='Sprzedaż'; zakladka:=3; short:=1; ~~}
{SUBSTITUTE: 'SRODEK'}
{PAGE}
{pierwszy:=1;last:='PRN3';podsum:=1;  ~~}
{s[1]:='Podsumowanie ewidencji zakupu'; w[5]:='Zakup'; zakladka:=4; short:=0; ~~}
{SUBSTITUTE: 'SRODEK'}
{s[1]:=''; w[5]:='Zakup'; zakladka:=5; short:=1; ~~}
{SUBSTITUTE: 'SRODEK'}
{PAGE}
{pierwszy:=1;last:='PRN4'; prn1:='PRN4';  short:=0; ~~}
{s[1]:='Oznaczenia dotyczące dostawy i świadczenia usług'; w[5]:='GTU'; zakladka:=6; ~~}
{SUBSTITUTE: 'SRODEK2'}
{PAGE}
{pierwszy:=1;last:='PRN4'; prn1:='PRN4'; ~~}
{s[1]:='Oznaczenia dotyczące procedur'; w[5]:='Procedury'; zakladka:=7; ~~}
{SUBSTITUTE: 'SRODEK2'}