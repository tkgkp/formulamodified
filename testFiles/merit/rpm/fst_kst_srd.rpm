:!UTF-8
{TITLE: Środki trwałe ze zmianą grupy po zmianie klasyfikacji}
{PRINTER: FINFO.W_PRN,,,,,'M','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   PRN:=obj_new(@.CLASS.PRINT,15); PRN.s_frame();
   c:=obj_new(15);
   {! _i:=1..14 |! c[_i] := '' !};
   i:=0;
   color:=prn1:=prn2:='';
   lm:=ll:=vp:=lmt:=rsep:=0;
   __t_sgr:=__t_ngr:=__t_nri:=__t_nst:=__t_odd:='';
   par1:=0; par2:=0; par3:=0; par4:=0; par5:=0
}
{END:
   obj_del(PRN);
   obj_del(c);
   &i; &color; &prn1; &prn2;
   &lm; &ll; &vp; &lmt; &rsep;
   &par1; &par2; &par3;&par4;&par5;
   &__t_sgr; &__t_ngr; &__t_nri; &__t_nst; &__t_odd
}
{EXIT:
   {? SSTALE.AR().ZK<>'T'
   || FUN.emsg('W bieżącym roku nie przeprowadzono zmiany klasyfikacji.'@);
      1
   || 0
   ?}
}
{COMMENT}
==================================================
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
Nazwa pliku: fst_kst_srd.rpm
Utworzony  : 2018-10-30
Zawartość  : Środki trwałe ze zmianą grupy po zmianie klasyfikacji
==================================================
{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{COMMENT}--Definicja wiersza wydruku--------------------{COMMENT-}
{  prn1:='PRN'; prn2:='PRN'; ~~}
{
      PRN.add("c[1]",18,'Nr inwentarzowy',,'#');
      PRN.add("c[2]",50,'Nazwa środka',,' ');
      PRN.add("c[3]",12,'J. księgowa',,' ');
      PRN.add("c[4]",16,'Poprzednia grupa',,' ');
      PRN.add("c[5]",16,'Obecna grupa',,' ');

      PAR_WYDR.TITLE:='Środki trwałe ze zmianą grupy po zmianie klasyfikacji'; ~~}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{COMMENT}------------------------------Parametry wydruku------------{COMMENT-}
{FONT: 'W8'}{SPACE: 'C'}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{ rsep:=1; ~~}
{prn1:='PRN';~~}
{FOR: SRSR}{INDEX: 'NRI'}
 {DO}
 { __t_sgr:=__t_ngr:=__t_nri:=__t_nst:=__t_odd:='';
   _rok:=SSTALE.AO().RES;
   _rokp:=SSTALE.AO().RES-1;
   _new:=exec('find_okro_f','fst',date(_rok,1,1));
   _old:=exec('find_okro_f','fst',date(_rokp,12,1));
   SRST.cntx_psh();
   SRST.index('SROD');
   EDIT_ES.OKRO_F:=_new;
   SRST.prefix(SRSR.ref(),EDIT_ES.OKRO_F().ROK,_new);
   {? SRST.first()
   || __t_ngr:=SRST.GR().GR;
      __t_nri:=SRST.NRI;
      __t_nst:=SRST.NST;
      __t_odd:=SRST.ODD().OD
   ?};
   EDIT_ES.OKRO_F:=_old;
   SRST.prefix(SRSR.ref(),EDIT_ES.OKRO_F().ROK,_old);
   {? SRST.first()
   || __t_sgr:=SRST.GR().GR
   ?};
   SRST.cntx_pop()
 ;~~}
 {IF: __t_nri<>'' & __t_ngr<>__t_sgr}
{COMMENT} ---- zwykłe wiersze ---- {COMMENT-}
 {
      c[1] := __t_nri;
      c[2] := __t_nst;
      c[3] := __t_odd;
      c[4] := __t_sgr;
      c[5] := __t_ngr

 ;~~}
  {IF: lineleft() <> 0 & lineleft() <=4}{PAGE}{FI}
  {SUBSTITUTE: 'LINIA0'}
  {rsep:=PAR_WYDR.RSEP;~~}
 {FI}
 {OD}
{COMMENT}------------------------------FOOTER-LAST------------------{COMMENT-}
{FOOTER}{FOOTER-}
{REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}