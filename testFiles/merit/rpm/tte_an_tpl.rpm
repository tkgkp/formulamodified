:!UTF-8
{TITLE: Struktura produktu}
{PRINTER: INFO.W_PRN,,,,,'E','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
      PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
  prn1:='PRN';
  waslbar:=0;
  dalej:=0;
  icon:='';
  color:='';
  lm:=ll:=vp:=lmt:=rsep:=0
}
{END:
  {? var_pres('T_T')>0
  || &T_T;
     &ticon;
     &tdepth;
     &tlast
  ?};
  &dalej;
  &prn1;
  &icon;
  &color;
  &lm; &ll; &vp; &lmt; &rsep
}
{COMMENT}
  Wydruk struktury produktu (drzewo)
   [MK] - 2001/11/07 - [7.53] OWwPRO13/5.1
{COMMENT-}
{COMMENT}--Definicja wiersza wydruku--------------------------------{COMMENT-}
{
PAR_WYDR.TITLE:='STRUKTURA PRODUKTU';~~}
{INCLUDE: tte_tree.rpi}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8'}{SPACE: 'B'}
{<1 'Technologia:'}{<25 VAR.A_KTL().NRK+' wer.'+VAR.A_KTL().WER}
{<1 form('Opis:')}{<25 VAR.A_KTL().OPIS}

{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8'}{SPACE: 'B'}
{SUBSTITUTE: 'form'}
{ 'zasilamy tabele tymczasowa T_T, ktora potem posluzy do wydruku drzewa';
  dodaj:="
  TKTL.cntx_psh();
  _a.cntx_psh();
  _a.index(_b);
  _a.prefix(_c);
  {? _a.first()
  || {!
     |?
        _ktl:=null();
        {? _a.RKTL<>''
        ||
           TKTL.use(form(8+_a.RKTL));
           TKTL.clear();
           {? TKTL.seek(BIT.sqlint(_a.RKTL),)
           || _ktl:=TKTL.ref()
           || TKTL.NRK:=TKTL.WER:=''
           ?}
        ?};

        addt(_d,_a.PT_S+' - '+_a.PT_N,', S/O '+_a.SO+', norma: '+form(_a.WARB)+' ('+_a.PT_JM+')',
        {? _ktl<>null || ', techn. '+ TKTL.NRK+' wer.'+ TKTL.WER || '' ?});
        dodaj(_a,_b,_a.NODE,#T_T.ref());

        _a.next()
     !}
  ?};
  _a.cntx_pop();
  TKTL.cntx_pop();
  ~~" ;
  __SUR.TAB.first();
   addt(0,VAR.A_KTL().KTM().KTM+' - '+VAR.A_KTL().KTM().KTM ,', Ilość: '+form(VAR.A_KTL().XJM)+' ('+VAR.A_KTL().KTM().J().KOD+')',
  ', techn. '+ VAR.A_KTL().NRK+' wer.'+ VAR.A_KTL().WER);
  dodaj(__SUR.TAB,__SUR.NDX1,__SUR.TAB1.NODE,#T_T.ref());
  ~~}
{ rsep:=PAR_WYDR.RSEP; ~~}
{FOR: T_T}
{PREFIX: 0}
{DO}
{ ticon(T_T, 'UPNODE')+T_T.OPIS1}
{SUBSTITUTE: 'branch'}
{OD}
