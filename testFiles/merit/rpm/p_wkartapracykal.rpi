:!UTF-8
{BEGIN:
   VAR_DEL.delete('tresc','lmt','Cnt');
   VAR_DEL.delete('dz','var','val','total','display','names','PRH','PRG','PRN');
   VAR_DEL.delete('mark','control','group','dayOfWeek');
   VAR_DEL.delete('empty','lp','prn1','prn2','vp','rsep','size');

   tresc:='pkd_wkartapracykal';

   dz:=obj_new(32);
   {! _ii:=1..obj_len(dz) |! dz[_ii]:=obj_new(43) !};
   var:=obj_new(8);
   var[2]:=151;
   var[1]:=exec('uprawnieniawrap','pkd','nieobecnościach'@,'PKD_EZK_OPNN','PKD_EZK_ORNN')+
           exec('uprawnieniawrap','pkd','godzinach pracy'@,'PPL_PLL_PGOD','PPL_PLL_RGOD')+
           exec('uprawnieniawrap','pkd','wzorcach czasu pracy'@,'PKD_EZK_OPKA','PKD_EZK_ORKA');

   PAR_WYDR.TITLE:='';
   P.cntx_psh();
   H.cntx_psh();
   N.cntx_psh();
   R_WZCZ.cntx_psh();
   R_WYK.cntx_psh();
   G.cntx_psh();

   {? +var[1]
   || FUN.emsg('Brak wymaganych uprawnień do przeglądania informacji o: %1'@[var[1]])
   || var[8]:=exec('par_wydr_ddp','pkd',
         'Karta czasu pracy'@,
         "  {? cur_tab().ROK<1900
            || FUN.emsg('Wymagane poprawne wypełnienie pola \"Rok\"'@); 'ROK'
            |? cur_tab().MC<1 | cur_tab().MC>12
            || FUN.emsg('Wymagane poprawne wypełnienie pola \"Miesiąc\"'@); 'MC'
            || 1
            ?}
         ",
         ,,,
         ,,,
         ,,,,,
         date()~1,"1",
         date()~2,"1",
         'Godziny z kalendarza'@,'Tak, dodawać godziny pracy z kalendarza'@,0
      );
      {? var[7]:=var[8].size()
      || H.index('_HISTKOD');
         N.index('NIEOBECN');
         R_WZCZ.index('R_WZCZE');
         R_WYK.index('R_WYKDN');
         G.use('godz'+form(var[8].ROK,-4,,'9.'));
         G.index('MSCDKW');
         params_set('P',exec('wybierz_parses','pracownik','PKD').P);

         size:=42;
         val:=obj_new(size);
         {! _ii:=1..obj_len(val) |! val[_ii]:=obj_new(31) !};
         total:=obj_new(size);
         display:=obj_new(size);
         names:=obj_new(size);

         'Dzień:';
         display[1]:=0;    names[1]:='Dzień miesiąca';
         display[2]:=0;    names[2]:='Dzień tygodnia';
         'Plan pracy:';
         display[3]:=1;    names[3]:='Plan pracy:';
         display[4]:=1;    names[4]:='oznaczenie dnia';
         'Dzień pracy:';
         display[5]:=1;    names[5]:='Dzień pracy (liczba dni):';
         display[6]:=1;    names[6]:='godzina rozpoczęcia';
         display[7]:=1;    names[7]:='godzina zakończenia';
         display[8]:=1;    names[8]:='data zakończenia';
         'Czas pracy:';
         display[9]:=1;    names[9]:='Czas pracy (liczba godzin):';
         display[10]:=1;   names[10]:='praca w niedziele i święta';
         display[11]:=1;   names[11]:='praca w dni dodatkowo wolne';
         display[12]:=1;   names[12]:='godziny nadliczbowe';
         display[13]:=0;   names[13]:='przekroczenia średniotygodniowe';
         display[14]:=0;   names[14]:='praca ponad wymiar';
         'Dyżury:';
         display[15]:=1;   names[15]:='Dyżury (liczba godzin):';
         display[16]:=1;   names[16]:='godzina rozpoczęcia';
         display[17]:=1;   names[17]:='godzina zakończenia';
         display[18]:=1;   names[18]:='miejsce pełnienia';
         'Młodociani:';
         display[19]:=1;   names[19]:='Młodociani (czas pracy):';
         display[20]:=1;   names[20]:='liczba godzin pracy wzbronionej';
         'Nieobecności:';
         display[21]:=1;   names[21]:='Nieobecności (liczba godzin):';
         display[22]:=0;   names[22]:='urlop wypoczynkowy';
         display[23]:=0;   names[23]:='urlop macierzyński';
         display[24]:=0;   names[24]:='urlop wychowawczy';
         display[25]:=0;   names[25]:='urlop bezpłatny';
         display[26]:=0;   names[26]:='urlop okolicznościowy';
         display[27]:=0;   names[27]:='zwolnienie niepłatne';
         display[28]:=0;   names[28]:='choroba pracownika';
         display[29]:=0;   names[29]:='opieka nad dzieckiem';
         display[30]:=0;   names[30]:='nieobecność usprawiedliwiona';
         display[31]:=0;   names[31]:='nieobecność nieusprawiedliwiona';
         display[32]:=0;   names[32]:='przestój';
         'Informacje dodatkowe:';
         display[33]:=1;   names[33]:='Informacje dodatkowe:';
         display[34]:=1;   names[34]:='praca w porze nocnej';
         display[35]:=0;   names[35]:='liczba godzin z dodatkiem 50%';
         display[36]:=0;   names[36]:='liczba godzin z dodatkiem 100%';
         display[37]:=0;   names[37]:='godziny odebrane';
         display[38]:=0;   names[38]:='odbiór godzin nadliczbowych';
         display[39]:=0;   names[39]:='wnioskowany czas wolny';
         display[40]:=0;   names[40]:='godziny do odpracowania';
         display[41]:=0;   names[41]:='godziny odpracowane';
         display[42]:=0;   names[42]:='praca poza siedzibą firmy';

         dayOfWeek:="
            _dt:=date(_a,_b,_c)~4;
            {? _dt=1 || 'Po'@
            |? _dt=2 || 'Wt'@
            |? _dt=3 || 'Śr'@
            |? _dt=4 || 'Cz'@
            |? _dt=5 || 'Pt'@
            |? _dt=6 || 'So'@
            || 'Nd'@
            ?}";

         group:="
            {? _a=3  || ',4'
            |? _a=5  || ',6,7,8'
            |? _a=9  || ',10,11,12,13,14'
            |? _a=15 || ',16,17,18'
            |? _a=19 || ',20'
            |? _a=21 || ',22,23,24,25,26,27,28,29,30,31,32'
            |? _a=33 || ',34,35,36,37,38,39,40,41,42'
            || ''
            ?}";

         mark:="
            {? ((',3,5,9,15,19,21,33,')*(','+$_a+','))>0 || 1 || 0 ?}";

         control:="
            _pos:=spli_str($Cnt+group(Cnt),',');
            '{! _days:=1..date(var[8].ROK,var[8].MC,0)~3 |!';
            '   {! _ind:=1 .. obj_len(_pos) |!';
            '      {? val[#_pos[_ind]][_days]<>form('',5)';
            '      || return(0)';
            '      ?}';
            '   !}';
            '!};';
            {! _ind:=1 .. obj_len(_pos) |!
               {? total[#_pos[_ind]]<>form('',6)
               || return(0)
               ?}
            !};
            return(1)";

         _days:=date(var[8].ROK,var[8].MC,0)~3;
         _cols:={? rep_export() || _days+4 || _days+2 ?};
         _wDni:=5;
         _wOG:=7;

         {? var_pres('PRH')>0 || obj_del(PRH) ?};
         PRH:=obj_new(@.CLASS.PRINT,_cols);
         {? rep_export()
         || PRH.add("''",12,'Numer teczki'@);
            PRH.add("''",40,'Współpracownik'@);
            PRH.add("''",40,'Jednostka organizacyjna'@)
         ?};
         PRH.add("",40,_a:=~-(date(var[8].ROK,var[8].MC,0)$8); form(_a,-((38/2)+(floor((+_a)/2))),1));
         {! _i:=1.._days |! PRH.add("''",5,form($_i,-4)) !};
         {? ~rep_export()
         || PRH.add("''",7,form('Razem'@,-6))
         ?};
         PRH.sl_frame();

         {? var_pres('PRG')>0 || obj_del(PRG) ?};
         PRG:=obj_new(@.CLASS.PRINT,_cols);
         {? rep_export()
         || PRG.add("'%1'[P.T]",12,'');
            PRG.add("'%1 %2'[P.OSOBA().NAZWISKO,OSOBA.PIERWSZE]",40,'');
            PRG.add("P.WYDZIAL().SYMBOL+' '+|UD_SKL.OPIS",40,'')
         ?};
         PRG.add("names[Cnt]",40,'');
         {! _i:=1.._days |! PRG.add(($('val[Cnt]['+$_i+']')),_wDni,'') !};
         {? ~rep_export()
         || PRG.add("total[Cnt]",_wOG,'',1,,,,,',2,\'9.\'')
         ?};
         PRG.sl_frame();

         {? var_pres('PRN')>0 || obj_del(PRN) ?};
         PRN:=obj_new(@.CLASS.PRINT,_cols);
         {? rep_export()
         || PRN.add("'%1'[P.T]",12,'');
            PRN.add("'%1 %2'[P.OSOBA().NAZWISKO,OSOBA.PIERWSZE]",40,'');
            PRN.add("P.WYDZIAL().SYMBOL+' '+|UD_SKL.OPIS",40,'')
         ?};
         PRN.add("{?~mark(Cnt)||{? ~rep_export()||'    '||'- '?}||''?}+names[Cnt]",40,'');
         {! _i:=1.._days |!
            _fml_col:='
               _type:=\',\'+(2+|val[2]['+$_i+'])+\',\';
               _color:=color;
               _result:=\'\';
               {? _color<>\'\'
               || {? \',nd,\'*(-_type) || _result:=\',\'+_color ?}
               ?};
               _result
               ';
            PRN.add(($('val[Cnt]['+$_i+']')),_wDni,form(dayOfWeek(var[8].ROK,var[8].MC,_i),-4),,,$_fml_col)
         !};
         {? ~rep_export()
         || PRN.add("total[Cnt]",_wOG,'',1,,,,,',2,\'9.\'')
         ?};
         PRN.sl_frame();

         prn1:='PRN';
         prn2:='PRH';

         lp:=Cnt:=lmt:=rsep:=0;
         vp:=1

      ?}
   ?}
}
{END:
   VAR_DEL.delete('tresc','lmt','Cnt');
   VAR_DEL.delete('dz','var','val','total','display','names','PRH','PRG','PRN');
   VAR_DEL.delete('mark','control','group','dayOfWeek');
   VAR_DEL.delete('empty','lp','prn1','prn2','vp','rsep','size');
   G.cntx_pop();
   R_WYK.cntx_pop();
   R_WZCZ.cntx_pop();
   N.cntx_pop();
   H.cntx_pop();
   P.cntx_pop()
}
{EXIT: +var[1]}
{EXIT: ~var[7]}
{INCLUDE: wsp_pw.rpi}
{COMMENT}
═══════════════════════════════════════════════════════════════════════════
   K O N F I G U R A C J A   -   N A G Ł Ó W E K,   S T O P K A
═══════════════════════════════════════════════════════════════════════════
{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT:'T10B'}{SPACE: 'B'}
{CENTER}{<1>{charleft()}'E W I D E N C J A   M I E S I Ę C Z N A   C Z A S U   P R A C Y'}
{FONT:'T8G'}{SPACE: 'C'}
{lmt:=0;~~}
{FONT:'T10B'}{SPACE: 'B'}
{lmtt10b:=charleft();~~}
{FONT:'TW8B'}{SPACE: 'C'}
{<1>{charleft()}(137)*'─'}

   {IF: ~rep_export()}
      {FONT:'T10B'}{SPACE: 'B'}{<1>{lmtt10b} P.OSOBA().NAZWISKO+' '+OSOBA.PIERWSZE+
                                             '   (Nr teczki '+|P.T+'),   Jednostka org. '+P.WYDZIAL().SYMBOL}
   {ELSE}
      {FONT:'T8G'}{SPACE: 'C'}{<{lmt}'Parametry sprawozdania'@}
      {FONT:'T8G'}{SPACE: 'C'}{<{lmt}'%1 %2'['Za okres:',date(var[8].ROK,var[8].MC,0)$8]}
      {LINE}
   {FI}
{FONT: 'T8GB'}
{SPACE: 'D'}
{rsep:=0; ~~}
{SUBSTITUTE: 'TABHEAD2'}
{rsep:=1; ~~}
{HEADER-}
{FOOTER: 0}
{FONT: 'T8G'}
{SUBSTITUTE: rsep:=0; vp:=0; prn1:='PRN'; 'LINIAF'}

    Legenda :
             R - roboczy, RN - roboczy w niedzielę, RS - roboczy w święto, WH - harmonogramowo wolny, W5 - wolny z tytułu pięciodniowego tyg. pracy, WN - wolny za niedzielę,
             WS - wolny za święto, SN - święto niedzielne, SW - święto w inny dzień niż niedziela, [W - wolny - dane historyczne], [S - święto - dane historyczne])
{FOOTER-}
{IF: ~rep_export()}
   {SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}
═══════════════════════════════════════════════════════════════════════════
   M A K R O D E F I N I C J E
═══════════════════════════════════════════════════════════════════════════
{COMMENT-}
{MACRO: 'TABHEAD2'}
{ _f:=prn2+'.setcolor(color)'; ($(_f))(); ~~}
{ _f:=prn2+'.ini_head()'; ($(_f))()}
{REP: _f:=prn2+'.fhbar(lmt)'; ($(_f))()}
{WHILE: _f:=prn2+'.h_next()'; ($(_f))()}
{DO}
{REP: _f:=prn2+'.h_fline(lmt)'; ($(_f))()}
{OD}
{ _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
{ _f:=prn1+'.ini_head()'; ($(_f))()}
{WHILE: _f:=prn1+'.h_next()'; ($(_f))()}
{DO}
{REP: _f:=prn1+'.h_fline(lmt)'; ($(_f))()}
{OD}
{MACRO-}
{MACRO: 'LINEX'}
{  ll:=lineleft(); ~~}
{IF:  params_set(params_get());
      _f:='params_set(params_get()); '+prn1+'.ini_line()'; _v:=($(_f))();
      _f:=prn1+'.length()'; _v:=($(_f))();
      ll<(rsep+_v) & ll<>0}{PAGE}{FI}
{ENTIRE}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}{ vp:=0; ~~}
{ELSE}
   {IF: PAR_WYDR.RSEP & rsep}
      {REP: _f:=prn1+'.fcbar(lmt)'; ($(_f))()}
   {ELIF: rsep}
      {REP: _f:=prn1+'.fcbar(lmt)'; ($(_f))()}
   {FI}
{FI}
{WHILE: _f:=prn1+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.fline(lmt)'; ($(_f))()}
{OD}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{ENTIRE-}
{MACRO-}
{MACRO: tresc}
{exec('oblicz_godz','wkartp','msc'); ~~}
{IF: P.DZA>date(var[8].ROK,var[8].MC,0) | (P.DZ<>#0 & P.DZ<date(var[8].ROK,var[8].MC,1))}
{ELSE}
   {FONT: 'T8GB'}
   {SPACE: 'D'}
   {WHILE: dz[var[7]+=1][1] & var[7]<=var[4]~3}
   {DO}
      { val[1][var[7]]:=form(dz[var[7]][1],5);
        val[2][var[7]]:=form(dz[var[7]][2],5);

        val[3][var[7]]:=form(_a:=dz[var[7]][27];{?_a<>0||_a||''?},5,2);
        val[4][var[7]]:=form(dz[var[7]][3],-3);

        {? dz[var[7]][5]<>0 & dz[var[7]][5]<100
        || val[5][var[7]]:=form({?dz[var[7]][4]||{?(',nd,po,'*-dz[var[7]][2])||'  1'||'   1'?}||' '?},5);
           val[6][var[7]]:=form(_a:={?var[8].BOX||dz[var[7]][41]||0?};{?type_of(_a)=5||_a||''?},5);
           val[7][var[7]]:=form(_a:={?var[8].BOX||dz[var[7]][42]||0?};{?type_of(_a)=5||_a||''?},5);
           val[8][var[7]]:=form(_a:={?var[8].BOX||dz[var[7]][43]||0?};{?type_of(_a)=4&_a<>date(0,0,0)||5+(_a$3)||''?},5)
        || val[5][var[7]]:=form('',5);
           val[6][var[7]]:=form('',5);
           val[7][var[7]]:=form('',5);
           val[8][var[7]]:=form('',5)
        ?};

        val[9][var[7]]:=form(_a:=dz[var[7]][5]; {?_a<>0&_a<100||_a||''?},5,2);
        val[10][var[7]]:=form(_a:=dz[var[7]][6];{?_a<>0&_a<100||_a||''?},5,2);
        val[11][var[7]]:=form(_a:=dz[var[7]][7];{?_a<>0&_a<100||_a||''?},5,2);
        val[12][var[7]]:=form(_a:=dz[var[7]][9];{?_a<>0&_a<100||_a||''?},5,2);
        val[13][var[7]]:=form('',5);
        val[14][var[7]]:=form('',5);

        val[15][var[7]]:=form('',5);
        val[16][var[7]]:=form('',5);
        val[17][var[7]]:=form('',5);
        val[18][var[7]]:=form('',5);

        val[19][var[7]]:=form('',5);
        val[20][var[7]]:=form('',5);

        val[21][var[7]]:=form(_a:=dz[var[7]][40]; {? type_of(_a)=1 & _a<>0 || _a ||''?},5,2);
        val[22][var[7]]:=form(_a:=dz[var[7]][10]; {? type_of(_a)=1 & _a<>0 || _a ||''?},5,2);
        val[23][var[7]]:=form(_a:=dz[var[7]][11]; {? type_of(_a)=1 & _a<>0 || _a ||''?},5,2);
        val[24][var[7]]:=form(_a:=dz[var[7]][12]; {? type_of(_a)=1 & _a<>0 || _a ||''?},5,2);
        val[25][var[7]]:=form(_a:=dz[var[7]][13]; {? type_of(_a)=1 & _a<>0 || _a ||''?},5,2);
        val[26][var[7]]:=form(_a:=dz[var[7]][14]; {? type_of(_a)=1 & _a<>0 || _a ||''?},5,2);
        val[27][var[7]]:=form(_a:=dz[var[7]][15]; {? type_of(_a)=1 & _a<>0 || _a ||''?},5,2);
        val[28][var[7]]:=form(_a:=dz[var[7]][16]; {? type_of(_a)=1 & _a<>0 || _a ||''?},5,2);
        val[29][var[7]]:=form(_a:=dz[var[7]][17]; {? type_of(_a)=1 & _a<>0 || _a ||''?},5,2);
        val[30][var[7]]:=form(_a:=dz[var[7]][18]; {? type_of(_a)=1 & _a<>0 || _a ||''?},5,2);
        val[31][var[7]]:=form(_a:=dz[var[7]][19]; {? type_of(_a)=1 & _a<>0 || _a ||''?},5,2);
        val[32][var[7]]:=form(_a:=dz[var[7]][30]; {? type_of(_a)=1 & _a<>0 || _a ||''?},5,2);

        val[33][var[7]]:=form('',5);
        val[34][var[7]]:=form(_a:=dz[var[7]][8]; {?_a<>0&_a<100||_a||''?},5,2);
        val[35][var[7]]:=form(_a:=dz[var[7]][20];{?_a<>0&_a<100||_a||''?},5,2);
        val[36][var[7]]:=form(_a:=dz[var[7]][21];{?_a<>0&_a<100||_a||''?},5,2);
        val[37][var[7]]:=form('',5);
        val[38][var[7]]:=form(_a:=dz[var[7]][22];{?_a<>0&_a<100||_a||''?},5,2);
        val[39][var[7]]:=form('',5);
        val[40][var[7]]:=form('',5);
        val[41][var[7]]:=form(_a:=dz[var[7]][23];{?_a<>0&_a<100||_a||''?},5,2);
        val[42][var[7]]:=form(_a:=dz[var[7]][39];{?_a<>0&_a<100||_a||''?},5,2);
        ~~
      }
   {OD}
   { total[1]:=form('',6);
     total[2]:=form('',6);

     total[3]:=form(_a:=dz[obj_len(dz)][27];{?_a<>0||_a||''?},6,2);
     total[4]:=form('',6);

     total[5]:=form(_a:=dz[obj_len(dz)][4];{?_a<>0||_a||''?},6);
     total[6]:=form('',6);
     total[7]:=form('',6);
     total[8]:=form('',6);

     total[9]:=form(_a:=dz[obj_len(dz)][5];{?_a<>0||_a||''?},6,2);
     total[10]:=form(_a:=dz[obj_len(dz)][6]; {?_a<>0||_a||''?},6,2);
     total[11]:=form(_a:=dz[obj_len(dz)][7]; {?_a<>0||_a||''?},6,2);
     total[12]:=form(_a:=dz[obj_len(dz)][9]; {?_a<>0||_a||''?},6,2);
     total[13]:=form('',6);
     total[14]:=form('',6);

     total[15]:=form('',6);
     total[16]:=form('',6);
     total[17]:=form('',6);
     total[18]:=form('',6);

     total[19]:=form('',6);
     total[20]:=form('',6);

     total[21]:=form(_a:=dz[obj_len(dz)][40]; {? type_of(_a)=1 & _a<>0 || _a || '' ?},6,2);
     total[22]:=form(_a:=dz[obj_len(dz)][10]; {? type_of(_a)=1 & _a<>0 || _a || '' ?},6,2);
     total[23]:=form(_a:=dz[obj_len(dz)][11]; {? type_of(_a)=1 & _a<>0 || _a || '' ?},6,2);
     total[24]:=form(_a:=dz[obj_len(dz)][12]; {? type_of(_a)=1 & _a<>0 || _a || '' ?},6,2);
     total[25]:=form(_a:=dz[obj_len(dz)][13]; {? type_of(_a)=1 & _a<>0 || _a || '' ?},6,2);
     total[26]:=form(_a:=dz[obj_len(dz)][14]; {? type_of(_a)=1 & _a<>0 || _a || '' ?},6,2);
     total[27]:=form(_a:=dz[obj_len(dz)][15]; {? type_of(_a)=1 & _a<>0 || _a || '' ?},6,2);
     total[28]:=form(_a:=dz[obj_len(dz)][16]; {? type_of(_a)=1 & _a<>0 || _a || '' ?},6,2);
     total[29]:=form(_a:=dz[obj_len(dz)][17]; {? type_of(_a)=1 & _a<>0 || _a || '' ?},6,2);
     total[30]:=form(_a:=dz[obj_len(dz)][18]; {? type_of(_a)=1 & _a<>0 || _a || '' ?},6,2);
     total[31]:=form(_a:=dz[obj_len(dz)][19]; {? type_of(_a)=1 & _a<>0 || _a || '' ?},6,2);
     total[32]:=form(_a:=dz[obj_len(dz)][30]; {? type_of(_a)=1 & _a<>0 || _a || '' ?},6,2);

     total[33]:=form('',6);
     total[34]:=form(_a:=dz[obj_len(dz)][8]; {?_a<>0||_a||''?},6,2);
     total[35]:=form(_a:=dz[obj_len(dz)][20];{?_a<>0||_a||''?},6,2);
     total[36]:=form(_a:=dz[obj_len(dz)][21];{?_a<>0||_a||''?},6,2);
     total[37]:=form('',6);
     total[38]:=form(_a:=dz[obj_len(dz)][22];{?_a<>0||_a||''?},6,2);
     total[39]:=form('',6);
     total[40]:=form('',6);
     total[41]:=form(_a:=dz[obj_len(dz)][23];{?_a<>0||_a||''?},6,2);
     total[42]:=form(_a:=dz[obj_len(dz)][39];{?_a<>0||_a||''?},6,2);
     Cnt:=2; ~~
   }
   {WHILE: (Cnt+=1)<=size}
   {DO}
      { empty:={? display[Cnt]=0 || control() || 1 ?}; ~~}
      {IF: (display[Cnt]=1 | empty=0)}
         { _f:=prn1+'.setcolor(''255:255:254'')'; ($(_f))(); ~~ }
         {IF: group(Cnt)<>''}
            {FONT: 'T8GB'}
            { lp:=0; rsep:=1; ~~}
            {SUBSTITUTE: 'LINEX'}
         {ELIF: mark(Cnt)}
            {FONT: 'T8GB'}
            { rsep:=0; ~~}
            {SUBSTITUTE: 'LINEX'}
         {ELSE}
            {FONT: 'T8G'}
            { lp+=1; rsep:=0; ~~}
            {IF: lp%*2<>0}
               { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~ }
            {FI}
            {SUBSTITUTE: 'LINEX'}
         {FI}
         { _f:=prn1+'.setcolor(''255:255:254'')'; ($(_f))(); ~~ }
      {FI}
   {OD}
   {PAGE}
{FI}
{MACRO-}
{COMMENT}
═══════════════════════════════════════════════════════════════════════════
   Z A W A R T O Ś Ć   W Y D R U K U
═══════════════════════════════════════════════════════════════════════════
{COMMENT-}
{FOR: params_get().P}{DO}
   {IF: P.seek(params_get().P.SQL,,1)}
      {SUBSTITUTE: tresc}
   {FI}
{OD}