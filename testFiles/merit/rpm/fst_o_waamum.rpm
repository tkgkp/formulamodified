:!UTF-8
{TITLE:F. Wartości, amortyzacja i umorzenie środków}
{PRINTER: FINFO.SZ_PRN,,,,,'M','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
   PRN:=obj_new(@.CLASS.PRINT,16+{? rep_export() || 24 ?}); PRN.sl_frame();
   PRNF:=obj_new(@.CLASS.PRINT,16+{? rep_export() || 24 ?}); PRNF.sl_frame();
   c:=obj_new(16+{? rep_export() || 24 ?});
   d:=obj_new(16+{? rep_export() || 24 ?});
   {! _i:=1..16+{? rep_export() || 24 ?} |! c[_i]:='' !};
   {! _i:=1..16+{? rep_export() || 24 ?} |! d[_i]:='' !};
   VAR_DEL.delete('TAB_SQL','TAB_SROD','TMP_SROD','TAB_ZMIA');
   SRSR.cntx_psh(); SRST.cntx_psh();
   exec('init','fst');
   SRD.maski('r');
   exec('odd_filtr','fst');
   i:=0;
   {? FINFO.TOR_D<>'T'
   || PAR_WYDR.efld_opt('WARTAMO','enable=0',,'MAD')
   || PAR_WYDR.efld_opt('WARTAMO','enable=1',,'MAD')
   ?};
   color:=prn1:=prn2:='';
   lm:=ll:=vp:=lmt:=rsep:=0;
   par1:=0; par2:=0; par3:=0; par4:=0; par5:=0; par6:=0;
   g_warp:=0; g_umop:=0; g_netp:=0;
   g_warf:=0; g_umof:=0; g_netf:=0;
   g_ward:=0; g_umod:=0; g_netd:=0;
   g_amp:=0; g_amf:=0; g_amd:=0; g_ampa:=0; g_amfa:=0;g_amda:=0;
   g_ulga:=0; g_podamp:=0; g_podamf:=0;g_podamd:=0; klasyfikacja:='';
   sg_warp:=0; sg_umop:=0; sg_netp:=0; sg_warf:=0; sg_umof:=0; sg_netf:=0; sg_ward:=0; sg_umod:=0; sg_netd:=0;
   sg_amp:=0; sg_ampa:=0; sg_amf:=0; sg_amfa:=0;sg_amd:=0; sg_amda:=0; sg_ulga:=0; sgpodamp:=0; sgpodamf:=0; sgpodamd:=0;
   typsrodka:='';
   sum_warp:=0; sum_umop:=0; sum_netp:=0;
   sum_warf:=0; sum_umof:=0; sum_netf:=0;
   sum_ward:=0; sum_umod:=0; sum_netd:=0;
   sum_amp:=0; sum_amf:=0; sum_amd:=0; sum_ampa:=0;sum_amfa:=0;sum_amda:=0;
   sum_ulga:=0; sum_pamp:=0; sum_pamf:=0;sum_pamd:=0;
   sum_grupa:=''; test_grupa:='';
   ssum_grupa:=''; stest_grupa:='';
   PAR_WYDR.fld_fml('PR_GR','BEFORE_EDIT',"PAR_WYDR.RODZAJ=2 & PAR_WYDR.PODSUM=1");
   PAR_WYDR.fld_fml('RODZAJ','AFTER_EDIT',"{? PAR_WYDR.RODZAJ=1 | PAR_WYDR.PODSUM<>1 || PAR_WYDR.PR_GR:=0 ?};1 "); PAR_WYDR.PR_GR:=0
}
{END:
   obj_del(PRN);
   obj_del(PRNF);
   obj_del(c);
   obj_del(d);
   SRSR.cntx_pop(); SRST.cntx_pop();
   &i; &color; &prn1; &prn2;
   &lm; &ll; &vp; &lmt; &rsep;
   &par1; &par2; &par3;&par4;&par5;&par6;
   &g_warp; &g_umop; &g_netp;
   &g_warf; &g_umof; &g_netf;
   &g_ward; &g_umod; &g_netd;
   &g_amp; &g_amf; &g_amd; &g_ampa; &g_amfa; &g_amda;
   &g_ulga; &g_podamp; &g_podamf; &g_podamd; &klasyfikacja;
   &sg_warp; &sg_umop; &sg_netp; &sg_warf; &sg_umof; &sg_netf; &sg_ward; &sg_umod; &sg_netd;
   &sg_amp; &sg_ampa; &sg_amf; &sg_amfa; &sg_amd; &sg_amda; &sg_ulga; &sgpodamp; &sgpodamf; &sgpodamd;
   &typsrodka;
   &sum_warp; &sum_umop; &sum_netp;
   &sum_warf; &sum_umof; &sum_netf;
   &sum_ward; &sum_umod; &sum_netd;
   &sum_amp; &sum_amf; &sum_amd; &sum_ampa; &sum_amfa; &sum_amda;
   &sum_ulga; &sum_pamp; &sum_pamf; &sum_pamd;
   &sum_grupa; &test_grupa;
   &ssum_grupa; &stest_grupa;
   TSK.hdr_sel();
   VAR_DEL.delete('TAB_SQL','TAB_SROD','TMP_SROD','TAB_ZMIA');
   PAR_WYDR.fld_fml('PR_GR','BEFORE_EDIT',"*"); PAR_WYDR.fld_fml('RODZAJ','AFTER_EDIT',"*")
}
{EXIT:
   exec('clear_par','fst');
   exec('set_parw','param_wydr');
   {? OPERATOR.DEPT<>null
   || PAR_WYDR.ODD:=OPERATOR.DEPT
   || PAR_WYDR.ODD:=0
   ?};
   {? SSTALE.AO().KON<>date(0,0,0)
   || PAR_WYDR.STAN_NA:=SSTALE.AO().KON
   |? SSTALE.AO().OES=0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().POCZ_ROK
   |? SSTALE.AO().OES>0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().KON_ROK
   ?};
   PAR_WYDR.RODZAJ:=1;
   PAR_WYDR.RODZAJ2:=1;
   PAR_WYDR.ZMIANY:='T';
   exec('win_par_waamum','fst_ext');
   PAR_WYDR.hdr_edit(': F. Wartości, amortyzacja i umorzenie środków'@);
   PAR_WYDR.WART_PN:=2;
   SRD.PAR_WYDR:='T';
   PAR_WYDR.JORG:=null; EDIT_ES.JORG:='';
   exec('odd_filtr','fst');
   exec('set_gr_list','fst');
   _win:=TSK.mk_sel('Wybór klasyfikacji/typu'@,,0,'_tsk_wyb',20,8,12);
   TSK.win_fld(_win,TSK,'NAZ',,,20);
   TSK.win_fld(_win,TSK,'OPIS',,,25);
   TSK.win_dict(_win);
   TSK.prefix(null);
   {? PAR_WYDR.edit("exec('check_wartamo','fst')")
   || _exit:=0;
     {? PAR_WYDR.PODSUM=3
     || TSK.cntx_psh();
        TSK.prefix();
        {? TSK.seek(PAR_WYDR.K_TSK)
        || klasyfikacja:=TSK.NAZ;
           {? PAR_WYDR.T_TSK<>null & TSK.seek(PAR_WYDR.T_TSK)
           || typsrodka:=TSK.NAZ
           ?}
        || FUN.emsg('Nieprawidłowa klasyfikacja dodatkowa.'@);
           _exit:=1
        ?};
        TSK.cntx_pop()
     ?}
   || _exit:=1 ?};
   {? ~_exit
   || __ASKJRG:={? PAR_WYDR.ASKJRG='X' || 0
                |? PAR_WYDR.ASKJRG='N' || 0
                |? PAR_WYDR.ASKJRG='T' || 1
                ?};
      {? PAR_WYDR.ASKJRG='X'
      || PAR_WYDR.ZMIANY:='T'
      || PAR_WYDR.ZMIANY:='N'
      ?};
      {?  PAR_WYDR.RODZAJ=1
      || _wy:=exec('sql_sr','fst2',1)
      |?  PAR_WYDR.RODZAJ=2
      || _wy:=exec('sql_sr','fst2',2)
      ?};
      {? _wy || _exit:=0 || _exit:=1 ?}
   ?};
   _exit
}
{COMMENT}
==================================================
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
Nazwa pliku: fst_o_waamum.rpm
Utworzony  : 2004-09-10
Zawartość  : Wartości, amortyzacja i umorzenie
==================================================
--------------------------- OPIS PÓL ZMIENNEJ PAR_WYDR ------------{COMMENT-}
{COMMENT}
Dane pobierane są w sekcji Exit z wykorzystaniem formuł z pliku query.fml
RODZAJ : 1=analityczne, 2=syntetyczne,
RODZAJ2: 1=środki wszystkie, 2=jednorazowo umorzone, 3=całkowicie umorzone, 4=skreślone, 5=nowe
MAP    : kod metody podatkowej
MAF    : kod metody bilansowej
MAD    : kod metody dodatkowej
FROM_DE: data eksploatacji od
TO_DE  : data eksploatacji do
ODD    : jedn. ks.
GRUPA  : grupa środków trwałych np. 100, 1**
SKR_ONLY: tylko skreslone
UMO_ONLY: tylko umorzone
PODSUM : podsumowanie wedlug grup, jedn. ksieg., typow srodkow
{COMMENT-}
{COMMENT}zmienne pomocnicze do wydrukow graficznych:
i - licznik, color, prn1, lm, ll, vp, lmt, rsep
{COMMENT-}
{PAR_WYDR.cntx_psh(); ~~}
{INCLUDE: wsp_pw.rpi}
{PAR_WYDR.cntx_pop(); ~~}
{COMMENT}--Definicja wiersza wydruku--------------------{COMMENT-}
{  prn1:='PRN'; prn2:='PRN'; ~~}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
   {? FINFO.TOR_D='T'
   || {? PAR_WYDR.RODZAJ=1
      || PRN.add("c[1]",22,'Nr inwent.  -  Grupa#Nazwa środka'@,,'#');
         PRN.add("c[2]",16,'Symbol dok.#przyjęcia'@,,'#');
         PRN.add("c[4]",16,'Jed. księg.# Jedn. organ.'@,,'#');
         PRN.add("c[5]",15,'R. przych.#Data eksp.'@,,'#');
         PRN.add("c[6]",15,'R. rozch.#Data skrl.'@,,'#');
         PRN.add("c[7]",20,'Zestaw kont      # POD/BIL/DOD'@,,'#');
         PRN.add("c[8]",12,'MET/STAW# POD/BIL/DOD'@,,'#');
         PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",14,'Wart. inwent.#POD/BIL/DOD'@,1,'#');
         PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",14,'Umorzenie # POD/BIL/DOD'@,1,'#');
         PRN.add("{? type_of(c[12])=1 || form(c[12],,2,' ,') || c[12] ?}",14,'Netto     # POD/BIL/DOD'@,1,'#');
         PRN.add("{? type_of(c[16])=1 || form(c[16],,2,' ,') || c[16] ?}",14,'Podst. amort.# POD/BIL/DOD'@,1,'#');
         PRN.add("{? type_of(c[13])=1 || form(c[13],,2,' ,') || c[13] ?}",11,'Am.za mies.#POD/BIL/DOD'@,1,'#');
         PRN.add("{? type_of(c[14])=1 || form(c[14],,2,' ,') || c[14] ?}",14,'Amort. narast.#POD/BIL/DOD'@,1,'#');
         PRN.add("{? type_of(c[15])=1 || form(c[15],,2,' ,') || c[15] ?}",12,'Ulga inwest.#narastająco'@,1,'#');

         PRNF.add("d[1]", 122, 'Środki'@);
         PRNF.add("{? type_of(d[10])=1 || form(d[10],,2,' ,') || d[10] ?}",14,'Wart. inwent.# POD/BIL/DOD'@,1,'#');
         PRNF.add("{? type_of(d[11])=1 || form(d[11],,2,' ,') || d[11] ?}",14,'Umorzenie # POD/BIL/DOD'@,1,'#');
         PRNF.add("{? type_of(d[12])=1 || form(d[12],,2,' ,') || d[12] ?}",14,'Netto     # POD/BIL/DOD'@,1,'#');
         PRNF.add("{? type_of(d[16])=1 || form(d[16],,2,' ,') || d[16] ?}",14,'Podst. amort.# POD/BIL/DOD'@,1,'#');
         PRNF.add("{? type_of(d[13])=1 || form(d[13],,2,' ,') || d[13] ?}",11,'Am.za mies.# POD/BIL/DOD'@,1,'#');
         PRNF.add("{? type_of(d[14])=1 || form(d[14],,2,' ,') || d[14] ?}",14,'Amort narast.# POD/BIL/DOD'@,1,'#');
         PRNF.add("{? type_of(d[15])=1 || form(d[15],,2,' ,') || d[15] ?}",12,'Ulga inwest.# narastająco'@,1,'#')
      |? PAR_WYDR.RODZAJ=2
      || PRN.add("c[1]", 35, 35+klasyfikacja);
         PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",21,'Wartość inwentarzowa # POD/BIL/DOD'@,1,'#');
         PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",21,'Wartość umorzenia # POD/BIL/DOD'@,1,'#');
         PRN.add("{? type_of(c[12])=1 || form(c[12],,2,' ,') || c[12] ?}",21,'Wartość netto # POD/BIL/DOD'@,1,'#');
         PRN.add("{? type_of(c[16])=1 || form(c[16],,2,' ,') || c[16] ?}",21,'Podstawa amort.# POD/BIL/DOD'@,1,'#');
         PRN.add("{? type_of(c[13])=1 || form(c[13],,2,' ,') || c[13] ?}",21,'Amort. za miesiąc # POD/BIL/DOD'@,1,'#');
         PRN.add("{? type_of(c[14])=1 || form(c[14],,2,' ,') || c[14] ?}",21,'Amort. narastająco # POD/BIL/DOD'@,1,'#');
         PRN.add("{? type_of(c[15])=1 || form(c[15],,2,' ,') || c[15] ?}",21,'Ulga inwestycyjna # narastająco'@,1,'#');

         PRNF.add("d[1]", 35, '');
         PRNF.add("{? type_of(d[10])=1 || form(d[10],,2,' ,') || d[10] ?}",21,'Wartość inwentarzowa # POD/BIL/DOD'@,1,'#');
         PRNF.add("{? type_of(d[11])=1 || form(d[11],,2,' ,') || d[11] ?}",21,'Wartość umorzenia # POD/BIL/DOD'@,1,'#');
         PRNF.add("{? type_of(d[12])=1 || form(d[12],,2,' ,') || d[12] ?}",21,'Wartość netto # POD/BIL/DOD'@,1,'#');
         PRNF.add("{? type_of(d[16])=1 || form(d[16],,2,' ,') || d[16] ?}",21,'Podstawa amort.# POD/BIL/DOD'@,1,'#');
         PRNF.add("{? type_of(d[13])=1 || form(d[13],,2,' ,') || d[13] ?}",21,'Amort. za miesiąc # POD/BIL/DOD'@,1,'#');
         PRNF.add("{? type_of(d[14])=1 || form(d[14],,2,' ,') || d[14] ?}",21,'Amort. narastająco # POD/BIL/DOD'@,1,'#');
         PRNF.add("{? type_of(d[15])=1 || form(d[15],,2,' ,') || d[15] ?}",21,'Ulga inwestycyjna # narastająco'@,1,'#')
      ?}
   || {? PAR_WYDR.RODZAJ=1
      || PRN.add("c[1]",22,'Nr inwent.  -  Grupa#Nazwa środka'@,,'#');
         PRN.add("c[2]",16,'Symbol dok.#przyjęcia'@,,'#');
         PRN.add("c[4]",16,'Jed. księg.# Jedn. organ.'@,,'#');
         PRN.add("c[5]",15,'R. przych.#Data eksp.'@,,'#');
         PRN.add("c[6]",15,'R. rozch.#Data skrl.'@,,'#');
         PRN.add("c[7]",20,'Zestaw kont      # POD/BIL'@,,'#');
         PRN.add("c[8]",10,'MET/STAW# POD/BIL'@,,'#');
         PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",14,'Wart. inwent.#POD/BIL'@,1,'#');
         PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",14,'Umorzenie # POD/BIL'@,1,'#');
         PRN.add("{? type_of(c[12])=1 || form(c[12],,2,' ,') || c[12] ?}",14,'Netto     # POD/BIL'@,1,'#');
         PRN.add("{? type_of(c[16])=1 || form(c[16],,2,' ,') || c[16] ?}",14,'Podst. amort.# POD/BIL'@,1,'#');
         PRN.add("{? type_of(c[13])=1 || form(c[13],,2,' ,') || c[13] ?}",11,'Am.za mies.#POD/BIL'@,1,'#');
         PRN.add("{? type_of(c[14])=1 || form(c[14],,2,' ,') || c[14] ?}",14,'Amort. narast.#POD/BIL'@,1,'#');
         PRN.add("{? type_of(c[15])=1 || form(c[15],,2,' ,') || c[15] ?}",12,'Ulga inwest.#narastająco'@,1,'#');

         PRNF.add("d[1]", 120, 'Środki'@);
         PRNF.add("{? type_of(d[10])=1 || form(d[10],,2,' ,') || d[10] ?}",14,'Wart. inwent.# POD/BIL'@,1,'#');
         PRNF.add("{? type_of(d[11])=1 || form(d[11],,2,' ,') || d[11] ?}",14,'Umorzenie # POD/BIL'@,1,'#');
         PRNF.add("{? type_of(d[12])=1 || form(d[12],,2,' ,') || d[12] ?}",14,'Netto     # POD/BIL'@,1,'#');
         PRNF.add("{? type_of(d[16])=1 || form(d[16],,2,' ,') || d[16] ?}",14,'Podst. amort.# POD/BIL'@,1,'#');
         PRNF.add("{? type_of(d[13])=1 || form(d[13],,2,' ,') || d[13] ?}",11,'Am.za mies.# POD/BIL'@,1,'#');
         PRNF.add("{? type_of(d[14])=1 || form(d[14],,2,' ,') || d[14] ?}",14,'Amort narast.# POD/BIL'@,1,'#');
         PRNF.add("{? type_of(d[15])=1 || form(d[15],,2,' ,') || d[15] ?}",12,'Ulga inwest.# narastająco'@,1,'#')
      |? PAR_WYDR.RODZAJ=2
      || PRN.add("c[1]", 35, 35+klasyfikacja);
         PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",21,'Wartość inwentarzowa # Podatkowo/Bilansowo'@,1,'#');
         PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",21,'Wartość umorzenia # Podatkowo/Bilansowo'@,1,'#');
         PRN.add("{? type_of(c[12])=1 || form(c[12],,2,' ,') || c[12] ?}",21,'Wartość netto # Podatkowo/Bilansowo'@,1,'#');
         PRN.add("{? type_of(c[16])=1 || form(c[16],,2,' ,') || c[16] ?}",21,'Podstawa amort.# Podatkowo/Bilansowo'@,1,'#');
         PRN.add("{? type_of(c[13])=1 || form(c[13],,2,' ,') || c[13] ?}",21,'Amort. za miesiąc # Podatkowo/Bilansowo'@,1,'#');
         PRN.add("{? type_of(c[14])=1 || form(c[14],,2,' ,') || c[14] ?}",21,'Amort. narastająco # Podatkowo/Bilansowo'@,1,'#');
         PRN.add("{? type_of(c[15])=1 || form(c[15],,2,' ,') || c[15] ?}",21,'Ulga inwestycyjna # narastająco'@,1,'#');

         PRNF.add("d[1]", 35, '');
         PRNF.add("{? type_of(d[10])=1 || form(d[10],,2,' ,') || d[10] ?}",21,'Wartość inwentarzowa # Podatkowo/Bilansowo'@,1,'#');
         PRNF.add("{? type_of(d[11])=1 || form(d[11],,2,' ,') || d[11] ?}",21,'Wartość umorzenia # Podatkowo/Bilansowo'@,1,'#');
         PRNF.add("{? type_of(d[12])=1 || form(d[12],,2,' ,') || d[12] ?}",21,'Wartość netto # Podatkowo/Bilansowo'@,1,'#');
         PRNF.add("{? type_of(d[16])=1 || form(d[16],,2,' ,') || d[16] ?}",21,'Podstawa amort.# Podatkowo/Bilansowo'@,1,'#');
         PRNF.add("{? type_of(d[13])=1 || form(d[13],,2,' ,') || d[13] ?}",21,'Amort. za miesiąc # Podatkowo/Bilansowo'@,1,'#');
         PRNF.add("{? type_of(d[14])=1 || form(d[14],,2,' ,') || d[14] ?}",21,'Amort. narastająco # Podatkowo/Bilansowo'@,1,'#');
         PRNF.add("{? type_of(d[15])=1 || form(d[15],,2,' ,') || d[15] ?}",21,'Ulga inwestycyjna # narastająco'@,1,'#')
      ?}
   ?};

      PAR_WYDR.TITLE:='Wartości, amortyzacja i umorzenie środków - stan na dzień %1 roku'@[PAR_WYDR.STAN_NA$6]; ~~}
{FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
   {? FINFO.TOR_D='T'
   || {? PAR_WYDR.RODZAJ=1
      || PRN.add("c[1]",22,'Nr inwent.'@,,'#');
         PRN.add("c[37]",22,'Grupa'@,,'#');
         PRN.add("c[17]",22,'Nazwa środka'@,,'#');
         PRN.add("c[2]",16,'Symbol dok. przyjęcia'@,,'#');
         PRN.add("c[4]",16,'Jed. księg.'@,,'#');
         PRN.add("c[18]",16,'Jedn. organ.'@,,'#');
         PRN.add("c[5]",15,'R. przych.'@,,'#');
         PRN.add("c[19]",15,'Data eksp.'@,,'#');
         PRN.add("c[6]",15,'R. rozch.'@,,'#');
         PRN.add("c[20]",15,'Data skrl.'@,,'#');
         PRN.add("c[7]",20,'Zestaw kont POD'@,,'#');
         PRN.add("c[21]",20,'Zestaw kont BIL'@,,'#');
         PRN.add("c[22]",20,'Zestaw kont DOD'@,,'#');
         PRN.add("c[8]",12,'MET/STAW POD'@,,'#');
         PRN.add("c[23]",12,'MET/STAW BIL'@,,'#');
         PRN.add("c[24]",12,'MET/STAW DOD'@,,'#');
         PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",14,'Wart. inwent. POD'@,1,'#');
         PRN.add("{? type_of(c[25])=1 || form(c[25],,2,' ,') || c[25] ?}",14,'Wart. inwent. BIL'@,1,'#');
         PRN.add("{? type_of(c[26])=1 || form(c[26],,2,' ,') || c[26] ?}",14,'Wart. inwent. DOD'@,1,'#');
         PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",14,'Umorzenie POD'@,1,'#');
         PRN.add("{? type_of(c[27])=1 || form(c[27],,2,' ,') || c[27] ?}",14,'Umorzenie BIL'@,1,'#');
         PRN.add("{? type_of(c[28])=1 || form(c[28],,2,' ,') || c[28] ?}",14,'Umorzenie DOD'@,1,'#');
         PRN.add("{? type_of(c[12])=1 || form(c[12],,2,' ,') || c[12] ?}",14,'Netto   POD'@,1,'#');
         PRN.add("{? type_of(c[29])=1 || form(c[29],,2,' ,') || c[29] ?}",14,'Netto   BIL'@,1,'#');
         PRN.add("{? type_of(c[30])=1 || form(c[30],,2,' ,') || c[30] ?}",14,'Netto   DOD'@,1,'#');
         PRN.add("{? type_of(c[16])=1 || form(c[16],,2,' ,') || c[16] ?}",14,'Podst. amort. POD'@,1,'#');
         PRN.add("{? type_of(c[31])=1 || form(c[31],,2,' ,') || c[31] ?}",14,'Podst. amort. BIL'@,1,'#');
         PRN.add("{? type_of(c[32])=1 || form(c[32],,2,' ,') || c[32] ?}",14,'Podst. amort. DOD'@,1,'#');
         PRN.add("{? type_of(c[13])=1 || form(c[13],,2,' ,') || c[13] ?}",11,'Am.za mies. POD'@,1,'#');
         PRN.add("{? type_of(c[33])=1 || form(c[33],,2,' ,') || c[33] ?}",11,'Am.za mies. BIL'@,1,'#');
         PRN.add("{? type_of(c[34])=1 || form(c[34],,2,' ,') || c[34] ?}",11,'Am.za mies. DOD'@,1,'#');
         PRN.add("{? type_of(c[14])=1 || form(c[14],,2,' ,') || c[14] ?}",14,'Amort. narast. POD'@,1,'#');
         PRN.add("{? type_of(c[35])=1 || form(c[35],,2,' ,') || c[35] ?}",14,'Amort. narast. BIL'@,1,'#');
         PRN.add("{? type_of(c[36])=1 || form(c[36],,2,' ,') || c[36] ?}",14,'Amort. narast. DOD'@,1,'#');
         PRN.add("{? type_of(c[15])=1 || form(c[15],,2,' ,') || c[15] ?}",12,'Ulga inwest. narastająco'@,1,'#')

         |? PAR_WYDR.RODZAJ=2
      || PRN.add("c[1]", 35, 35+klasyfikacja);
         PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",14,'Wart. inwent. POD'@,1,'#');
         PRN.add("{? type_of(c[25])=1 || form(c[25],,2,' ,') || c[25] ?}",14,'Wart. inwent. BIL'@,1,'#');
         PRN.add("{? type_of(c[26])=1 || form(c[26],,2,' ,') || c[26] ?}",14,'Wart. inwent. DOD'@,1,'#');
         PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",14,'Umorzenie POD'@,1,'#');
         PRN.add("{? type_of(c[27])=1 || form(c[27],,2,' ,') || c[27] ?}",14,'Umorzenie BIL'@,1,'#');
         PRN.add("{? type_of(c[28])=1 || form(c[28],,2,' ,') || c[28] ?}",14,'Umorzenie DOD'@,1,'#');
         PRN.add("{? type_of(c[12])=1 || form(c[12],,2,' ,') || c[12] ?}",14,'Netto   POD'@,1,'#');
         PRN.add("{? type_of(c[29])=1 || form(c[29],,2,' ,') || c[29] ?}",14,'Netto   BIL'@,1,'#');
         PRN.add("{? type_of(c[30])=1 || form(c[30],,2,' ,') || c[30] ?}",14,'Netto   DOD'@,1,'#');
         PRN.add("{? type_of(c[16])=1 || form(c[16],,2,' ,') || c[16] ?}",14,'Podst. amort. POD'@,1,'#');
         PRN.add("{? type_of(c[31])=1 || form(c[31],,2,' ,') || c[31] ?}",14,'Podst. amort. BIL'@,1,'#');
         PRN.add("{? type_of(c[32])=1 || form(c[32],,2,' ,') || c[32] ?}",14,'Podst. amort. DOD'@,1,'#');
         PRN.add("{? type_of(c[13])=1 || form(c[13],,2,' ,') || c[13] ?}",11,'Am.za mies. POD'@,1,'#');
         PRN.add("{? type_of(c[33])=1 || form(c[33],,2,' ,') || c[33] ?}",11,'Am.za mies. BIL'@,1,'#');
         PRN.add("{? type_of(c[34])=1 || form(c[34],,2,' ,') || c[34] ?}",11,'Am.za mies. DOD'@,1,'#');
         PRN.add("{? type_of(c[14])=1 || form(c[14],,2,' ,') || c[14] ?}",14,'Amort. narast. POD'@,1,'#');
         PRN.add("{? type_of(c[35])=1 || form(c[35],,2,' ,') || c[35] ?}",14,'Amort. narast. BIL'@,1,'#');
         PRN.add("{? type_of(c[36])=1 || form(c[36],,2,' ,') || c[36] ?}",14,'Amort. narast. DOD'@,1,'#');
         PRN.add("{? type_of(c[15])=1 || form(c[15],,2,' ,') || c[15] ?}",12,'Ulga inwest. narastająco'@,1,'#')

      ?}
   ||
{? PAR_WYDR.RODZAJ=1
      || PRN.add("c[1]",22,'Nr inwent.'@,,'#');
         PRN.add("c[37]",22,'Grupa'@,,'#');
         PRN.add("c[17]",22,'Nazwa środka'@,,'#');
         PRN.add("c[2]",16,'Symbol dok. przyjęcia'@,,'#');
         PRN.add("c[4]",16,'Jed. księg.'@,,'#');
         PRN.add("c[18]",16,'Jedn. organ.'@,,'#');
         PRN.add("c[5]",15,'R. przych.'@,,'#');
         PRN.add("c[19]",15,'Data eksp.'@,,'#');
         PRN.add("c[6]",15,'R. rozch.'@,,'#');
         PRN.add("c[20]",15,'Data skrl.'@,,'#');
         PRN.add("c[7]",20,'Zestaw kont POD'@,,'#');
         PRN.add("c[21]",20,'Zestaw kont BIL'@,,'#');
         PRN.add("c[8]",12,'MET POD'@,,'#');
         PRN.add("c[38]",12,'STAW POD'@,,'#');
         PRN.add("c[23]",12,'MET BIL'@,,'#');
         PRN.add("c[39]",12,'STAW BIL'@,,'#');
         PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",14,'Wart. inwent. POD'@,1,'#');
         PRN.add("{? type_of(c[25])=1 || form(c[25],,2,' ,') || c[25] ?}",14,'Wart. inwent. BIL'@,1,'#');
         PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",14,'Umorzenie POD'@,1,'#');
         PRN.add("{? type_of(c[27])=1 || form(c[27],,2,' ,') || c[27] ?}",14,'Umorzenie BIL'@,1,'#');
         PRN.add("{? type_of(c[12])=1 || form(c[12],,2,' ,') || c[12] ?}",14,'Netto   POD'@,1,'#');
         PRN.add("{? type_of(c[29])=1 || form(c[29],,2,' ,') || c[29] ?}",14,'Netto   BIL'@,1,'#');
         PRN.add("{? type_of(c[16])=1 || form(c[16],,2,' ,') || c[16] ?}",14,'Podst. amort. POD'@,1,'#');
         PRN.add("{? type_of(c[31])=1 || form(c[31],,2,' ,') || c[31] ?}",14,'Podst. amort. BIL'@,1,'#');
         PRN.add("{? type_of(c[13])=1 || form(c[13],,2,' ,') || c[13] ?}",11,'Am.za mies. POD'@,1,'#');
         PRN.add("{? type_of(c[33])=1 || form(c[33],,2,' ,') || c[33] ?}",11,'Am.za mies. BIL'@,1,'#');
         PRN.add("{? type_of(c[14])=1 || form(c[14],,2,' ,') || c[14] ?}",14,'Amort. narast. POD'@,1,'#');
         PRN.add("{? type_of(c[35])=1 || form(c[35],,2,' ,') || c[35] ?}",14,'Amort. narast. BIL'@,1,'#');
         PRN.add("{? type_of(c[15])=1 || form(c[15],,2,' ,') || c[15] ?}",12,'Ulga inwest. narastająco'@,1,'#')

 |? PAR_WYDR.RODZAJ=2
      || PRN.add("c[1]", 35, 35+klasyfikacja);
         PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",21,'Wartość inwentarzowa Podatkowo'@,1,'#');
         PRN.add("{? type_of(c[25])=1 || form(c[25],,2,' ,') || c[25] ?}",21,'Wartość inwentarzowa Bilansowo'@,1,'#');
         PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",21,'Wartość umorzenia Podatkowo'@,1,'#');
         PRN.add("{? type_of(c[27])=1 || form(c[27],,2,' ,') || c[27] ?}",21,'Wartość umorzenia Bilansowo'@,1,'#');
         PRN.add("{? type_of(c[12])=1 || form(c[12],,2,' ,') || c[12] ?}",21,'Wartość netto  Podatkowo'@,1,'#');
         PRN.add("{? type_of(c[29])=1 || form(c[29],,2,' ,') || c[29] ?}",21,'Wartość netto  Bilansowo'@,1,'#');
         PRN.add("{? type_of(c[16])=1 || form(c[16],,2,' ,') || c[16] ?}",21,'Podstawa amort. Podatkowo'@,1,'#');
         PRN.add("{? type_of(c[31])=1 || form(c[31],,2,' ,') || c[31] ?}",21,'Podstawa amort. Bilansowo'@,1,'#');
         PRN.add("{? type_of(c[13])=1 || form(c[13],,2,' ,') || c[13] ?}",21,'Amort. za miesiąc  Podatkowo'@,1,'#');
         PRN.add("{? type_of(c[33])=1 || form(c[33],,2,' ,') || c[33] ?}",21,'Amort. za miesiąc  Bilansowo'@,1,'#');
         PRN.add("{? type_of(c[14])=1 || form(c[14],,2,' ,') || c[14] ?}",21,'Amort. narastająco  Podatkowo'@,1,'#');
         PRN.add("{? type_of(c[35])=1 || form(c[35],,2,' ,') || c[35] ?}",21,'Amort. narastająco  Bilansowo'@,1,'#');
         PRN.add("{? type_of(c[15])=1 || form(c[15],,2,' ,') || c[15] ?}",21,'Ulga inwestycyjna  narastająco'@,1,'#')

      ?}
   ?};

      PAR_WYDR.TITLE:='Wartości, amortyzacja i umorzenie środków - stan na dzień %1 roku'@[PAR_WYDR.STAN_NA$6]; ~~}
{FI}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{COMMENT}------------------------------Parametry wydruku------------{COMMENT-}
{FONT: 'W8'}{SPACE: 'C'}
{<1 'PARAMETRY WYDRUKU:'@}
{COMMENT} ---- Stan na, Grupa, Rodzaj zestawienia ---- {COMMENT-}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
  {? PAR_WYDR.ODD<>null || par1:=PAR_WYDR.ODD().OD || par1:='dowolny'@ ?};
  {? PAR_WYDR.WAR_GR=1
  || {? |PAR_WYDR.GRUPA<>'' || par2:=|PAR_WYDR.GRUPA || par2:='dowolna'@ ?}
  |? PAR_WYDR.WAR_GR=2
  || {? |PAR_WYDR.GRUPA_OD<>'' || _od:='od: '@+|PAR_WYDR.GRUPA_OD || _od:=''?};
     {? |PAR_WYDR.GRUPA_DO<>'' || _do:='do: '@+|PAR_WYDR.GRUPA_DO || _do:=''?};
     {? _od<>'' & _do<>'' || par2:=_od+' '+_do
     |? _od<>'' & _do='' ||  par2:=_od
     |? _od='' & _do<>'' || par2:=_do
    ?}
  |? PAR_WYDR.WAR_GR=3
  || par2:=PAR_WYDR.WYB_GRUP
  || par2:='wszystkie'
  ?};
  {? PAR_WYDR.RODZAJ=1
  || par3:='analityczne'@ || par3:='syntetyczne'@
  ?};
  {? PAR_WYDR.MAP<>null
  || par4:=PAR_WYDR.MAP().K
  || par4:='dowolna'@
  ?};
  {? PAR_WYDR.PRZYCHOD<>null || par5:=PAR_WYDR.PRZYCHOD().R || par5:='dowolny'@ ?}
;~~}
{IF: PAR_WYDR.WAR_GR<>3}
{FONT: 'W8B'}{<1 'Jedn. ks.: '@}{FONT: 'W8'}{par1}{FONT: 'W8B'}{<30 'Grupa: '@}{FONT: 'W8'}{par2}{FONT: 'W8B'}{<70 'Metoda podat.: '@}{FONT: 'W8'}{par4}{FONT: 'W8B'}{<95 'Przychód: '@}{FONT: 'W8'}{par5}{FONT: 'W8B'}{<120 'Rodzaj zestawienia: '@}{FONT: 'W8'}{par3}
{ELIF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{<1 'Jedn. ks.: '@}{FONT: 'W8'}{par1}{FONT: 'W8B'}{<70 'Metoda podat.: '@}{FONT: 'W8'}{par4}{FONT: 'W8B'}{<95 'Przychód: '@}{FONT: 'W8'}{par5}{FONT: 'W8B'}{<120 'Rodzaj zestawienia: '@}{FONT: 'W8'}{par3}
{FI}
{COMMENT} ---- Dane, Jedn. ks., Zestawienie według ---- {COMMENT-}
{
  {? PAR_WYDR.PODSUM=1
  || par1:='grup'@
  |? PAR_WYDR.PODSUM=2
  || par1:='jedn. księgowych.'@
  |? PAR_WYDR.PODSUM=3
  || par1:='klasyfikacji dodatkowej'@
  |? PAR_WYDR.PODSUM=4
  || par1:='struktury organizacyjnej'@
  ?};
  par3:='';
  {? PAR_WYDR.FROM_DE<>date(0,0,0)
  || par3:='od '@ + form(PAR_WYDR.FROM_DE,,1)
  ?};
  {? PAR_WYDR.TO_DE <> date(0,0,0)
  || {? par3<>'' || par3+=' ' ?};
     par3+='do '@+form(PAR_WYDR.TO_DE,,1)
  ?};
  {? par3='' || par3:='dowolna'@ ?};
  {? PAR_WYDR.MAF<>null
  || par4:=PAR_WYDR.MAF().K
  || par4:='dowolna'@
  ?};
  {? PAR_WYDR.ROZCHOD<>null || par5:=PAR_WYDR.ROZCHOD().R || par5:='dowolny'@ ?};
  {? PAR_WYDR.JORG<>null || par6:=PAR_WYDR.JORG().SYMBOL || par6:='dowolny'@ ?}
;~~}
{FONT: 'W8B'}{<1 'Jedn. organ.: '@}{FONT: 'W8'}{par6}{FONT: 'W8B'}{<30 'Podsumowanie wg: '@}{FONT: 'W8'}{par1}{FONT: 'W8B'}{<70 'Metoda bilan.: '@}{FONT: 'W8'}{par4}{FONT: 'W8B'}{<95 'Rozchód: '@}{FONT: 'W8'}{par5}{FONT: 'W8B'}{<120 'Data eksploatacji: '@}{FONT: 'W8'}{par3}
{IF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{<1 'Wybór grup: '@}{FONT: 'W8'}{exec('create_list_gr','fst')}
{FI}
{COMMENT} --- Zakres środków, metoda dodatkowa --- {COMMENT-}
{
  {? PAR_WYDR.ZAKRESDR=0
  || par6:='wszystkie'@
  |? PAR_WYDR.ZAKRESDR=1
  || par6:='trwałe'@
  |? PAR_WYDR.ZAKRESDR=2
  || par6:='niskocenne'@
  ?};
  {? PAR_WYDR.MO_DO=1 || par3:='miesiąca obowiązywania'@ || par3:='daty operacji'@ ?}
;~~}
{IF: FINFO.TOR_D='T'}
{
  {? PAR_WYDR.MAD<>null
  || par4:=PAR_WYDR.MAD().K
  || par4:='dowolna'@
  ?}
;~~}
{FONT: 'W8B'}{<1 'Zakres środków: '@}{FONT: 'W8'}{par6}{FONT: 'W8B'}{<70 'Metoda dodat.: '@}{FONT: 'W8'}{par4}
{ELSE}
{FONT: 'W8B'}{<1 'Zakres środków: '@}{FONT: 'W8'}{par6}
{FI}
{FONT: 'W8B'}{<1 'Dokumenty wartościowe uwzględniane według: '@}{FONT: 'W8'}{par3}
{IF: klasyfikacja<>''}
{
{? klasyfikacja<>'' || par1:=klasyfikacja ?};
{? klasyfikacja<>'' & typsrodka<>'' || par2:=typsrodka ?};
~~}
{FONT: 'W8B'}{<1 'Klasyfikacja: '@}{FONT: 'W8'}{par1 + {? typsrodka <> '' || (', typ środków: '@ + par2) || '' ?} }
{FI}
{IF: PAR_WYDR.UMO_ONLY=1 | PAR_WYDR.SKR_ONLY=1}
{ {? PAR_WYDR.UMO_ONLY=1 || par1:='tylko środki całkowicie umorzone'@ || par1:='' ?};
  {? PAR_WYDR.SKR_ONLY=1 || par2:='tylko środki skreślone'@ || par2:='' ?};
  {? par1 <> '' || par1:=par1 + {? par2 <> '' || ', ' || '' ?} + par2 || par1:=par2 ?};
~~}
{FONT: 'W8B'}{<1 'Kryteria dodatkowe: '@}{FONT: 'W8'}{{? par1 <> '' || par1 || 'brak'@ ?}}
{FI}
{ par1:='Środki przeniesione w bieżącym roku uwzględniono: '@ + {? PAR_WYDR.ZMIANY='T'
                                                               || 'tylko w obecnej jedn. księgowej'@
                                                               || 'w obecnej i poprzednich jedn. księg.'@
                                                               ?}
;~~}
{IF: PAR_WYDR.SKRESL=1}
{FONT: 'W8B'}{<1 'Nie uwzględniono środków skreślonych w bieżącym roku lecz przed datą stan na dzień.'@}{FONT: 'W8'}
{FI}
{FONT: 'W8B'}{<1 par1}{FONT: 'W8'}
{FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
  {? PAR_WYDR.ODD<>null || par1:=PAR_WYDR.ODD().OD || par1:='dowolny'@ ?};
  {? PAR_WYDR.WAR_GR=1
  || {? |PAR_WYDR.GRUPA<>'' || par2:=|PAR_WYDR.GRUPA || par2:='dowolna'@ ?}
  |? PAR_WYDR.WAR_GR=2
  || {? |PAR_WYDR.GRUPA_OD<>'' || _od:='od: '@+|PAR_WYDR.GRUPA_OD || _od:=''?};
     {? |PAR_WYDR.GRUPA_DO<>'' || _do:='do: '@+|PAR_WYDR.GRUPA_DO || _do:=''?};
     {? _od<>'' & _do<>'' || par2:=_od+' '+_do
     |? _od<>'' & _do='' ||  par2:=_od
     |? _od='' & _do<>'' || par2:=_do
    ?}
  |? PAR_WYDR.WAR_GR=3
  || par2:=PAR_WYDR.WYB_GRUP
  || par2:='wszystkie'
  ?};
  {? PAR_WYDR.RODZAJ=1
  || par3:='analityczne'@ || par3:='syntetyczne'@
  ?};
  {? PAR_WYDR.MAP<>null
  || par4:=PAR_WYDR.MAP().K
  || par4:='dowolna'@
  ?};
  {? PAR_WYDR.PRZYCHOD<>null || par5:=PAR_WYDR.PRZYCHOD().R || par5:='dowolny'@ ?}
;~~}
{IF: PAR_WYDR.WAR_GR<>3}
{FONT: 'W8B'}{ 'Jedn. ks.: '@}{FONT: 'W8'}{par1}
{FONT: 'W8B'}{ 'Grupa: '@}{FONT: 'W8'}{par2}
{FONT: 'W8B'}{ 'Metoda podat.: '@}{FONT: 'W8'}{par4}
{FONT: 'W8B'}{ 'Przychód: '@}{FONT: 'W8'}{par5}
{FONT: 'W8B'}{ 'Rodzaj zestawienia: '@}{FONT: 'W8'}{par3}
{ELIF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{ 'Jedn. ks.: '@}{FONT: 'W8'}{par1}
{FONT: 'W8B'}{ 'Metoda podat.: '@}{FONT: 'W8'}{par4}
{FONT: 'W8B'}{ 'Przychód: '@}{FONT: 'W8'}{par5}
{FONT: 'W8B'}{ 'Rodzaj zestawienia: '@}{FONT: 'W8'}{par3}
{FI}
{COMMENT} ---- Dane, Jedn. ks., Zestawienie według ---- {COMMENT-}
{
  {? PAR_WYDR.PODSUM=1
  || par1:='grup'@
  |? PAR_WYDR.PODSUM=2
  || par1:='jedn. księgowych.'@
  |? PAR_WYDR.PODSUM=3
  || par1:='klasyfikacji dodatkowej'@
  |? PAR_WYDR.PODSUM=4
  || par1:='struktury organizacyjnej'@
  ?};
  par3:='';
  {? PAR_WYDR.FROM_DE<>date(0,0,0)
  || par3:='od '@ + form(PAR_WYDR.FROM_DE,,1)
  ?};
  {? PAR_WYDR.TO_DE <> date(0,0,0)
  || {? par3<>'' || par3+=' ' ?};
     par3+='do '@+form(PAR_WYDR.TO_DE,,1)
  ?};
  {? par3='' || par3:='dowolna'@ ?};
  {? PAR_WYDR.MAF<>null
  || par4:=PAR_WYDR.MAF().K
  || par4:='dowolna'@
  ?};
  {? PAR_WYDR.ROZCHOD<>null || par5:=PAR_WYDR.ROZCHOD().R || par5:='dowolny'@ ?};
  {? PAR_WYDR.JORG<>null || par6:=PAR_WYDR.JORG().SYMBOL || par6:='dowolny'@ ?}
;~~}
{FONT: 'W8B'}{ 'Jedn. organ.: '@}{FONT: 'W8'}{par6}
{FONT: 'W8B'}{ 'Podsumowanie wg: '@}{FONT: 'W8'}{par1}
{FONT: 'W8B'}{ 'Metoda bilan.: '@}{FONT: 'W8'}{par4}
{FONT: 'W8B'}{ 'Rozchód: '@}{FONT: 'W8'}{par5}
{FONT: 'W8B'}{ 'Data eksploatacji: '@}{FONT: 'W8'}{par3}
{IF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{ 'Wybór grup: '@}{FONT: 'W8'}{exec('create_list_gr','fst')}
{FI}
{COMMENT} --- Zakres środków, metoda dodatkowa --- {COMMENT-}
{
  {? PAR_WYDR.ZAKRESDR=0
  || par6:='wszystkie'@
  |? PAR_WYDR.ZAKRESDR=1
  || par6:='trwałe'@
  |? PAR_WYDR.ZAKRESDR=2
  || par6:='niskocenne'@
  ?};
  {? PAR_WYDR.MO_DO=1 || par3:='miesiąca obowiązywania'@ || par3:='daty operacji'@ ?}
;~~}
{IF: FINFO.TOR_D='T'}
{
  {? PAR_WYDR.MAD<>null
  || par4:=PAR_WYDR.MAD().K
  || par4:='dowolna'@
  ?}
;~~}
{FONT: 'W8B'}{ 'Zakres środków: '@}{FONT: 'W8'}{par6}
{FONT: 'W8B'}{ 'Metoda dodat.: '@}{FONT: 'W8'}{par4}
{ELSE}
{FONT: 'W8B'}{ 'Zakres środków: '@}{FONT: 'W8'}{par6}
{FI}
{FONT: 'W8B'}{ 'Dokumenty wartościowe uwzględniane według: '@}{FONT: 'W8'}{par3}
{IF: klasyfikacja<>''}
{
{? klasyfikacja<>'' || par1:=klasyfikacja ?};
{? klasyfikacja<>'' & typsrodka<>'' || par2:=typsrodka ?};
~~}
{FONT: 'W8B'}{<1 'Klasyfikacja: '@}{FONT: 'W8'}{par1 + {? typsrodka <> '' || (', typ środków: '@ + par2) || '' ?} }
{FI}
{IF: PAR_WYDR.UMO_ONLY=1 | PAR_WYDR.SKR_ONLY=1}
{ {? PAR_WYDR.UMO_ONLY=1 || par1:='tylko środki całkowicie umorzone'@ || par1:='' ?};
  {? PAR_WYDR.SKR_ONLY=1 || par2:='tylko środki skreślone'@ || par2:='' ?};
  {? par1 <> '' || par1:=par1 + {? par2 <> '' || ', ' || '' ?} + par2 || par1:=par2 ?};
~~}
{FONT: 'W8B'}{'Kryteria dodatkowe: '@}{FONT: 'W8'}{{? par1 <> '' || par1 || 'brak'@ ?}}
{FI}
{ par1:='Środki przeniesione w bieżącym roku uwzględniono: '@ + {? PAR_WYDR.ZMIANY='T'
                                                               || 'tylko w obecnej jedn. księgowej'@
                                                               || 'w obecnej i poprzednich jedn. księg.'@
                                                               ?}
;~~}
{IF: PAR_WYDR.SKRESL=1}
{FONT: 'W8B'}{ 'Nie uwzględniono środków skreślonych w bieżącym roku lecz przed datą stan na dzień.'@}{FONT: 'W8'}
{FI}
{FONT: 'W8B'}{ par1}{FONT: 'W8'}
{FI}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: ~rep_export()}
{SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{ rsep:=PAR_WYDR.RSEP; ~~}
{FOR: TAB_SQL}
 {DO}
{COMMENT} ---- Podsumowanie cząstkowe według grup lub jedn. ksiegowych ---- {COMMENT-}
  { {? PAR_WYDR.RODZAJ=1
    || {? PAR_WYDR.PODSUM=1
       || test_grupa:=TAB_SQL.GR
       |? PAR_WYDR.PODSUM=2
       || test_grupa:=TAB_SQL.ODDZIAL
       |? PAR_WYDR.PODSUM=3
       || test_grupa:=TAB_SQL.TYPSROD
       |? PAR_WYDR.PODSUM=4
       || test_grupa:=TAB_SQL.JORG+' ('+TAB_SQL.ODDZIAL +')'
       ?};
       {? sum_grupa='' || test_grupa:=''?}
    ?}
  ;~~}
  {IF: PAR_WYDR.RODZAJ=1 & sum_grupa <> test_grupa}
  {
   {? PAR_WYDR.PODSUM=1
   || d[1]:='Razem grupa: '@ + sum_grupa + {? PAR_WYDR.WAR_GR=2 || '(w wybranym zakresie) '@ || '' ?}
   |? PAR_WYDR.PODSUM=2
   || d[1]:='Jedn. księg. '@ + sum_grupa + ' razem:'@
   |? PAR_WYDR.PODSUM=3
   || d[1]:= sum_grupa + ' razem:'@
   |? PAR_WYDR.PODSUM=4
   || d[1]:= 'Jedn. organ. '@ + sum_grupa + ' razem:'@
   ?};
   d[2]:=''; d[3]:=''; d[4]:=''; d[5]:=''; d[6]:=''; d[7]:=''; d[8]:=''; d[9]:='';
   d[10]:= g_warp; d[11]:= g_umop; d[12]:= g_netp; d[13]:= g_ampa; d[14]:= g_amp;
   d[15]:= g_ulga; d[16]:=g_podamp;
   prn1:='PRN'; prn2:='PRNF';
   rsep:=1;"vp:=0"
  ;~~}
  {FONT: 'T8GB'}{SPACE: 'C'}{IF: lineleft()<=4 & lineleft()<>0}{PAGE}{FI}{SUBSTITUTE: 'LINIA02'}
  {
   d[1]:=''; d[2]:=''; d[3]:=''; d[4]:=''; d[5]:=''; d[6]:=''; d[7]:=''; d[8]:=''; d[9]:='';
   d[10]:=g_warf; d[11]:= g_umof; d[12]:=g_netf; d[13]:=g_amfa; d[14]:=g_amf;
   d[15]:=''; d[16]:=g_podamf;
   "vp:=0";
   rsep:=0;
   prn1:='PRN'; prn2:='PRNF'
   ;~~}
  {SUBSTITUTE: 'LINIA02'}
  {IF: FINFO.TOR_D='T'}
  {
   d[1]:=''; d[2]:=''; d[3]:=''; d[4]:=''; d[5]:=''; d[6]:=''; d[7]:=''; d[8]:=''; d[9]:='';
   d[10]:= g_ward; d[11]:= g_umod; d[12]:= g_netd; d[13]:= g_amda; d[14]:= g_amd;
   d[15]:=''; d[16]:=g_podamd;
   "vp:=0";
   rsep:=0;
   prn1:='PRNF'; prn2:='PRNF'
   ;~~}
  {SUBSTITUTE: 'LINIA02'}
  {FI}
  {rsep:=1;
  prn1:='PRNF'; prn2:='PRN'
  ;~~}
  {FONT: 'T8G'}{SPACE: 'C'}
{COMMENT} ---- wyzerowanie podsumowań cząstkowych---- {COMMENT-}
  {
     {? PAR_WYDR.RODZAJ=1
        || g_warp:=0; g_umop:=0; g_netp:=0; g_warf:=0; g_umof:=0; g_netf:=0;g_ward:=0; g_umod:=0; g_netd:=0;
           g_amp:=0; g_ampa:=0; g_amf:=0; g_amfa:=0; g_amd:=0; g_amda:=0; g_ulga:=0; g_podamp:=0; g_podamf:=0; g_podamd:=0
     ?}
  ;~~}
 {FI}
 {COMMENT} ---- Super podsumowanie cząstkowe jedn. ksiegowych jesli PAR_WYD.PODSUM=4 ---- {COMMENT-}
 {COMMENT} ---- Podsumowania nie występują dla excel ---- {COMMENT-}
{IF: ~rep_export()}
{IF: PAR_WYDR.PODSUM=4}
  { stest_grupa:=TAB_SQL.ODDZIAL;
  {? ssum_grupa='' || stest_grupa:=''?}
  ;~~}
  {IF: ssum_grupa<>stest_grupa}
  {
   d[1]:= 'Jedn. księg. '@ + ssum_grupa + ' razem:'@;
   d[2]:=''; d[3]:=''; d[4]:=''; d[5]:=''; d[6]:=''; d[7]:=''; d[8]:=''; d[9]:='';
   d[10]:=sg_warp; d[11]:= sg_umop; d[12]:= sg_netp; d[13]:= sg_ampa; d[14]:= sg_amp;
   d[15]:=sg_ulga; d[16]:=sgpodamp;
   prn1:='PRNF'; prn2:='PRNF';
   rsep:=1;"vp:=0"
  ;~~}
  {FONT: 'T8GB'}{SPACE: 'C'}{IF: lineleft()<=4 & lineleft()<>0}{PAGE}{FI}{SUBSTITUTE: 'LINIA02'}
  {
   d[1]:=''; d[2]:=''; d[3]:=''; d[4]:=''; d[5]:=''; d[6]:=''; d[7]:=''; d[8]:=''; d[9]:='';
   d[10]:= sg_warf; d[11]:= sg_umof; d[12]:= sg_netf; d[13]:= sg_amfa; d[14]:= sg_amf;
   d[15]:=''; d[16]:=sgpodamf;
   "vp:=0";
   rsep:=0;
   prn1:='PRN'; prn2:='PRNF'
   ;~~}
  {SUBSTITUTE: 'LINIA02'}
  {IF: FINFO.TOR_D='T'}
  {
   d[1]:=''; d[2]:=''; d[3]:=''; d[4]:=''; d[5]:=''; d[6]:=''; d[7]:=''; d[8]:=''; d[9]:='';
   d[10]:=sg_ward; d[11]:=sg_umod; d[12]:=sg_netd; d[13]:=sg_amda; d[14]:=sg_amd;
   d[15]:=''; d[16]:=sgpodamd;
   "vp:=0";
   rsep:=0;
   prn1:='PRNF'; prn2:='PRNF'
   ;~~}
  {SUBSTITUTE: 'LINIA02'}
  {FI}
  {rsep:=1;
  prn1:='PRNF'; prn2:='PRN'
  ;~~}
  {FONT: 'T8G'}{SPACE: 'C'}
 {COMMENT} ---- wyzerowanie super podsumowań cząstkowych---- {COMMENT-}
  {
    sg_warp:=0; sg_umop:=0; sg_netp:=0; sg_warf:=0; sg_umof:=0; sg_netf:=0; sg_ward:=0; sg_umod:=0; sg_netd:=0;
    sg_amp:=0; sg_ampa:=0; sg_amd:=0; sg_amda:=0; sg_amf:=0; sg_amfa:=0; sg_ulga:=0; sgpodamp:=0; sgpodamf:=0;sgpodamd:=0
  ;~~}
 {FI}
{FI}
{FI}
{COMMENT} ---- zwykłe wiersze ---- {COMMENT-}
{COMMENT} ---- NIE EXCEL ---- {COMMENT-}
{IF: ~rep_export()}
 {

   {? PAR_WYDR.RODZAJ=1
   ||
      c[1]:=TAB_SQL.NRI + '-' + TAB_SQL.GRUPA;
      c[2]:=TAB_SQL.SYM_OT;
      c[4]:=TAB_SQL.ODDZIAL;
      c[5]:=TAB_SQL.PRZYCH;
      c[6]:={? TAB_SQL.ZB<>'T' & TAB_SQL.D_SPRZ=date(0,0,0) || TAB_SQL.ROZCH || 'Sprz. grupa' ?};
      c[7]:=TAB_SQL.KONTOP;
      c[9]:=form((TAB_SQL.STAWKA * TAB_SQL.WKP),,2,' ,');
      c[8]:=TAB_SQL.MAP + '-' + c[9];

      {? TAB_SQL.AKTYWNY <> 'N'
      || c[10]:=TAB_SQL.WARP;
         c[11]:=TAB_SQL.UMOP;
         c[12]:=TAB_SQL.NETP;

         c[16]:=TAB_SQL.PNETP;
         c[13]:=TAB_SQL.ACT_AMP;
         c[14]:={? TAB_SQL.AKTYWNY='T' || TAB_SQL.AM_POD || '['+form(TAB_SQL.AM_POD,,2,' ,')+']' ?};
         c[15]:=0
      || c[10]:='-';
         c[11]:='-';
         c[12]:='-';
         c[16]:='-';
         c[13]:='-';
         c[14]:='['+form(TAB_SQL.AM_POD,,2,' ,')+']';
         c[15]:='-'
      ?};

      sum_warp+=TAB_SQL.WARP;
      sum_umop+=TAB_SQL.UMOP;
      sum_netp+=TAB_SQL.NETP;

      sum_warf+=TAB_SQL.WARF;
      sum_umof+=TAB_SQL.UMOF;
      sum_netf+=TAB_SQL.NETF;

      sum_amp+=TAB_SQL.AM_POD;
      sum_amf+=TAB_SQL.AM_FIN;

      {? TAB_SQL.AKTYWNY<>'N'
      || sum_ampa+=TAB_SQL.ACT_AMP;
         sum_amfa+=TAB_SQL.ACT_AMF
      ?};
      sum_ulga+=0;

      sum_pamp+=TAB_SQL.PNETP;
      sum_pamf+=TAB_SQL.PNETF;

      g_warp+=TAB_SQL.WARP; g_umop+=TAB_SQL.UMOP; g_netp+=TAB_SQL.NETP;
      g_warf+=TAB_SQL.WARF; g_umof+=TAB_SQL.UMOF; g_netf+=TAB_SQL.NETF;
      g_amp+=TAB_SQL.AM_POD; g_amf+=TAB_SQL.AM_FIN;
      {? TAB_SQL.AKTYWNY<>'N'
      || g_ampa+=TAB_SQL.ACT_AMP; g_amfa+=TAB_SQL.ACT_AMF
      ?};
      g_ulga+=0;
      g_podamp+=TAB_SQL.PNETP;
      g_podamf+=TAB_SQL.PNETF;

      sg_warp+=TAB_SQL.WARP; sg_umop+=TAB_SQL.UMOP; sg_netp+=TAB_SQL.NETP;
      sg_warf+=TAB_SQL.WARF; sg_umof+=TAB_SQL.UMOF; sg_netf+=TAB_SQL.NETF;
      sg_amp+=TAB_SQL.AM_POD; sg_amf+=TAB_SQL.AM_FIN;
      {? TAB_SQL.AKTYWNY <> 'N'
      || sg_ampa+=TAB_SQL.ACT_AMP; sg_amfa+=TAB_SQL.ACT_AMF
      ?};
      sg_ulga+=0;
      sgpodamp+=TAB_SQL.PNETP;
      sgpodamf+=TAB_SQL.PNETF;

      {? FINFO.TOR_D='T'
      ||
         sum_ward+=TAB_SQL.WARD;
         sum_umod+=TAB_SQL.UMOD;
         sum_netd+=TAB_SQL.NETD;
         sum_amd+=TAB_SQL.AM_DOD;
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_amda+=TAB_SQL.ACT_AMD
         ?};
         sum_pamd+=TAB_SQL.PNETD;
         g_ward+=TAB_SQL.WARD; g_umod+=TAB_SQL.UMOD; g_netd+=TAB_SQL.NETD;
         g_amd+=TAB_SQL.AM_DOD;
         {? TAB_SQL.AKTYWNY<>'N'
         || g_amda+=TAB_SQL.ACT_AMD
         ?};

         g_podamd+=TAB_SQL.PNETD;
         sg_ward+=TAB_SQL.WARD; sg_umod+=TAB_SQL.UMOD; sg_netd+=TAB_SQL.NETD;
         sg_amd+=TAB_SQL.AM_DOD;
         {? TAB_SQL.AKTYWNY <> 'N'
         || sg_amda+=TAB_SQL.ACT_AMD
         ?};
         sgpodamd+=TAB_SQL.PNETD
      ?}
   ||
      sum_warp+=TAB_SQL.SUM_WARP;
      sum_umop+=TAB_SQL.SUM_UMOP;
      sum_netp+=TAB_SQL.SUM_NETP;
      sum_warf+=TAB_SQL.SUM_WARF;
      sum_umof+=TAB_SQL.SUM_UMOF;
      sum_netf+=TAB_SQL.SUM_NETF;
      sum_amp+=TAB_SQL.SUM_AMP;
      sum_amf+=TAB_SQL.SUM_AMF;
      sum_ampa+=TAB_SQL.SUM_AMPA;
      sum_amfa+=TAB_SQL.SUM_AMFA;
      sum_ulga+=TAB_SQL.SUM_ULGA;
      sum_pamp+=TAB_SQL.SUM_PNEP;
      sum_pamf+=TAB_SQL.SUM_PNEF;

      sg_warp+=TAB_SQL.SUM_WARP;
      sg_umop+=TAB_SQL.SUM_UMOP;
      sg_netp+=TAB_SQL.SUM_NETP;
      sg_warf+=TAB_SQL.SUM_WARF;
      sg_umof+=TAB_SQL.SUM_UMOF;
      sg_netf+=TAB_SQL.SUM_NETF;
      sg_amp+=TAB_SQL.SUM_AMP;
      sg_amf+=TAB_SQL.SUM_AMF;
      sg_ampa+=TAB_SQL.SUM_AMPA;
      sg_amfa+=TAB_SQL.SUM_AMFA;
      sg_ulga+=0;
      sgpodamp+=TAB_SQL.SUM_PNEP;
      sgpodamf+=TAB_SQL.SUM_PNEF;

      {? FINFO.TOR_D='T'
      ||
         sum_ward+=TAB_SQL.SUM_WARD;
         sum_umod+=TAB_SQL.SUM_UMOD;
         sum_netd+=TAB_SQL.SUM_NETD;

         sum_amd+=TAB_SQL.SUM_AMD;
         sum_amda+=TAB_SQL.SUM_AMDA;
         sum_pamd+=TAB_SQL.SUM_PNED;

         sg_ward+=TAB_SQL.SUM_WARD;
         sg_umod+=TAB_SQL.SUM_UMOD;
         sg_netd+=TAB_SQL.SUM_NETD;

         sg_amd+=TAB_SQL.SUM_AMD;
         sg_amda+=TAB_SQL.SUM_AMDA;
         sgpodamd+=TAB_SQL.SUM_PNED
      ?};

      {? PAR_WYDR.PODSUM=1
      || c[1]:='Razem grupa: '@ +{? PAR_WYDR.PR_GR || TAB_SQL.GRUPA+' - '+TAB_SQL.NGS ||  TAB_SQL.GR ?}+{? PAR_WYDR.WAR_GR=2 || '(w wybranym zakresie) '@ || '' ?}
      |? PAR_WYDR.PODSUM=2
      || c[1]:='Jedn. księg.'@ + TAB_SQL.ODDZIAL + ' razem:'@
      |? PAR_WYDR.PODSUM=3
      || c[1]:= TAB_SQL.TYPSROD + ' razem:'@
      |? PAR_WYDR.PODSUM=4
      || c[1]:='Jedn. organ. '@ + TAB_SQL.JORG+' ('+ TAB_SQL.ODDZIAL+') razem:'@
      ?};

      c[10]:=TAB_SQL.SUM_WARP;
      c[11]:=TAB_SQL.SUM_UMOP;
      c[12]:=TAB_SQL.SUM_NETP;
      c[13]:=TAB_SQL.SUM_AMPA;
      c[14]:=TAB_SQL.SUM_AMP;
      c[15]:=TAB_SQL.SUM_ULGA;
      c[16]:=TAB_SQL.SUM_PNEP
   ?}
 ;~~}
{IF: lineleft() <=4 & lineleft()<>0}{PAGE}{FI}
{
{? vp || prn1:='PRN'; prn2:='PRN'?} ;~~}{SUBSTITUTE: 'LINIA02'}
{prn1:='PRN'; prn2:='PRN';~~}
{COMMENT} ---- druga linia---- {COMMENT-}
  {
   {? PAR_WYDR.RODZAJ=1
   ||
      c[1]:={? +TAB_SQL.NST<22 | FINFO.TOR_D<>'T' || TAB_SQL.NST || 22+TAB_SQL.NST ?};
      c[2]:='';
      c[4]:=TAB_SQL.JORG;
      c[5]:=form(TAB_SQL.DE,,1);
      c[6]:={? TAB_SQL.ZB<>'T' & TAB_SQL.D_SPRZ=date(0,0,0)
            || {? TAB_SQL.DES<>date(0,0,0) || form(TAB_SQL.DES,,1) || '' ?}
            || {? TAB_SQL.D_SPRZ<>date(0,0,0) || form(TAB_SQL.D_SPRZ,,1) || '' ?}
            ?};
      c[7]:=TAB_SQL.KONTOF;
      c[9]:=form((TAB_SQL.STAFIN * TAB_SQL.WKF),,2,' ,');
      c[8]:=TAB_SQL.MAF + '-' + c[9];
      {? TAB_SQL.AKTYWNY<>'N'
      || c[10]:=TAB_SQL.WARF;
         c[11]:=TAB_SQL.UMOF;
         c[12]:=TAB_SQL.NETF;
         c[16]:=TAB_SQL.PNETF;
         c[13]:=TAB_SQL.ACT_AMF;
         c[14]:={? TAB_SQL.AKTYWNY='T' || TAB_SQL.AM_FIN || '['+form(TAB_SQL.AM_FIN,,2,' ,')+']' ?};
         c[15]:=''
      || c[10]:='-';
         c[11]:='-';
         c[12]:='-';
         c[16]:='-';
         c[13]:='-';
         c[14]:='['+form(TAB_SQL.AM_FIN,,2,' ,')+']';
         c[15]:=''
      ?}

   || c[1]:='';
      c[10]:=TAB_SQL.SUM_WARF;
      c[11]:=TAB_SQL.SUM_UMOF;
      c[12]:=TAB_SQL.SUM_NETF;
      c[13]:= TAB_SQL.SUM_AMFA;
      c[14]:= TAB_SQL.SUM_AMF;
      c[15]:='';
      c[16]:=TAB_SQL.SUM_PNEF
   ?};
   rsep:=0;
   prn1:='PRN'; prn2:='PRN'
   ;~~}
  {SUBSTITUTE: 'LINIA02'}
{COMMENT} ---- Trzecia linia---- {COMMENT-}
{IF: FINFO.TOR_D='T'}
  {
   {? PAR_WYDR.RODZAJ=1
   ||
      c[1]:={? +TAB_SQL.NST<22 || '' || 22-TAB_SQL.NST ?};
      c[4]:='';
      c[5]:='';
      c[6]:='';
      c[7]:=TAB_SQL.KONTOD;
      c[9]:=form((TAB_SQL.STADOD * TAB_SQL.WKD),,2,' ,');
      c[8]:=TAB_SQL.MAD + '-' + c[9];

      {? TAB_SQL.AKTYWNY<>'N'
      || c[10]:=TAB_SQL.WARD;
         c[11]:=TAB_SQL.UMOD;
         c[12]:=TAB_SQL.NETD;
         c[16]:=TAB_SQL.PNETD;
         c[13]:=TAB_SQL.ACT_AMD;
         c[14]:={? TAB_SQL.AKTYWNY='T' || TAB_SQL.AM_DOD || '['+form(TAB_SQL.AM_DOD,,2,' ,')+']' ?};
         c[15]:=''
      || c[10]:='-';
         c[11]:='-';
         c[12]:='-';
         c[16]:='-';
         c[13]:='-';
         c[14]:='['+form(TAB_SQL.AM_DOD,,2,' ,')+']';
         c[15]:=''
      ?}
   || c[1]:='';
      c[10]:=TAB_SQL.SUM_WARD;
      c[11]:=TAB_SQL.SUM_UMOD;
      c[12]:=TAB_SQL.SUM_NETD;
      c[13]:= TAB_SQL.SUM_AMDA;
      c[14]:= TAB_SQL.SUM_AMD;
      c[15]:='';
      c[16]:=TAB_SQL.SUM_PNED
   ?};
   rsep:=0;
   prn1:='PRN'; prn2:='PRN'
   ;~~}
  {SUBSTITUTE: 'LINIA02'}
  {FI}
{FI}
{COMMENT} ---- zwykłe wiersze ---- {COMMENT-}
{COMMENT} ----- EXCEL ---- {COMMENT-}
{IF: rep_export()}
{


{? FINFO.TOR_D='T' ||
   {? PAR_WYDR.RODZAJ=1
   ||
      c[22]:=TAB_SQL.KONTOD;
      c[9]:=form((TAB_SQL.STADOD * TAB_SQL.WKD),,2,' ,');
      c[24]:=TAB_SQL.MAD + '-' + c[9];

      {? TAB_SQL.AKTYWNY<>'N'
      || c[26]:=TAB_SQL.WARD;
         c[28]:=TAB_SQL.UMOD;
         c[30]:=TAB_SQL.NETD;
         c[32]:=TAB_SQL.PNETD;
         c[34]:=TAB_SQL.ACT_AMD;
         c[36]:={? TAB_SQL.AKTYWNY='T' || TAB_SQL.AM_DOD || '['+form(TAB_SQL.AM_DOD,,2,' ,')+']' ?}
      ||
         c[36]:='['+form(TAB_SQL.AM_DOD,,2,' ,')+']'
      ?}
   ||
      c[26]:=TAB_SQL.SUM_WARD;
      c[28]:=TAB_SQL.SUM_UMOD;
      c[30]:=TAB_SQL.SUM_NETD;
      c[34]:= TAB_SQL.SUM_AMDA;
      c[36]:= TAB_SQL.SUM_AMD;
      c[32]:=TAB_SQL.SUM_PNED
   ?}

?};


   {? PAR_WYDR.RODZAJ=1
   ||


      c[17]:={? +TAB_SQL.NST<22 | FINFO.TOR_D<>'T' || TAB_SQL.NST || 22+TAB_SQL.NST ?};
      c[18]:=TAB_SQL.JORG;
      c[19]:=form(TAB_SQL.DE,,1);
      c[20]:={? TAB_SQL.ZB<>'T' & TAB_SQL.D_SPRZ=date(0,0,0)
            || {? TAB_SQL.DES<>date(0,0,0) || form(TAB_SQL.DES,,1) || '' ?}
            || {? TAB_SQL.D_SPRZ<>date(0,0,0) || form(TAB_SQL.D_SPRZ,,1) || '' ?}
            ?};
      c[21]:=TAB_SQL.KONTOF;
      c[9]:=form((TAB_SQL.STAFIN * TAB_SQL.WKF),,2,' ,');
      c[23]:=TAB_SQL.MAF;
      c[39]:=c[9];
      {? TAB_SQL.AKTYWNY<>'N'
      || c[25]:=TAB_SQL.WARF;
         c[27]:=TAB_SQL.UMOF;
         c[29]:=TAB_SQL.NETF;
         c[31]:=TAB_SQL.PNETF;
         c[33]:=TAB_SQL.ACT_AMF;
         c[35]:={? TAB_SQL.AKTYWNY='T' || TAB_SQL.AM_FIN || '['+form(TAB_SQL.AM_FIN,,2,' ,')+']' ?}
      || c[25]:='-';
         c[27]:='-';
         c[29]:='-';
         c[31]:='-';
         c[33]:='-';
         c[35]:='['+form(TAB_SQL.AM_FIN,,2,' ,')+']'
      ?};

      c[1]:=TAB_SQL.NRI;
      c[37]:=TAB_SQL.GRUPA;
      c[2]:=TAB_SQL.SYM_OT;
      c[4]:=TAB_SQL.ODDZIAL;
      c[5]:=TAB_SQL.PRZYCH;
      c[6]:={? TAB_SQL.ZB<>'T' & TAB_SQL.D_SPRZ=date(0,0,0) || TAB_SQL.ROZCH || 'Sprz. grupa' ?};
      c[7]:=TAB_SQL.KONTOP;
      c[9]:=form((TAB_SQL.STAWKA * TAB_SQL.WKP),,2,' ,');
      c[8]:=TAB_SQL.MAP;
      c[38]:=c[9];

      {? TAB_SQL.AKTYWNY <> 'N'
      || c[10]:=TAB_SQL.WARP;
         c[11]:=TAB_SQL.UMOP;
         c[12]:=TAB_SQL.NETP;

         c[16]:=TAB_SQL.PNETP;
         c[13]:=TAB_SQL.ACT_AMP;
         c[14]:={? TAB_SQL.AKTYWNY='T' || TAB_SQL.AM_POD || '['+form(TAB_SQL.AM_POD,,2,' ,')+']' ?};
         c[15]:=0
      || c[10]:='-';
         c[11]:='-';
         c[12]:='-';
         c[16]:='-';
         c[13]:='-';
         c[14]:='['+form(TAB_SQL.AM_POD,,2,' ,')+']';
         c[15]:='-'
      ?};

      sum_warp+=TAB_SQL.WARP;
      sum_umop+=TAB_SQL.UMOP;
      sum_netp+=TAB_SQL.NETP;

      sum_warf+=TAB_SQL.WARF;
      sum_umof+=TAB_SQL.UMOF;
      sum_netf+=TAB_SQL.NETF;

      sum_amp+=TAB_SQL.AM_POD;
      sum_amf+=TAB_SQL.AM_FIN;

      {? TAB_SQL.AKTYWNY<>'N'
      || sum_ampa+=TAB_SQL.ACT_AMP;
         sum_amfa+=TAB_SQL.ACT_AMF
      ?};
      sum_ulga+=0;

      sum_pamp+=TAB_SQL.PNETP;
      sum_pamf+=TAB_SQL.PNETF;

      g_warp+=TAB_SQL.WARP; g_umop+=TAB_SQL.UMOP; g_netp+=TAB_SQL.NETP;
      g_warf+=TAB_SQL.WARF; g_umof+=TAB_SQL.UMOF; g_netf+=TAB_SQL.NETF;
      g_amp+=TAB_SQL.AM_POD; g_amf+=TAB_SQL.AM_FIN;
      {? TAB_SQL.AKTYWNY<>'N'
      || g_ampa+=TAB_SQL.ACT_AMP; g_amfa+=TAB_SQL.ACT_AMF
      ?};
      g_ulga+=0;
      g_podamp+=TAB_SQL.PNETP;
      g_podamf+=TAB_SQL.PNETF;

      sg_warp+=TAB_SQL.WARP; sg_umop+=TAB_SQL.UMOP; sg_netp+=TAB_SQL.NETP;
      sg_warf+=TAB_SQL.WARF; sg_umof+=TAB_SQL.UMOF; sg_netf+=TAB_SQL.NETF;
      sg_amp+=TAB_SQL.AM_POD; sg_amf+=TAB_SQL.AM_FIN;
      {? TAB_SQL.AKTYWNY <> 'N'
      || sg_ampa+=TAB_SQL.ACT_AMP; sg_amfa+=TAB_SQL.ACT_AMF
      ?};
      sg_ulga+=0;
      sgpodamp+=TAB_SQL.PNETP;
      sgpodamf+=TAB_SQL.PNETF;

      {? FINFO.TOR_D='T'
      ||
         sum_ward+=TAB_SQL.WARD;
         sum_umod+=TAB_SQL.UMOD;
         sum_netd+=TAB_SQL.NETD;
         sum_amd+=TAB_SQL.AM_DOD;
         {? TAB_SQL.AKTYWNY<>'N'
         || sum_amda+=TAB_SQL.ACT_AMD
         ?};
         sum_pamd+=TAB_SQL.PNETD;
         g_ward+=TAB_SQL.WARD; g_umod+=TAB_SQL.UMOD; g_netd+=TAB_SQL.NETD;
         g_amd+=TAB_SQL.AM_DOD;
         {? TAB_SQL.AKTYWNY<>'N'
         || g_amda+=TAB_SQL.ACT_AMD
         ?};

         g_podamd+=TAB_SQL.PNETD;
         sg_ward+=TAB_SQL.WARD; sg_umod+=TAB_SQL.UMOD; sg_netd+=TAB_SQL.NETD;
         sg_amd+=TAB_SQL.AM_DOD;
         {? TAB_SQL.AKTYWNY <> 'N'
         || sg_amda+=TAB_SQL.ACT_AMD
         ?};
         sgpodamd+=TAB_SQL.PNETD
      ?}
   ||
      sum_warp+=TAB_SQL.SUM_WARP;
      sum_umop+=TAB_SQL.SUM_UMOP;
      sum_netp+=TAB_SQL.SUM_NETP;
      sum_warf+=TAB_SQL.SUM_WARF;
      sum_umof+=TAB_SQL.SUM_UMOF;
      sum_netf+=TAB_SQL.SUM_NETF;
      sum_amp+=TAB_SQL.SUM_AMP;
      sum_amf+=TAB_SQL.SUM_AMF;
      sum_ampa+=TAB_SQL.SUM_AMPA;
      sum_amfa+=TAB_SQL.SUM_AMFA;
      sum_ulga+=TAB_SQL.SUM_ULGA;
      sum_pamp+=TAB_SQL.SUM_PNEP;
      sum_pamf+=TAB_SQL.SUM_PNEF;

      sg_warp+=TAB_SQL.SUM_WARP;
      sg_umop+=TAB_SQL.SUM_UMOP;
      sg_netp+=TAB_SQL.SUM_NETP;
      sg_warf+=TAB_SQL.SUM_WARF;
      sg_umof+=TAB_SQL.SUM_UMOF;
      sg_netf+=TAB_SQL.SUM_NETF;
      sg_amp+=TAB_SQL.SUM_AMP;
      sg_amf+=TAB_SQL.SUM_AMF;
      sg_ampa+=TAB_SQL.SUM_AMPA;
      sg_amfa+=TAB_SQL.SUM_AMFA;
      sg_ulga+=0;
      sgpodamp+=TAB_SQL.SUM_PNEP;
      sgpodamf+=TAB_SQL.SUM_PNEF;

      {? FINFO.TOR_D='T'
      ||
         sum_ward+=TAB_SQL.SUM_WARD;
         sum_umod+=TAB_SQL.SUM_UMOD;
         sum_netd+=TAB_SQL.SUM_NETD;

         sum_amd+=TAB_SQL.SUM_AMD;
         sum_amda+=TAB_SQL.SUM_AMDA;
         sum_pamd+=TAB_SQL.SUM_PNED;

         sg_ward+=TAB_SQL.SUM_WARD;
         sg_umod+=TAB_SQL.SUM_UMOD;
         sg_netd+=TAB_SQL.SUM_NETD;

         sg_amd+=TAB_SQL.SUM_AMD;
         sg_amda+=TAB_SQL.SUM_AMDA;
         sgpodamd+=TAB_SQL.SUM_PNED
      ?};

      {? PAR_WYDR.PODSUM=1
      || c[1]:='Razem grupa: '@ +{? PAR_WYDR.PR_GR || TAB_SQL.GRUPA+' - '+TAB_SQL.NGS ||  TAB_SQL.GR ?}+{? PAR_WYDR.WAR_GR=2 || '(w wybranym zakresie) '@ || '' ?}
      |? PAR_WYDR.PODSUM=2
      || c[1]:='Jedn. księg.'@ + TAB_SQL.ODDZIAL + ' razem:'@
      |? PAR_WYDR.PODSUM=3
      || c[1]:= TAB_SQL.TYPSROD + ' razem:'@
      |? PAR_WYDR.PODSUM=4
      || c[1]:='Jedn. organ. '@ + TAB_SQL.JORG+' ('+ TAB_SQL.ODDZIAL+') razem:'@
      ?};

      c[10]:=TAB_SQL.SUM_WARP;
      c[11]:=TAB_SQL.SUM_UMOP;
      c[12]:=TAB_SQL.SUM_NETP;
      c[13]:=TAB_SQL.SUM_AMPA;
      c[14]:=TAB_SQL.SUM_AMP;
      c[15]:=TAB_SQL.SUM_ULGA;
      c[16]:=TAB_SQL.SUM_PNEP;
      c[25]:=TAB_SQL.SUM_WARF;
      c[27]:=TAB_SQL.SUM_UMOF;
      c[29]:=TAB_SQL.SUM_NETF;
      c[33]:= TAB_SQL.SUM_AMFA;
      c[35]:= TAB_SQL.SUM_AMF;
      c[31]:=TAB_SQL.SUM_PNEF
   ?}
 ;~~}
{IF: lineleft() <=4 & lineleft()<>0}{PAGE}{FI}
{
{? vp || prn1:='PRN'; prn2:='PRN'?} ;~~}{SUBSTITUTE: 'LINIA02'}
{prn1:='PRN'; prn2:='PRN';~~}


{FI}
  {rsep:=PAR_WYDR.RSEP;~~}
 {
   {? PAR_WYDR.RODZAJ=1
   || {? PAR_WYDR.PODSUM=1
      || sum_grupa:=TAB_SQL.GR
      |? PAR_WYDR.PODSUM=2
      || sum_grupa:=TAB_SQL.ODDZIAL
      |? PAR_WYDR.PODSUM=3
      || sum_grupa:=TAB_SQL.TYPSROD
      |? PAR_WYDR.PODSUM=4
      || sum_grupa:=TAB_SQL.JORG+' ('+TAB_SQL.ODDZIAL+')';
         ssum_grupa:=TAB_SQL.ODDZIAL
      ?}
   || {? PAR_WYDR.PODSUM=4
      || ssum_grupa:=TAB_SQL.ODDZIAL
      ?}
   ?}
 ;~~}
 {OD}
{COMMENT} ---- podsumowanie czastkowe za ostatnim rekordem tabeli TAB_SQL ---- {COMMENT-}
  {COMMENT} ---- Podsumowania nie występują dla excel ---- {COMMENT-}
{IF: ~rep_export()}
  {IF: PAR_WYDR.RODZAJ=1}
  {
   {? PAR_WYDR.PODSUM=1
   || d[1]:='Razem grupa: '@ + sum_grupa + {? PAR_WYDR.WAR_GR=2 || '(w wybranym zakresie) '@ || '' ?}
   |? PAR_WYDR.PODSUM=2
   || d[1]:='Jedn. księg. '@ + sum_grupa + ' razem:'@
   |? PAR_WYDR.PODSUM=3
   || d[1]:=sum_grupa + ' razem:'@
   |? PAR_WYDR.PODSUM=4
   || d[1]:='Jedn. organ. '@ + sum_grupa + ' razem:'@
   ?};
   d[2]:=''; d[3]:=''; d[4]:=''; d[5]:='';  d[6]:=''; d[7]:=''; d[8]:=''; d[9]:='';
   d[10]:= g_warp; d[11]:=g_umop; d[12]:=g_netp; d[13]:=g_ampa; d[14]:=g_amp;
   d[15]:=g_ulga; d[16]:=g_podamp;
   prn1:='PRN'; prn2:='PRNF'; rsep:=1
  ;~~}
  {IF: lineleft() <=4 & lineleft()<>0}{PAGE}{FI}
  {FONT: 'T8GB'}{SPACE: 'C'}{SUBSTITUTE: 'LINIA02'}
{COMMENT} ---- druga linia podsumowania ---- {COMMENT-}
  {
   d[1]:=''; d[2]:=''; d[3]:=''; d[4]:=''; d[5]:=''; d[6]:=''; d[7]:=''; d[8]:=''; d[9]:='';
   d[10]:=g_warf; d[11]:=g_umof; d[12]:=g_netf; d[13]:=g_amfa; d[14]:=g_amf;
   d[15]:=''; d[16]:=g_podamf;
   rsep:=0;"vp:=0";
   prn1:='PRN'; prn2:='PRNF'
   ;~~}
  {SUBSTITUTE: 'LINIA02'}
{COMMENT} ---- Trzecia linia podsumowania ---- {COMMENT-}
  {IF: FINFO.TOR_D='T'}
  {
   d[1]:=''; d[2]:=''; d[3]:=''; d[4]:=''; d[5]:=''; d[6]:=''; d[7]:=''; d[8]:=''; d[9]:='';
   d[10]:=g_ward; d[11]:=g_umod; d[12]:=g_netd; d[13]:=g_amda; d[14]:=g_amd;
   d[15]:=''; d[16]:=g_podamd;
   rsep:=0;"vp:=0";
   prn1:='PRNF'; prn2:='PRNF'
   ;~~}
  {SUBSTITUTE: 'LINIA02'}
  {FI}
  {rsep:=PAR_WYDR.RSEP;~~}
  {FONT: 'T8G'}{SPACE: 'C'}
 {FI}
 {FI}
 {COMMENT} ---- Super podsumowanie cząstkowe jedn. ks. jesli PAR_WYD.PODSUM=4 ---- {COMMENT-}
 {COMMENT} ---- Podsumowania nie występują dla excel ---- {COMMENT-}
{IF: ~rep_export()}
{IF: PAR_WYDR.PODSUM=4}
{
   d[1]:='Jed. ks. '@ + ssum_grupa + ' razem:'@;
   d[2]:=''; d[3]:=''; d[4]:=''; d[5]:=''; d[6]:=''; d[7]:=''; d[8]:=''; d[9]:='';
   d[10]:=sg_warp; d[11]:= sg_umop; d[12]:= sg_netp; d[13]:=sg_ampa; d[14]:=sg_amp;
   d[15]:=sg_ulga; d[16]:=sgpodamp;
   prn1:='PRNF'; prn2:='PRNF';
   rsep:=1;"vp:=0"
  ;~~}
  {FONT: 'T8GB'}{SPACE: 'C'}{IF: lineleft()<=4 & lineleft()<>0}{PAGE}{FI}{SUBSTITUTE: 'LINIA02'}
  {
   d[1]:=''; d[2]:=''; d[3]:=''; d[4]:=''; d[5]:=''; d[6]:=''; d[7]:=''; d[8]:=''; d[9]:='';
   d[10]:=sg_warf; d[11]:=sg_umof; d[12]:=sg_netf; d[13]:=sg_amfa; d[14]:=sg_amf;
   d[15]:=''; d[16]:=sgpodamf;
   "vp:=0";
   rsep:=0;
   prn1:='PRNF'; prn2:='PRNF'
   ;~~}
   {SUBSTITUTE: 'LINIA02'}
   {IF: FINFO.TOR_D='T'}
   {
   d[1]:=''; d[2]:=''; d[3]:=''; d[4]:=''; d[5]:=''; d[6]:=''; d[7]:=''; d[8]:=''; d[9]:='';
   d[10]:=sg_ward; d[11]:=sg_umod; d[12]:=sg_netd; d[13]:=sg_amda; d[14]:=sg_amd;
   d[15]:=''; d[16]:=sgpodamd;
   "vp:=0";
   rsep:=0;
   prn1:='PRNF'; prn2:='PRNF'
   ;~~}
   {SUBSTITUTE: 'LINIA02'}
   {FI}
  {rsep:=1;
  prn1:='PRNF'; prn2:='PRN'
  ;~~}
  {FONT: 'T8G'}{SPACE: 'C'}
{FI}
{COMMENT}------------------------------FOOTER-LAST------------------{COMMENT-}
{IF: lineleft()<>0 & lineleft()<6}{PAGE}{FI}
{FOOTER}{FOOTER-}
{FONT: 'T8GB'}{SPACE: 'C'}
{
   d[1]:='Ogółem: '@;
   d[10]:=sum_warp;
   d[11]:=sum_umop;
   d[12]:=sum_netp;
   d[13]:=sum_ampa;
   d[14]:=sum_amp;
   d[15]:=sum_ulga;
   d[16]:=sum_pamp;
   prn1:='PRNF';prn2:='PRNF'; rsep:=1
;~~}
{SUBSTITUTE: 'LINIA02'}
{
   d[1]:='';
   d[10]:=sum_warf;
   d[11]:=sum_umof;
   d[12]:=sum_netf;
   d[13]:=sum_amfa;
   d[14]:=sum_amf;
   d[15]:='';
   d[16]:=sum_pamf;
   prn1:='PRNF';prn2:='PRNF';
   "vp:=0";
   rsep:=0
;~~}
{SUBSTITUTE: 'LINIA02'}
{IF: FINFO.TOR_D='T'}
{
   d[1]:='';
   d[10]:=sum_ward;
   d[11]:=sum_umod;
   d[12]:=sum_netd;
   d[13]:=sum_amda;
   d[14]:=sum_amd;
   d[15]:='';
   d[16]:=sum_pamd;
   prn1:='PRNF';prn2:='PRNF';
   "vp:=0";
   rsep:=0
;~~}
{SUBSTITUTE: 'LINIA02'}
{FI}
{FI}
{ vp:=0; ~~}
{REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}