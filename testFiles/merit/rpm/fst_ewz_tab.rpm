:!UTF-8
{TITLE: Tabela planów amortyzacji}
{PRINTER: FINFO.SZ_PRN,,,,,'M','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   VAR_DEL.delete('PRN','c');
   PRN:=obj_new(@.CLASS.PRINT,17); PRN.sl_frame();
   c:=obj_new(17);
   {! _i:=1..17 |! c[_i] := '' !};
   i:=0;
   color:=prn1:=prn2:='';
   lm:=ll:=vp:=lmt:=rsep:=0;
   par1:=0; par2:=0; par3:=0; par4:=0; par5:=0
}
{END:
   VAR_DEL.delete('PRN','c');
   &i; &color; &prn1; &prn2;
   &lm; &ll; &vp; &lmt; &rsep;
   &par1; &par2; &par3;&par4;&par5
}
{EXIT:
   exec('set_var','param_wydr');
   {? OPERATOR.DEPT<>null
      || PAR_WYDR.ODD:=OPERATOR.DEPT
      || PAR_WYDR.ODD:=0
   ?};
   0
}
{COMMENT}
========================================================================================================================
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
Nazwa pliku: fst_ewz_tab.rpm
Utworzony  : 2016-02-27
Zawartość  : Tabela planów amortyzacji
========================================================================================================================
{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{COMMENT}--Definicja wiersza wydruku--------------------{COMMENT-}
{  prn1:='PRN'; prn2:='PRN'; ~~}
{
      PRN.add("{? type_of(c[1]) = 1 || form(c[1],,2,' ,') || c[1] ?}",18,'Nr inwentarzowy',,'#');
      PRN.add("{? type_of(c[2]) = 1 || form(c[2],,2,' ,') || c[2] ?}",20,'Nazwa',,' ');
      PRN.add("{? type_of(c[3]) = 1 || form(c[3],,2,' ,') || c[3] ?}",12,'J. księgowa',,'#');
      PRN.add("{? type_of(c[4]) = 1 || form(c[4],,2,' ,') || c[4] ?}",6,'Rok',,'#');
      PRN.add("{? type_of(c[5]) = 1 || form(c[5],,2,' ,') || c[5] ?}",10,'01',1,'#');
      PRN.add("{? type_of(c[6]) = 1 || form(c[6],,2,' ,') || c[6] ?}",10,'02',1,'#');
      PRN.add("{? type_of(c[7]) = 1 || form(c[7],,2,' ,') || c[7] ?}",10,'03',1,'#');
      PRN.add("{? type_of(c[8]) = 1 || form(c[8],,2,' ,') || c[8] ?}",10,'04',1,'#');
      PRN.add("{? type_of(c[9]) = 1 || form(c[9],,2,' ,') || c[9] ?}",10,'05',1,'#');
      PRN.add("{? type_of(c[10]) = 1 || form(c[10],,2,' ,') || c[10] ?}",10,'06',1,'#');
      PRN.add("{? type_of(c[11]) = 1 || form(c[11],,2,' ,') || c[11] ?}",10,'07',1,'#');
      PRN.add("{? type_of(c[12]) = 1 || form(c[12],,2,' ,') || c[12] ?}",10,'08',1,'#');
      PRN.add("{? type_of(c[13]) = 1 || form(c[13],,2,' ,') || c[13] ?}",10,'09',1,'#');
      PRN.add("{? type_of(c[14]) = 1 || form(c[14],,2,' ,') || c[14] ?}",10,'10',1,'#');
      PRN.add("{? type_of(c[15]) = 1 || form(c[15],,2,' ,') || c[15] ?}",10,'11',1,'#');
      PRN.add("{? type_of(c[16]) = 1 || form(c[16],,2,' ,') || c[16] ?}",10,'12',1,'#');
      PRN.add("{? type_of(c[17]) = 1 || form(c[17],,2,' ,') || c[17] ?}",10,'Razem',1,'#');

      PAR_WYDR.TITLE:='Tabela planu amortyzacji '+SRSP.NAZWA; ~~}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{COMMENT}------------------------------Parametry wydruku------------{COMMENT-}
{FONT: 'W8'}{SPACE: 'C'}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{ rsep:=1; ~~}
{prn1:='PRN';~~}
{FOR: __tb}
 {INDEX: __idx_tb}
 {DO}
{COMMENT} ---- zwykłe wiersze ---- {COMMENT-}
 {
      c[1]:=__tb.NRI2;
      c[2]:=__tb.NST2;
      c[3]:=__tb.ODD2;
      c[4]:=__tb.ROK;
      c[5]:=__tb.AM_01;
      c[6]:=__tb.AM_02;
      c[7]:=__tb.AM_03;
      c[8]:=__tb.AM_04;
      c[9]:=__tb.AM_05;
      c[10]:=__tb.AM_06;
      c[11]:=__tb.AM_07;
      c[12]:=__tb.AM_08;
      c[13]:=__tb.AM_09;
      c[14]:=__tb.AM_10;
      c[15]:=__tb.AM_11;
      c[16]:=__tb.AM_12;
      c[17]:=__tb.RAZEM
 ;~~}
  {IF: lineleft() <> 0 & lineleft() <=4}{PAGE}{FI}
  {IF: c[1]<>''}{FONT: 'T8GB'}{SPACE: 'C'}{ELSE}{FONT: 'T8G'}{SPACE: 'C'}{FI}
  {SUBSTITUTE: 'LINIA0'}
  {FONT: 'T8G'}{SPACE: 'C'}
  {rsep:=PAR_WYDR.RSEP;~~}
 {OD}
{COMMENT}------------------------------FOOTER-LAST------------------{COMMENT-}
{FOOTER}{FOOTER-}
{REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}