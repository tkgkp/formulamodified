:!UTF-8
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzezone
==============================================================================
Nazwa pliku: wsp_pw.rpi
  Utworzony: 2001-09-04 [AMA]
==============================================================================
Zawartosc: Moduł pomocniczy do sporządzania wydruków
           zgodnych z OWwSK003_aneks1.
{COMMENT-}
{  _v:=$int((100-PAR_WYDR.SHAD)*2.55);
   color:=_v+':'+_v+':'+_v; ~~}
{INCLUDE: wsp_pw1.rpi}
{COMMENT}------------------------------MACRO-LINIA0-----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania rekordu z linią poprzedzającą
dla wydruków z obiektem PRINTER o nazwie przekazywanej przez zmienną prn1.
{COMMENT-}
{MACRO: 'LINIA0'}
{  ll:=lineleft(); ~~}
{IF:  params_set(params_get());
      _f:='params_set(params_get()); '+prn1+'.ini_line()'; _v:=($(_f))();
      _f:=prn1+'.length()'; _v:=($(_f))();
      ll<(rsep+_v) & ll<>0}{PAGE}{FI}
{ENTIRE}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}{ vp:=0; ~~}
{ELSE}
   {IF: PAR_WYDR.RSEP & rsep}
      {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   {ELIF: rsep}
      {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   {FI}
{FI}
{WHILE: _f:=prn1+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.fline(lmt)'; ($(_f))()}
{OD}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{ENTIRE-}
{MACRO-}
{COMMENT}------------------------------MACRO-LINIA0I-----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania rekordu z linią poprzedzającą
dla wydruków z obiektem PRINTER o nazwie przekazywanej przez zmienną prn1.
BEZ ENTIRE
{COMMENT-}
{MACRO: 'LINIA0I'}
{  ll:=lineleft(); ~~}
{IF:  params_set(params_get());
      _f:='params_set(params_get()); '+prn1+'.ini_line()'; _v:=($(_f))();
      _f:=prn1+'.length()'; _v:=($(_f))();
      ll<(rsep+_v) & ll<>0}{PAGE}{FI}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}{ vp:=0; ~~}
{ELSE}
   {IF: PAR_WYDR.RSEP & rsep}
      {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   {ELIF: rsep}
      {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   {FI}
{FI}
{WHILE: _f:=prn1+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.fline(lmt)'; ($(_f))()}
{OD}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{MACRO-}
{COMMENT}------------------------------MACRO-LINIA02----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania rekordu z linią poprzedzającą
dla wydruków z obiektem PRINTER o nazwie przekazywanej przez zmienną prn1
i drugiego o nazwie przekazywanej przez zmienną prn2. Linia separatora
drukowana jest jako linia przejściowa między obiektem prn1 i prn2.
{COMMENT-}
{MACRO: 'LINIA02'}
{  ll:=lineleft(); ~~}
{IF:  params_set(params_get());
      _f:='params_set(params_get()); '+prn2+'.ini_line()'; _v:=($(_f))();
      _f:=prn2+'.length()'; _v:=($(_f))();
      ll<(rsep+_v) & ll<>0}{PAGE}{FI}
{ENTIRE}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}{ vp:=0; ~~}
{ELSE}
   {IF: PAR_WYDR.RSEP & rsep}
      {REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
   {ELIF: rsep}
      {REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
   {FI}
{FI}
{WHILE: _f:=prn2+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn2+'.fline(lmt)'; ($(_f))()}
{OD}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{ENTIRE-}
{MACRO-}
{COMMENT}------------------------------MACRO-LINIA02I----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania rekordu z linią poprzedzającą
dla wydruków z obiektem PRINTER o nazwie przekazywanej przez zmienną prn1
i drugiego o nazwie przekazywanej przez zmienną prn2. Linia separatora
drukowana jest jako linia przejściowa między obiektem prn1 i prn2.
{COMMENT-}
{MACRO: 'LINIA02I'}
{  ll:=lineleft(); ~~}
{IF:  params_set(params_get());
      _f:='params_set(params_get()); '+prn2+'.ini_line()'; _v:=($(_f))();
      _f:=prn2+'.length()'; _v:=($(_f))();
      ll<(rsep+_v) & ll<>0}{PAGE}{FI}
{ENTIRE}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}{ vp:=0; ~~}
{FI}
{WHILE: _f:=prn2+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn2+'.fline(lmt)'; ($(_f))()}
{OD}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{ENTIRE-}
{MACRO-}
{COMMENT}------------------------------MACRO-LINIA03I-----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania rekordu z linią poprzedzającą
dla wydruków z obiektem PRINTER o nazwie przekazywanej przez zmienną prn1.
BEZ ENTIRE
{COMMENT-}
{MACRO: 'LINIA03I'}
{  ll:=lineleft(); ~~}
{IF:  params_set(params_get());
      _f:='params_set(params_get()); '+prn1+'.ini_line()'; _v:=($(_f))();
      _f:=prn1+'.length()'; _v:=($(_f))();
      ll<(rsep+_v) & ll<>0}{PAGE}{FI}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}{ vp:=0; ~~}
{ELSE}
   {IF: PAR_WYDR.RSEP & rsep}
      {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   {ELIF: rsep}
      {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   {FI}
{FI}
{WHILE: _f:=prn1+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.fline(lmt)'; ($(_f))()}
{OD}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{MACRO-}
{COMMENT}------------------------------MACRO-LINIAF-----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania stopki z linią domykającą tabelę
dla wydruków z jednym tylko obiektem PRINTER.
{COMMENT-}
{MACRO: 'LINIAF'}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}
{ELSE}
   {REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}
{FI}
{ vp:=1; ~~}
{MACRO-}
{COMMENT}------------------------------MACRO-LINIAFS----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania stopki z linią poprzedzającą
dla wydruków z jednym obiektem PRINTER o nazwie przekazywanej przez zmienna
prn1 dla tabeli i jednym obiektem o nazwie przekazywanej przez zmienna prn2
dla stopki; z wierszem podsumowania w stopce.
{COMMENT-}
{MACRO: 'LINIAFS'}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}
{ELSE}
   {REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
{FI}
{ params_set(params_get()); _f:='params_set(params_get()); '+prn2+'.ini_line()'; ($(_f))()}
{WHILE: _f:=prn2+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn2+'.fline(lmt)'; ($(_f))()}
{OD}
{REP: _f:=prn2+'.flbar(lmt)'; ($(_f))()}
{ vp:=1; ~~}
{MACRO-}
{COMMENT}------------------------------MACRO-LINIAFSI----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania stopki z linią poprzedzającą
dla wydruków z jednym obiektem PRINTER o nazwie przekazywanej przez zmienna
prn1 dla tabeli i jednym obiektem o nazwie przekazywanej przez zmienna prn2
dla stopki; z wierszem podsumowania w stopce.
{COMMENT-}
{MACRO: 'LINIAFSI'}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}
{FI}
{ params_set(params_get()); _f:='params_set(params_get()); '+prn2+'.ini_line()'; ($(_f))()}
{WHILE: _f:=prn2+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn2+'.fline(lmt)'; ($(_f))()}
{OD}
{REP: _f:=prn2+'.flbar(lmt)'; ($(_f))()}
{ vp:=1; ~~}
{MACRO-}
{COMMENT}------------------------------MACRO-TABHEAD----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania nagłówka tabeli (np. w nagłówku strony)
dla tabeli obiektu PRINTER o nazwie przekazywanej przez zmienna prn1.
{COMMENT-}
{MACRO: 'TABHEAD'}
{ _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
{ _f:=prn1+'.ini_head()'; ($(_f))()}
{REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}
{WHILE: _f:=prn1+'.h_next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.h_fmline(lmt)'; ($(_f))()}
{OD}
{MACRO-}
{COMMENT}------------------------------MACRO-LINIAFS2----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania stopki z linią poprzedzającą
dla wydruków z jednym obiektem PRINTER o nazwie przekazywanej przez zmienna
prn1 dla tabeli i dwoma obiektami o nazwie przekazywanej przez zmienna prn2 i prn3
dla stopki; z wierszem podsumowania w stopce.
{COMMENT-}
{MACRO: 'LINIAFS2'}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}
{ELSE}
   {REP: _f:=prn1+'.fjbar('+prn2+',lmt)'; ($(_f))()}
   { params_set(params_get()); _f:='params_set(params_get()); '+prn2+'.ini_line()'; ($(_f))()}
   {WHILE: _f:=prn2+'.next()'; ($(_f))()}
   {DO}
      {REP: _f:=prn2+'.fline(lmt)'; ($(_f))()}
   {OD}
   {REP: _f:=prn2+'.fjbar('+prn3+',lmt)'; ($(_f))()}
   { params_set(params_get()); _f:='params_set(params_get()); '+prn3+'.ini_line()'; ($(_f))()}
   {WHILE: _f:=prn3+'.next()'; ($(_f))()}
   {DO}
      {REP: _f:=prn3+'.fline(lmt)'; ($(_f))()}
   {OD}
   {REP: _f:=prn3+'.flbar(lmt)'; ($(_f))()}
{FI}
{ vp:=1; ~~}
{MACRO-}
{MACRO: 'LINIA01'}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}
{ELSE}
   {REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}
{FI}
{  ll:=lineleft();vp:=0; ~~}
{IF: params_set(params_get());
     _f:='params_set(params_get()); '+prn1+'.ini_line()'; _v:=($(_f))();
     _f:=prn1+'.length()'; _v:=($(_f))();
      ll<(2+_v) & ll<>0}{PAGE}{FI}
{ENTIRE}
{WHILE: _f:=prn1+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.fline(lmt)'; ($(_f))()}
{OD}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{ENTIRE-}
{MACRO-}
{MACRO: 'LINIAH'}
{COMMENT}{REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}{COMMENT-}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   { params_set(params_get()); _f:='params_set(params_get()); '+prn1+'.ini_line()'; ($(_f))()}
   {REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}
{ELSE}
   { params_set(params_get()); _f:='params_set(params_get()); '+prn1+'.ini_line()'; ($(_f))()}
   {REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}
{FI}
{vp:=0; ~~}
{MACRO-}
{MACRO: 'LINIA0H'}
{  ll:=lineleft(); ~~}
{IF:  params_set(params_get());
      _f:='params_set(params_get()); '+prn1+'.ini_line()'; _v:=($(_f))();
      _f:=prn1+'.length()'; _v:=($(_f))();
      ll<(rsep+_v) & ll<>0}{PAGE}{FI}
{ENTIRE}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
{ELSE}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}
{FI}
{IF: PAR_WYDR.RSEP & rsep}
   {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
{ELIF: rsep}
   {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
{FI}
{WHILE: _f:=prn1+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.fline(lmt)'; ($(_f))()}
{OD}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{ENTIRE-}
{MACRO-}
{MACRO: 'LINIA01H'}
{ _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
{REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}
{  ll:=lineleft();vp:=0; ~~}
{IF: params_set(params_get());
     _f:='params_set(params_get()); '+prn1+'.ini_line()'; _v:=($(_f))();
     _f:=prn1+'.length()'; _v:=($(_f))();
      ll<(2+_v) & ll<>0}{PAGE}{FI}
{ENTIRE}
{WHILE: _f:=prn1+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.fline(lmt)'; ($(_f))()}
{OD}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{ENTIRE-}
{MACRO-}
{COMMENT}------------------------------MACRO-CELL-----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania kolorowych harmonogramów, gdzie oczka tabelki mają różne kolory
Najpierw drukuje wiersz, a dopiero później linię oddzielającą wiersze
Ostatnią linią w dziedzinie należy sobie posterować zmienną rsep
{COMMENT-}
{MACRO: 'CELL'}
{  ll:=lineleft(); ~~}
{IF:  params_set(params_get());
      _f:='params_set(params_get()); '+prn1+'.ini_line()'; _v:=($(_f))();
      _f:=prn1+'.length()'; _v:=($(_f))();
      ll<(rsep+_v) & ll<>0}{PAGE}{FI}
{ENTIRE}
{IF: vp}
   { _f:=prn1+'.setcolor(color)'; ($(_f))(); ~~}
   {REP: _f:=prn1+'.fbar(lmt)'; ($(_f))()}
   { _f:=prn1+'.setcolor(''255:255:255'')'; ($(_f))(); ~~}{ vp:=0; ~~}
{FI}
{WHILE: _f:=prn1+'.next()'; ($(_f))()}
{DO}
   {REP: _f:=prn1+'.fline(lmt)'; ($(_f))()}
{OD}
   {IF: rsep}
      {REP: _f:=prn1+'.fcbar(lmt)'; ($(_f))()}
   {FI}
{IF: var_pres('fun')>=0 & fun<>''}
{  $fun(); ~~}
{FI}
{ENTIRE-}
{MACRO-}
{COMMENT}------------------------------MACRO-LINIA0X-----------------{COMMENT-}
{COMMENT}
Makro używane do drukowania pustego rekordu z kontynyacją koloru.
{COMMENT-}
{MACRO: 'LINIA0X'}
{ENTIRE}
{REP: _f:=prn1+'.fline(lmt)'; ($(_f))()}
{ENTIRE-}
{MACRO-}