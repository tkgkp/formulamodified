:!UTF-8
{COMMENT}OLD: okrrozl.rpi{COMMENT-}
{COMMENT}OLD: skid_pw.rpi{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{HEADER}
   {FONT: 'HEAD'}
   {SPACE: 'B'}
   { lmt:=charleft(); ~~ }
   {SUBSTITUTE: 'HEAD'}
   {LINE:3}
{HEADER-}
{FOR: __CALL}
{DO}
   {  PAR_WYDR.TITLE:='Rozliczenie okresu: %1 \nod %2 do %3'@[__CALL.OKR_NAZ,__CALL.OKR_OD,__CALL.OKR_DO]; ~~}
   {SPACE: 'A'}
   {FONT: 'W12'}
   {  lmt:=charleft();
      Text:=
         {? __CALL.PLEC='K'
         || 'Rozliczenie czasu pracy dla Pani'
         || 'Rozliczenie czasu pracy dla Pana'
         ?}+' '+__CALL.NAZWISKO+' '+__CALL.IMIE+{? +form(__CALL.DRUGIEIM) || ' '+__CALL.DRUGIEIM || '' ?}+'.';
      STR.split(Text); ~~
   }
   {JUSTIFY}
   {WHILE: +(Text:=STR.line(charleft()))}{DO}
   {REP: {? +STR.spl_str
         || '{<1>{charleft()}'
         || '{CENTER}{'
      ?}+'Text}'
   }{OD}

   {<5'Wymiar czasu pracy dla całego etatu:'@} {>70__CALL.OKR_WYM}
   {<5'Wymiar czasu pracy pracownika:'@}       {>70__CALL.ROZ_NORM}
   {<5'Czas przepracowany, w tym:'@}           {>70__CALL.ROZ_PRZE}
   {<10'czas pracy:'@}                         {>70__CALL.SZ_PRACA}
   {<10'nieobecności usprawiedliwione:'@}      {>70__CALL.SZ_NIEO}
   {<10'czas pracy ponad normę, w tym:'@}      {>70__CALL.SZ_NADM}
   {<15'nadgodziny 50\%:'@}                    {>70__CALL.SZ_50}
   {<15'nadgodziny 100\%:'@}                   {>70__CALL.SZ_100}
   {<5'Nieobecności nieusprawiedliwione:'@}    {>70__CALL.ROZ_NIEO}

   {IF: __CALL.ROZ_NN='N'}
      {<5'Nadmiarowy czas pracy wynikający z rozliczenia okresu:'@} {__CALL.ROZ_NADM}
   {ELIF: __CALL.ROZ_NN='A'}
      {<5'Niedopracowany czas pracy wynikający z rozliczenia okresu:'@} {__CALL.ROZ_NIED}
   {FI}

   {IF: __CALL.SZ_JOD='1'}
      {<5'Odbiory godzin w okresie rozliczeniowym:'@}
      {  {? var_pres('Temp')=type_of(SYSLOG) || obj_del(Temp) ?};
         Temp:=proc_exe('rozodb@okres',__CALL.PRACOWN,__CALL.OKR_OD1,__CALL.OKR_DO1);
         {? Temp.first() || Temp.del() ?}; ~~
      }
      {FONT: 'T8'}
      {SPACE: 'B'}
      { lmt:=int((charleft()-par.width())/2); ~~}
      {SUBSTITUTE: 'TABHEAD'}
      {FOR: Temp}
      {DO}
         {SUBSTITUTE: 'LINIA0'}
      {OD}
      {SUBSTITUTE: 'LINIAF'}
      { {? var_pres('Temp')=type_of(SYSLOG) || obj_del(Temp) ?}; ~~}
   {FI}
   {PAGE}
{OD}