:!UTF-8
{
  pre:=REF.WFIRM & exec('czy_tab_glob','#table','SLO_OSOB')=0;
  kl:=4;
  kolu[1]:=10;
  kolu[2]:=53;
  kolu[3]:=13;
  kolu[4]:=19;
  il:=kolu[1]+kolu[2]+kolu[3]+kolu[4]+kl+1;
  p[1]:=2+kolu[1];
   {!_a:=2 ..kl
   |! p[_a]:=1+p[_a-1]+kolu[_a]
   !};   ~~
}
{MACRO: 'LINIA1'}
┌{kolu[1]*'─'}┬{kolu[2]*'─'}┬{kolu[3]*'─'}┬{kolu[4]*'─'}┐
{MACRO-}
{MACRO: 'LINIA2'}
├{kolu[1]*'─'}┼{kolu[2]*'─'}┼{kolu[3]*'─'}┼{kolu[4]*'─'}┤
{MACRO-}
{MACRO: 'LINIA3'}
└{kolu[1]*'─'}┴{kolu[2]*'─'}┴{kolu[3]*'─'}┴{kolu[4]*'─'}┘
{MACRO-}
{COMMENT}------------------------------------------------------------------{COMMENT-}
{HEADER}
{PAR_WYDR.TITLE:='Słownik użytkownika - %1'@[SLU.NAZ];~~}{SUBSTITUTE: 'CHARHEAD'}{FONT: 'R'}
{LINE: 1}{SPACE: 'C'}
{SUBSTITUTE: 'LINIA1'}
{<1'│'}{<1>{p[1]}'Kod'@}{<{p[1]}'│'}{<{p[1]}>{p[2]}'Imię i nazwisko'@}{<{p[2]}'│'}{<{p[2]}>{p[3]}'Pesel'@}{<{p[3]}'│'}{<{p[3]}>{p[4]}'Jednostka księgowa'@}{<{p[4]}'│'}
{SUBSTITUTE: 'LINIA2'}
{HEADER-}
{COMMENT}------------------------------------------------------------------{COMMENT-}
{FOOTER:0}
{FONT: 'Q'}{SPACE: 'C'}{SUBSTITUTE: 'LINIA3'}
{SUBSTITUTE: 'CHARFOOT'}
{~~}
{FOOTER-}
{COMMENT}---------------------------CIALO-WYDRUKU--------------------------{COMMENT-}
{FONT: 'Q'}{SPACE: 'C'}
{FOR: 'SLO'}
{INDEX: 'SL'}
{PREFIX: SLU.ref()}
{DO}
     {FOR: 'SLO_OSOB'}
     {INDEX: 'ID'}
     {PREFIX: RS.F_ZATR, {? ~pre || #SLO.KOD || #(3-SLO.KOD) ?}}
     {DO}
     { w[1]:=SLO.KOD; SLO_OSOB.OSOBA();
       w[2]:=OSOBA.PIERWSZE+' '+OSOBA.NAZWISKO; w[3]:=OSOBA.PESEL;
       P.cntx_psh(); P.index('PRACOIP'); P.prefix();
       w[4]:={? P.find_key(exec('ref_firma','ustawienia'),RS.F_ZATR().KOD,SLO_OSOB.ID) || P.ODDZIAL().OD || '' ?};
       P.cntx_pop();~~}
    {<{1}'│'} {w[1]}{<{p[1]}'│'} {w[2]}{<{p[2]}'│'} {w[3]}{<{p[3]}'│'} {w[4]}{<{p[4]}'│'}
     {OD}
{OD}
{COMMENT}------------------------------------------------------------------{COMMENT-}
{FOOTER}
{SUBSTITUTE: 'CHARFOOT'}
{~~}
{FOOTER-}
{SUBSTITUTE: 'LINIA3'}
{<1>{il}'KONIEC WYDRUKU'@}
