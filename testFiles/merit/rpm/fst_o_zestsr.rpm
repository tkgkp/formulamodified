:!UTF-8
{TITLE:B. Zestawienie środków}
{PRINTER: FINFO.SZ_PRN,,,,,'M','B',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
   PRN:=obj_new(@.CLASS.PRINT,12 + {? rep_export() || 15 ?}); PRN.s_frame();
   PRNF:=obj_new(@.CLASS.PRINT,12 + {? rep_export() || 15 ?}); PRNF.s_frame();
   c:=obj_new(12+{? rep_export() || 15 ?});
   {! _i:=1..12+{? rep_export() || 15 ?} |! c[_i]:='' !};
   SRST.cntx_psh(); SRSR.cntx_psh();
   exec('init','fst');
   SRD.maski('r');
   SRST.prefix(); SRSR.prefix();
   exec('odd_filtr','fst');
   SRD.PAR_WYDR:='T';
   EDIT_ES.JORG:='';
   i:=0;
   color:=prn1:=prn2:='';
   lm:=ll:=vp:=lmt:=rsep:=0;
   par1:=0; par2:=0; par3:=0; par4:=0; par5:=0;
   g_warp:=0; g_umop:=0; g_netp:=0;
   g_warf:=0; g_umof:=0; g_netf:=0;
   g_ward:=0; g_umod:=0; g_netd:=0;
   sum_warp:=0; sum_umop:=0; sum_netp:=0;
   sum_warf:=0; sum_umof:=0; sum_netf:=0;
   sum_ward:=0; sum_umod:=0; sum_netd:=0;
   sum_grupa:=''; test_grupa:='';
   zakresdr:=0;
   srst_dr:=0
}
{END:
   obj_del(PRN);
   obj_del(PRNF);
   obj_del(c);
   SRST.cntx_pop(); SRSR.cntx_pop();
   SRD.PAR_WYDR:='N';
   &i; &color; &prn1; &prn2;
   &lm; &ll; &vp; &lmt; &rsep;
   &par1; &par2; &par3;&par4; &par5;
   &g_warp; &g_umop; &g_netp;
   &g_warf; &g_umof; &g_netf;
   &g_ward; &g_umod; &g_netd;
   &sum_warp; &sum_umop; &sum_netp;
   &sum_warf; &sum_umof; &sum_netf;
   &sum_ward; &sum_umod; &sum_netd;
   &sum_grupa; &test_grupa;
   &zakresdr;
   &srst_dr
}
{EXIT:
   exec('clear_par','fst');
   exec('set_parw','param_wydr');
   {? OPERATOR.DEPT<>null
   || PAR_WYDR.ODD:=OPERATOR.DEPT
   || PAR_WYDR.ODD:=null
   ?};
   {? SSTALE.AO().KON<>date(0,0,0)
   || PAR_WYDR.STAN_NA:=SSTALE.AO().KON
   |? SSTALE.AO().OES=0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().POCZ_ROK
   |? SSTALE.AO().OES>0
   || PAR_WYDR.STAN_NA:=SSTALE.AR().KON_ROK
   ?};
   PAR_WYDR.TO_DE:=SSTALE.AO().KON;
   PAR_WYDR.RODZAJ:=1;
   PAR_WYDR.RODZAJ2:=1;
   PAR_WYDR.WART_PN:=2;
   PAR_WYDR.JORG:=null; EDIT_ES.JORG:='';
   exec('set_gr_list','fst');
   PAR_WYDR.win_edit('ZEST_DEF');
   PAR_WYDR.hdr_edit(': B. Zestawienie środków'@);
   {? PAR_WYDR.edit("exec('check_zest_def','fst')")
   || _exit:=0;
      exec('zakres_gr','fst');
      zakresdr:=PAR_WYDR.ZAKRESDR
   || _exit:=1
   ?};
   _exit
}
{COMMENT}
==================================================
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
Nazwa pliku: o_zestsr.rpm
Utworzony  : 2004-09-10
Zawartość  : Zestawienie środków trwałych - zdefiniowane
==================================================
--------------- OPIS PÓL ZMIENNEJ PAR_WYDR ------------{COMMENT-}
{COMMENT}
Dane pobierane są w sekcji Exit z wykorzystaniem formuł z pliku query.fml
RODZAJ : 1=analityczne, 2=syntetyczne,
RODZAJ2: 1=środki wszystkie, 2=jednorazowo umorzone, 3=całkowicie umorzone, 4=skreślone, 5=nowe 6=zestawienie do BO
MAP    : kod metody podatkowej
MAF    : kod metody bilansowej
FROM_DE: data eksploatacji od
TO_DE  : data eksploatacji do
ODD    : jedn. ksiegowa
GRUPA  : grupa środków trwałych np. 100, 1**
SKR_ONLY: tylko skreslone
UMO_ONLY: tylko umorzone
{COMMENT-}
{COMMENT}zmienne pomocnicze do wydrukow graficznych:
i - licznik, color, prn1, lm, ll, vp, lmt, rsep
{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{COMMENT}--Definicja wiersza wydruku--------------------{COMMENT-}
{  prn1:='PRN'; prn2:='PRN'; ~~}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
      PAR_WYDR.ZAKRESDR:=zakresdr;
      {? FINFO.TOR_D<>'T'
      ||
         {? PAR_WYDR.RODZAJ=1
         ||
            PRN.add("c[1]",40,'Nr inwentarzowy#       Nazwa środka                '@,,'#');
            PRN.add("c[2]",5,'Grupa'@);
            PRN.add("c[3]",7,'Metoda#POD/BIL'@,,'#');
            PRN.add("c[4]",16,'Jedn. księg.# Jedn. organ.'@,,'#');
            PRN.add("c[5]",15,'Rodz. przych.# Data ekspl.'@,,'#');
            PRN.add("c[6]",15,'Rodz. rozch.# Data skreśl.'@,,'#');
            PRN.add("c[7]",20,'Zestaw kont podat.#Zestaw kont bilan.'@,,'#');
            PRN.add("{? type_of(c[8])=1 || form(c[8],,2,' ,') || c[8] ?}",14,'Stawka amort.# POD/BIL'@,1,'#');
            PRN.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",14,'Wart. inwent.# POD/BIL'@,1,'#');
            PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",14,'Umorzenie # POD/BIL'@,1,'#');
            PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",14,'Netto     # POD/BIL'@,1,'#');
            PRNF.add("c[1]", 153, 'Środki'@);
            PRNF.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",14,'Wart. inwent.# POD/BIL'@,1,'#');
            PRNF.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",14,'Umorzenie # POD/BIL'@,1,'#');
            PRNF.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",14,'Netto     # POD/BIL'@,1,'#')


         |? PAR_WYDR.RODZAJ=2
         || PRN.add("c[1]", 25, 'Grupa środków'@);
            PRN.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",25,'Wartość inwentarzowa # Podatkowo / Bilansowo'@,1,'#');
            PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",25,'Wartość umorzenia # Podatkowo / Bilansowo'@,1,'#');
            PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",25,'Wartość netto # Podatkowo / Bilansowo'@,1,'#');
            PRNF.add("c[1]", 25, '');
            PRNF.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",25,'',1,'#');
            PRNF.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",25,'',1,'#');
            PRNF.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",25,'',1,'#')
         ?}
      ||
         {? PAR_WYDR.RODZAJ=1
         ||
            PRN.add("c[1]",40,'Nr inwentarzowy#       Nazwa środka                '@,,'#');
            PRN.add("c[2]",5,'Grupa'@);
            PRN.add("c[3]",11,'Metoda#POD/BIL/DOD'@,,'#');
            PRN.add("c[4]",16,'Jedn. księg.# Jedn. organ.'@,,'#');
            PRN.add("c[5]",15,'Rodz. przych.# Data ekspl.'@,,'#');
            PRN.add("c[6]",15,'Rodz. rozch.# Data skreśl.'@,,'#');
            PRN.add("c[7]",20,'Zestaw kont podat.#Zestaw kont bilan.#Zestaw kont dodat.'@,,'#');
            PRN.add("{? type_of(c[8])=1 || form(c[8],,2,' ,') || c[8] ?}",14,'Stawka amort.# POD/BIL/DOD'@,1,'#');
            PRN.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",14,'Wart. inwent.# POD/BIL/DOD'@,1,'#');
            PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",14,'Umorzenie # POD/BIL/DOD'@,1,'#');
            PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",14,'Netto     # POD/BIL/DOD'@,1,'#');
            PRNF.add("c[1]", 157, 'Środki'@);
            PRNF.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",14,'Wart. inwent.# POD/BIL/DOD'@,1,'#');
            PRNF.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",14,'Umorzenie # POD/BIL/DOD'@,1,'#');
            PRNF.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",14,'Netto     # POD/BIL/DOD'@,1,'#')


         |? PAR_WYDR.RODZAJ=2
         || PRN.add("c[1]", 25, 'Grupa środków'@);
            PRN.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",35,'Wartość inwentarzowa # Podatkowo / Bilansowo / Dodatkowo'@,1,'#');
            PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",35,'Wartość umorzenia # Podatkowo / Bilansowo / Dodatkowo'@,1,'#');
            PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",35,'Wartość netto # Podatkowo / Bilansowo / Dodatkowo'@,1,'#');
            PRNF.add("c[1]", 25, '');
            PRNF.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",35,'',1,'#');
            PRNF.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",35,'',1,'#');
            PRNF.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",35,'',1,'#')
         ?}
      ?}; ~~
      }
      {FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
PAR_WYDR.ZAKRESDR:=zakresdr;
      {? FINFO.TOR_D<>'T'
      ||
         {? PAR_WYDR.RODZAJ=1
         ||
            PRN.add("c[1]",40,'Nr inwentarzowy'@,,'#');
            PRN.add("c[12]",40,'Nazwa środka'@,,'#');
            PRN.add("c[2]",5,'Grupa'@);
            PRN.add("c[3]",7,'Metoda POD'@,,'#');
            PRN.add("c[13]",7,'Metoda BIL'@,,'#');
            PRN.add("c[4]",16,'Jedn. księg.'@,,'#');
            PRN.add("c[14]",16,'Jedn. organ.'@,,'#');
            PRN.add("c[5]",15,'Rodz. przych.'@,,'#');
            PRN.add("c[15]",15,'Data ekspl.'@,,'#');
            PRN.add("c[6]",15,'Rodz. rozch.'@,,'#');
            PRN.add("c[16]",15,'Data skreśl.'@,,'#');
            PRN.add("c[7]",20,'Zestaw kont podat.'@,,'#');
            PRN.add("c[17]",20,'Zestaw kont bilan.'@,,'#');
            PRN.add("{? type_of(c[8])=1 || form(c[8],,2,' ,') || c[8] ?}",14,'Stawka amort. POD'@,1,'#');
            PRN.add("{? type_of(c[18])=1 || form(c[18],,2,' ,') || c[18] ?}",14,'Stawka amort. BIL'@,1,'#');
            PRN.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",14,'Wart. inwent. POD'@,1,'#');
            PRN.add("{? type_of(c[19])=1 || form(c[19],,2,' ,') || c[19] ?}",14,'Wart. inwent. BIL'@,1,'#');
            PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",14,'Umorzenie POD'@,1,'#');
            PRN.add("{? type_of(c[20])=1 || form(c[20],,2,' ,') || c[20] ?}",14,'Umorzenie BIL'@,1,'#');
            PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",14,'Netto POD'@,1,'#');
            PRN.add("{? type_of(c[21])=1 || form(c[21],,2,' ,') || c[21] ?}",14,'Netto BIL'@,1,'#');
            PRNF.add("c[1]", 153, 'Środki'@);
            PRNF.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",14,'Wart. inwent. POD'@,1,'#');
            PRNF.add("{? type_of(c[19])=1 || form(c[19],,2,' ,') || c[19] ?}",14,'Wart. inwent. BIL'@,1,'#');
            PRNF.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",14,'Umorzenie  POD'@,1,'#');
            PRNF.add("{? type_of(c[20])=1 || form(c[20],,2,' ,') || c[20] ?}",14,'Umorzenie  BIL'@,1,'#');
            PRNF.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",14,'Netto POD'@,1,'#');
            PRNF.add("{? type_of(c[21])=1 || form(c[21],,2,' ,') || c[21] ?}",14,'Netto BIL'@,1,'#')

         |? PAR_WYDR.RODZAJ=2
         || PRN.add("c[1]", 25, 'Grupa środków'@);
            PRN.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",25,'Wartość inwentarzowa Podatkowo'@,1,'#');
            PRN.add("{? type_of(c[19])=1 || form(c[19],,2,' ,') || c[19] ?}",25,'Wartość inwentarzowa Bilansowo'@,1,'#');
            PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",25,'Wartość umorzenia Podatkowo'@,1,'#');
            PRN.add("{? type_of(c[20])=1 || form(c[20],,2,' ,') || c[20] ?}",25,'Wartość umorzenia Bilansowo'@,1,'#');
            PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",25,'Wartość netto Podatkowo'@,1,'#');
            PRN.add("{? type_of(c[21])=1 || form(c[21],,2,' ,') || c[21] ?}",25,'Wartość netto Bilansowo'@,1,'#')
         ?}
      ||
         {? PAR_WYDR.RODZAJ=1
         ||
            PRN.add("c[1]",40,'Nr inwentarzowy'@,,'#');
            PRN.add("c[12]",40,'Nazwa środka'@,,'#');
            PRN.add("c[2]",5,'Grupa'@);
            PRN.add("c[3]",7,'Metoda POD'@,,'#');
            PRN.add("c[13]",7,'Metoda BIL'@,,'#');
            PRN.add("c[22]",7,'Metoda DOD'@,,'#');
            PRN.add("c[4]",16,'Jedn. księg. '@,,'#');
            PRN.add("c[14]",16,'Jedn. organ.'@,,'#');
            PRN.add("c[5]",15,'Rodz. przych.'@,,'#');
            PRN.add("c[15]",15,'Data ekspl.'@,,'#');
            PRN.add("c[6]",15,'Rodz. rozch.'@,,'#');
            PRN.add("c[16]",15,'Data skreśl.'@,,'#');
            PRN.add("c[7]",20,'Zestaw kont podat.'@,,'#');
            PRN.add("c[17]",20,'Zestaw kont bilan.'@,,'#');
            PRN.add("c[23]",20,'Zestaw kont dodat.'@,,'#');
            PRN.add("{? type_of(c[8])=1 || form(c[8],,2,' ,') || c[8] ?}",14,'Stawka amort. POD'@,1,'#');
            PRN.add("{? type_of(c[18])=1 || form(c[18],,2,' ,') || c[18] ?}",14,'Stawka amort. BIL'@,1,'#');
            PRN.add("{? type_of(c[24])=1 || form(c[24],,2,' ,') || c[24] ?}",14,'Stawka amort. DOD'@,1,'#');
            PRN.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",14,'Wart. inwent. POD'@,1,'#');
            PRN.add("{? type_of(c[19])=1 || form(c[19],,2,' ,') || c[19] ?}",14,'Wart. inwent. BIL'@,1,'#');
            PRN.add("{? type_of(c[25])=1 || form(c[25],,2,' ,') || c[25] ?}",14,'Wart. inwent. DOD'@,1,'#');
            PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",14,'Umorzenie  POD'@,1,'#');
            PRN.add("{? type_of(c[20])=1 || form(c[20],,2,' ,') || c[20] ?}",14,'Umorzenie BIL'@,1,'#');
            PRN.add("{? type_of(c[26])=1 || form(c[26],,2,' ,') || c[26] ?}",14,'Umorzenie DOD'@,1,'#');
            PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",14,'Netto POD'@,1,'#');
            PRN.add("{? type_of(c[21])=1 || form(c[21],,2,' ,') || c[21] ?}",14,'Netto BIL'@,1,'#');
            PRN.add("{? type_of(c[27])=1 || form(c[27],,2,' ,') || c[27] ?}",14,'Netto DOD'@,1,'#');

            PRN.add("c[1]", 153, 'Środki'@);
            PRN.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",14,'Wart. inwent. POD'@,1,'#');
            PRN.add("{? type_of(c[19])=1 || form(c[19],,2,' ,') || c[19] ?}",14,'Wart. inwent. BIL'@,1,'#');
            PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",14,'Umorzenie  POD'@,1,'#');
            PRN.add("{? type_of(c[20])=1 || form(c[20],,2,' ,') || c[20] ?}",14,'Umorzenie  BIL'@,1,'#');
            PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",14,'Netto POD'@,1,'#');
            PRN.add("{? type_of(c[21])=1 || form(c[21],,2,' ,') || c[21] ?}",14,'Netto BIL'@,1,'#')
         |? PAR_WYDR.RODZAJ=2
         || PRN.add("c[1]", 25, 'Grupa środków'@);
            PRN.add("{? type_of(c[9])=1 || form(c[9],,2,' ,') || c[9] ?}",35,'Wartość inwentarzowa  Podatkowo'@,1,'#');
            PRN.add("{? type_of(c[19])=1 || form(c[19],,2,' ,') || c[19] ?}",35,'Wartość inwentarzowa Bilansowo'@,1,'#');
            PRN.add("{? type_of(c[25])=1 || form(c[25],,2,' ,') || c[25] ?}",35,'Wartość inwentarzowa Dodatkowo'@,1,'#');
            PRN.add("{? type_of(c[10])=1 || form(c[10],,2,' ,') || c[10] ?}",35,'Wartość umorzenia Podatkowo'@,1,'#');
            PRN.add("{? type_of(c[20])=1 || form(c[20],,2,' ,') || c[20] ?}",35,'Wartość umorzenia Bilansowo'@,1,'#');
            PRN.add("{? type_of(c[26])=1 || form(c[26],,2,' ,') || c[26] ?}",35,'Wartość umorzenia Dodatkowo'@,1,'#');
            PRN.add("{? type_of(c[11])=1 || form(c[11],,2,' ,') || c[11] ?}",35,'Wartość netto Podatkowo'@,1,'#');
            PRN.add("{? type_of(c[21])=1 || form(c[21],,2,' ,') || c[21] ?}",35,'Wartość netto Bilansowo'@,1,'#');
            PRN.add("{? type_of(c[27])=1 || form(c[27],,2,' ,') || c[27] ?}",35,'Wartość netto Dodatkowo'@,1,'#')
         ?}
      ?}; ~~
      }
{FI}
{      PAR_WYDR.TITLE:='Zestawienie środków - stan na dzień %1 roku'@[PAR_WYDR.STAN_NA$6]; ~~}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{COMMENT}------------------------------Parametry wydruku------------{COMMENT-}
{FONT: 'W8'}{SPACE: 'C'}
{<1 'PARAMETRY WYDRUKU:'@}
{COMMENT} ---- Stan na, Grupa, Rodzaj zestawienia ---- {COMMENT-}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
  par1:='';
  {? PAR_WYDR.FROM_DE<>date(0,0,0)
  || par1:='od '+form(PAR_WYDR.FROM_DE,,1)
  ?};
  {? PAR_WYDR.TO_DE<>date(0,0,0)
  || {? par1<>'' || par1+=' ' ?};
     par1+='do '+form(PAR_WYDR.TO_DE,,1)
  ?};
  {? par1='' || par1:='dowolna'@ ?};
  par2:={? PAR_WYDR.JORG<>null || PAR_WYDR.JORG().SYMBOL || 'dowolna'@ ?};
  {? PAR_WYDR.RODZAJ=1 || par3:='analityczne'@ || par3:='syntetyczne'@ ?}
;~~}
{IF: PAR_WYDR.WAR_GR<>3}
{FONT: 'W8B'}{<1 'Rodzaj zestawienia: '@}{FONT: 'W8'}{<22 par3}{FONT: 'W8B'}{<45 'J. organizacyjna: '@}{FONT: 'W8'}{<65 par2}{FONT: 'W8B'}{<79 'Data eksploatacji: '@}{FONT: 'W8'}{<99 par1}
{ELIF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{<1 'Rodzaj zestawienia: '@}{FONT: 'W8'}{<22 par3}{FONT: 'W8B'}{<45 'J. organizacyjna: '@}{FONT: 'W8'}{<65 par2}{FONT: 'W8B'}{<79 'Data eksploatacji: '@}{FONT: 'W8'}{<99 par1}
{FI}
{COMMENT} ---- Dane, Jedn. ksiegowa, Zestawienie według ---- {COMMENT-}
{
  {? PAR_WYDR.RODZAJ2=1 || par1:='bez względu na umorz./skreślenie'@
  |? PAR_WYDR.RODZAJ2=2 || par1:='jednorazowo umorzone'@
  |? PAR_WYDR.RODZAJ2=3 || par1:='całkowicie umorzone'@
  |? PAR_WYDR.RODZAJ2=4 || par1:='skreślone'@
  |? PAR_WYDR.RODZAJ2=5 || par1:='nowe'@
  ?};
  {? PAR_WYDR.ODD<>null || par2:=PAR_WYDR.ODD().OD || par2:='wszystkie'@ ?};
  {? PAR_WYDR.ZAKRESDR=0 || par3:='wszystkie'@
  |? PAR_WYDR.ZAKRESDR=1 || par3:='trwałe'@
  |? PAR_WYDR.ZAKRESDR=2 || par3:='niskocenne'@
  ?};

  {? PAR_WYDR.WAR_GR=1
  || {? |PAR_WYDR.GRUPA<>'' || par5:=|PAR_WYDR.GRUPA || par5:='dowolna'@ ?}
  |? PAR_WYDR.WAR_GR=2
  || {? |PAR_WYDR.GRUPA_OD<>'' || _od:='od: '@+|PAR_WYDR.GRUPA_OD || _od:='' ?};
     {? |PAR_WYDR.GRUPA_DO<>'' || _do:='do: '@+|PAR_WYDR.GRUPA_DO || _do:='' ?};
     {? _od<>'' & _do<>'' || par5:=_od+' '+_do
     |? _od<>'' & _do='' ||  par5:=_od
     |? _od='' & _do<>'' || par5:=_do
    ?}
  |? PAR_WYDR.WAR_GR=4
  || par5:='dowolna'@
  ?}
;~~}
{FONT: 'W8B'}{<1 'Środki: '@}{FONT: 'W8'}{<9 par1}{FONT: 'W8B'}{<45 'J. księgowa: '@}{FONT: 'W8'}{<65 par2}{FONT: 'W8B'}{<79 'Zakres środków: '@}{FONT: 'W8'}{<99 par3}
{
  {? PAR_WYDR.MO_DO=1 || par3:='miesiąca obowiązywania'@ || par3:='daty operacji'@ ?}
;~~}
{IF: FINFO.TOR_D='T'}
{IF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{<1 'Wybór grup:'@}{FONT: 'W8'}{<12 exec('create_list_gr','fst')}
{ELSE}
{FONT: 'W8B'}{<1 'Grupa: '@}{FONT: 'W8'}{<9 par5}{FONT: 'W8B'}{<45 'Dokumenty wartościowe uwzględniane według: '@}{FONT: 'W8'}{<90 par3}
{FI}
{ELSE}
{IF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{<1 'Wybór grup:'@}{FONT: 'W8'}{<12 exec('create_list_gr','fst')}
{ELSE}
{FONT: 'W8B'}{<1 'Grupa: '@}{FONT: 'W8'}{<9 par5}{FONT: 'W8B'}{<45 'Dokumenty wartościowe uwzględniane według: '@}{FONT: 'W8'}{<90 par3}
{FI}
{FI}
{FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
  par1:='';
  {? PAR_WYDR.FROM_DE<>date(0,0,0)
  || par1:='od '+form(PAR_WYDR.FROM_DE,,1)
  ?};
  {? PAR_WYDR.TO_DE<>date(0,0,0)
  || {? par1<>'' || par1+=' ' ?};
     par1+='do '+form(PAR_WYDR.TO_DE,,1)
  ?};
  {? par1='' || par1:='dowolna'@ ?};
  par2:={? PAR_WYDR.JORG<>null || PAR_WYDR.JORG().SYMBOL || 'dowolna'@ ?};
  {? PAR_WYDR.RODZAJ=1 || par3:='analityczne'@ || par3:='syntetyczne'@ ?}
;~~}
{IF: PAR_WYDR.WAR_GR<>3}
{FONT: 'W8B'}{ 'Rodzaj zestawienia: '@}{FONT: 'W8'}{<22 par3}{FONT: 'W8B'}
{'J. organizacyjna: '@}{FONT: 'W8'}{ par2}{FONT: 'W8B'}
{'Data eksploatacji: '@}{FONT: 'W8'}{ par1}
{ELIF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}
{ 'Rodzaj zestawienia: '@}{FONT: 'W8'}{<22 par3}{FONT: 'W8B'}
{ 'J. organizacyjna: '@}{FONT: 'W8'}{ par2}{FONT: 'W8B'}
{ 'Data eksploatacji: '@}{FONT: 'W8'}{ par1}
{FI}
{COMMENT} ---- Dane, Jedn. ksiegowa, Zestawienie według ---- {COMMENT-}
{
  {? PAR_WYDR.RODZAJ2=1 || par1:='bez względu na umorz./skreślenie'@
  |? PAR_WYDR.RODZAJ2=2 || par1:='jednorazowo umorzone'@
  |? PAR_WYDR.RODZAJ2=3 || par1:='całkowicie umorzone'@
  |? PAR_WYDR.RODZAJ2=4 || par1:='skreślone'@
  |? PAR_WYDR.RODZAJ2=5 || par1:='nowe'@
  ?};
  {? PAR_WYDR.ODD<>null || par2:=PAR_WYDR.ODD().OD || par2:='wszystkie'@ ?};
  {? PAR_WYDR.ZAKRESDR=0 || par3:='wszystkie'@
  |? PAR_WYDR.ZAKRESDR=1 || par3:='trwałe'@
  |? PAR_WYDR.ZAKRESDR=2 || par3:='niskocenne'@
  ?};

  {? PAR_WYDR.WAR_GR=1
  || {? |PAR_WYDR.GRUPA<>'' || par5:=|PAR_WYDR.GRUPA || par5:='dowolna'@ ?}
  |? PAR_WYDR.WAR_GR=2
  || {? |PAR_WYDR.GRUPA_OD<>'' || _od:='od: '@+|PAR_WYDR.GRUPA_OD || _od:='' ?};
     {? |PAR_WYDR.GRUPA_DO<>'' || _do:='do: '@+|PAR_WYDR.GRUPA_DO || _do:='' ?};
     {? _od<>'' & _do<>'' || par5:=_od+' '+_do
     |? _od<>'' & _do='' ||  par5:=_od
     |? _od='' & _do<>'' || par5:=_do
     |? _od='' & _do='' || par5:='wszystkie'
    ?}
  |? PAR_WYDR.WAR_GR=4
  || par5:='wszystkie'@
  ?}
;~~}
{FONT: 'W8B'}
{ 'Środki: '@}{FONT: 'W8'}{ par1}{FONT: 'W8B'}
{ 'J. księgowa: '@}{FONT: 'W8'}{ par2}{FONT: 'W8B'}
{ 'Zakres środków: '@}{FONT: 'W8'}{ par3}
{IF: FINFO.TOR_D='T'}
{IF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{ 'Wybór grup:'@}
{FONT: 'W8'}{ exec('create_list_gr','fst')}
{ELSE}
{FONT: 'W8B'}{ 'Grupa: '@}{FONT: 'W8'}
{ par5}
{FI}
{ELSE}
{IF: PAR_WYDR.WAR_GR=3}
{FONT: 'W8B'}{ 'Wybór grup:'@}
{FONT: 'W8'}{ exec('create_list_gr','fst')}
{ELSE}
{FONT: 'W8B'}{ 'Grupa: '@}{FONT: 'W8'}{ par5}
{FI}
{FI}
{FI}
{LINE: 1}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{SPACE: 'C'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: ~rep_export()}
{SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{ rsep:=PAR_WYDR.RSEP; ~~}
{FOR: SRST}{INDEX: SRST.ndx_tmp(,,'ROK_F',,,'OKRO_F',,,'GR','GR',0) }{PREFIX: SSTALE.AR, SSTALE.AO,}
 {DO}
 {COMMENT}Warunek sprawdzajacy czy drukowac SRST{COMMENT-}
 { {? PAR_WYDR.WAR_GR=4
   || _grupa_ok:=1
   || _grupa_ok:=exec('gr_fit','fst',SRST.GR().GR)
   ?};
   srst_dr:=(PAR_WYDR.JORG=null | PAR_WYDR.JORG=SRST.JORG)
            & (PAR_WYDR.ODD=null | PAR_WYDR.ODD=SRST.ODD)
            & (PAR_WYDR.ZAKRESDR=0
              | (PAR_WYDR.ZAKRESDR=1 & SRST.R='T')
              | (PAR_WYDR.ZAKRESDR=2 & SRST.R='N'))
            & (PAR_WYDR.RODZAJ2=1 | (PAR_WYDR.RODZAJ2=2 & 1+SRST.MP().K='U' & 1+SRST.MF().K='U')
                                  | (PAR_WYDR.RODZAJ2=3 & SRST.NETP=0 & SRST.NETF=0)
                                  | (PAR_WYDR.RODZAJ2=4 & SRST.SRSR().Z='T')
                                  | (PAR_WYDR.RODZAJ2=5 & SRST.DE>=PAR_WYDR.FROM_DE))
            & SRST.GR<>null
            & SRST.KIND='T'
            & _grupa_ok & SRST.R<>'S'
 ;~~}
 {IF: srst_dr}
{COMMENT} ---- Podsumowanie cząstkowe według grup lub jedn. ksiegowa ---- {COMMENT-}
{COMMENT} ---- Podsumowania nie występują dla excel ---- {COMMENT-}
{IF: ~rep_export()}
  { {? PAR_WYDR.RODZAJ=1 | PAR_WYDR.RODZAJ=2
    || test_grupa:=1+SRST.GR().GR;
       {? sum_grupa='' || test_grupa:='' ?}
   ?}
  ;~~}
  {IF: (PAR_WYDR.RODZAJ=1 | PAR_WYDR.RODZAJ=2) & sum_grupa<>test_grupa}
  {
   c[1]:='Grupa '@ + sum_grupa + ' razem:'@;
   c[2]:=''; c[3]:=''; c[4]:=''; c[5]:='';  c[6]:=''; c[7]:=''; c[8]:='';
   c[9]:= g_warp; c[10]:= g_umop; c[11]:= g_netp;
   prn1:='PRN'; prn2:='PRNF';
   rsep:=1;"vp:=0"
  ;~~}
  {IF: lineleft() <=4}{PAGE}{FI}
  {IF: PAR_WYDR.RODZAJ=1}{FONT: 'T8GB'}{ELSE}{FONT: 'T8G'}{FI}{SPACE: 'C'}{SUBSTITUTE: 'LINIA02'}
  {
   c[1]:=''; c[2]:=''; c[3]:=''; c[4]:=''; c[5]:=''; c[6]:=''; c[7]:=''; c[8]:='';
   c[9]:= g_warf; c[10]:= g_umof; c[11]:= g_netf;
   "vp:=0";
   rsep:=0;
   prn1:='PRN'; prn2:='PRNF'
   ;~~}
  {IF: PAR_WYDR.RODZAJ=1}{FONT: 'T8GB'}{ELSE}{FONT: 'T8G'}{FI}{SPACE: 'C'}{SUBSTITUTE: 'LINIA02'}
  {IF: FINFO.TOR_D='T'}
  {
   c[1]:=''; c[2]:=''; c[3]:=''; c[4]:=''; c[5]:=''; c[6]:=''; c[7]:=''; c[8]:='';
   c[9]:= g_ward; c[10]:= g_umod; c[11]:= g_netd;
   "vp:=0";
   rsep:=0;
   prn1:='PRNF'; prn2:='PRNF'
   ;~~}
  {IF: PAR_WYDR.RODZAJ=1}{FONT: 'T8GB'}{ELSE}{FONT: 'T8G'}{FI}{SPACE: 'C'}{SUBSTITUTE: 'LINIA02'}
  {FI}
  {rsep:=1;
  prn1:='PRNF'; prn2:='PRN'
  ;~~}
  {FONT: 'T8G'}{SPACE: 'C'}
    {COMMENT} ---- wyzerowanie podsumowań cząstkowych---- {COMMENT-}
  {
     {? PAR_WYDR.RODZAJ=1 | PAR_WYDR.RODZAJ=2
     || g_warp:=0; g_umop:=0; g_netp:=0; g_warf:=0; g_umof:=0; g_netf:=0; g_ward:=0; g_umod:=0; g_netd:=0
     ?}
  ;~~}
  {FI}
  {FI}
  {COMMENT} ---- Podsumowania nie występują dla excel, ale dla syntetycznego już tak---- {COMMENT-}
{IF: rep_export() & PAR_WYDR.RODZAJ=2}
  { {? PAR_WYDR.RODZAJ=1 | PAR_WYDR.RODZAJ=2
    || test_grupa:=1+SRST.GR().GR;
       {? sum_grupa='' || test_grupa:='' ?}
   ?}
  ;~~}
  {IF: (PAR_WYDR.RODZAJ=1 | PAR_WYDR.RODZAJ=2) & sum_grupa<>test_grupa}
  {
   c[1]:='Grupa '@ + sum_grupa + ' razem:'@;
   c[2]:=''; c[3]:=''; c[4]:=''; c[5]:='';  c[6]:=''; c[7]:=''; c[8]:='';
   c[9]:= g_warp; c[10]:= g_umop; c[11]:= g_netp;
   prn1:='PRN'; prn2:='PRNF';
   rsep:=1;"vp:=0"
  ;~~}
  {IF: lineleft() <=4}{PAGE}{FI}
  {
   c[19]:= g_warf; c[20]:= g_umof; c[21]:= g_netf;
   "vp:=0";
   rsep:=0;
   prn1:='PRN'; prn2:='PRNF'
   ;~~}
  {IF: FINFO.TOR_D='T'}
  {
   c[1]:=''; c[2]:=''; c[3]:=''; c[4]:=''; c[5]:=''; c[6]:=''; c[7]:=''; c[8]:='';
   c[25]:= g_ward; c[26]:= g_umod; c[27]:= g_netd;
   "vp:=0";
   rsep:=0;
   prn1:='PRN'; prn2:='PRNF'
   ;~~}
  {FI}
  {rsep:=1;
  prn1:='PRN'; prn2:='PRN'
  ;~~}
  {FONT: 'T8G'}{SPACE: 'C'}
  {IF: PAR_WYDR.RODZAJ=1}{FONT: 'T8GB'}{ELSE}{FONT: 'T8G'}{FI}{SPACE: 'C'}{SUBSTITUTE: 'LINIA02'}
   {COMMENT} ---- wyzerowanie podsumowań cząstkowych---- {COMMENT-}
  {
     {? PAR_WYDR.RODZAJ=1 | PAR_WYDR.RODZAJ=2
     || g_warp:=0; g_umop:=0; g_netp:=0; g_warf:=0; g_umof:=0; g_netf:=0; g_ward:=0; g_umod:=0; g_netd:=0
     ?}
  ;~~}
  {FI}
  {FI}
{COMMENT} ---- zwykłe wiersze ---- {COMMENT-}
{COMMENT}----------NIE EXCEL-------------{COMMENT-}
{IF: ~rep_export()}
{
   {? PAR_WYDR.RODZAJ=1
   ||
      c[1]:=SRST.NRI;
      c[2]:=SRST.GR().GR;
      c[3]:=SRST.MP().K;
      c[4]:=SRST.ODD().OD;
      c[5]:=SRST.SRSR().PRZYCHOD().R;
      c[6]:=SRST.SRSR().ROZ().R;
      c[7]:=SRST.KONPOD().KOD;
      c[8]:=SRST.STAP;
      {? PAR_WYDR.WART_PN=1
      || c[9]:=SRST.SRSR().WARP;
         c[10]:=SRST.SRSR().UMOP+SRST.SRSR().ZALP100;
         c[11]:=SRST.SRSR().NETP-SRST.SRSR().ZALP100;

         sum_warp+=SRST.SRSR().WARP;
         sum_umop+=SRST.SRSR().UMOP+SRST.SRSR().ZALP100;
         sum_netp+=SRST.SRSR().NETP-SRST.SRSR().ZALP100;

         sum_warf+=SRST.SRSR().WARF;
         sum_umof+=SRST.SRSR().UMOF;
         sum_netf+=SRST.SRSR().NETF;

         g_warp+=SRST.SRSR().WARP; g_umop+=SRST.SRSR().UMOP+SRST.SRSR().ZALP100; g_netp+=(SRST.SRSR().NETP-SRST.SRSR().ZALP100);
         g_warf+=SRST.SRSR().WARF; g_umof+=SRST.SRSR().UMOF; g_netf+=SRST.SRSR().NETF;

         {? FINFO.TOR_D='T'
         || g_ward+=SRST.SRSR().WARD; g_umod+=SRST.SRSR().UMOD; g_netd+=SRST.SRSR().NETD;
            sum_ward+=SRST.SRSR().WARD;
            sum_umod+=SRST.SRSR().UMOD;
            sum_netd+=SRST.SRSR().NETD
         ?}
      |? PAR_WYDR.WART_PN=2
      || {? SRST.SRSR().DOKSKR().DW<>date(0,0,0) & PAR_WYDR.MO_DO=2 & SRST.SRSR().DOKSKR().DW<=PAR_WYDR.STAN_NA
         || c[9]:=0;
            c[10]:=0;
            c[11]:=0
         || c[9]:=SRST.WARP;
            c[10]:=SRST.UMOP+SRST.SRSR().ZALP100;
            c[11]:=SRST.NETP-SRST.SRSR().ZALP100;

            sum_warp+=SRST.WARP;
            sum_umop+=SRST.UMOP+SRST.SRSR().ZALP100;
            sum_netp+=SRST.NETP-SRST.SRSR().ZALP100;

            sum_warf+=SRST.WARF;
            sum_umof+=SRST.UMOF;
            sum_netf+=SRST.NETF;

            g_warp+=SRST.WARP; g_umop+=SRST.UMOP+SRST.SRSR().ZALP100; g_netp+=(SRST.NETP-SRST.SRSR().ZALP100);
            g_warf+=SRST.WARF; g_umof+=SRST.UMOF; g_netf+=SRST.NETF;
            {? FINFO.TOR_D='T'
            || sum_ward+=SRST.WARD;
               sum_umod+=SRST.UMOD;
               sum_netd+=SRST.NETD;
               g_ward+=SRST.WARD; g_umod+=SRST.UMOD; g_netd+=SRST.NETD
            ?}
         ?}
      ?}
   ||
      {? PAR_WYDR.WART_PN=1
      || g_warp+=SRST.SRSR().WARP; g_umop+=SRST.SRSR().UMOP+SRST.SRSR().ZALP100; g_netp+=(SRST.SRSR().NETP-SRST.SRSR().ZALP100);
         g_warf+=SRST.SRSR().WARF; g_umof+=SRST.SRSR().UMOF; g_netf+=SRST.SRSR().NETF;

         sum_warp+=SRST.SRSR().WARP;
         sum_umop+=SRST.SRSR().UMOP+SRST.SRSR().ZALP100;
         sum_netp+=SRST.SRSR().NETP-SRST.SRSR().ZALP100;
         sum_warf+=SRST.SRSR().WARF;
         sum_umof+=SRST.SRSR().UMOF;
         sum_netf+=SRST.SRSR().NETF;
         {? FINFO.TOR_D='T'
         || sum_ward+=SRST.SRSR().WARD;
            sum_umod+=SRST.SRSR().UMOD;
            sum_netd+=SRST.SRSR().NETD;
            g_ward+=SRST.SRSR().WARD; g_umod+=SRST.SRSR().UMOD; g_netd+=SRST.SRSR().NETD
         ?}
      |? PAR_WYDR.WART_PN=2
      || {? ~(SRST.SRSR().DOKSKR().DW<>date(0,0,0) & PAR_WYDR.MO_DO=2 & SRST.SRSR().DOKSKR().DW<=PAR_WYDR.STAN_NA)
         || g_warp+=SRST.WARP; g_umop+=SRST.UMOP+SRST.SRSR().ZALP100; g_netp+=(SRST.NETP-SRST.SRSR().ZALP100);
            g_warf+=SRST.WARF; g_umof+=SRST.UMOF; g_netf+=SRST.NETF;

            sum_warp+=SRST.WARP;
            sum_umop+=SRST.UMOP+SRST.SRSR().ZALP100;
            sum_netp+=SRST.NETP-SRST.SRSR().ZALP100;
            sum_warf+=SRST.WARF;
            sum_umof+=SRST.UMOF;
            sum_netf+=SRST.NETF;
            {? FINFO.TOR_D='T'
            || g_ward+=SRST.WARD; g_umod+=SRST.UMOD; g_netd+=SRST.NETD;
               sum_ward+=SRST.WARD;
               sum_umod+=SRST.UMOD;
               sum_netd+=SRST.NETD
            ?}
         ?}
      ?}
   ?}
 ;~~}
  {IF: lineleft() <=4}{PAGE}{FI}
  { {? vp || prn1:='PRN'; prn2:='PRN'?} ;~~}{IF: PAR_WYDR.RODZAJ=1}{SUBSTITUTE: 'LINIA02'}{FI}
{COMMENT} ---- druga linia---- {COMMENT-}
  {
   {? PAR_WYDR.RODZAJ=1
   ||
      c[1]:=40+SRST.NST;
      c[2]:='';
      c[3]:=SRST.MF().K;
      c[4]:=SRST.JORG().SYMBOL;
      c[5]:=form(SRST.SRSR().DE,,1);
      c[6]:={? SRST.SRSR().DES<>date(0,0,0) || form(SRST.SRSR().DES,,1) || '' ?};
      c[7]:=SRST.KONFIN().KOD;
      c[8]:=SRST.STAF;
      {? PAR_WYDR.WART_PN=1
      || c[9]:=SRST.SRSR().WARF;
         c[10]:=SRST.SRSR().UMOF;
         c[11]:=SRST.SRSR().NETF
      |? PAR_WYDR.WART_PN=2
      || {? SRST.SRSR().DOKSKR().DW<>date(0,0,0) & SRST.SRSR().DOKSKR().DW<=PAR_WYDR.STAN_NA & PAR_WYDR.MO_DO=2
         || c[9]:=0;
            c[10]:=0;
            c[11]:=0
         || c[9]:=SRST.WARF;
            c[10]:=SRST.UMOF;
            c[11]:=SRST.NETF
         ?}
      ?}
   ?};
   rsep:=0;
   prn1:='PRN'; prn2:='PRN'
  ;~~}
  {IF: PAR_WYDR.RODZAJ=1}{SUBSTITUTE: 'LINIA02'}{FI}
{COMMENT} ---- Trzecia linia---- {COMMENT-}
  {IF: FINFO.TOR_D='T'}
    {
     {? PAR_WYDR.RODZAJ=1
     ||
        c[1]:=40-SRST.NST;
        c[2]:='';
        c[3]:=SRST.MD().K;
        c[4]:='';
        c[5]:='';
        c[6]:='';
        c[7]:=SRST.KONDOD().KOD;
        c[8]:=SRST.STAD;
        {? PAR_WYDR.WART_PN=1
        || c[9]:=SRST.SRSR().WARD;
           c[10]:=SRST.SRSR().UMOD;
           c[11]:=SRST.SRSR().NETD
        |? PAR_WYDR.WART_PN=2
        || {? SRST.SRSR().DOKSKR().DW<>date(0,0,0) & SRST.SRSR().DOKSKR().DW<=PAR_WYDR.STAN_NA & PAR_WYDR.MO_DO=2
           || c[9]:=0;
              c[10]:=0;
              c[11]:=0
           || c[9]:=SRST.WARD;
              c[10]:=SRST.UMOD;
              c[11]:=SRST.NETD
           ?}
        ?}
     ?};
     rsep:=0;
     prn1:='PRN'; prn2:='PRN'
   ;~~}
  {IF: PAR_WYDR.RODZAJ=1}{SUBSTITUTE: 'LINIA02'}{FI}
  {FI}
  {rsep:=PAR_WYDR.RSEP;~~}
 {
   {? PAR_WYDR.RODZAJ=1 | PAR_WYDR.RODZAJ=2 || sum_grupa:=SRST.GR().GR1 ?}
 ;~~}
   {FI}
{COMMENT}----------EXCEL-------------{COMMENT-}
{IF: rep_export()}
{
   {? PAR_WYDR.RODZAJ=1
      ||
      c[1]:=SRST.NRI;
      c[12]:=SRST.NST;
      c[2]:=SRST.GR().GR;
      c[3]:=SRST.MP().K;
      c[13]:=SRST.MF().K;
      c[4]:=SRST.ODD().OD;
      c[14]:=SRST.JORG().SYMBOL;
      c[5]:=SRST.SRSR().PRZYCHOD().R;
      c[15]:=form(SRST.SRSR().DE,,1);
      c[6]:=SRST.SRSR().ROZ().R;
      c[16]:={? SRST.SRSR().DES<>date(0,0,0) || form(SRST.SRSR().DES,,1) || '' ?};
      c[7]:=SRST.KONPOD().KOD;
      c[17]:=SRST.KONFIN().KOD;
      c[8]:=SRST.STAP;
      c[18]:=SRST.STAF;


      {? PAR_WYDR.WART_PN=1
      || c[9]:=SRST.SRSR().WARP;
         c[19]:=SRST.SRSR().WARF;
         c[10]:=SRST.SRSR().UMOP+SRST.SRSR().ZALP100;
         c[11]:=SRST.SRSR().NETP-SRST.SRSR().ZALP100;
         c[20]:=SRST.SRSR().UMOF;
         c[21]:=SRST.SRSR().NETF;

         sum_warp+=SRST.SRSR().WARP;
         sum_umop+=SRST.SRSR().UMOP+SRST.SRSR().ZALP100;
         sum_netp+=SRST.SRSR().NETP-SRST.SRSR().ZALP100;

         sum_warf+=SRST.SRSR().WARF;
         sum_umof+=SRST.SRSR().UMOF;
         sum_netf+=SRST.SRSR().NETF;

         g_warp+=SRST.SRSR().WARP; g_umop+=SRST.SRSR().UMOP+SRST.SRSR().ZALP100; g_netp+=(SRST.SRSR().NETP-SRST.SRSR().ZALP100);
         g_warf+=SRST.SRSR().WARF; g_umof+=SRST.SRSR().UMOF; g_netf+=SRST.SRSR().NETF;

         {? FINFO.TOR_D='T'
         || g_ward+=SRST.SRSR().WARD; g_umod+=SRST.SRSR().UMOD; g_netd+=SRST.SRSR().NETD;
            sum_ward+=SRST.SRSR().WARD;
            sum_umod+=SRST.SRSR().UMOD;
            sum_netd+=SRST.SRSR().NETD
         ?}
      |? PAR_WYDR.WART_PN=2
      || c[9]:=SRST.WARP;
         c[10]:=SRST.UMOP+SRST.SRSR().ZALP100;
         c[11]:=SRST.NETP-SRST.SRSR().ZALP100;
         c[19]:=SRST.WARF;
         c[20]:=SRST.UMOF;
         c[21]:=SRST.NETF;
         sum_warp+=SRST.WARP;
         sum_umop+=SRST.UMOP+SRST.SRSR().ZALP100;
         sum_netp+=SRST.NETP-SRST.SRSR().ZALP100;

         sum_warf+=SRST.WARF;
         sum_umof+=SRST.UMOF;
         sum_netf+=SRST.NETF;

         g_warp+=SRST.WARP; g_umop+=SRST.UMOP+SRST.SRSR().ZALP100; g_netp+=(SRST.NETP-SRST.SRSR().ZALP100);
         g_warf+=SRST.WARF; g_umof+=SRST.UMOF; g_netf+=SRST.NETF;
         {? FINFO.TOR_D='T'
         || sum_ward+=SRST.WARD;
            sum_umod+=SRST.UMOD;
            sum_netd+=SRST.NETD;
            g_ward+=SRST.WARD; g_umod+=SRST.UMOD; g_netd+=SRST.NETD
         ?}
      ?}

   ||
      {? PAR_WYDR.WART_PN=1
      || g_warp+=SRST.SRSR().WARP; g_umop+=SRST.SRSR().UMOP+SRST.SRSR().ZALP100; g_netp+=(SRST.SRSR().NETP-SRST.SRSR().ZALP100);
         g_warf+=SRST.SRSR().WARF; g_umof+=SRST.SRSR().UMOF; g_netf+=SRST.SRSR().NETF;

         sum_warp+=SRST.SRSR().WARP;
         sum_umop+=SRST.SRSR().UMOP+SRST.SRSR().ZALP100;
         sum_netp+=SRST.SRSR().NETP-SRST.SRSR().ZALP100;
         sum_warf+=SRST.SRSR().WARF;
         sum_umof+=SRST.SRSR().UMOF;
         sum_netf+=SRST.SRSR().NETF;
         {? FINFO.TOR_D='T'
         || sum_ward+=SRST.SRSR().WARD;
            sum_umod+=SRST.SRSR().UMOD;
            sum_netd+=SRST.SRSR().NETD;
            g_ward+=SRST.SRSR().WARD; g_umod+=SRST.SRSR().UMOD; g_netd+=SRST.SRSR().NETD
         ?}
      |? PAR_WYDR.WART_PN=2
      || g_warp+=SRST.WARP; g_umop+=SRST.UMOP+SRST.SRSR().ZALP100; g_netp+=(SRST.NETP-SRST.SRSR().ZALP100);
         g_warf+=SRST.WARF; g_umof+=SRST.UMOF; g_netf+=SRST.NETF;

         sum_warp+=SRST.WARP;
         sum_umop+=SRST.UMOP+SRST.SRSR().ZALP100;
         sum_netp+=SRST.NETP-SRST.SRSR().ZALP100;
         sum_warf+=SRST.WARF;
         sum_umof+=SRST.UMOF;
         sum_netf+=SRST.NETF;
         {? FINFO.TOR_D='T'
         || g_ward+=SRST.WARD; g_umod+=SRST.UMOD; g_netd+=SRST.NETD;
            sum_ward+=SRST.WARD;
            sum_umod+=SRST.UMOD;
            sum_netd+=SRST.NETD
         ?}
      ?}
   ?}
 ;~~}
  {IF: lineleft() <=4}{PAGE}{FI}
 { {? vp || prn1:='PRN'; prn2:='PRN'?} ;~~}{IF: PAR_WYDR.RODZAJ=1}{SUBSTITUTE: 'LINIA02'}{FI}
  {rsep:=PAR_WYDR.RSEP;~~}
 {FI}
 {
   {? PAR_WYDR.RODZAJ=1 | PAR_WYDR.RODZAJ=2 || sum_grupa:=1+SRST.GR().GR ?}
 ;~~}
 {FI}
 {OD}
{COMMENT} ---- podsumowanie czastkowe za ostatnim rekordem tabeli ---- {COMMENT-}
{COMMENT} ---- Podsumowania nie występują dla excel ---- {COMMENT-}
{IF: ~rep_export()}
  {IF: PAR_WYDR.RODZAJ=1 | PAR_WYDR.RODZAJ=2}
{
   c[1]:='Grupa '@ + sum_grupa + ' razem:'@;
   c[2]:=''; c[3]:=''; c[4]:=''; c[5]:='';  c[6]:=''; c[7]:=''; c[8]:='';
   c[9]:= g_warp; c[10]:= g_umop; c[11]:= g_netp;
   prn1:='PRN'; prn2:='PRNF';
   rsep:=1;~~ }
  {IF: lineleft() <=4}{PAGE}{FI}
  {IF: PAR_WYDR.RODZAJ=1}{FONT: 'T8GB'}{ELSE}{FONT: 'T8G'}{FI}{SPACE: 'C'}{SUBSTITUTE: 'LINIA02'}
{COMMENT} ---- druga linia podsumowania ---- {COMMENT-}
  {
   c[1]:=''; c[2]:=''; c[3]:=''; c[4]:=''; c[5]:=''; c[6]:=''; c[7]:=''; c[8]:='';
   c[9]:= g_warf; c[10]:= g_umof; c[11]:= g_netf;
   rsep:=0;
   prn1:='PRN'; prn2:='PRNF'
   ;~~ }
   {SUBSTITUTE: 'LINIA02'}
{COMMENT} ---- Trzecia linia podsumowania ---- {COMMENT-}
  {IF: FINFO.TOR_D='T'}
  {
   c[1]:=''; c[2]:=''; c[3]:=''; c[4]:=''; c[5]:=''; c[6]:=''; c[7]:=''; c[8]:='';
   c[9]:= g_ward; c[10]:= g_umod; c[11]:= g_netd;
   rsep:=0;
   prn1:='PRNF'; prn2:='PRNF'
   ;~~}
  {SUBSTITUTE: 'LINIA02'}
  {FI}
  {FONT: 'T8G'}{SPACE: 'C'}
 {FI}
 {FI}
 {COMMENT} ---- Podsumowania syntetyczne dla excel ---- {COMMENT-}
 {IF: rep_export()}
  {IF: PAR_WYDR.RODZAJ=2}
{
   c[1]:='Grupa '@ + sum_grupa + ' razem:'@;
   c[9]:= g_warp; c[10]:= g_umop; c[11]:= g_netp;
   prn1:='PRN'; prn2:='PRNF';
   rsep:=1;~~;
   prn1:='PRN';prn2:='PRNF';
   ~~
   }
  {IF: lineleft() <=4}{PAGE}{FI}
{COMMENT} ---- druga linia podsumowania ---- {COMMENT-}
  {
   c[19]:= g_warf; c[20]:= g_umof; c[21]:= g_netf;
   rsep:=0;
   prn1:='PRN'; prn2:='PRNF'
   ;~~ }
   {SUBSTITUTE: 'LINIA02'}
{COMMENT} ---- Trzecia linia podsumowania ---- {COMMENT-}
  {IF: FINFO.TOR_D='T'}
  {
   c[25]:= g_ward; c[26]:= g_umod; c[27]:= g_netd;
   rsep:=0;
   prn1:='PRN'; prn2:='PRNF'
   ;~~}
   {FI}
  { prn1:='PRN'; prn2:='PRN';~~}{SUBSTITUTE: 'LINIA02'}
  {FI}
  {FONT: 'T8G'}{SPACE: 'C'}
{FI}
{COMMENT}------------------------------FOOTER-LAST------------------{COMMENT-}
{IF: lineleft()<>0 & lineleft()<6}{PAGE}{FI}
{FOOTER}{FOOTER-}
{FONT: 'T8GB'}{SPACE: 'C'}
{COMMENT} ---- Podsumowania nie występują dla excel ---- {COMMENT-}
{IF: ~rep_export()}
{
   c[1]:='Ogółem środki trwałe:'@;
   c[9]:=sum_warp;
   c[10]:=sum_umop;
   c[11]:=sum_netp;
   prn1:='PRNF';prn2:='PRNF';
   rsep:=1
;~~}
{SUBSTITUTE: 'LINIA02'}
{
   c[1]:='';
   c[2]:='';
   c[9]:=sum_warf;
   c[10]:=sum_umof;
   c[11]:=sum_netf;
   prn1:='PRNF';prn2:='PRNF';
   "vp:=0";
   rsep:=0
;~~}
{SUBSTITUTE: 'LINIA02'}
{IF: FINFO.TOR_D='T'}
{
   c[1]:='';
   c[9]:=sum_ward;
   c[10]:=sum_umod;
   c[11]:=sum_netd;
   prn1:='PRNF';prn2:='PRNF';
   "vp:=0";
   rsep:=0
;~~}
{SUBSTITUTE: 'LINIA02'}{FI}
{FI}
{ vp:=0; ~~}
{REP: _f:=prn1+'.flbar(lmt)'; ($(_f))()}
