:!UTF-8
┌────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────────────────┬───────────┐
│                                                        │                                                                    │           │
│{FONT: 'e'}{<30                             }{FONT: 'q'}│{FONT: 'e'}{<65                             }{FONT: 'q'}│           │
└────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────┴───────────┘







                    ┌────────────────┬───────────────────┐                                                                         ┌───────────────────────┐
                    │                │                   │                                                                         │                       │
{FONT: 'e'}{<11}{FONT: 'q'}│{FONT: 'e'}{<20}{FONT: 'q'}│{FONT: 'e'}{<32}{FONT: 'q'}│{FONT: 'e'}{<69}{FONT: 'q'} │                       │
                    └────────────────┴───────────────────┘                                                                         └───────────────────────┘
┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                                                                           │
│                                                                                                                                                           │
│                                                                                                                                                           │
│                                                                                                                                                           │
│                                                                                                                                                           │
│                                                                                                                                                           │
╞═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╡{FONT: 'q'}
│{FONT: 'e'}{<78                                                                                                                           }{FONT: 'q'}{<81}│
│                                                                                                                                                           │
│    ┌──────────────────────────────────────────────────────────────────────────────────────────────┬───────────────────────────────────────────────────────┤
│    │                                                                                              │                                                       │
│    │{<7}{FONT: 'e'}{<54}{FONT: 'q'}{<54                                                          }│{<110                                                 }│
╞════╧══════════════════════════════════════════════════════════════════════════════════════════════╧═══════════════════════════════════════════════════════╡
│{FONT: 'e'}{<78                                                                                                                           }{FONT: 'q'}{<81}│
│                                                                                                                                                           │
│                                                                                                                                                           │
│    ┌──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│    │                                                                                                                                                      │
│    │                                                                                                                                                      │
│    ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│    │                                                                                                                                                      │
{i:=0;l:=2;~~}
{WHILE: i<=l}
{DO}{i+=1;~~}
│    │{<7}{FONT: 'e'}{<81                                                                                                                  }{FONT: 'q'}{<84}│
{OD}
╞════╧══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╡
│{<123}│{FONT: 'zw'}
│                                                                                                                                                           │
│    ┌───────────┬─────────────────────────────────────────────────────────────────────────────────────────┬────────────────────────┬───────────────────────┤
│    │           │                                                                                         │                        │                       │
│    │           │                                                                                         │                        │                       │
│    │           │                                                                                         │                        │                       │
│    ├───────────┼─────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────┼───────────────────────┤
│    │           │                                                                                         │                        │                       │
│    ├───────────┼─────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────┼───────────────────────┤
{i:=1;~~}
{WHILE: i<=19-1}
{DO}{i+=1;~~}
│    │           │                                                                                         │                        │                       │
│    │           │                                                                                         │                        │                       │
│    ├───────────┼─────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────┼───────────────────────┤
{OD}
│    │           │                                                                                         │                        │                       │
│    │           │                                                                                         │                        │                       │
└────┴───────────┴─────────────────────────────────────────────────────────────────────────────────────────┴────────────────────────┴───────────────────────┘

                                                                                                                          ┌────────────────────┬────────────┐
                                                                                                                          │{FONT: 'e'}{<134}{FONT: 'q'}{<134}│{FONT: 'e'}{<140}{FONT: 'q'}{<142}│
                                                                                                                          │                    │            │
                                                                                                                          └────────────────────┴────────────┘
{COMMENT}
Dodanie koloru
{COMMENT-}
{ line(2); ~~}{ ' '}{<59  }{COLOR: kl}{<140}{COLOR: bl}
{ line(3); ~~}{ ' '}{<31  }{COLOR: kl}{<78}{COLOR: bl}
{ line(4); ~~}{ ' '}{<59  }{COLOR: kl}{<140}{COLOR: bl}
{ line(17); ~~}{ ' '}{<2  }{COLOR: kl}{<158}{COLOR: bl}
{ line(18); ~~}{ ' '}{<2  }{COLOR: kl}{<158}{COLOR: bl}
{ line(19); ~~}{ ' '}{<2  }{COLOR: kl}{<158}{COLOR: bl}
{ line(20); ~~}{ ' '}{<2  }{COLOR: kl}{<158}{COLOR: bl}
{ line(21); ~~}{ ' '}{<2  }{COLOR: kl}{<158}{COLOR: bl}
{ line(22); ~~}{ ' '}{<2  }{COLOR: kl}{<158}{COLOR: bl}
{ line(23); ~~}{ ' '}{<2  }{COLOR: kl}{<158}{COLOR: bl}
{ line(24); ~~}{ ' '}{<2  }{COLOR: kl}{<82 }{COLOR: bl}
{ line(25); ~~}{ ' '}{<2  }{COLOR: kl}{<158}{COLOR: bl}
{ line(26); ~~}{ ' '}{<2  }{COLOR: kl}{<158}{COLOR: bl}
{ line(27); ~~}{ ' '}{<2  }{COLOR: kl}{<7  }{COLOR: bl}
{ line(28); ~~}{ ' '}{<2  }{COLOR: kl}{<7  }{COLOR: bl}
{ line(29); ~~}{ ' '}{<2  }{COLOR: kl}{<7  }{COLOR: bl}
{ line(30); ~~}{ ' '}{<2  }{COLOR: kl}{<82 }{COLOR: bl}
{ line(31); ~~}{ ' '}{<2  }{COLOR: kl}{<158}{COLOR: bl}
{ line(32); ~~}{ ' '}{<2  }{COLOR: kl}{<158}{COLOR: bl}
{ line(33); ~~}{ ' '}{<2  }{COLOR: kl}{<158}{COLOR: bl}
{ line(34); ~~}{ ' '}{<2  }{COLOR: kl}{<7}{COLOR: bl}
{ line(35); ~~}{ ' '}{<2  }{COLOR: kl}{<7}{COLOR: bl}
{ line(36); ~~}{ ' '}{<2  }{COLOR: kl}{<7  }{COLOR: bl}
{ line(37); ~~}{ ' '}{<2  }{COLOR: kl}{<7  }{COLOR: bl}
{ line(38); ~~}{ ' '}{<2  }{COLOR: kl}{<7  }{COLOR: bl}
{ line(39); ~~}{ ' '}{<2  }{COLOR: kl}{<7  }{COLOR: bl}
{ line(40); ~~}{ ' '}{<2  }{COLOR: kl}{<7  }{COLOR: bl}
{ line(41); ~~}{ ' '}{<2  }{COLOR: kl}{<7  }{COLOR: bl}
{ line(42); ~~}{ ' '}{<2  }{COLOR: kl}{<123 }{COLOR: bl}
{ line(43); ~~}{ ' '}{<2  }{COLOR: kl}{<158 }{COLOR: bl}
{ line(44); ~~}{ ' '}{<2  }{COLOR: kl}{<158 }{COLOR: bl}
{ line(45); ~~}{ ' '}{<2  }{COLOR: kl}{<158 }{COLOR: bl}
{ line(46); ~~}{ ' '}{<2  }{COLOR: kl}{<158 }{COLOR: bl}
{ line(47); ~~}{ ' '}{<2  }{COLOR: kl}{<158 }{COLOR: bl}
{ line(48); ~~}{ ' '}{<2  }{COLOR: kl}{<158 }{COLOR: bl}
{ line(49); ~~}{ ' '}{<2  }{COLOR: kl}{<158 }{COLOR: bl}
{ line(50); ~~}{ ' '}{<2  }{COLOR: kl}{<158 }{COLOR: bl}
{i:=0;~~}
{WHILE: i<=19*3-1}
{DO}
{ line(51+i); i+=1;~~}{ ' '}{<2  }{COLOR: kl}{<7  }{COLOR: bl}
{OD}

{COMMENT}
Dodanie opisów komórek
{COMMENT-}
{ line( 2); ~~}{FONT: 'gr'}{<3 '1. Identyfikator podatkowy NIP podatnika'@}{<60 '2. Numer dokumentu'@}{<129 '3. Status'@}
{ line( 6); ~~}{FONT: 'tyt'}{SPACE: 'b'}{<1 '  VAT-27'}{FONT: 'q'}{SPACE: 'd'}
{ line( 8); ~~}{FONT: 'tyt'}{SPACE: 'b'}{<1 '    INFORMACJA PODSUMOWUJĄCA / KOREKTA INFORMACJI PODSUMOWUJĄCEJ'@}{FONT: 'q'}{SPACE: 'd'}
{ line( 10); ~~}{FONT: 'tyt'}{SPACE: 'b'}{<1'                        W OBROCIE KRAJOWYM                      '@}{FONT: 'q'}{SPACE: 'd'}
{ line( 13); ~~}{FONT: 'gr'}{<23 '4. '+{? SIK.ROZL_VAT='M'||'Miesiąc'@ ||'Kwartał'@ ?}}{<40 '5. Rok'@}{<134 '6. Numer załącznika'@}
{ line(17); ~~}{<2}{FONT: 'zw'}{<3 'Podstawa prawna:    Art. 101a ust.1, 4 albo 5 ustawy z dnia 11 marca 2004 r. o podatku od towarów i usług (Dz. U. z 2011 r. Nr 177, poz 1054,'@}
{ line(18); ~~}{<2}{FONT: 'zw'}{<23 'z późn. zm.), zwanej dalej "ustawą"'}
{ line(19); ~~}{<2}{FONT: 'zw'}{<3 'Termin składania:    Do 25. dnia miesiąca, po okresie, za który składana jest informacja.'@}
{ line(20); ~~}{<2}{FONT: 'zw'}{<3 'Składający:             Podatnicy podatku od towarów i usług dokonujący dostawy towarów lub świadczący usługi, dla których podatnikiem jest'@}
{ line(21); ~~}{<2}{FONT: 'zw'}{<23 'nabywca w przypadkach, o których jest mowa w art. 17 ust. 1 pkt 7 i 8 ustawy.'@}
{ line(22); ~~}{<2}{FONT: 'zw'}{<3 'Miejsce składania:   Urząd skarbowy właściwy dla podatnika.'@}
{ line(24); ~~}{<2}{FONT: 'tyt'}{SPACE: 'b'}{<3 'A. MIEJSCE SKŁADANIA INFORMACJI'@}{SPACE: 'd'}
{ line(27); ~~}{<2}{FONT: 'gr'}{<8 '7. Urząd skarbowy, do którego adresowana jest informacja'@}{<102 '8. Cel złożenia formularza'}{FONT: 'zw'}{'(zaznaczyć właściwy kwadrat):'@}
{ line(28); ~~}{<59}{FONT: 'zw'}{SPACE: 'd'}{{? VAT_DEK.TYP<>'VAT27_KOR' || 'X' || '_' ?}+' 1. złożenie informacji'@}{<80 {? VAT_DEK.TYP<>'VAT27_KOR' || '_' || 'X' ?}+' 2. korekta informacji'@}{FONT: 'prz'}{'1)'}{FONT: 'zw'}
{ line(30); ~~}{<2}{FONT: 'tyt'}{SPACE: 'b'}{<3 'B. DANE IDENTYFIKACYJNE PODATNIKA '@}{SPACE: 'd'}
{ line(32); ~~}{<2}{FONT: 'zw'}{<8 '* - dotyczy podmiotów niebędących osobami fizycznymi'@}{<80 '** - dotyczy podmiotów będących osobami fizycznymi'@}
{ line(34); ~~}{<2}{FONT: 'gr'}{<8 '9. Rodzaj podatnika'@}{FONT: 'zw'}{ '(zaznaczyć właściwy kwadrat):'@}
{ line(35); ~~}{<2}{FONT: 'zw'}{<22 {? VAT_DEK.POD=0 || 'X' || '_' ?}+' 1. podatnik niebędący osobą fizyczną'@}{<92 {? VAT_DEK.POD=1 || 'X' || '_' ?}+' 2. osoba fizyczna'@}
{ line(37); ~~}{<2}{FONT: 'gr'}{<8 '10. Nazwa pełna, REGON* / Nazwisko, pierwsze imię, data urodzenia**'@}
{ line(42); ~~}{<2}{FONT: 'tyt'}{SPACE: 'b'}{<3 'C. INFORMACJA O DOSTAWACH TOWARÓW'@}{FONT: 'zw'}{', do których ma zastosowanie art. 17 ust. 1 pkt 7 ustawy'@}{SPACE: 'd'}
{ line(45); ~~}{<2}{FONT: 'gr'}{SPACE: 'd'}{<8 'Nastąpiła'@}{<110 'Identyfikator podatkowy'@}{<138 'Łączna wartość'@}
{ line(46); ~~}{<2}{FONT: 'gr'}{SPACE: 'd'}{<8 ' zmiana  '@}{<50 'Nazwa lub nazwisko i imię nabywcy'@}{<115 'NIP nabywcy'@}{<137 'transakcji w zł, gr'@}
{ line(47); ~~}{<2}{FONT: 'gr'}{SPACE: 'd'}{<8 ' danych  '@}{<151 'zł, gr'}
{ line(49); ~~}{<2}{FONT: 'gr'}{SPACE: 'd'}{<12 'a'}{<60 'b'}{<120 'c'}{<145 'd'}
{i:=j:=0;~~}
{WHILE: i<19*3}
{DO}
{ line(51+i); i+=1;~~}
{ line(51+i); i+=1;j+=1;~~}{<3}{FONT: 'gr'}{SPACE: 'd'}{<4 form(j,2)}
{ line(51+i); i+=1;~~}
{OD}
{ line(110); ~~}{<2}{FONT: 'q'}{' '}{<126}{FONT: 'tyt'}{SPACE: 'b'}{<126 'VAT-27'}{<136}{FONT: 'tyt'}{SPACE: 'b'}{<136 '1'}{SPACE: 'd'}
{ line(111); ~~}{<2}{FONT: 'zw'}{' '}{<141}{'(1)'}{<149}{'/2'}
{COMMENT}
Wypełnienie komórek
{COMMENT-}
{ line( 3); ~~}{SPACE: 'c'}{<11 XINFO.NIP}{<32 exec('upo_id','xml')}{SPACE: 'd'}
{ line(14); ~~}{<1}{FONT: 'e'}{SPACE: 'c'}{<15 {? SIK.ROZL_VAT='M' || VAT_DEK.OKRES+2 || VAT_DEK.OKRES+1 ?}}{<25 4+VAT_DEK.OKRES}{FONT: 'q'}{SPACE: 'd'}{<80 $__Zal+' / '+$__ZalZ}
{ line(28); ~~}{SPACE: 'c'}{<7 form(XINFO.URZAD().NU,47)}{FONT: 'q'}{SPACE: 'd'}
{STR.split(XINFO.NAZ+', '+XINFO.REGON);i:=0;~~}
{WHILE: STR.next()|i<3}
{DO}
{ line(38+i); i+=1;~~}{SPACE: 'c'}{<9 form(STR.line(71),71)}{FONT: 'q'}{SPACE: 'd'}
{OD}
{VAT_POZ.cntx_psh();
 ilec:=i:=0;~~}
{FOR: VAT_POZ}
{INDEX: 'VAT_POZ'}
{PREFIX: VAT_DEK.ref(),__PrfC}
{DO}
{ilec+=1;~~}
{IF: ilec<=19}
{_p:=VAT_POZ.OP*','; nip:=_p+VAT_POZ.OP-1; naz:=(_p+1)-VAT_POZ.OP; ~~}
{ line(51+i); i+=1;~~}
{ line(51+i); i+=1;~~}{<3}{FONT: 'gr'}{SPACE: 'd'}{<8}{IF: VAT_POZ.Z='T'}{'X Tak   '}{ELSE}{'_ Tak   '}{FI}{<20 naz}{<115 nip}{<140 form(VAT_POZ.NETTO,17,2,' ,')}
{ line(51+i); i+=1; __SumaC+=VAT_POZ.NETTO;~~}
{FI}
{OD}
{VAT_POZ.cntx_pop();~~}