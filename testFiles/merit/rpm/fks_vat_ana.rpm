:!UTF-8
{TITLE:A. Analiza VAT}
{PRINTER: FINFO.SZ_PRN,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN: PRN:=obj_new(@.CLASS.PRINT,10); PRN.sl_frame(); TTVAT.cntx_psh(); w:=obj_new(7);
        color:=''; prn1:=prn2:='PRN'; lm:=ll:=lmt:=dl:=0; vp:=1; rsep:=s_sign:=0;
        PAR_WYDR.TITLE:='Analiza VAT'
}
{END: VAR_DEL.delete('PRN','w'); TTVAT.cntx_pop(); &dl;
      &color; &prn1; &prn2; &lm; &ll; &vp; &lmt; &rsep; &s_sign
}
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzezone
====================================================================================================
Nazwa pliku: vat_ana.rpm
Utworzony:   01-08-2008 [MB] Mariusz Buraczewski
====================================================================================================
Zawartosc: Analiza VAT w podziale na typ podatku (naliczony/nalezny), rejestr VAT, okres VAT
{COMMENT-}
{
 {? __wgkraj=0
 || {? ~rep_expo()
    || PRN.add("TTVAT.POZ*'  '+{? TTVAT.POZ=3 || '' |? TTVAT.tr_state() || '-' || '+' ?}+TTVAT.LABEL",45,'')
    || PRN.add("TTVAT.SYM",45,'Symbol dokumentu')
    ?};
    PRN.add("form(TTVAT.NETTO,16,2,' ,')",16,'Kwota netto',1);
    PRN.add("form(TTVAT.VAT,16,2,' ,')",16,'Kwota VAT',1);
    PRN.add("form(TTVAT.VAT_ODL,16,2,' ,')",16,'Kwota VAT do odliczenia',1);
    PRN.add("form(TTVAT.BRUTTO,16,2,' ,')",16,'Kwota brutto',1);
    PRN.add("TTVAT.KH",35,'Kontrahent');
    PRN.add("TTVAT.DATA_DOK",10,'Data dok.');
    PRN.add("TTVAT.DATA_TP",10,'Term. pł.')
||  {? ~rep_expo()
    || PRN.add("TTVAT.POZ*'  '+{? TTVAT.POZ=3 || '' |? TTVAT.tr_state() || '-' || '+' ?}+TTVAT.LABEL",45,'')
    || PRN.add("TTVAT.SYM",45,'Symbol dokumentu')
    ?};
    PRN.add("TTVAT.KRAJ",18,'Kraj opodatkowania');
    PRN.add("TTVAT.KWARTAL",8,'Kwartał');
    PRN.add("form(TTVAT.NETTO,16,2,' ,')",16,'Kwota netto',1);
    PRN.add("form(TTVAT.VAT,16,2,' ,')",16,'Kwota VAT',1);
    PRN.add("form(TTVAT.VAT_ODL,16,2,' ,')",16,'Kwota VAT do odliczenia',1);
    PRN.add("form(TTVAT.BRUTTO,16,2,' ,')",16,'Kwota brutto',1);
    PRN.add("TTVAT.KH",35,'Kontrahent');
    PRN.add("TTVAT.DATA_DOK",10,'Data dok.');
    PRN.add("TTVAT.DATA_TP",10,'Term. pł.')
 ?};
 ~~}
{INCLUDE: wsp_pw.rpi}
{DEFINEFONT: 'T8u='+PAR_WYDR.FONTTAB+',100,P,8'}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: ~rep_expo()}{SUBSTITUTE: 'FOOT'}{FI}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}{FONT: 'W8'}{SPACE: 'C'}
{IF: page=1}
   {<1 'Parametry wydruku:'}
   {<3 {? OPERATOR.DEPT || 'Jednostka księgowa: '+OPERATOR.DEPT().OD || 'Wszystkie jednostki księgowe'?}}
   {<3 'Okres: '+SSTALE.AO().NAZ+' '+OKRO_F.ROK().NAZ}
   {<3 'Waluta opodatkowania: '+SSTALE.WAL().KOD}
   {<3 {? TTPAR.ALL || 'Wszystkie dokumenty' || 'Bez dokumentów pomijanych w JPK_V7' ?}}
{FI}
{FONT: 'T8B'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}{ vp:=1;~~}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}{FONT: 'T8'}{SPACE: 'C'}
{SUBSTITUTE: 'LINIAF'}{ vp:=1;~~}
{FOOTER-}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{MACRO: 'TREE'}
{IF: TTVAT.tr_state()}
{FOR: TTVAT}
{INDEX: TTIND}
{PREFIX: TTVAT.ref()}
{DO}
   {IF: TTVAT.POZ=4}{IF: TTVAT.POMIN}{FONT: 'T8u'}{ELSE}{FONT: 'T8'}{FI}{ELSE}{FONT: 'T8B'}{FI}
   {IF: (~rep_expo() ) | TTVAT.REF<>0}
   {SUBSTITUTE: 'LINIA02'}
   {FI}
   {SUBSTITUTE: 'TREE'}
{OD}
{FI}
{MACRO-}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8'}{SPACE: 'C'}
{FOR: TTVAT}
{INDEX: TTIND}
{PREFIX: 0}
{DO}
   {IF: TTVAT.POZ=4}{FONT: 'T8'}{ELSE}{FONT: 'T8B'}{FI}
   {IF: (~rep_expo()) | TTVAT.REF<>0}{SUBSTITUTE: 'LINIA0'}{FI}
   {SUBSTITUTE: 'TREE'}
{OD}