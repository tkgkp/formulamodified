:!UTF-8
{TITLE:ZZ.  Wniosek o zwrot podatku VAT}
{PRINTER: 'port_std',,,,,'Q','C',,,,,,1,0,0,0,0,1,1,'A4'}
{BEGIN:
   exec('rpm_as_pdf_ini','rpm_pdf');
   l:=i:=-1; k:=0; STR.split(XINFO.NAZ+', '+XINFO.REGON); {! |? l+=1; STR.line(71); STR.next() !};
   tekst :=exec('uzasad','!fks_ved_dvod',VAT_DEK.ref);
   STR.split(4500+tekst); {! |? k+=1; STR.line(135); STR.next() !}; k+=1;
   kl:='0:0:0,240:240:240'; bl:='0:0:0,255:255:255'; ks:='0:0:0,200:200:200';
   _size:=exec('vat_zd_size','fks_ved','N');
   vatzdstr:=_size%8+(_size%*8>0);
   vatzdzob:=exec('vat_zd_size','fks_ved','z');
   VAR_DEL.delete('sel','tmp');
   tmp:=tab_tmp(,'KOD','STRING[1]','KOD','OPIS','STRING[180]','Opis');
   ndx:=tmp.ndx_tmp(,1,'KOD',,);
   tmp.index(ndx);
   tmp.KOD:='1';
   tmp.OPIS:='1) Zwrot podatnikowi, który dokonywał dostawy towarów lub świadczył usługi poza terytorium kraju';
   tmp.OPIS+=' i nie dokonywał sprzedaży opodatkowanej';
   tmp.add();
   tmp.KOD:='2';
   tmp.OPIS:='2) Zwrot podatnikowi, który nie dokonywał w okresie rozliczeniowym czynności opodatkowanych na terytorium kraju oraz czynności,';
   tmp.OPIS+=' o których mowa w art. 86 ust. 8 pkt 1 ustawy';
   tmp.add();
   tmp.KOD:='3';
   tmp.OPIS:='3) Zwrot podatnikowi, który dokonywał nabycia (importu) towarów lub usług finansowych ze środków bezzwrotnej pomocy zagranicznej';
   tmp.add();
   tmp.KOD:='4';
   tmp.OPIS:='4) W innych przypadkach niż wymienione w pkt 1-3, jeżeli wniosek o zwrot składany jest zgodnie z przepisami o podatku od towarów i usług';
   tmp.add();
   sel:=tmp.mk_sel('Powód zwrotu',,,,,,6);
   tmp.win_fld(sel,tmp,'OPIS');
   tmp.win_act(sel,0,'Formuła','TEN',,'Ten',"sel_exit()",,1);
   tmp.win_sel(sel);
   tmp.find_key(1+tekst);
   tmp.seek(tmp.ref)
}
{END: exec('rpm_as_pdf_end','rpm_pdf');
 VAR_DEL.delete('vatzdstr','vatzdzob','kl','ndx','bl','ks','l','i','k','tmp','sel','tekst') }
{EXIT: ~tmp.select(,1,4)}
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
========================================================================================================================
Nazwa pliku: vat_zz.rpm [MM]
Utworzony: 21.06.2017
========================================================================================================================
Zawartość: Wydruk dokumentu o zwrot podartku VAT
{COMMENT-}
{exec('powod','!fks_ved_dvod',VAT_DEK.ref,tmp.KOD);~~}
{GRAPHIC: 'vat-zz.pdf';1;10;10;10;10}
{GRAPHICFONT: 'Arial';13;'';'0:0:0'}
{IF: VAT_DEK.POD=0}{REP: '1. NIP';Kratki(STR.gsub(XINFO.NIP,'-',''),19.3,4.2,23)}{FI}
{GRAPHICTEXT: exec('upo_id','xml');111;23;32;'left'}
{GRAPHICTEXT: exec('urzad','!fks_ved_dvod',XINFO.URZAD);21;57;172;'left'}
{IF:VAT_DEK.POD=0}
 {GRAPHICTEXT: 'X';33.8;83.1;170;'left'}
{ELSE}
 {GRAPHICTEXT: 'X';124.5;83.1;170;'left'}
{FI}
{IF: VAT_DEK.POD=0}
 {GRAPHICTEXT: XINFO.NAZ;21;95.5;178}
{ELSE}
 {GRAPHICTEXT: VAT_DEK.OS_PODAT().NAZWISKO+' '+VAT_DEK.OS_PODAT().PIERWSZE+', '+VAT_DEK.OS_PODAT().UR_DATA $ 5+' r.';21;95.5;178}
{FI}
{GRAPHICTEXT: gsub(form(exec('zwrot','!fks_ved_dvod',VAT_DEK.ref()),,2),'.',' ')+' zł';19.9;175;170;'left'}
{IF: tmp.KOD='1'}{GRAPHICTEXT: ' X ';19.9;116;170;'left'}{FI}
{IF: tmp.KOD='2'}{GRAPHICTEXT: ' X ';19.9;128.7;170;'left'}{FI}
{IF: tmp.KOD='3'}{GRAPHICTEXT: ' X ';19.9;141;170;'left'}{FI}
{IF: tmp.KOD='4'}{GRAPHICTEXT: ' X ';19.9;153.2;170;'left'}{FI}
{GRAPHICFONT: 'Arial'; 10; ''; '0:0:0'}
{tekst:=exec('uzasad','!fks_ved_dvod',VAT_DEK.ref);ile:=1;y:=183;~~}
{{? tekst*'\t' || tekst:=STR.gsub(tekst,'\t',' ') ?};~~}
{STR.split(3-tekst,'\n');~~}
{WHILE: STR.next()&y<=220}
{DO}
 {GRAPHICTEXT: form(STR.line(105),107);19.9;y;200;'left'}
 {y:=y+5;ile:=ile+1;~~}
{OD}
{IF: y>220}
 {msg('Tekst uzasadnienia jest za długi, więc został skrócony! \n Proszę skrócić uzasadnienie.','Uwaga!');~~}
{FI}
{GRAPHICTEXT:  VAT_DEK.IMIE;19.9;233;50;'left'}
{GRAPHICTEXT: VAT_DEK.NAZ;111.9;233;50;'left'}
{REP: 'Dzień';Kratki({? +($(VAT_DEK.DATA~3))=1 || '0'+$(VAT_DEK.DATA~3) || $(VAT_DEK.DATA~3)?},69,4,242.3)}
{REP: 'Miesiąc';Kratki({? +($(VAT_DEK.DATA~2))=1 || '0'+$(VAT_DEK.DATA~2) || $(VAT_DEK.DATA~2)?},79.8,3.9,242.3)}
{REP: 'Rok';Kratki($(VAT_DEK.DATA~1),90.8,4,242.3)}
{GRAPHIC-}