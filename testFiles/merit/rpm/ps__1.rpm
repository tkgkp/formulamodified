:!UTF-8
{TITLE:A. Plan sprzedaży}
{PRINTER: exec('set_parw','param_wydr');exec('prt','param_wydr','h'),exec('nopanel','param_wydr','S'),,,,'Q','C',,,,,,1,
   10,10,10,10,0,exec('get','#params',2121,2,OPERATOR.USER)<>'T'}
{BEGIN:
   ps__01:="
      VAR_DEL.delete('PRN','PRNS','w','dokl','doklw','doklp','color_frame_g');
      VAR_DEL.delete('__plps','__ind_ps');

      VAR_DEL.delete('color','prn1','prn2');
      VAR_DEL.delete('lm','ll','vp','lmt','rsep')";
   ps__01();
   color_frame_g:='204:204:204';

   _empty_char:={? exec('get','#params', 100236, 2)='N' || ^160 || ' ' ?};

   PRN:=obj_new(@.CLASS.PRINT,7,_empty_char*3,'  ' ,'  ', '───' ,'  ' ,'──','─',' ');
   PRN.framecol(color_frame_g);
   dokl:=3; "--dokladnosc ilosci--";
   doklw:=2; "--dokladnosc wartosc--";
   doklp:=1; "--dokladnosc procent--";
   w:=obj_new(7); "--wartosci kolumn--";

   "--zmienne pomocnicze do wydrukow graficznych--";
   color:='';
   prn1:='PRN'; prn2:='PRNS';
   lm:=ll:=vp:=lmt:=0; rsep:=PAR_WYDR.RSEP;

   PAR_WYDR.TITLE:='Plan sprzedaży';
~~}
{END:
   ps__01(); VAR_DEL.delete('ps__01');
~~}
{INCLUDE: wsp_pw.rpi}
{DEFINEFONT: 'TM=Inter,100,Q,,0,0'}
{DEFINEFONT: 'TMB=Inter,100,R,,0,0'}
{DEFINEFONT: 'TF=Inter,100,F,,0,0'}
{DEFINEFONT: 'IE=Inter,150,E,,0,0'}
{DEFINEFONT: 'IF=Inter,150,F,,0,0'}
{DEFINEFONT: 'HEAD=Inter,100,M,8'}
{DEFINEFONT: 'TITLE=Inter,100,F,8'}
{DEFINEFONT: 'SIGN=Inter,100,M,8'}
{
PRN.add("w[1]",100,'Struktura');
PRN.add("w[2]",15,'Ilość',1);
PRN.add("w[3]",15,'Ilość - wykonanie',1);
PRN.add("w[4]",15,'Ilość - wykonanie[%]',1);
{? __Logupr.CS=0
||
   PRN.add("w[5]",15,'Wartość',1);
   PRN.add("w[6]",15,'Wartość - wykonanie',1);
   PRN.add("w[7]",15,'Wartość - wykonanie[%]',1)
?};
~~}
{FONT: exec('font','param_wydr','T8GB')}
{COMMENT}   SIGNATURE                                                {COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}   REPORT-HEADER                                            {COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: exec('font','param_wydr','T8G')}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{<{lmt+3}}{'Parametry wydruku:'} {PS.S+' '+PS.OP+', '
+exec('tr','tlumaczenia','1000152')+': '+(SLO.cntx_psh();_kod:=PS.WAL().KOD;SLO.cntx_pop();_kod)}
{FONT: exec('font','param_wydr','T8GB')}
{SUBSTITUTE: 'TABHEAD'}{FONT: exec('font','param_wydr','T8G')}{ vp:=1; ~~}
{COMMENT}   HEADER                                                   {COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: exec('font','param_wydr','T8GB')}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}   FOOTER                                                   {COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}   WYDRUK                                                   {COMMENT-}
{MACRO:'splinia'}
   {
   w[1]:=' '*(__plps.P*5)+__plps.O;
   w[2]:=form(__plps.IL,,dokl,'.,');
   w[3]:=form(__plps.ILW,,dokl,'.,');
   w[4]:=form(__plps.ILWP,,doklp,'.,');
   w[5]:=form(__plps.W,,doklw,'.,');
   w[6]:=form(__plps.WW,,doklw,'.,');
   w[7]:=form(__plps.WWP,,doklp,'.,');
   ~~}
   {SUBSTITUTE: 'LINIA0'}
{MACRO-}
{FONT: exec('font','param_wydr','T8G')}{SPACE: 'C'}
{exec('psp_tree','plsprz',0,1,'N');
 __plps.ndx_drop();
 __ind_ps:=__plps.ndx_tmp('',,'P',,,'PARENT',,,'O',,);~~}
{FOR: '__plps'}
{INDEX: __ind_ps}
{PREFIX: 0}
{DO}
   {SUBSTITUTE: 'splinia'}
   {FOR: '__plps'}
   {INDEX: __ind_ps}
   {PREFIX: 1,__plps.ref}
   {DO}
      {SUBSTITUTE: 'splinia'}
      {FOR: '__plps'}
      {INDEX: __ind_ps}
      {PREFIX: 2,__plps.ref}
      {DO}
         {SUBSTITUTE: 'splinia'}
         {FOR: '__plps'}
         {INDEX: __ind_ps}
         {PREFIX: 3,__plps.ref}
         {DO}
            {SUBSTITUTE: 'splinia'}
            {FOR: '__plps'}
            {INDEX: __ind_ps}
            {PREFIX: 4,__plps.ref}
            {DO}
               {SUBSTITUTE: 'splinia'}
               {FOR: '__plps'}
               {INDEX: __ind_ps}
               {PREFIX: 5,__plps.ref}
               {DO}
                  {SUBSTITUTE: 'splinia'}
                  {FOR: '__plps'}
                  {INDEX: __ind_ps}
                  {PREFIX: 6,__plps.ref}
                  {DO}
                     {SUBSTITUTE: 'splinia'}
                     {FOR: '__plps'}
                     {INDEX: __ind_ps}
                     {PREFIX: 7,__plps.ref}
                     {DO}
                        {SUBSTITUTE: 'splinia'}
                        {FOR: '__plps'}
                        {INDEX: __ind_ps}
                        {PREFIX: 8,__plps.ref}
                        {DO}
                           {SUBSTITUTE: 'splinia'}
                           {FOR: '__plps'}
                           {INDEX: __ind_ps}
                           {PREFIX: 9,__plps.ref}
                           {DO}
                              {SUBSTITUTE: 'splinia'}
                              {FOR: '__plps'}
                              {INDEX: __ind_ps}
                              {PREFIX: 10,__plps.ref}
                              {DO}
                                 {SUBSTITUTE: 'splinia'}
                              {OD}
                           {OD}
                        {OD}
                     {OD}
                  {OD}
               {OD}
            {OD}
         {OD}
      {OD}
   {OD}
{OD}