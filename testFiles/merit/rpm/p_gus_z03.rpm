:!UTF-8
{TITLE: Sprawozdanie Z-03}
{PRINTER: exec('prt','param_wydr','h',KST),,,,,'Q','C',,,,,,1,
          PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   VAR_DEL.delete('tresc','par','__TPAR');
   tresc:='spr_z03';
   par:=obj_new(7);

   PAR_WYDR.TITLE:='Dane do sprawozdania Z-03'@;

   par[7]:=__F_ZATR.P;
   __F_ZATR.mod('P');
   par[5]:=exec('gus_rok_mce','!pkd_roz_zsst','Z-03');

   par[3]:=tab_tmp(1,
      'DZIAL','INTEGER','Dział'@,
      'TYT','STRING[110]','Tytuł'@,
      'KOL1','STRING[40]','Kolumna 1'@);

   par[2]:=tab_tmp(2,
      'DZIAL','INTEGER','Dział'@,
      'IND','INTEGER','Index'@,
      'KOD','STRING[5]','Kod'@,
      'NAZWA','STRING[100]','Nazwa'@,
      'WAR1','REAL','Wartość kolumny 1'@);

   {? par[5]
   || exec('spr_Z03_2011','!pkd_roz_zsst',__TPAR.ROK,__TPAR.MOD,__TPAR.MDO)
   ?};

   par[1]:=obj_new(@.CLASS.PRINT,4);
   par[1].add("par[2].KOD",5,'Kod'@);
   par[1].add("par[2].NAZWA",100,'Nazwa'@);
   par[1].add("par[2].WAR1",20,'Dane'@,1,,,,,'12,2');
   par[1].s_frame();

   par[6]:=1;
   par[4]:=0;
   prn1:='par[1]';
   lmt:=0;
   vp:=rsep:=1;
   h_rat:=1

}
{END:
   __F_ZATR.mod(par[7]);
   VAR_DEL.delete('tresc','par','prn1','vp','lmt','rsep','h_rat','__TPAR')
}
{EXIT: ~par[5]}
{COMMENT}OLD: gus_z03.rpm{COMMENT-}
{COMMENT}OLD: skid_pw.rpi{COMMENT-}
{COMMENT}OLD: std_info.rpi{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{COMMENT}
══════════════════════════════════════════════════════════════════════════════

   K O N F I G U R A C J A   -   N A G Ł ╙ W E K,   S T O P K A

{COMMENT-}
{HEADER}
{FONT: 'T8'}{ h_rat:=charleft; ~~ }
{SUBSTITUTE: 'HEAD'}
{ h_rat:=charleft/h_rat; ~~ }
{<{ceil(lmt*h_rat)-9} 'DZIAŁ '+$int(par[3].DZIAL)+'. '+par[3].TYT}
{IF: par[6]}
{ par[6]:=0; ~~}
{FONT: 'T8'}{ h_rat:=charleft; ~~ }
{FONT: 'T8G'}{ h_rat:=charleft/h_rat; ~~ }
   {FONT: 'T8G'}
   {SPACE: 'C'}
   {LINE}
   {<{ceil(lmt*h_rat)+1}'Parametry sprawozdania'@}
   {<{ceil(lmt*h_rat)+1}'Zakres danych: %1 - %2'@
      [date(__TPAR.ROK,__TPAR.MOD,1)$8,date(__TPAR.ROK,__TPAR.MDO,0)$8]
   }
{FI}
{FONT: 'T8B'}
{SPACE: 'B'}
{LINE}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{FOOTER: 0}
{FONT: 'T8'}
{SPACE: 'B'}
{SUBSTITUTE: 'LINIAF'}
{FOOTER-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}
══════════════════════════════════════════════════════════════════════════════

   M A K R O D E F I N I C J E

{COMMENT-}
{MACRO: tresc}
{FOR: par[2]}{PREFIX:par[3].DZIAL}
{DO}
      {SUBSTITUTE: 'LINIA0'}
{OD}
{MACRO-}
{COMMENT}
══════════════════════════════════════════════════════════════════════════════

   Z A W A R T O Ś Ć   W Y D R U K U

{COMMENT-}
{FONT: 'T8'}
{SPACE: 'B'}
{ lmt:=int((charleft-par[1].width())/2); ~~ }
{FOR: par[3]}
{DO}
   {IF:par[3].DZIAL>1}{PAGE}{FI}
   {SUBSTITUTE: tresc}
{OD}