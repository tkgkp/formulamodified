:!UTF-8
{TITLE:B. Lista wierszy - algorytmy}
{PRINTER: SIK.PRT,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
   PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
   dz:=obj_new(15);   i:=j:=0;il:=0; ok:=0; licz:=0;
   paralg:=obj_new(10);
   {! _i:=1..10 |! paralg[_i]:='' !};
   par1:=par2:=npar1:=npar2:='';  dru_kol:=1;
   SIK.GRUP:=2; SIK.DANEWSKP:=0; SIK.ALGROK:=null;
   SIK.EXF_JEDN:='N';
   {? ~rep_export()
   || SIK.win_edit('SKID_GR2')
   || SIK.DANEWSKP:=1;
      SIK.win_edit('SKID_GR3');
      SIK.efld_opt(SIK.win_edit('?'),'enable=1, editable=1',,'EXF_JEDN')
   ?};
   PRN:=obj_new(@.CLASS.PRINT,26); PRN.sl_frame();
   color:=prn1:=prn2:=''; lm:=ll:=lmt:=rsep:=0; vp:=1; GR_SIK.win_sel('SLO2')
}
{END:
   VAR_DEL.delete('PRN','dz','paralg'); &il; &i; &j; &ok; &licz;
   &par1; &par2; &npar1; &npar2; &dru_kol;
   &color; &prn1; &prn2; &lm; &ll; &vp; &lmt; &rsep
}
{EXIT: ~SIK.edit()}
{  PRN.add("dz[1]",3,'LP.'@,1);
   {? ~rep_export()
   || PRN.add("dz[2]",38,'KOD / NAZWA'@)
   || PRN.add("dz[2]",16,'KOD'@);
      PRN.add("dz[14]",40,'NAZWA'@)
   ?};
   PRN.add("dz[4]",1,'A'@);
   {? ~rep_export()
   || PRN.add("dz[13]",12,'ZAOKR./DOKŁ.'@)
   || PRN.add("dz[13]",12,'ZAOKRĄGLENIE'@,1);
      PRN.add("dz[15]",12,'DOKŁADNOŚĆ'@,1)
   ?};
   {? ~rep_export()
   || PRN.add("dz[11]",10,'WSPÓŁCZ.'@,1)
   || PRN.add("dz[11]",10,'WSPÓŁCZYNNIK WIERSZA'@,1)
   ?};
   {? ~rep_export()
   || PRN.add("dz[12]",30,'%1WSPÓŁCZYNNIK - FORMUŁA#%2PARAMETRY WIER.PODSTAWOWEGO'@[6*' ',3*' '],,'#')
   || PRN.add("dz[12]",30,'%1WSPÓŁCZYNNIK - FORMUŁA, PARAMETRY WIER.PODSTAWOWEGO'@[6*' '],,'#')
   ?};
   PRN.add("dz[5]",3,'KOL',1);
   PRN.add("dz[6]",10,'SPRAWOZD.');
   {? SIK.DANEWSKP
   || {? SIK.EXF_JEDN='T'
      || PRN.add("dz[7]",50,'WIERSZ'@);
         PRN.add("paralg[1]",11,'PARAMETR 1'@);
         PRN.add("paralg[2]",11,'PARAMETR 2'@);
         PRN.add("paralg[3]",11,'PARAMETR 3'@);
         PRN.add("paralg[4]",11,'PARAMETR 4'@);
         PRN.add("paralg[5]",11,'PARAMETR 5'@);
         PRN.add("paralg[6]",11,'PARAMETR 6'@);
         PRN.add("paralg[7]",11,'PARAMETR 7'@);
         PRN.add("paralg[8]",11,'PARAMETR 8'@);
         PRN.add("paralg[9]",11,'KOLUMNA'@);
         PRN.add("paralg[10]",11,'ROK OBOW.'@)
      || PRN.add("dz[7]",75,'%1WIERSZ/PARAMETRY WIERSZY PODSTAWOWYCH'@[18*' '])
      ?}
   || PRN.add("dz[7]",50,'WIERSZ'@)
   ?};
   {? ~rep_export()
   || PRN.add("dz[8]",3,'KOL'@)
   || PRN.add("dz[8]",17,'KOLUMNA ARGUMENTU'@)
   ?};
   PRN.add("dz[9]",10,'WSPÓŁCZ.'@,1);
   PRN.add("dz[10]",1,'T',1);
   PAR_WYDR.TITLE:='%1 - algorytmy wierszy'@[GR_SIK.NAZWA];
   prn1:=prn2:='PRN'; ~~}
{INCLUDE: wsp_pw.rpi}
{ lmt:=int((charleft()-PRN.width())/2);~~}
{COMMENT}------------------------------linia------------------------{COMMENT-}
{MACRO: 'linia'}
{ lmt:=int((charleft()-PRN.width())/2);~~}
{SUBSTITUTE: 'LINIA0'}
{MACRO-}
{COMMENT}------------------------------param------------------------{COMMENT-}
{MACRO: 'param'}
{  par1:=par2:=npar1:=npar2:='';
   {! licz:=(licz+1)..8 |?
      {? |($('ALG_PAR.P'+$licz))()<>''
      || {? par1=''
         || par1:=($('ALG_PAR.P'+$licz))(); npar1:=$licz
         || par2:=($('ALG_PAR.P'+$licz))(); npar2:=$licz
         ?}
      ?};
      par2=''
   !};~~
}
{IF: par1<>'' | par2<>''}
{ dz[7]:='PARAMETR '+npar1+': '+form(par1,35)+{? par2<>'' ||'PARAMETR '+npar2+': '+par2|| '' ?};~~}
{SUBSTITUTE: 'linia'}
{FI}
{MACRO-}
{COMMENT}------------------------------linia_f1---------------------{COMMENT-}
{MACRO: 'linia_f1'}
{ dz[7]:={? dru_kol || 'KOL.: '+form(ALG_PAR.GR_KOL().NAZWA,50) || 56*' ' ?}+
         'FORMUŁA: '+ALG_PAR.FORMULA().SKROT; licz:=0; dru_kol:=0; ~~}
{SUBSTITUTE: 'linia'}
{WHILE: licz<8}{DO}{SUBSTITUTE: 'param'}{OD}
{ dz[7]:='WSPÓŁCZ.: %1'@[form(ALG_PAR.WSP,10,6,'9.')]+
         {? SIK.ALGROK=null || '    ROK OBOW.: %1'@[form(ALG_PAR.ROK().NAZ,20)] || '' ?};~~}
{SUBSTITUTE: 'linia'}
{MACRO-}
{COMMENT}------------------------------linia_f----------------------{COMMENT-}
{MACRO: 'linia_f'}
{SUBSTITUTE: 'linia'}
{ {? ~rep_export() || {! j:=1..15 |! dz[j]:='' !} ?}; dru_kol:=1;~~}
{IF: SIK.ALGROK=null | ALG_PAR.ROK=SIK.ALGROK}
 {SUBSTITUTE: 'linia_f1'}
{FI}
{MACRO-}
{COMMENT}------------------------------petla------------------------{COMMENT-}
{MACRO: 'petla'}
{ PAR_WYDR.TITLE:='%1 - algorytmy wierszy'@[GR_SIK.NAZWA];
  WYRAZ.GRUPA:=GR_SIK.ref; {? ~rep_export() || i:=0 ?}; ~~}
{FOR: 'DEFW'}{INDEX: 'LP'}{PREFIX: WYRAZ.GRUPA}
{DO}
 { i+=1;
   {! j:=1..15 |! dz[j]:='' !};
   {? ~rep_export() || dz[1]:=form(i) ?};
   {? ~rep_export() || dz[2]:=DEFW.KOD+' - '+DEFW.NAZWA ?};
   {? ~rep_export() || dz[4]:=DEFW.ALGORYTM ?};
   {? ~rep_export() || dz[11]:=form(DEFW.WSPOL,,6,' ,') ?};
   {? +DEFW.WSPOLF || dz[12]:='FORMUŁA: ['+DEFW.WSPOLF+']' ?};
   {? DEFW.ALGORYTM='F' & (DEFW.TAB<>'' | DEFW.SLU<>null)
   || {? DEFW.TAB<>''
      || dz[12]:=dz[12] + {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'TAB: [' + DEFW.TAB+'] ';
         dz[12]:=dz[12] + {? DEFW.INDEX<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + form('INDEX: ['  + DEFW.INDEX  + '] ',31) || '' ?};
         dz[12]:=dz[12] + {? DEFW.PREFIX<>'' || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'PREFIX: [' + DEFW.PREFIX + '] ' || '' ?};
         dz[12]:=dz[12] + {? DEFW.KODF<>''   || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} +
                                                {?+('KOD: ['    + DEFW.KODF   + '] ')<31
                                                || form('KOD: ['    + DEFW.KODF   + ']',31)
                                                || 'KOD: ['+DEFW.KODF+']'
                                                ?}
                                             || '' ?};
         dz[12]:=dz[12] + {? DEFW.MASKA<>''
                          || {? +dz[12]
                             || {? ~rep_export() || '#' || ' ' ?}
                             || '' ?} + 'MASKA: ['  + DEFW.MASKA  + '] '
                          || '' ?};
         dz[12]:=dz[12] + {? DEFW.TR<>''     || {? +dz[12] || {? ~rep_export() || {? ~rep_export() || '#' || ' ' ?} || ' ' ?} || '' ?} + 'NAZWA: ['  + DEFW.TR     + '] ' || '' ?}
      |? DEFW.SLU<>null
      || dz[12]:=dz[12] + {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'SŁOWNIK: ['+DEFW.SLU().SLU().NAZ+'] ';
         dz[12]:=dz[12] + {? DEFW.MASKA<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'MASKA: ['  + DEFW.MASKA  + '] ' || '' ?}
      ?}
   ?};
   {? ~rep_export() || dz[13]:={? -DEFW.ALGORYTM<>'p'
                    || $DEFW.ZAOKR+(11-(+($DEFW.ZAOKR)))*' '+$DEFW.DOKL
                    || ''
                    ?}
   ?};
   WYRAZ.WIERSZ:=DEFW.ref;~~}
  {IF: 'SIW'*DEFW.ALGORYTM>0}
   { DEFA.index('LP');
     DEFA.prefix(WYRAZ.WIERSZ);~~}
   {IF: DEFA.first()=0}
    { {? rep_export() || dz[1]:=form(i) ?}; ~~}
    { {? rep_export() || dz[2]:=DEFW.KOD ?}; ~~}
    { {? rep_export() || dz[14]:=DEFW.NAZWA ?}; ~~}
    { {? rep_export() || dz[4]:=DEFW.ALGORYTM ?}; ~~}
    { {? rep_export() || dz[13]:={? -DEFW.ALGORYTM<>'p' || $DEFW.ZAOKR || '' ?} ?}; ~~}
    { {? rep_export() || dz[15]:={? -DEFW.ALGORYTM<>'p' || $DEFW.DOKL || '' ?} ?}; ~~}
    { {? rep_export() || dz[11]:=form(DEFW.WSPOL,,6,' ,') ?}; ~~}
    { {? rep_export() || {? +DEFW.WSPOLF || dz[12]:='FORMUŁA: ['+DEFW.WSPOLF+']' ?};
                         {? DEFW.ALGORYTM='F' & (DEFW.TAB<>'' | DEFW.SLU<>null)
                         || {? DEFW.TAB<>''
                         || dz[12]:=dz[12] + {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'TAB: [' + DEFW.TAB+'] ';
                            dz[12]:=dz[12] + {? DEFW.INDEX<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + form('INDEX: ['  + DEFW.INDEX  + '] ',31) || '' ?};
                            dz[12]:=dz[12] + {? DEFW.PREFIX<>'' || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'PREFIX: [' + DEFW.PREFIX + '] ' || '' ?};
                            dz[12]:=dz[12] + {? DEFW.KODF<>''   || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} +
                                                {?+('KOD: ['    + DEFW.KODF   + '] ')<31
                                                || form('KOD: ['    + DEFW.KODF   + ']',31)
                                                || 'KOD: ['+DEFW.KODF+']'
                                                ?}
                                             || '' ?};
                           dz[12]:=dz[12] + {? DEFW.MASKA<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'MASKA: ['  + DEFW.MASKA  + '] ' || '' ?};
                           dz[12]:=dz[12] + {? DEFW.TR<>''     || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'NAZWA: ['  + DEFW.TR     + '] ' || '' ?}
                         |? DEFW.SLU<>null
                         || dz[12]:=dz[12] + {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'SŁOWNIK: ['+DEFW.SLU().SLU().NAZ+'] ';
                           dz[12]:=dz[12] + {? DEFW.MASKA<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'MASKA: ['  + DEFW.MASKA  + '] ' || '' ?}
                         ?}
   ?} ?}; ~~}
    {SUBSTITUTE: 'linia'}
   {ELSE}
    { kolumna:=0;~~}
    {FOR: 'DEFA'}{INDEX: 'LP'}{PREFIX: WYRAZ.WIERSZ}
    {DO}
      { {? rep_export() || dz[1]:=form(i) ?}; ~~}
      { {? rep_export() || dz[2]:=DEFW.KOD ?}; ~~}
      { {? rep_export() || dz[14]:=DEFW.NAZWA ?}; ~~}
      { {? rep_export() || dz[4]:=DEFW.ALGORYTM ?}; ~~}
      { {? rep_export() || dz[13]:={? -DEFW.ALGORYTM<>'p' || $DEFW.ZAOKR || '' ?} ?}; ~~}
      { {? rep_export() || dz[15]:={? -DEFW.ALGORYTM<>'p' || $DEFW.DOKL || '' ?} ?}; ~~}
      { {? rep_export() || dz[11]:=form(DEFW.WSPOL,,6,' ,') ?}; ~~}
      { {? rep_export() || {? +DEFW.WSPOLF || dz[12]:='FORMUŁA: ['+DEFW.WSPOLF+']' ?};
                         {? DEFW.ALGORYTM='F' & (DEFW.TAB<>'' | DEFW.SLU<>null)
                         || {? DEFW.TAB<>''
                         || dz[12]:=dz[12] + {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'TAB: [' + DEFW.TAB+'] ';
                            dz[12]:=dz[12] + {? DEFW.INDEX<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + form('INDEX: ['  + DEFW.INDEX  + '] ',31) || '' ?};
                            dz[12]:=dz[12] + {? DEFW.PREFIX<>'' || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'PREFIX: [' + DEFW.PREFIX + '] ' || '' ?};
                            dz[12]:=dz[12] + {? DEFW.KODF<>''   || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} +
                                                {?+('KOD: ['    + DEFW.KODF   + '] ')<31
                                                || form('KOD: ['    + DEFW.KODF   + ']',31)
                                                || 'KOD: ['+DEFW.KODF+']'
                                                ?}
                                             || '' ?};
                           dz[12]:=dz[12] + {? DEFW.MASKA<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'MASKA: ['  + DEFW.MASKA  + '] ' || '' ?};
                           dz[12]:=dz[12] + {? DEFW.TR<>''     || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'NAZWA: ['  + DEFW.TR     + '] ' || '' ?}
                         |? DEFW.SLU<>null
                         || dz[12]:=dz[12] + {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'SŁOWNIK: ['+DEFW.SLU().SLU().NAZ+'] ';
                           dz[12]:=dz[12] + {? DEFW.MASKA<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'MASKA: ['  + DEFW.MASKA  + '] ' || '' ?}
                         ?}
      ?} ?}; ~~}
      { kolumna:=DEFA.KOL().LP;~~}
      { dz[5]:=form(kolumna);~~}
      {IF: DEFA.KOL().GRUPA<>WYRAZ.WIERSZ().GRUPA}
      { dz[5]+='*';~~}
      {FI}
      { DEFW.cntx_psh();~~}
      { GR_SIK.cntx_psh();~~}
      { dz[6]:=DEFA.ARGUMENT().GRUPA().SKROT;~~}
      { dz[7]:=DEFA.ARGUMENT().KOD+' '+DEFA.ARGUMENT().NAZWA;~~}
      { dz[8]:=form(DEFA.ARG_KOL().LP);~~}
      { dz[9]:=form(DEFA.WSP,10,6);~~}
      { dz[10]:=DEFA.LM;~~}
      { DEFW.cntx_pop();~~}
      { GR_SIK.cntx_pop();~~}
      { DEFW.seek(WYRAZ.WIERSZ);~~}
      {SUBSTITUTE: 'linia'}
      { {! j:=1..15 |! dz[j]:='' !};~~}
   {OD}
   {FI}
  {ELIF: DEFW.ALGORYTM='F'}
   { {? rep_export() || dz[1]:=form(i) ?}; ~~}
   { {? rep_export() || dz[2]:=DEFW.KOD ?}; ~~}
   { {? rep_export() || dz[14]:=DEFW.NAZWA ?}; ~~}
   { {? rep_export() || dz[4]:=DEFW.ALGORYTM ?}; ~~}
   { {? rep_export() || dz[13]:={? -DEFW.ALGORYTM<>'p' || $DEFW.ZAOKR || '' ?} ?}; ~~}
   { {? rep_export() || dz[15]:={? -DEFW.ALGORYTM<>'p' || $DEFW.DOKL || '' ?} ?}; ~~}
   { {? rep_export() || dz[11]:=form(DEFW.WSPOL,,6,' ,') ?}; ~~}
    { {? rep_export() || {? +DEFW.WSPOLF || dz[12]:='FORMUŁA: ['+DEFW.WSPOLF+']' ?};
                         {? DEFW.ALGORYTM='F' & (DEFW.TAB<>'' | DEFW.SLU<>null)
                         || {? DEFW.TAB<>''
                         || dz[12]:=dz[12] + {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'TAB: [' + DEFW.TAB+'] ';
                            dz[12]:=dz[12] + {? DEFW.INDEX<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + form('INDEX: ['  + DEFW.INDEX  + '] ',31) || '' ?};
                            dz[12]:=dz[12] + {? DEFW.PREFIX<>'' || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'PREFIX: [' + DEFW.PREFIX + '] ' || '' ?};
                            dz[12]:=dz[12] + {? DEFW.KODF<>''   || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} +
                                                {?+('KOD: ['    + DEFW.KODF   + '] ')<31
                                                || form('KOD: ['    + DEFW.KODF   + ']',31)
                                                || 'KOD: ['+DEFW.KODF+']'
                                                ?}
                                             || '' ?};
                           dz[12]:=dz[12] + {? DEFW.MASKA<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'MASKA: ['  + DEFW.MASKA  + '] ' || '' ?};
                           dz[12]:=dz[12] + {? DEFW.TR<>''     || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'NAZWA: ['  + DEFW.TR     + '] ' || '' ?}
                         |? DEFW.SLU<>null
                         || dz[12]:=dz[12] + {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'SŁOWNIK: ['+DEFW.SLU().SLU().NAZ+'] ';
                           dz[12]:=dz[12] + {? DEFW.MASKA<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'MASKA: ['  + DEFW.MASKA  + '] ' || '' ?}
                         ?}
   ?} ?}; ~~}
   {IF: SIK.DANEWSKP & (ALG_PAR.index('ALG_PAR1'); ALG_PAR.prefix(REF.FIRMA,DEFW.ref());ALG_PAR.first())}
    { kolumna:=0;~~}
    {FOR: 'ALG_PAR'}{INDEX: 'ALG_PAR1'}{PREFIX: REF.FIRMA,WYRAZ.WIERSZ}
    {DO}
      {IF: SIK.ALGROK=null | SIK.ALGROK=ALG_PAR.ROK}
      { kolumna:=ALG_PAR.GR_KOL().LP;~~}
      { dz[5]:=form(kolumna);~~}
      {IF: ALG_PAR.GR_KOL().GRUPA<>WYRAZ.WIERSZ().GRUPA}
       { dz[5]+='*';~~}
      {FI}
      { dz[6]:=ALG_PAR.FORMULA().SKROT;~~}
      { dz[7]:=ALG_PAR.FORMULA().NAZWA;~~}
      { dz[8]:='';~~}
      { dz[9]:=form(ALG_PAR.WSP,10,6);~~}
      { dz[10]:='';~~}
      {IF: SIK.EXF_JEDN='N'}
      {SUBSTITUTE: 'linia_f'}
      {ELSE}
      { paralg[1]:=ALG_PAR.P1;~~}
      { paralg[2]:=ALG_PAR.P2;~~}
      { paralg[3]:=ALG_PAR.P3;~~}
      { paralg[4]:=ALG_PAR.P4;~~}
      { paralg[5]:=ALG_PAR.P5;~~}
      { paralg[6]:=ALG_PAR.P6;~~}
      { paralg[7]:=ALG_PAR.P7;~~}
      { paralg[8]:=ALG_PAR.P8;~~}
      { paralg[9]:=form(ALG_PAR.GR_KOL().NAZWA,50);~~}
      { paralg[10]:={? SIK.ALGROK=null || form(ALG_PAR.ROK().NAZ,20) || '' ?};~~}
      {SUBSTITUTE: 'linia'}
      { {! _i:=1..10 |! paralg[_i]:='' !};~~ }
      {FI}
      { {? ~rep_export() || {! j:=1..15 |! dz[j]:='' !} ?}; ~~}
      {FI}
    {OD}
   {ELSE}
    {SUBSTITUTE: 'linia'}
   {FI}
  {ELSE}
   { {? rep_export() || dz[1]:=form(i) ?}; ~~}
   { {? rep_export() || dz[2]:=DEFW.KOD ?}; ~~}
   { {? rep_export() || dz[14]:=DEFW.NAZWA ?}; ~~}
   { {? rep_export() || dz[4]:=DEFW.ALGORYTM ?}; ~~}
   { {? rep_export() || dz[13]:={? -DEFW.ALGORYTM<>'p' || $DEFW.ZAOKR || '' ?} ?}; ~~}
   { {? rep_export() || dz[15]:={? -DEFW.ALGORYTM<>'p' || $DEFW.DOKL || '' ?} ?}; ~~}
   { {? rep_export() || dz[11]:=form(DEFW.WSPOL,,6,' ,') ?}; ~~}
    { {? rep_export() || {? +DEFW.WSPOLF || dz[12]:='FORMUŁA: ['+DEFW.WSPOLF+']' ?};
                         {? DEFW.ALGORYTM='F' & (DEFW.TAB<>'' | DEFW.SLU<>null)
                         || {? DEFW.TAB<>''
                         || dz[12]:=dz[12] + {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'TAB: [' + DEFW.TAB+'] ';
                            dz[12]:=dz[12] + {? DEFW.INDEX<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + form('INDEX: ['  + DEFW.INDEX  + '] ',31) || '' ?};
                            dz[12]:=dz[12] + {? DEFW.PREFIX<>'' || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'PREFIX: [' + DEFW.PREFIX + '] ' || '' ?};
                            dz[12]:=dz[12] + {? DEFW.KODF<>''   || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} +
                                                {?+('KOD: ['    + DEFW.KODF   + '] ')<31
                                                || form('KOD: ['    + DEFW.KODF   + ']',31)
                                                || 'KOD: ['+DEFW.KODF+']'
                                                ?}
                                             || '' ?};
                           dz[12]:=dz[12] + {? DEFW.MASKA<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'MASKA: ['  + DEFW.MASKA  + '] ' || '' ?};
                           dz[12]:=dz[12] + {? DEFW.TR<>''     || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'NAZWA: ['  + DEFW.TR     + '] ' || '' ?}
                         |? DEFW.SLU<>null
                         || dz[12]:=dz[12] + {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'SŁOWNIK: ['+DEFW.SLU().SLU().NAZ+'] ';
                           dz[12]:=dz[12] + {? DEFW.MASKA<>''  || {? +dz[12] || {? ~rep_export() || '#' || ' ' ?} || '' ?} + 'MASKA: ['  + DEFW.MASKA  + '] ' || '' ?}
                         ?}
   ?} ?}; ~~}
   {SUBSTITUTE: 'linia'}
  {FI}
{OD}
{MACRO-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: page=1 & ~rep_export()}
{SUBSTITUTE: 'FOOT'}
{FI}
{COMMENT}------------------------------naglowek---------------------{COMMENT-}
{MACRO: 'NAGLOWEK'}
{FONT: 'HEAD'}{SPACE: 'B'}
{ lm:=charleft(); ~~}
{SPACE: 'A'}
{IF: PAR_WYDR.TITLE<>''}
{SPACE: 'A'}{FONT: 'TITLE'}{lm:=charleft();~~}
   {<1>{lm} _poz:=PAR_WYDR.TITLE*'\n';
            {? _poz
               || (_poz-1)+PAR_WYDR.TITLE
               || PAR_WYDR.TITLE
            ?}}
   {IF: PAR_WYDR.TITLE*'\n'}
      {<1>{lm} _poz:=PAR_WYDR.TITLE*'\n';
            PAR_WYDR.TITLE+(+PAR_WYDR.TITLE-_poz)}
   {FI}
{FI}
{MACRO-}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{IF: ~rep_export()}
{SUBSTITUTE: 'HEAD'}
{ELSE}
{SUBSTITUTE: 'NAGLOWEK'}
{FI}
{IF: page=1}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{<1 'PARAMETRY WYDRUKU:'@}
{<1 {?SIK.DANEWSKP||'Uwzględniać parametry wierszy podstawowych: tak'@||'Uwzględniać parametry wierszy podstawowych: nie'@?}+
{? SIK.ALGROK<>null || ' z roku: %1'@[SIK.ALGROK().NAZ] || '' ?}}
{<1 'Kolumny: '@}
  { WYRAZ.GRUPA:=GR_SIK.ref;~~}
  { GR_KOL.index('LP'); GR_KOL.prefix(WYRAZ.GRUPA);~~}
  {IF: GR_KOL.first()=0}{<17 ''}
  {ELSE}
   {FOR: 'GR_KOL'}{INDEX: 'LP'}{PREFIX: WYRAZ.GRUPA}
   {DO}{>17 form(GR_KOL.LP)}{<19 GR_KOL.NAZWA}
   {OD}
  {FI}
{FI}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{~~}
{FOOTER-}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{  rsep:=1; ~~}
{ i:=0;{! j:=1..15 |! dz[j]:='' !}; ~~}
{ WYRAZ.GRUPA:=GR_SIK.ref;~~}
{IF: SIK.GRUP=0}
 {FOR: 'GR_SIK'}
 {INDEX: 'SYSSKROT'}
 {PREFIX: REF.FIRMA}
 {DO}
 {SUBSTITUTE: 'petla'}
  { ok:=1;~~}
 {OD}
{ELIF: SIK.GRUP=1}
 {FOR: 'GR_SIK'}
 {INDEX: 'SYSSKROT'}
 {PREFIX: REF.FIRMA}
 {SELECT}
 {DO}
 {SUBSTITUTE: 'petla'}
 { ok:=1;~~}
 {OD}
{ELIF: SIK.GRUP=2}
 {SUBSTITUTE: 'petla'}
{FI}
{COMMENT}------------------------------FOOTER-LAST-------------------------{COMMENT-}
{FOOTER}{FOOTER-}
{ENTIRE}
{SUBSTITUTE: 'LINIAF'}
{IF: ~rep_export()}
{<1>{PRN.width()} 'KONIEC WYDRUKU'@}
{FI}
{ENTIRE-}
