:!UTF-8
{TITLE:D. Wykaz nierozliczonych pozycji kartoteki, których termin zwrotu upłynął podanego dnia}
{PRINTER: exec('set_parw','param_wydr'); exec('prt','param_wydr','h'),,,,,'E','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
      PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{INCLUDE: wyp_beginend.rpi}
{
  f_htab:='T10B';
  f_tab:='T10';
  ~~
}
{ "---Definicja wiersza wydruku ."; ~~}
{IF: tryb=1}
   {PRN.add("__WYP_K1.NAZWISKO",30,'Nazwisko'@);~~}
   {PRN.add("__WYP_K1.IMIE",20,'Imię'@);~~}
   {PRN.add("__WYP_K1.WYD",10,'Wydział'@);~~}
   {PRN.add("__WYP_K1.S",30,'Stanowisko'@);~~}
   {PRN.add("__WYP_K1.KOD",20,'Grupa materiałowa'@);~~}
   {PRN.add("__WYP_K1.NAZ",20,'Nazwa grupy'@);~~}
{ELSE}
   {PRN.add("lp+=1;form(lp,,0)",4,'Lp.'@,1); ~~}
   {PRN.add("__WYP_K1.NAZWIM",10,'Pracownik'@); ~~}
   {PRN.add("__WYP_K1.INFO",10,'Char. zatr.'@); ~~}
   {PRN.add("__WYP_K1.KOD+' - '+__WYP_K1.NAZ",20,'Wyposażenie'@); ~~}
{FI}
{PRN.add("$__WYP_K1.DATA",10,'Wydane'@); ~~}
{PRN.add("$__WYP_K1.DATAZ",10,'Termin zużycia'@); ~~}
{PRN.add("form(__WYP_K1.ILWYN,10,2)",10,'Ilość wydana'@,1); ~~}
{PRN.add("form(__WYP_K1.ILPOZ,10,2)",10,'Ilość pozostała'@,1); ~~}
{
   _wydr_naz:='karowz04';
   WYDRUKIL.index('WYDRUKI');
   WYDRUKIL.prefix(OPERATOR.USER().KOD,_wydr_naz);
   {? ~WYDRUKIL.first()
   || WYDRUKIL.blank();
      WYDRUKIL.USERS:=OPERATOR.USER().KOD;
      WYDRUKIL.WYDRUK:=_wydr_naz;
      WYDRUKIL.add();
      datado:=date()
   || datado:=WYDRUKIL.DO_DATY
   ?};
   _valid:="
      _valid:=1;
      {? cur_tab(1,1).VAL=date(0,0,0)
      || FUN.info('Pole musi być wypełnione.\nNależy uzupełnić brakujące informacje.'@);
         _valid:=0
      ?};
      _valid
   ";
   _result:=exec('edit_date','#edit',datado,'Termin upłynął do dnia'@,_valid,'Parametry zestawienia'@);
   {? var_pres('_result')=type_of(date())
   || datado:=_result ;
      WYDRUKIL.DO_DATY:=datado;
      WYDRUKIL.put(1)
   ?};
   PODTYTUL:='Do dnia %1'@[$datado];
   ~~
}
{COMMENT}
 (c) Macrologic S.A. Wszelkie prawa zastrzezone
 Wersja: 12.10
 Autor: Waldemar Werbinski
 Systemy: WYPOSAZ
{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{PAR_WYDR.TITLE:='WYKAZ NIEROZLICZONYCH POZYCJI KARTOTEKI, KTÓRYCH TERMIN ZWROTU UPŁYNĄŁ'@; ~~}
{IF: exec('przetermpoz','wyp_head',datado)}
{INCLUDE: wyp_idruk01.rpi}
{FOR: '__WYP_K1'}
{INDEX: __WYP_K1.index('?')}
{DO}
   {SUBSTITUTE: 'LINIA0'}
{OD}
{ELSE}
   {FUN.info('Brak przeterminowanych pozycji u pracowników, do których użytkownik jest uprawniony.'@); ~~}
   {EXIT}
{FI}
