:!UTF-8
{TITLE:Polecenie wyjazdu służbowego}
{PRINTER: 'hp3v',,,,,'M','B',,,,,,1,15,15,15,15,0,1}
{BEGIN:
   PRN:=obj_new(@.CLASS.PRINT,15); PRN.s_frame();
   PRN2:=obj_new(@.CLASS.PRINT,15); PRN2.s_frame();
   c:=obj_new(15);
   {! _i:=1..14 |! c[_i] := '' !};
   i:=0;
   color:=prn1:=prn2:='';__tmpopi:=obj_new(5);__LOOPRE:=1;
   lm:=ll:=vp:=lmt:=rsep:=0;
   par1:=0; par2:=0; par3:=0; par4:=0; par5:=0;
   exec('czytaj','#stalesys');
   {? app_info('web_sesid')<>''
   || 
      exec('set_parw','param_wydr');
      EDOKUM.web_cntx_load()
   ?}
}
{END:
   obj_del(PRN);
   obj_del(PRN2);
   obj_del(c);
   &i; &color; &prn1; &prn2; obj_del(__tmpopi);&__LOOPRE;
   &lm; &ll; &vp; &lmt; &rsep;
   &par1; &par2; &par3;&par4;&par5
}
{EXIT:
   0
}
{COMMENT}
==================================================
(c) Macrologic S.A. Wszelkie prawa zastrzeżone
Nazwa pliku: delegaz.rpm
Utworzony  : 2012-07-19
Zawartość  : Polecenie wyjazdu służbowego
==================================================
{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{COMMENT}--Definicja wiersza wydruku--------------------{COMMENT-}
{  prn1:='PRN'; prn2:='PRN2'; ~~}
{
      _txt:='POTWIERDZENIE POBYTU SŁUŻBOWEGO#(podać daty przybycia i wyjazdu oraz liczbę noclegów#bezpłatnych lub tańszych niż ryczałt).#Adnotacje te zaopatrzyć pieczęcią i podpisem.'@;
      PRN.add("c[1]",64,'Pieczątka instytucji:'@,,' ');
      PRN.add("c[2]",64,_txt,,' ',,,,,1);

      PRN2.add("c[1]",64,'Pieczątka instytucji:'@,,' ',,,,,1);
      PRN2.add("c[2]",64,_txt,,' ',,,,,1);

      PAR_WYDR.TITLE:='Polecenie wyjazdu służbowego'@

; ~~}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2);~~}
{COMMENT}------------------------------Parametry wydruku------------{COMMENT-}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{LINE: 1}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOTCMS'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{LINE: 3}
{ rsep:=1; ~~}
{REP: _f:=prn1+'.fhbar(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='POTWIERDZENIE POBYTU SŁUŻBOWEGO'@;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='';c[2]:='(podać daty przybycia i wyjazdu oraz liczbę noclegów'@;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='';c[2]:='bezpłatnych lub tańszych niż ryczałt).'@;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='Pieczątka instytucji'@;c[2]:='Adnotacje te zaopatrzyć pieczęcią i podpisem.'@;~~}
{REP: _f:=prn2+'.ini_line()'; ($(_f))(); _f:=prn2+'.fline(lmt)'; ($(_f))()}
{REP: _f:=prn1+'.fcbar(lmt)'; ($(_f))()}
{
  exec('pw_del_etat','obe');
  par3:=OBIEGI.DEL_ETAT
;~~}
{FONT: 'T8GB'}{SPACE: 'C'}
{c[1]:='Polecenie wyjazdu służbowego nr: %1'@[EDOKUM.ID]; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{FONT: 'T8G'}{SPACE: 'C'}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='Z dnia: %1'@[$EDOKUM.DW]; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='Dla: %1 %2'@[EDOKUM.DOSTAWCA().PIERWSZE,EDOKUM.DOSTAWCA().NAZWISKO]; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='Stanowisko: %1'@[par3]; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='Miejsce delegacji: %1'@[EDOKUM.DEL_MIE]; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='Data od: %1'@[$EDOKUM.DATA_OD]; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='Data do: %1'@[$EDOKUM.DATA_DO]; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='Cel delegacji: %1'@[EDOKUM.DEL_CEL().TR]; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{IF: +('Opis: %1'@[EDOKUM.TR])<=64}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='Opis: %1'@[EDOKUM.TR]; c[2]:='' ;~~}
{ELSE}
{  {! _i:=1..obj_len(__tmpopi) |! __tmpopi[_i]:='' !};
   STR.spl_word();
   STR.split(EDOKUM.TR);
   {? STR.next()
   || _dalej:=1;
      __tmpopi[_dalej]:='Opis: '@;
      {! |?
         _tmp:=STR.get_word();
         {? +(__tmpopi[_dalej]+' '+_tmp)<=64
         || __tmpopi[_dalej]+=' '+_tmp
         || _dalej+=1;
            __tmpopi[_dalej]+={? +__tmpopi[_dalej]>0 || ' ' || '' ?}+_tmp
         ?};
         STR.next()
      !}
   ?}
;~~}
{WHILE: __LOOPRE<=obj_len(__tmpopi)}
{DO}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=__tmpopi[__LOOPRE]; c[2]:=''; __LOOPRE+=1;~~}
{OD}
{FI}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='.......................................................................'; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='Delegację zatwierdził:'; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=''; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:=$date+' '+$time+'             ............................................'; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{c[1]:='data'+'                            podpis'; c[2]:='' ;~~}
{REP: _f:=prn1+'.ini_line()'; ($(_f))(); _f:=prn1+'.fline(lmt)'; ($(_f))()}
{rsep:=PAR_WYDR.RSEP;~~}
{COMMENT}------------------------------FOOTER-LAST------------------{COMMENT-}
{FOOTER}{FOOTER-}
{FONT: 'T8G'}{SPACE: 'C'}
{REP: _f:=prn2+'.flbar(lmt)'; ($(_f))()}