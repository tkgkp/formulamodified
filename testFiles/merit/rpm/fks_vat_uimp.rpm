:!UTF-8
{TITLE:Wydruk ewidencji VAT}
{PRINTER: FINFO.SZ_PRN,,,,,'Q','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1,,'enable'}
{BEGIN:
  sstr5:=sstr6:=sstr7:=sstr8:=sstr9:=sstr10:=sstr11:=sstr12:=sstr13:=0; tryb:=2;  ile_l:=0;
  sstr14:=sstr15:=sstr16:=sstr17:=sstr18:=sstr19:=sstr20:=sstr21:=sstr22:=sstr23:=sstr24:=0;
  suma5:=suma6:=suma7:=suma8:=suma9:=suma10:=suma11:=suma12:=suma13:=0;
  suma14:=suma15:=suma16:=suma17:=suma18:=suma19:=suma20:=suma21:=suma22:=suma23:=suma24:=0;
PRN:=obj_new(@.CLASS.PRINT,30); PRN.sl_frame();
  PRN1:=obj_new(@.CLASS.PRINT,20); PRN1.sl_frame();
  PRN2:=obj_new(@.CLASS.PRINT,7); PRN2.sl_frame(); STR2:=obj_new(@.CLASS.STRING); STR3:=obj_new(@.CLASS.STRING);
  w2:=''; w15:=inwest5:=pozost5:=0;
  inwestv5:=pozostv5:=w16:=0; zakup:=1; ue:=0;
  inwest0:=inwest1:=inwest2:=inwest3:=inwest4:=inwestv1:=inwestv2:=0;
  pozost0:=pozost1:=pozost2:=pozost3:=pozost4:=pozostv1:=pozostv2:=0; ok:=rek:=0;
  rycz1:=ryczv1:=rycz2:=ryczv2:=rycz3:=rycz4:=rycz5:=ryczv5:=0;
  wart7:=obj_new(3); wart8:=obj_new(3); wart9:=obj_new(3); wart10:=obj_new(3); wart11:=obj_new(3);
  wart12:=obj_new(3); wart15:=obj_new(3); wart16:=obj_new(3); in_w:=po_z:=ryc_z:=0;
  s:=obj_new(20); n:=obj_new(20); v:=obj_new(20);np:=obj_new(20);vp1:=obj_new(20);
  svat:=obj_new(20); snetto:=obj_new(20);
  linijka:=numer:=linecnt:=0; w:=obj_new(52); szer:=obj_new(17); ww:=obj_new(39); www:=obj_new(30); text:=obj_new(18);
  stawka:=obj_new(12); VAT7.PAR1:=VAT7.PAR3:=VAT7.PAR4:=0;VAT7.PAR2:=3; rejestr:='ImpU'; w55:=w555:='';
  param1:=param2:=param3:=param4:=param5:=param6:=param7:=param8:=''; {!_a:=1 ..25 |! w[_a]:='' !};  {! _a:=1..30 |! ww[_a]:=www[_a]:=0 !}; pom:=1;
  dru_rej:=0;  rej_1:=rej_2:=rej_3:=rej_4:=rej_5:=rej_6:=rej_7:=rej_8:=0;
  rej_9:=rej_10:=rej_11:=rej_12:=rej_13:=rej_14:=rej_15:=rej_16:=rej_17:=rej_18:=0;
  rej_naz:=pom_1:=pom_2:=pom_3:=pom_4:=pom_5:=pom_6:=pom_7:='';  pierwszy:=1; VAT7.WY2:=0; kor:=0;
  font_gr:=0; color:=''; prn1:=prn2:='PRN';
  lm:=ll:=lmt:=rsep:=0; vp:=1; rsep:=PAR_WYDR.RSEP; PAR_WYDR.RSEP:=1; fun:='';
  UNPAR.P1_BE:=UNPAR.P1_AE:=UNPAR.P1_BV:='';
  VAT7.win_edit('REJSP2'); VAT7.hdr_edit();
  hdr_vat:={? var_pres('hdr_vat')<0 || ~(-'Usługi z importu') || hdr_vat:=~(-hdr_vat) ?};
  VAT7.hdr_edit(hdr_vat);
 {? var_press('WAL',VAT7)>0 || VAT7.WAL:=exec('kod_pln','slo_slu') ?}; 
  wal_op:=''; VAT7.KRAJ:=exec('kod_pl','slo_slu'); kraj:='';
  VAT7.WY3:=1; VAT7.WYD_TECH:=0; UNPAR.P1:=0;
  OKRO_F.win_dict('SLO'); VAT7.WYSTROK:=VAT7.WYSTOKRO:=null;
  edycja:=VAT7.edit(); dokvpoch:=exec('dokvpoch','!fks_vat_zrej');
  PAR_WYDR.TITLE:=hdr_vat+exec('naz_okr_vat','!fks_vat_zrej');
  okrVat:=exec('okr_vat_wydr','!fks_vat_zrej');
  SLU.cntx_psh(); SLU.index('NAZ'); SLU.prefix(); RVAT.cntx_psh();
  {? SLU.find_key('~STAWKI VAT '+VAT7.KRAJ().KOD)
  || SLO.cntx_psh(); SLO.index('SL'); SLO.prefix(SLU.ref); sizeslo:=SLO.size();
     tvat:=obj_new(sizeslo); tn:=obj_new(sizeslo); tv:=obj_new(sizeslo); tb:=obj_new(sizeslo);
     sn:=obj_new(sizeslo); sv:=obj_new(sizeslo); sb:=obj_new(sizeslo); SLO.first;
     tv1:=obj_new(sizeslo); sv1:=obj_new(sizeslo);
     su:=obj_new(sizeslo); ssu:=obj_new(4); ssu[1]:=ssu[2]:=ssu[3]:=ssu[4]:=0; is_us:=0;
     {! _a:=1 ..sizeslo
     |! su[_a]:=obj_new(4); su[_a][1]:=su[_a][2]:=su[_a][3]:=su[_a][4]:=0;
        tvat[_a]:=SLO.KOD; tn[_a]:=tv[_a]:=tb[_a]:=sn[_a]:=sv[_a]:=sb[_a]:=tv1[_a]:=sv1[_a]:=0;
        SLO.next()
     !}; SLO.cntx_pop()
  ?};
  SLU.cntx_pop;
  par84:=PAR_SKID.get(84)='T'; par83:=(var_pres('C_PREWSK',VPOZ)>0 & PAR_SKID.get(83)='T');
  prewsk:={? var_pres('PREWSK',ROK_F)>0 || SSTALE.AR().PREWSK || 100 ?};
  procst:=SSTALE.AR().PROC_VAT;
  head:=PAR_WYDR.HEAD; logo:=PAR_WYDR.LOGO; odd:=OPERATOR.DEPT=null
}
{END: &hdr_vat; PAR_WYDR.HEAD:=head; &head; PAR_WYDR.LOGO:=logo; &logo; &ile_l;
   VAR_DEL.delete('PRN','PRN1','szer','w','ww','www','text','stawka');
   &sstr5; &sstr6; &sstr7; &sstr8; &sstr9; &sstr10; &sstr11; &sstr12; &sstr13; &sstr14;
   &sstr15; &sstr16; &sstr17; &sstr18; &sstr19; &sstr20; &sstr21; &sstr22; &sstr23; &sstr24;
   &suma5; &suma6; &suma7; &suma8; &suma9; &suma10; &suma11; &suma12; &suma13; &suma14;
   &suma15; &suma16; &suma17; &suma18; &suma19; &suma20; &suma21; &suma22; &suma23; &suma24;
   _a:=SSTALE.AR().KOD+form(SSTALE.AO().NR,-2); &tryb;  &linijka; &numer;
   DOK.use('doku'+_a); POZ.use('pozy'+_a); POW.use('pow_'+_a); VPOZ.use('pozv'+_a); VPOZ_ROZ.use('pozr'+_a);
   VAT7.hdr_edit(); &linecnt;
   &param1; &param2; &param3; &param4; &param5; &param6; &param7; &param8;
   VAR_DEL.delete('sn','sv','sb','tvat','tn','tv','tb','tv1','sv1');
   RVAT.cntx_pop; &rejestr; &pom; &ok; &sizeslo; &w55; &w555;
   &dru_rej; &rej_1; &rej_2; &rej_3; &rej_4; &rej_5; &rej_6; &rej_7;&rej_8; &rej_9; &rej_10; &rej_11;
   &rej_12; &rej_13; &rej_14; &rej_15; &rej_16; &rej_17; &rej_18;
   &rej_naz; &pom_1; &pom_2; &pom_3; &pom_4; &pom_5; &pom_6; &pom_7; &pierwszy; &kor;
   font_gr:=1; &color; &prn1; &prn2;
   VAR_DEL.delete('PRN2','wart7','wart8','wart9','wart10','wart11','wart12','wart15','wart16');
   VAR_DEL.delete('s','n','v','np','vp1','svat','snetto');
   VAR_DEL.delete('par84','par83','prewsk','procst');
   &w2; &w15; &inwest5; &pozost5; &zakup; &ue;
   &inwestv5; &pozostv5; &w16; &inwest0; &inwest1; &inwest2; &inwest3; &inwest4; &inwestv1; &inwestv2;
   &pozost0; &pozost1; &pozost2; &pozost3; &pozost4; &pozostv1; &pozostv2; &rek;
   &rycz1; &ryczv1; &rycz2; &ryczv2; &rycz3; &rycz4; &rycz5; &ryczv5; &in_w; &po_z; &ryc_z;
   &lm; &ll; &vp; &lmt; PAR_WYDR.RSEP:=rsep; &rsep; &fun;
   &wal_op; &kraj; &edycja; &odd; VAR_DEL.delete('dokvpoch','s2c','su','ssu','is_us','okrVat','okrVatNr','STR2','STR3')
 }
{EXIT: ~edycja}
{COMMENT}
(c) Macrologic S.A. Wszelkie prawa zastrzezone
==================================================
Nazwa pliku: vat_uimp.rpm
Utworzony:   ???? - ??- ?? [?????] ???????????
Modyfikacje: 2001-03-20 [AMK] Artur Makos
==================================================
Zawartosc: Wydruk zestawienia zbiorczego VAT
{COMMENT-}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: ~rep_expo()}{SUBSTITUTE: 'FOOT'}{FI}
{  param1:='VAT: '+{? VAT7.PAR4=1 || 'naliczony' || 'należny' ?};
   param2:='Wydruk w wariancie: '+{? VAT7.PAR1=1 || 'uproszczonym' || 'rozszerzonym' ?};
   param3:='Uwzględniono: '+{? VAT7.PAR2=1 || 'korekty' |? VAT7.PAR2=2 || 'usługi z importu' || 'usługi z importu i korekty'?};
   param4:='Wydruk dokumentów: '+exec('vat7par3','!fks_vat_zrej');~~}
{IF: VAT7.PAR4=1}
 {IF: VAT7.PAR1=2}
  { VAT7.WY1:=1;~~}
  {INCLUDE: fks_vatzbzak.rpi}
 {ELIF: VAT7.PAR1=1}
  {INCLUDE: fks_vatrej2.rpi}
 {FI}
{ELIF: VAT7.PAR4=2}
 {IF: VAT7.PAR1=2}
  { zak:=3;~~}
  {INCLUDE: fks_vatrej5.rpi}
 {ELIF: VAT7.PAR1=1}
  {INCLUDE: fks_vatrej2.rpi}
 {FI}
{FI}