:!UTF-8
{COMMENT}OLD: zlermua.rpi{COMMENT-}
{IF: exec('zn_ttub','pracownik',OSOBA.ref(),RH.DWY)}
{'Typ identyfikatora'@}:   {exec('memo2print','#string',S_ZUS,'OPIS',P_INFO.TPID)}{<40'Identyfikator'@}:{
 {? P_INFO.TPID().KOD = '1' || OSOBA.DOWOD
 |? P_INFO.TPID().KOD = '2' || OSOBA.PASZPORT
 |? P_INFO.TPID().KOD = 'P' || OSOBA.PESEL
 |? P_INFO.TPID().KOD = 'N' || OSOBA.NIP ?}}
{'Kod NFZ'@}:     {P_INFO.KC().SYMBOL}          {<40}{'Nazwa NFZ'@}: {P_INFO.KC().NAZWA}
{'Tytuł ubezpieczenia'@}:  {RH.ZC_INFO().TTUB().KOD} {ZC_INFO.PREM().KOD} {ZC_INFO.STNP().KOD}
                      {_a:=exec('memo2print','#string',S_ZUS,'OPIS',ZC_INFO.TTUB); STR.split(_a); ~~ }
                      {WHILE: +(Text:=STR.line(100))}{DO}
                      {<22}{Text}
                      {OD}
                      {_a:=exec('memo2print','#string',S_ZUS,'OPIS',ZC_INFO.PREM); STR.split(_a); ~~ }
                      {WHILE: +(Text:=STR.line(100))}{DO}
                      {<22}{Text}
                      {OD}
                      {_a:=exec('memo2print','#string',S_ZUS,'OPIS',ZC_INFO.STNP); STR.split(_a); ~~ }
                      {WHILE: +(Text:=STR.line(100))}{DO}
                      {<22}{Text}
                      {OD}
{ &Text; ~~ }
{<22}{ _test:=0;_napis:=~~;
 P_INFO.cntx_psh();
 P_INFO.index('OD');
 P_INFO.prefix(exec('ref_firma','ustawienia'),OSOBA.ref());
 {? P_INFO.last()
  || {!
     |? {? P_INFO.BLOKADA<>#0 & P_INFO.BLOKADA~1=RH.DWY~1 & P_INFO.BLOKADA<=date(RH.DWY~1,RH.DWY~2,0) & _test=0
        || _test:=1;
           _napis:='przekroczenie rocznej podstawy składek na ubezpieczenie emerytalne i rentowe'@
        ?};
        P_INFO.prev() & ~_test
     !}
  ?};
 P_INFO.cntx_pop();
 _napis}
{ELSE}
{'Brak danych ubezpieczeniowych.'@}
{FI}