:!UTF-8
{TITLE:Raport możliwości zamknięcia grupy operacji}
{PRINTER: INFO.W_PRN,,,,,'E','C',,,,,,1,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,
      PAR_WYDR.MRIGHT,PAR_WYDR.MBOT,0,1}
{BEGIN:
   dalej:=0;
   PRN2:=obj_new(@.CLASS.PRINT,10); PRN2.s_frame();
   PRN3:=obj_new(@.CLASS.PRINT,10); PRN3.s_frame();
   PRN4:=obj_new(@.CLASS.PRINT,10); PRN4.s_frame();
   PRN5:=obj_new(@.CLASS.PRINT,10); PRN5.s_frame();
   PRN6:=obj_new(@.CLASS.PRINT,11); PRN6.sl_frame();
   PRN7:=obj_new(@.CLASS.PRINT,10); PRN7.s_frame();
   __TAB2:=params_get().tab2;
   __TAB3:=params_get().tab3;
   __TAB4:=params_get().tab4;
   __TAB5:=params_get().tab5;
   __TAB6:=params_get().tab6;
   __TAB7:=params_get().tab7;
   prn1:='PRN1';
   color:='';
   licznik:=0;
   lm:=ll:=vp:=lmt:=rsep:=0;
   _par:=exec('get','#params',500121,type_of(0));
   k_nzl:=1+_par;
   k_lim:=1+(2-_par);
   k_pdp:=1+(1-_par);
   k_nli:=1+(3-_par);
   k_ilo:=_par+1;
   tabs:=0
}
{END:
   &dalej;
   VAR_DEL.delete('PRN2','PRN3','PRN4','PRN5','PRN6','PRN7');
   VAR_DEL.delete('__TAB2','__TAB3','__TAB4','__TAB5','__TAB6','__TAB7');
   &prn1;
   &color;
   &licznik;
   &lm; &ll; &vp; &lmt; &rsep;
   &k_nzl; & k_lim; &k_pdp; &k_nli; &k_ilo;
   &tabs
}
{COMMENT}
  Raport możliwości zamknięcia zlecenia
  [TS] - 2002/12/10 - [7.62]
  Wywołanie: Zlecenia (produkcyjne, warsztatowe) -> Funkcje -> Kontrola zamknięcia zlecenia
{COMMENT-}
{  'niezaakceptowane limity';
   PRN2.add("__TAB2[1].KOD",15,'Kod surowca'@);
   PRN2.add("__TAB2[1].NAZ",40,'Nazwa surowca'@);
   PRN2.add("form(__TAB2[1].ILOSC,,4)",15,'Ilość'@,1);
   'limity';
   PRN3.add("__TAB3[1].KOD",15,'Kod surowca'@);
   PRN3.add("__TAB3[1].NAZ",35,'Nazwa surowca'@);
   PRN3.add("form(__TAB3[1].ILL,,4)",15,'Ilość limitowana'@,1);
   PRN3.add("form(__TAB3[1].ILP,,4)",15,'Ilość pobrana'@,1);
   PRN3.add("__TAB3[1].MX",8,'Pobrania poniżej limitu'@);
   PRN3.add("__TAB3[1].DX",8,'Pobrania powyżej limitu'@);
   'niezaakceptowane dokumenty magazynowe';
   PRN4.add("__TAB4[1].WPM",3,'R'@);
   PRN4.add("__TAB4[1].KOD",15,'Kod materiału'@);
   PRN4.add("__TAB4[1].NAZ",40,'Nazwa materiału'@);
   PRN4.add("__TAB4[1].SYMDOK",15,'Symbol dokumentu'@);
   PRN4.add("$__TAB4[1].DATA",10,'Data'@);
   PRN4.add("__TAB4[1].SLO",8,'Wydział'@);
   'surowce nielimitowane';
   PRN5.add("__TAB5[1].KOD",15,'Kod surowca'@);
   PRN5.add("__TAB5[1].NAZ",30,'Nazwa surowca'@);
   PRN5.add("form(__TAB5[1].ILL,,4)",15,'Norma brutto'@,1);
   PRN5.add("form(__TAB5[1].ILP,,4)",15,'Pobrano'@,1);
   PRN5.add("__TAB5[1].MX",8,'Pobrania poniżej limitu'@);
   PRN5.add("__TAB5[1].DX",8,'Pobrania powyżej limitu'@);
   PRN5.add("__TAB5[1].REJ_MAT",8,'Nierozliczony na wykonaniach'@);
   'rejestracja robocizny (ilości)';
   PRN7.add("__TAB7[1].KOD",20,'Zasób grupy'@);
   PRN7.add("__TAB7[1].ZAS",20,'Zasób planistyczny'@);
   PRN7.add("form(__TAB7[1].IL,,4)",15,'Ilość planowana'@,1);
   PRN7.add("form(__TAB7[1].ILW,,4)",15,'Ilość zare- jestrowana'@,1);
   PRN7.add("__TAB7[1].ZAK",8,'Zakoń- czone'@);
   PRN7.add("__TAB7[1].POTW",8,'Potwier- dzone'@);
   PRN7.add("__TAB7[1].MX",8,'Niedobór'@);
   PRN7.add("__TAB7[1].DX",8,'Przekro- czenie'@);
   PAR_WYDR.TITLE:='RAPORT MOŻLIWOŚCI ZAMKNIĘCIA GRUPY OPERACJI'@; ~~}
{INCLUDE: wsp_pw.rpi}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{ prn1:='PRN1'; ~~}
{FONT: 'T8G'}{SPACE: 'B'}
{<1 'PARAMETRY WYDRUKU:'@}
{<1 'Grupa operaji: %1'@[VAR.A_GROP().KOD]}
{<1 'Ilość planowana: %1'@[form(GROP.IL,,4)]}
{<1 'Ilość zarejestrowana: %1'@[form(GROP.ILW,,4)]}
{<1 'Podczas kontroli grupy sprawdzono:'@}
{IF: k_nzl='T'}
{<10 'Akceptację limitów grupy'@}
{FI}
{IF: k_pdp='T'}
{<10 'Akceptację dokumentów produkcyjnych'@}
{FI}
{IF: k_lim='T'}
{<10 'Poprawność rozliczenia surowców limitowanych'@}
{FI}
{IF: k_nli='T'}
{<10 'Poprawność rozliczenia surowców nielimitowanych'@}
{FI}
{IF: k_ilo='T'}
{<10 'Poprawność rejestracji robocizny (ilości)'@}
{FI}

{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{SUBSTITUTE: 'FOOT'}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{IF: var_pres('__TAB2')>100}
  { prn1:='PRN2'; ~~}
  {FOOTER: 0}
    {SUBSTITUTE: 'LINIAF'}
    {LINE: 1}
  {FOOTER-}
  {FONT: 'T8G'}{SPACE: 'B'}
{  lmt:=int((charleft()-PRN2.width())/2); ~~}
  {<{lmt+1} 'NIEZAAKCEPTOWANE LIMITY DO GRUPY'@}
  {FONT: 'T8GB'}
  {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
  {FONT: 'T8G'}{SPACE: 'B'}
  { rsep:=PAR_WYDR.RSEP; ~~}
  {FOR: __TAB2[1]}
  {DO}
  {FIRST}
   {HEADER}
    {SUBSTITUTE: 'HEAD'}
    {FONT: 'T8GB'}{SPACE: 'B'}
    {SUBSTITUTE: 'TABHEAD'}
   {HEADER-}
  {FIRST-}
    {SUBSTITUTE: 'LINIA0'}
    { licznik+=1; ~~}
  {OD}
  {FOOTER: 0}
    {LINE: 1}
  {FOOTER-}
  {HEADER}
    {SUBSTITUTE: 'HEAD'}
  {HEADER-}
  {SUBSTITUTE: 'LINIAF'}
  {IF:lineleft()>=1 & lineleft()<=2}{PAGE}{FI}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{IF: var_pres('__TAB4')>100}
  { prn1:='PRN4'; ~~}
  {FOOTER: 0}
    {SUBSTITUTE: 'LINIAF'}
    {LINE: 1}
  {FOOTER-}
  {FONT: 'T8G'}{SPACE: 'B'}
{  lmt:=int((charleft()-PRN4.width())/2); ~~}
  {<{lmt+1} 'NIEZAAKCEPTOWANE DOKUMENTY PRODUKCYJNE'@}
  {FONT: 'T8GB'}
  {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
  {FONT: 'T8G'}{SPACE: 'B'}
  { rsep:=PAR_WYDR.RSEP; ~~}
  {FOR: __TAB4[1]}
  {DO}
  {FIRST}
   {HEADER}
    {SUBSTITUTE: 'HEAD'}
    {FONT: 'T8GB'}{SPACE: 'B'}
    {SUBSTITUTE: 'TABHEAD'}
   {HEADER-}
  {FIRST-}
    {SUBSTITUTE: 'LINIA0'}
    { licznik+=1; ~~}
  {OD}
  {FOOTER: 0}
    {LINE: 1}
  {FOOTER-}
  {HEADER}
    {SUBSTITUTE: 'HEAD'}
  {HEADER-}
  {SUBSTITUTE: 'LINIAF'}
  {IF:lineleft()>=1 & lineleft()<=2}{PAGE}{FI}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{IF: var_pres('__TAB3')>100}
  { prn1:='PRN3'; ~~}
  {FOOTER: 0}
    {SUBSTITUTE: 'LINIAF'}
    {LINE: 1}
  {FOOTER-}
  {FONT: 'T8G'}{SPACE: 'B'}
{  lmt:=int((charleft()-PRN3.width())/2); ~~}
  {<{lmt+1} 'NIEZGODNOŚCI LIMITÓW GRUPY (przeliczone do ilości wykonanej)'@}
  {FONT: 'T8GB'}
  {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
  {FONT: 'T8G'}{SPACE: 'B'}
  { rsep:=PAR_WYDR.RSEP; ~~}
  {FOR: __TAB3[1]}
  {DO}
  {FIRST}
   {HEADER}
    {SUBSTITUTE: 'HEAD'}
    {FONT: 'T8GB'}{SPACE: 'B'}
    {SUBSTITUTE: 'TABHEAD'}
   {HEADER-}
  {FIRST-}
    {SUBSTITUTE: 'LINIA0'}
    { licznik+=1; ~~}
  {OD}
  {FOOTER: 0}
    {LINE: 1}
  {FOOTER-}
  {HEADER}
    {SUBSTITUTE: 'HEAD'}
  {HEADER-}
  {SUBSTITUTE: 'LINIAF'}
  {IF:lineleft()>=1 & lineleft()<=2}{PAGE}{FI}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{IF: var_pres('__TAB5')>100}
  { prn1:='PRN5'; ~~}
  {FOOTER: 0}
    {SUBSTITUTE: 'LINIAF'}
    {LINE: 1}
  {FOOTER-}
  {FONT: 'T8G'}{SPACE: 'B'}
{  lmt:=int((charleft()-PRN5.width())/2); ~~}
  {<{lmt+1} 'NIEZGODNOŚCI W ROZLICZENIU SUROWCÓW NIELIMITOWANYCH'@}
  {FONT: 'T8GB'}
  {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
  {FONT: 'T8G'}{SPACE: 'B'}
  { rsep:=PAR_WYDR.RSEP; ~~}
  {FOR: __TAB5[1]}
  {DO}
  {FIRST}
   {HEADER}
    {SUBSTITUTE: 'HEAD'}
    {FONT: 'T8GB'}{SPACE: 'B'}
    {SUBSTITUTE: 'TABHEAD'}
   {HEADER-}
  {FIRST-}
    {SUBSTITUTE: 'LINIA0'}
    { licznik+=1; ~~}
  {OD}
  {FOOTER: 0}
    {LINE: 1}
  {FOOTER-}
  {HEADER}
    {SUBSTITUTE: 'HEAD'}
  {HEADER-}
  {SUBSTITUTE: 'LINIAF'}
  {IF:lineleft()>=1 & lineleft()<=2}{PAGE}{FI}
{FI}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{IF: var_pres('__TAB7')>100}
  { prn1:='PRN7'; ~~}
  {FOOTER: 0}
    {SUBSTITUTE: 'LINIAF'}
    {LINE: 1}
  {FOOTER-}
  {FONT: 'T8G'}{SPACE: 'B'}
{  lmt:=int((charleft()-PRN7.width())/2); ~~}
  {<{lmt+1} 'NIEZGODNOŚCI W ROZLICZENIU ROBOCIZNY WG ZASOBÓW GRUPY'@}
  {FONT: 'T8GB'}
  {SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
  {FONT: 'T8G'}{SPACE: 'B'}
  { rsep:=PAR_WYDR.RSEP; ~~}
  {FOR: __TAB7[1]}
  {DO}
  {FIRST}
   {HEADER}
    {SUBSTITUTE: 'HEAD'}
    {FONT: 'T8GB'}{SPACE: 'B'}
    {SUBSTITUTE: 'TABHEAD'}
   {HEADER-}
  {FIRST-}
    {SUBSTITUTE: 'LINIA0'}
    { licznik+=1; ~~}
  {OD}
  {HEADER}
    {SUBSTITUTE: 'HEAD'}
  {HEADER-}
  {FOOTER: 0}
    {LINE: 1}
  {FOOTER-}
  {SUBSTITUTE: 'LINIAF'}
  {IF:lineleft()>=1 & lineleft()<=2}{PAGE}{FI}
{FI}
{IF: licznik=0}
{FONT: 'T8G'}{SPACE: 'B'}
{<1 'Nie znaleziono niezgodności.'@}
{FI}
