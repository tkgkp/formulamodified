:!UTF-8
{TITLE:C. Zestawienie posesji kontrahentów}
{PRINTER: exec('set_parw','param_wydr'); exec('prt','param_wydr','h'),,,,,'Q','C',,,,,,1,
   PAR_WYDR.MBOT,PAR_WYDR.MLEFT,PAR_WYDR.MTOP,PAR_WYDR.MRIGHT,0,1,,'enable'}
{BEGIN:
   KH.cntx_psh();
   KH.win_dict('WERHOME2');
   GRKH.cntx_psh();
   GRKH.win_dict('WER');
   GRKH.index('KOD');

   VAR_DEL.delete('PRN','k','w','s','tryb');

   PRN:=obj_new(@.CLASS.PRINT,12);  PRN.s_frame();
   tryb:=rep_export();

   k:=obj_new(8);
   w:=obj_new(8);
   s:=obj_new(3);

   k[1] := 3;
   k[2] := 10;
   k[3] := 20;
   k[4] := 6;
   k[5] := 20;
   k[6] := 20;
   k[7] := 20;
   k[8] := 5;
   w[1] := w[2] := w[3] := w[4] := w[5] := w[6] := w[7] := w[8] := '';
   s[1] := s[2] := s[3] := 0;

   nrpos:=0;
   lp:=0;
   od_kh:='';
   do_kh:='';
   od_kod:='';
   do_kod:='';
   od_gr:='';
   do_gr:='';
   od_grk:='';
   do_grk:='';
   pref_miasto:='';
   pref_rejon:='';
   pref_ulica:='';
   pref_kod:='';
   ok:=0;

   'zmienne pomocnicze do wydrukow graficznych';
   color:='';
   prn1:='PRN'; prn2:='PRX';
   lm:=ll:=vp:=lmt:=0; rsep:=PAR_WYDR.RSEP;

   'parametry z tabeli WYDRUKI';
   _wydr_naz:='umo_002';
   WYDRUKIL.index('WYDRUKI');
   WYDRUKIL.prefix(OPERATOR.USER().KOD,_wydr_naz,);
   {? ~WYDRUKIL.first()
   ||
      WYDRUKIL.blank();
      WYDRUKIL.USERS:=OPERATOR.USER().KOD;
      WYDRUKIL.WYDRUK:=_wydr_naz;
      WYDRUKIL.add()
   ?};

   PAR_WYDR.TITLE:='Zestawienie posesji kontrahentów'@
;~~}
{END:
   VAR_DEL.delete('PRN','k','w','s','tryb');
   KH.cntx_pop();
   GRKH.cntx_pop();
   &nrpos;
   &lp;
   &od_kh;
   &od_kod;
   &do_kh;
   &do_kod;
   &od_gr;
   &do_gr;
   &od_grk;
   &do_grk;
   &pref_miasto;
   &pref_rejon;
   &pref_ulica;
   &pref_kod;
   &ok
;~~}
{INCLUDE: wsp_pw.rpi}
{INCLUDE: lum_umo_002.rpi}
{ {? tryb<>1 || PRN.add("form(w[1])",k[1],'Lp'@,1) ?}; ~~}
{ PRN.add("form(w[2])",k[2],'Kontrahent'@); ~~}
{ PRN.add("form(w[3])",k[3],'Grupa'@); ~~}
{ PRN.add("form(w[4])",k[4],'Poczta'@);~~}
{ PRN.add("form(w[5])",k[5],'Miasto'@); ~~}
{ PRN.add("form(w[6])",k[6],'Rejon'@); ~~}
{ PRN.add("form(w[7])",k[7],'Ulica'@); ~~}
{ PRN.add("form(w[8])",k[8],'Nr'@); ~~}
{
   WYDRUKIL.win_edit('UMO_002');
   {? WYDRUKIL.edit() || ok:=WYDRUKIL.put() ?}
;~~}
{COMMENT}------------------------------SIGNATURE--------------------{COMMENT-}
{IF: tryb<>1}{SUBSTITUTE: 'FOOT'}{FI}
{COMMENT}------------------------------REPORT-HEADER----------------{COMMENT-}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8G'}{SPACE: 'C'}
{ lmt:=int((charleft()-PRN.width())/2); ~~}
{<{lmt+1}}{'Parametry wydruku:'@}
{IF: WYDRUKIL.KH_OD | WYDRUKIL.KH_DO}{<{lmt+1}'Zakres kontrahentów: od %1 do %2'@[WYDRUKIL.KH_OD().KOD,WYDRUKIL.KH_DO().KOD]}{FI}
{IF: WYDRUKIL.GRKH_OD | WYDRUKIL.GRKH_DO}{<{lmt+1}'Zakres grup kontrahentów: od %1 do %2'@[WYDRUKIL.GRKH_OD().KOD,WYDRUKIL.GRKH_DO().KOD]}{FI}
{IF: WYDRUKIL.MI_OD<>null}{<{lmt+1}'Miasto - %1'@[WYDRUKIL.MI_OD().NAZ]}{FI}
{IF: WYDRUKIL.UL_OD<>null}{<{lmt+1}'Ulica - %1'@[WYDRUKIL.UL_OD().UL]}{FI}
{IF: UMO.REJO<>null}{<{lmt+1}'Rejon - %1'@[UMO.REJO().NAZ]}{FI}
{FONT: 'T8GB'}
{SUBSTITUTE: 'TABHEAD'}{FONT: 'T8G'}{ vp:=1; ~~}
{COMMENT}------------------------------HEADER-----------------------{COMMENT-}
{HEADER}
{SUBSTITUTE: 'HEAD'}
{FONT: 'T8GB'}{SPACE: 'C'}
{SUBSTITUTE: 'TABHEAD'}
{HEADER-}
{COMMENT}------------------------------FOOTER-----------------------{COMMENT-}
{FOOTER: 0}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}
{COMMENT}------------------------------WYDRUK-----------------------{COMMENT-}
{FONT: 'T8G'}{SPACE: 'C'}
{
   od_kh  := WYDRUKIL.KH_OD;
   do_kh  := WYDRUKIL.KH_DO;
   od_kod := WYDRUKIL.KH_OD().KOD;
   do_kod := WYDRUKIL.KH_DO().KOD;
   od_gr  := WYDRUKIL.GRKH_OD;
   do_gr  := WYDRUKIL.GRKH_DO;
   od_grk := WYDRUKIL.GRKH_OD().KOD;
   do_grk := WYDRUKIL.GRKH_DO().KOD;
   pref_miasto := WYDRUKIL.MI_OD().NAZ;
   pref_ulica := WYDRUKIL.UL_OD().UL;
   pref_rejon := UMO.REJO().NAZ
;~~}
{SUBSTITUTE:'druk'}
{FOOTER: 0}
{prn1:='PRN';~~}
{SUBSTITUTE: 'LINIAF'}
{LINE: 1}
{FOOTER-}